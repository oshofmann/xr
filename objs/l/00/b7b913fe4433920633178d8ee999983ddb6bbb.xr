var __xr_tmp = [
"static struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#netlbl_domhsh_search_def\">netlbl_domhsh_search_def</a>(const char *<a class=\"id\" href=\"#domain\">domain</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#netlbl_domhsh_search\">netlbl_domhsh_search</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#netlbl_domhsh_rcu_deref\">netlbl_domhsh_rcu_deref</a>(<a class=\"id\" href=\"#netlbl_domhsh_def\">netlbl_domhsh_def</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> != <a class=\"id\" href=\"#NULL\">NULL</a> && !<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#valid\">valid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#entry\">entry</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_audit_add - Generate an audit entry for an add event</span>", 
"<span class=\"comment\"> * @entry: the entry being added</span>", 
"<span class=\"comment\"> * @addr4: the IPv4 address information</span>", 
"<span class=\"comment\"> * @addr6: the IPv6 address information</span>", 
"<span class=\"comment\"> * @result: the result code</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Generate an audit record for adding a new NetLabel/LSM mapping entry with</span>", 
"<span class=\"comment\"> * the given information.  Caller is responsibile for holding the necessary</span>", 
"<span class=\"comment\"> * locks.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#netlbl_domhsh_audit_add\">netlbl_domhsh_audit_add</a>(struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#addr4\">addr4</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#addr6\">addr6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    int <a class=\"id\" href=\"#result\">result</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#cipsov4\">cipsov4</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#type\">type</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#netlbl_audit_start_common\">netlbl_audit_start_common</a>(<a class=\"id\" href=\"#AUDIT_MAC_MAP_ADD\">AUDIT_MAC_MAP_ADD</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" nlbl_domain=%s\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> ? <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> : \"(default)\");", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addr4\">addr4</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domaddr4_map\">netlbl_domaddr4_map</a> *<a class=\"id\" href=\"#map4\">map4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map4\">map4</a> = <a class=\"id\" href=\"#netlbl_domhsh_addr4_entry\">netlbl_domhsh_addr4_entry</a>(<a class=\"id\" href=\"#addr4\">addr4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#map4\">map4</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipsov4\">cipsov4</a> = <a class=\"id\" href=\"#map4\">map4</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_audit_addr\">netlbl_af4list_audit_addr</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, 0, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#addr4\">addr4</a>-><a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#addr4\">addr4</a>-><a class=\"id\" href=\"#mask\">mask</a>);", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#addr6\">addr6</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domaddr6_map\">netlbl_domaddr6_map</a> *<a class=\"id\" href=\"#map6\">map6</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map6\">map6</a> = <a class=\"id\" href=\"#netlbl_domhsh_addr6_entry\">netlbl_domhsh_addr6_entry</a>(<a class=\"id\" href=\"#addr6\">addr6</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#map6\">map6</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_audit_addr\">netlbl_af6list_audit_addr</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, 0, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#addr6\">addr6</a>-><a class=\"id\" href=\"#addr\">addr</a>, &amp;<a class=\"id\" href=\"#addr6\">addr6</a>-><a class=\"id\" href=\"#mask\">mask</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipsov4\">cipsov4</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLBL_NLTYPE_UNLABELED\">NETLBL_NLTYPE_UNLABELED</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" nlbl_protocol=unlbl\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLBL_NLTYPE_CIPSOV4\">NETLBL_NLTYPE_CIPSOV4</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#cipsov4\">cipsov4</a> == <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \" nlbl_protocol=cipsov4 cipso_doi=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#cipsov4\">cipsov4</a>-><a class=\"id\" href=\"#doi\">doi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" res=%u\", <a class=\"id\" href=\"#result\">result</a> == 0 ? 1 : 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Domain Hash Table Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_init - Init for the domain hash</span>", 
"<span class=\"comment\"> * @size: the number of bits to use for the hash buckets</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Initializes the domain hash table, should be called only by</span>", 
"<span class=\"comment\"> * netlbl_user_init() during initialization.  Returns zero on success, non-zero</span>", 
"<span class=\"comment\"> * values on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#netlbl_domhsh_init\">netlbl_domhsh_init</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#size\">size</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domhsh_tbl\">netlbl_domhsh_tbl</a> *<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#size\">size</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#size\">size</a> = 1 << <a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#size\">size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       sizeof(struct <a class=\"id\" href=\"#list_head\">list_head</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#tbl\">tbl</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#size\">size</a>; <a class=\"id\" href=\"#iter\">iter</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#tbl\">tbl</a>[<a class=\"id\" href=\"#iter\">iter</a>]);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#netlbl_domhsh\">netlbl_domhsh</a>, <a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_add - Adds a entry to the domain hash table</span>", 
"<span class=\"comment\"> * @entry: the entry to add</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Adds a new entry to the domain hash table and handles any updates to the</span>", 
"<span class=\"comment\"> * lower level protocol handler (i.e. CIPSO).  Returns zero on success,</span>", 
"<span class=\"comment\"> * negative on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_domhsh_add\">netlbl_domhsh_add</a>(struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry_old\">entry_old</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#iter4\">iter4</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#tmp4\">tmp4</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#iter6\">iter6</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#tmp6\">tmp6</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* XXX - we can remove this RCU read lock as the spinlock protects the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *       entire function, but before we do we need to fixup the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *       netlbl_af[4,6]list RCU functions to do \"the right thing\" with</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *       respect to rcu_dereference() when only a spinlock is held. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry_old\">entry_old</a> = <a class=\"id\" href=\"#netlbl_domhsh_search\">netlbl_domhsh_search</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry_old\">entry_old</a> = <a class=\"id\" href=\"#netlbl_domhsh_search_def\">netlbl_domhsh_search_def</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry_old\">entry_old</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#valid\">valid</a> = 1;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#bkt\">bkt</a> = <a class=\"id\" href=\"#netlbl_domhsh_hash\">netlbl_domhsh_hash</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail_rcu\">list_add_tail_rcu</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_domhsh\">netlbl_domhsh</a>)-><a class=\"id\" href=\"#tbl\">tbl</a>[<a class=\"id\" href=\"#bkt\">bkt</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#netlbl_domhsh_def\">netlbl_domhsh_def</a>, <a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_rcu\">netlbl_af4list_foreach_rcu</a>(<a class=\"id\" href=\"#iter4\">iter4</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_domhsh_audit_add\">netlbl_domhsh_audit_add</a>(<a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#iter4\">iter4</a>, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_foreach_rcu\">netlbl_af6list_foreach_rcu</a>(<a class=\"id\" href=\"#iter6\">iter6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list6\">list6</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_domhsh_audit_add\">netlbl_domhsh_audit_add</a>(<a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#iter6\">iter6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_domhsh_audit_add\">netlbl_domhsh_audit_add</a>(<a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#entry_old\">entry_old</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#old_list4\">old_list4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#old_list6\">old_list6</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_list4\">old_list4</a> = &amp;<a class=\"id\" href=\"#entry_old\">entry_old</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_list6\">old_list6</a> = &amp;<a class=\"id\" href=\"#entry_old\">entry_old</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list6\">list6</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* we only allow the addition of address selectors if all of</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * the selectors do not exist in the existing domain map */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_rcu\">netlbl_af4list_foreach_rcu</a>(<a class=\"id\" href=\"#iter4\">iter4</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#netlbl_af4list_search_exact\">netlbl_af4list_search_exact</a>(<a class=\"id\" href=\"#iter4\">iter4</a>-><a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter4\">iter4</a>-><a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_list4\">old_list4</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_return\">add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_foreach_rcu\">netlbl_af6list_foreach_rcu</a>(<a class=\"id\" href=\"#iter6\">iter6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list6\">list6</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#netlbl_af6list_search_exact\">netlbl_af6list_search_exact</a>(&amp;<a class=\"id\" href=\"#iter6\">iter6</a>-><a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#iter6\">iter6</a>-><a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_list6\">old_list6</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_return\">add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_safe\">netlbl_af4list_foreach_safe</a>(<a class=\"id\" href=\"#iter4\">iter4</a>, <a class=\"id\" href=\"#tmp4\">tmp4</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_remove_entry\">netlbl_af4list_remove_entry</a>(<a class=\"id\" href=\"#iter4\">iter4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter4\">iter4</a>-><a class=\"id\" href=\"#valid\">valid</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_af4list_add\">netlbl_af4list_add</a>(<a class=\"id\" href=\"#iter4\">iter4</a>, <a class=\"id\" href=\"#old_list4\">old_list4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_domhsh_audit_add\">netlbl_domhsh_audit_add</a>(<a class=\"id\" href=\"#entry_old\">entry_old</a>, <a class=\"id\" href=\"#iter4\">iter4</a>, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_return\">add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_foreach_safe\">netlbl_af6list_foreach_safe</a>(<a class=\"id\" href=\"#iter6\">iter6</a>, <a class=\"id\" href=\"#tmp6\">tmp6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list6\">list6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_remove_entry\">netlbl_af6list_remove_entry</a>(<a class=\"id\" href=\"#iter6\">iter6</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter6\">iter6</a>-><a class=\"id\" href=\"#valid\">valid</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_af6list_add\">netlbl_af6list_add</a>(<a class=\"id\" href=\"#iter6\">iter6</a>, <a class=\"id\" href=\"#old_list6\">old_list6</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_domhsh_audit_add\">netlbl_domhsh_audit_add</a>(<a class=\"id\" href=\"#entry_old\">entry_old</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#iter6\">iter6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_return\">add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<a class=\"id\" href=\"#add_return\">add_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_add_default - Adds the default entry to the domain hash table</span>", 
"<span class=\"comment\"> * @entry: the entry to add</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Adds a new default entry to the domain hash table and handles any updates</span>", 
"<span class=\"comment\"> * to the lower level protocol handler (i.e. CIPSO).  Returns zero on success,</span>", 
"<span class=\"comment\"> * negative on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_domhsh_add_default\">netlbl_domhsh_add_default</a>(struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_domhsh_add\">netlbl_domhsh_add</a>(<a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_remove_entry - Removes a given entry from the domain table</span>", 
"<span class=\"comment\"> * @entry: the entry to remove</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Removes an entry from the domain hash table and handles any updates to the</span>", 
"<span class=\"comment\"> * lower level protocol handler (i.e. CIPSO).  Caller is responsible for</span>", 
"<span class=\"comment\"> * ensuring that the RCU read lock is held.  Returns zero on success, negative</span>", 
"<span class=\"comment\"> * on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_domhsh_remove_entry\">netlbl_domhsh_remove_entry</a>(struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#valid\">valid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#valid\">valid</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> != <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_domhsh_def\">netlbl_domhsh_def</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#netlbl_domhsh_def\">netlbl_domhsh_def</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#netlbl_audit_start_common\">netlbl_audit_start_common</a>(<a class=\"id\" href=\"#AUDIT_MAC_MAP_DEL\">AUDIT_MAC_MAP_DEL</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \" nlbl_domain=%s res=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> ? <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> : \"(default)\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#ret_val\">ret_val</a> == 0 ? 1 : 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#iter4\">iter4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domaddr4_map\">netlbl_domaddr4_map</a> *<a class=\"id\" href=\"#map4\">map4</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_rcu\">netlbl_af4list_foreach_rcu</a>(<a class=\"id\" href=\"#iter4\">iter4</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map4\">map4</a> = <a class=\"id\" href=\"#netlbl_domhsh_addr4_entry\">netlbl_domhsh_addr4_entry</a>(<a class=\"id\" href=\"#iter4\">iter4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_putdef\">cipso_v4_doi_putdef</a>(<a class=\"id\" href=\"#map4\">map4</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* no need to check the IPv6 list since we currently</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * support only unlabeled protocols for IPv6 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLBL_NLTYPE_CIPSOV4\">NETLBL_NLTYPE_CIPSOV4</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_putdef\">cipso_v4_doi_putdef</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#netlbl_domhsh_free_entry\">netlbl_domhsh_free_entry</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_remove_af4 - Removes an address selector entry</span>", 
"<span class=\"comment\"> * @domain: the domain</span>", 
"<span class=\"comment\"> * @addr: IPv4 address</span>", 
"<span class=\"comment\"> * @mask: IPv4 address mask</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Removes an individual address selector from a domain mapping and potentially</span>", 
"<span class=\"comment\"> * the entire mapping if it is empty.  Returns zero on success, negative values</span>", 
"<span class=\"comment\"> * on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_domhsh_remove_af4\">netlbl_domhsh_remove_af4</a>(const char *<a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const struct <a class=\"id\" href=\"#in_addr\">in_addr</a> *<a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const struct <a class=\"id\" href=\"#in_addr\">in_addr</a> *<a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry_map\">entry_map</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#entry_addr\">entry_addr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#iter4\">iter4</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#iter6\">iter6</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domaddr4_map\">netlbl_domaddr4_map</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#domain\">domain</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry_map\">entry_map</a> = <a class=\"id\" href=\"#netlbl_domhsh_search\">netlbl_domhsh_search</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry_map\">entry_map</a> = <a class=\"id\" href=\"#netlbl_domhsh_search_def\">netlbl_domhsh_search_def</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry_map\">entry_map</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || <a class=\"id\" href=\"#entry_map\">entry_map</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#remove_af4_failure\">remove_af4_failure</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry_addr\">entry_addr</a> = <a class=\"id\" href=\"#netlbl_af4list_remove\">netlbl_af4list_remove</a>(<a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#s_addr\">s_addr</a>, <a class=\"id\" href=\"#mask\">mask</a>-><a class=\"id\" href=\"#s_addr\">s_addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#entry_map\">entry_map</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_domhsh_lock\">netlbl_domhsh_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry_addr\">entry_addr</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#remove_af4_failure\">remove_af4_failure</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_rcu\">netlbl_af4list_foreach_rcu</a>(<a class=\"id\" href=\"#iter4\">iter4</a>, &amp;<a class=\"id\" href=\"#entry_map\">entry_map</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#remove_af4_single_addr\">remove_af4_single_addr</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_foreach_rcu\">netlbl_af6list_foreach_rcu</a>(<a class=\"id\" href=\"#iter6\">iter6</a>, &amp;<a class=\"id\" href=\"#entry_map\">entry_map</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list6\">list6</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#remove_af4_single_addr\">remove_af4_single_addr</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* the domain mapping is empty so remove it from the mapping table */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_domhsh_remove_entry\">netlbl_domhsh_remove_entry</a>(<a class=\"id\" href=\"#entry_map\">entry_map</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"", 
"<a class=\"id\" href=\"#remove_af4_single_addr\">remove_af4_single_addr</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"comment\">/* yick, we can't use call_rcu here because we don't have a rcu head</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * pointer but hopefully this should be a rare case so the pause</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * shouldn't be a problem */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#synchronize_rcu\">synchronize_rcu</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#netlbl_domhsh_addr4_entry\">netlbl_domhsh_addr4_entry</a>(<a class=\"id\" href=\"#entry_addr\">entry_addr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_putdef\">cipso_v4_doi_putdef</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#remove_af4_failure\">remove_af4_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_remove - Removes an entry from the domain hash table</span>", 
"<span class=\"comment\"> * @domain: the domain to remove</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Removes an entry from the domain hash table and handles any updates to the</span>", 
"<span class=\"comment\"> * lower level protocol handler (i.e. CIPSO).  Returns zero on success,</span>", 
"<span class=\"comment\"> * negative on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_domhsh_remove\">netlbl_domhsh_remove</a>(const char *<a class=\"id\" href=\"#domain\">domain</a>, struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#domain\">domain</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#netlbl_domhsh_search\">netlbl_domhsh_search</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#netlbl_domhsh_search_def\">netlbl_domhsh_search_def</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_domhsh_remove_entry\">netlbl_domhsh_remove_entry</a>(<a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_remove_default - Removes the default entry from the table</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Removes/resets the default entry for the domain hash table and handles any</span>", 
"<span class=\"comment\"> * updates to the lower level protocol handler (i.e. CIPSO).  Returns zero on</span>", 
"<span class=\"comment\"> * success, non-zero on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_domhsh_remove_default\">netlbl_domhsh_remove_default</a>(struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_domhsh_remove\">netlbl_domhsh_remove</a>(<a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_getentry - Get an entry from the domain hash table</span>", 
"<span class=\"comment\"> * @domain: the domain name to search for</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Look through the domain hash table searching for an entry to match @domain,</span>", 
"<span class=\"comment\"> * return a pointer to a copy of the entry or NULL.  The caller is responsibile</span>", 
"<span class=\"comment\"> * for ensuring that rcu_read_[un]lock() is called.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#netlbl_domhsh_getentry\">netlbl_domhsh_getentry</a>(const char *<a class=\"id\" href=\"#domain\">domain</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_domhsh_search_def\">netlbl_domhsh_search_def</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_getentry_af4 - Get an entry from the domain hash table</span>", 
"<span class=\"comment\"> * @domain: the domain name to search for</span>", 
"<span class=\"comment\"> * @addr: the IP address to search for</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Look through the domain hash table searching for an entry to match @domain</span>", 
"<span class=\"comment\"> * and @addr, return a pointer to a copy of the entry or NULL.  The caller is</span>", 
"<span class=\"comment\"> * responsible for ensuring that rcu_read_[un]lock() is called.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"struct <a class=\"id\" href=\"#netlbl_domaddr4_map\">netlbl_domaddr4_map</a> *<a class=\"id\" href=\"#netlbl_domhsh_getentry_af4\">netlbl_domhsh_getentry_af4</a>(const char *<a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#dom_iter\">dom_iter</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#addr_iter\">addr_iter</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dom_iter\">dom_iter</a> = <a class=\"id\" href=\"#netlbl_domhsh_search_def\">netlbl_domhsh_search_def</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dom_iter\">dom_iter</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dom_iter\">dom_iter</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addr_iter\">addr_iter</a> = <a class=\"id\" href=\"#netlbl_af4list_search\">netlbl_af4list_search</a>(<a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#dom_iter\">dom_iter</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list4\">list4</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#addr_iter\">addr_iter</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_domhsh_addr4_entry\">netlbl_domhsh_addr4_entry</a>(<a class=\"id\" href=\"#addr_iter\">addr_iter</a>);", 
"}", 
"", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_getentry_af6 - Get an entry from the domain hash table</span>", 
"<span class=\"comment\"> * @domain: the domain name to search for</span>", 
"<span class=\"comment\"> * @addr: the IP address to search for</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Look through the domain hash table searching for an entry to match @domain</span>", 
"<span class=\"comment\"> * and @addr, return a pointer to a copy of the entry or NULL.  The caller is</span>", 
"<span class=\"comment\"> * responsible for ensuring that rcu_read_[un]lock() is called.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"struct <a class=\"id\" href=\"#netlbl_domaddr6_map\">netlbl_domaddr6_map</a> *<a class=\"id\" href=\"#netlbl_domhsh_getentry_af6\">netlbl_domhsh_getentry_af6</a>(const char *<a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   const struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#dom_iter\">dom_iter</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#addr_iter\">addr_iter</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dom_iter\">dom_iter</a> = <a class=\"id\" href=\"#netlbl_domhsh_search_def\">netlbl_domhsh_search_def</a>(<a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dom_iter\">dom_iter</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dom_iter\">dom_iter</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addr_iter\">addr_iter</a> = <a class=\"id\" href=\"#netlbl_af6list_search\">netlbl_af6list_search</a>(<a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#dom_iter\">dom_iter</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a>-><a class=\"id\" href=\"#list6\">list6</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#addr_iter\">addr_iter</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_domhsh_addr6_entry\">netlbl_domhsh_addr6_entry</a>(<a class=\"id\" href=\"#addr_iter\">addr_iter</a>);", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_domhsh_walk - Iterate through the domain mapping hash table</span>", 
"<span class=\"comment\"> * @skip_bkt: the number of buckets to skip at the start</span>", 
"<span class=\"comment\"> * @skip_chain: the number of entries to skip in the first iterated bucket</span>", 
"<span class=\"comment\"> * @callback: callback for each entry</span>", 
"<span class=\"comment\"> * @cb_arg: argument for the callback function</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Interate over the domain mapping hash table, skipping the first @skip_bkt</span>", 
"<span class=\"comment\"> * buckets and @skip_chain entries.  For each entry in the table call</span>", 
"<span class=\"comment\"> * @callback, if @callback returns a negative value stop 'walking' through the</span>", 
"<span class=\"comment\"> * table and return.  Updates the values in @skip_bkt and @skip_chain on</span>", 
"<span class=\"comment\"> * return.  Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_domhsh_walk\">netlbl_domhsh_walk</a>(<a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#skip_bkt\">skip_bkt</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#skip_chain\">skip_chain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>     int (*<a class=\"id\" href=\"#callback\">callback</a>) (struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>, void *<a class=\"id\" href=\"#arg\">arg</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/>     void *<a class=\"id\" href=\"#cb_arg\">cb_arg</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter_bkt\">iter_bkt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#iter_list\">iter_list</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#iter_entry\">iter_entry</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#chain_cnt\">chain_cnt</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter_bkt\">iter_bkt</a> = *<a class=\"id\" href=\"#skip_bkt\">skip_bkt</a>;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#iter_bkt\">iter_bkt</a> &lt; <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_domhsh\">netlbl_domhsh</a>)-><a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#iter_bkt\">iter_bkt</a>++, <a class=\"id\" href=\"#chain_cnt\">chain_cnt</a> = 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_list\">iter_list</a> = &amp;<a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_domhsh\">netlbl_domhsh</a>)-><a class=\"id\" href=\"#tbl\">tbl</a>[<a class=\"id\" href=\"#iter_bkt\">iter_bkt</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#iter_entry\">iter_entry</a>, <a class=\"id\" href=\"#iter_list\">iter_list</a>, <a class=\"id\" href=\"#list\">list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter_entry\">iter_entry</a>-><a class=\"id\" href=\"#valid\">valid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#chain_cnt\">chain_cnt</a>++ &lt; *<a class=\"id\" href=\"#skip_chain\">skip_chain</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#callback\">callback</a>(<a class=\"id\" href=\"#iter_entry\">iter_entry</a>, <a class=\"id\" href=\"#cb_arg\">cb_arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#chain_cnt\">chain_cnt</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#walk_return\">walk_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#walk_return\">walk_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#skip_bkt\">skip_bkt</a> = <a class=\"id\" href=\"#iter_bkt\">iter_bkt</a>;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#skip_chain\">skip_chain</a> = <a class=\"id\" href=\"#chain_cnt\">chain_cnt</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
];
xr_frag_insert('l/00/b7b913fe4433920633178d8ee999983ddb6bbb.xr', __xr_tmp);
