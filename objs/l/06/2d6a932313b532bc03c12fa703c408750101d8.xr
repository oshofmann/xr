var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * xfrm6_policy.c: based on xfrm4_policy.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Authors:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Mitsuru KANDA @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>Kazunori MIYAZAWA @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>Kunihiro Ishiguro &lt;kunihiro@ipinfusion.com&gt;</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/><span class=\"ts\"/>IPv6 support</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>YOSHIFUJI Hideaki</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/><span class=\"ts\"/>Split up af-specific portion</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#err\">err</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#addrconf\">addrconf</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip6_route\">ip6_route</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MIP6\">CONFIG_IPV6_MIP6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MIP6_MODULE\">CONFIG_IPV6_MIP6_MODULE</a>)", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#mip6\">mip6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> <a class=\"id\" href=\"#xfrm6_policy_afinfo\">xfrm6_policy_afinfo</a>;", 
"", 
"static struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#xfrm6_dst_lookup\">xfrm6_dst_lookup</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#tos\">tos</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = {};", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl6_dst\">fl6_dst</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, sizeof(<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl6_dst\">fl6_dst</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#saddr\">saddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl6_src\">fl6_src</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, sizeof(<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl6_src\">fl6_src</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#ip6_route_output\">ip6_route_output</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#error\">error</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_release\">dst_release</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#dst\">dst</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#xfrm6_get_saddr\">xfrm6_get_saddr</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#xfrm6_dst_lookup\">xfrm6_dst_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, 0, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#daddr\">daddr</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#dst\">dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EHOSTUNREACH\">EHOSTUNREACH</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ip6_dst_idev\">ip6_dst_idev</a>(<a class=\"id\" href=\"#dst\">dst</a>)-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ipv6_dev_get_saddr\">ipv6_dev_get_saddr</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)&amp;<a class=\"id\" href=\"#daddr\">daddr</a>-><a class=\"id\" href=\"#a6\">a6</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)&amp;<a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#a6\">a6</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst_release\">dst_release</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#xfrm6_get_tos\">xfrm6_get_tos</a>(struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>)", 
"{", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#xfrm6_init_path\">xfrm6_init_path</a>(struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#path\">path</a>, struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   int <a class=\"id\" href=\"#nfheader_len\">nfheader_len</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a> *<a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a>*)<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_node\">rt6i_node</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#path_cookie\">path_cookie</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_node\">rt6i_node</a>-><a class=\"id\" href=\"#fn_sernum\">fn_sernum</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_nfheader_len\">rt6i_nfheader_len</a> = <a class=\"id\" href=\"#nfheader_len\">nfheader_len</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#xfrm6_fill_dst\">xfrm6_fill_dst</a>(struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a> *<a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a>*)<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#route\">route</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_idev\">rt6i_idev</a> = <a class=\"id\" href=\"#in6_dev_get\">in6_dev_get</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_idev\">rt6i_idev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Sheit... I remember I did this right. Apparently,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * it was magically lost, so this code needs audit */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_flags\">rt6i_flags</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_flags\">rt6i_flags</a> &amp; (<a class=\"id\" href=\"#RTF_ANYCAST\">RTF_ANYCAST</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#RTF_LOCAL\">RTF_LOCAL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_metric\">rt6i_metric</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_metric\">rt6i_metric</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_node\">rt6i_node</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_node\">rt6i_node</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_node\">rt6i_node</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#route_cookie\">route_cookie</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_node\">rt6i_node</a>-><a class=\"id\" href=\"#fn_sernum\">fn_sernum</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_gateway\">rt6i_gateway</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_gateway\">rt6i_gateway</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_dst\">rt6i_dst</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_dst\">rt6i_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_src\">rt6i_src</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_src\">rt6i_src</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void", 
"<a class=\"id\" href=\"#_decode_session6\">_decode_session6</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>, int <a class=\"id\" href=\"#reverse\">reverse</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#onlyproto\">onlyproto</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#skb_network_header_len\">skb_network_header_len</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipv6hdr\">ipv6hdr</a> *<a class=\"id\" href=\"#hdr\">hdr</a> = <a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipv6_opt_hdr\">ipv6_opt_hdr</a> *<a class=\"id\" href=\"#exthdr\">exthdr</a>;", 
"<span class=\"ts\"/>const unsigned char *<a class=\"id\" href=\"#nh\">nh</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#nexthdr\">nexthdr</a> = <a class=\"id\" href=\"#nh\">nh</a>[<a class=\"id\" href=\"#IP6CB\">IP6CB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#nhoff\">nhoff</a>];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#fl\">fl</a>, 0, sizeof(struct <a class=\"id\" href=\"#flowi\">flowi</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl6_dst\">fl6_dst</a>, <a class=\"id\" href=\"#reverse\">reverse</a> ? &amp;<a class=\"id\" href=\"#hdr\">hdr</a>-><a class=\"id\" href=\"#saddr\">saddr</a> : &amp;<a class=\"id\" href=\"#hdr\">hdr</a>-><a class=\"id\" href=\"#daddr\">daddr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl6_src\">fl6_src</a>, <a class=\"id\" href=\"#reverse\">reverse</a> ? &amp;<a class=\"id\" href=\"#hdr\">hdr</a>-><a class=\"id\" href=\"#daddr\">daddr</a> : &amp;<a class=\"id\" href=\"#hdr\">hdr</a>-><a class=\"id\" href=\"#saddr\">saddr</a>);", 
"", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a> + 1 &lt; <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> ||", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#pskb_may_pull\">pskb_may_pull</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a> + 1 - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nh\">nh</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#exthdr\">exthdr</a> = (struct <a class=\"id\" href=\"#ipv6_opt_hdr\">ipv6_opt_hdr</a> *)(<a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#nexthdr\">nexthdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NEXTHDR_FRAGMENT\">NEXTHDR_FRAGMENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#onlyproto\">onlyproto</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NEXTHDR_ROUTING\">NEXTHDR_ROUTING</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NEXTHDR_HOP\">NEXTHDR_HOP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NEXTHDR_DEST\">NEXTHDR_DEST</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> += <a class=\"id\" href=\"#ipv6_optlen\">ipv6_optlen</a>(<a class=\"id\" href=\"#exthdr\">exthdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nexthdr\">nexthdr</a> = <a class=\"id\" href=\"#exthdr\">exthdr</a>-><a class=\"id\" href=\"#nexthdr\">nexthdr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#exthdr\">exthdr</a> = (struct <a class=\"id\" href=\"#ipv6_opt_hdr\">ipv6_opt_hdr</a> *)(<a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_UDP\">IPPROTO_UDP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_UDPLITE\">IPPROTO_UDPLITE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_TCP\">IPPROTO_TCP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_SCTP\">IPPROTO_SCTP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_DCCP\">IPPROTO_DCCP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#onlyproto\">onlyproto</a> && (<a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a> + 4 &lt; <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#pskb_may_pull\">pskb_may_pull</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a> + 4 - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be16\">__be16</a> *<a class=\"id\" href=\"#ports\">ports</a> = (<a class=\"id\" href=\"#__be16\">__be16</a> *)<a class=\"id\" href=\"#exthdr\">exthdr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl_ip_sport\">fl_ip_sport</a> = <a class=\"id\" href=\"#ports\">ports</a>[!!<a class=\"id\" href=\"#reverse\">reverse</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl_ip_dport\">fl_ip_dport</a> = <a class=\"id\" href=\"#ports\">ports</a>[!<a class=\"id\" href=\"#reverse\">reverse</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#nexthdr\">nexthdr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_ICMPV6\">IPPROTO_ICMPV6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#onlyproto\">onlyproto</a> && <a class=\"id\" href=\"#pskb_may_pull\">pskb_may_pull</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a> + 2 - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#icmp\">icmp</a> = (<a class=\"id\" href=\"#u8\">u8</a> *)<a class=\"id\" href=\"#exthdr\">exthdr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl_icmp_type\">fl_icmp_type</a> = <a class=\"id\" href=\"#icmp\">icmp</a>[0];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl_icmp_code\">fl_icmp_code</a> = <a class=\"id\" href=\"#icmp\">icmp</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#nexthdr\">nexthdr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MIP6\">CONFIG_IPV6_MIP6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MIP6_MODULE\">CONFIG_IPV6_MIP6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_MH\">IPPROTO_MH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#onlyproto\">onlyproto</a> && <a class=\"id\" href=\"#pskb_may_pull\">pskb_may_pull</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nh\">nh</a> + <a class=\"id\" href=\"#offset\">offset</a> + 3 - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ip6_mh\">ip6_mh</a> *<a class=\"id\" href=\"#mh\">mh</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mh\">mh</a> = (struct <a class=\"id\" href=\"#ip6_mh\">ip6_mh</a> *)<a class=\"id\" href=\"#exthdr\">exthdr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl_mh_type\">fl_mh_type</a> = <a class=\"id\" href=\"#mh\">mh</a>-><a class=\"id\" href=\"#ip6mh_type\">ip6mh_type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#nexthdr\">nexthdr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* XXX Why are there these headers? */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_AH\">IPPROTO_AH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_ESP\">IPPROTO_ESP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPPROTO_COMP\">IPPROTO_COMP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl_ipsec_spi\">fl_ipsec_spi</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#nexthdr\">nexthdr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#xfrm6_garbage_collect\">xfrm6_garbage_collect</a>(struct <a class=\"id\" href=\"#dst_ops\">dst_ops</a> *<a class=\"id\" href=\"#ops\">ops</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#ops\">ops</a>, struct <a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#xfrm6_dst_ops\">xfrm6_dst_ops</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_policy_afinfo\">xfrm6_policy_afinfo</a>.<a class=\"id\" href=\"#garbage_collect\">garbage_collect</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#entries\">entries</a>) &gt; <a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#gc_thresh\">gc_thresh</a> * 2);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm6_update_pmtu\">xfrm6_update_pmtu</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mtu\">mtu</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a> = (struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *)<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#path\">path</a> = <a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#route\">route</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#update_pmtu\">update_pmtu</a>(<a class=\"id\" href=\"#path\">path</a>, <a class=\"id\" href=\"#mtu\">mtu</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm6_dst_destroy\">xfrm6_dst_destroy</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a> = (struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *)<a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_idev\">rt6i_idev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_idev\">rt6i_idev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_dst_destroy\">xfrm_dst_destroy</a>(<a class=\"id\" href=\"#xdst\">xdst</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm6_dst_ifdown\">xfrm6_dst_ifdown</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     int <a class=\"id\" href=\"#unregister\">unregister</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#unregister\">unregister</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a> = (struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *)<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_idev\">rt6i_idev</a>-><a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet6_dev\">inet6_dev</a> *<a class=\"id\" href=\"#loopback_idev\">loopback_idev</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_get\">in6_dev_get</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>)-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(!<a class=\"id\" href=\"#loopback_idev\">loopback_idev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_idev\">rt6i_idev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#rt6\">rt6</a>.<a class=\"id\" href=\"#rt6i_idev\">rt6i_idev</a> = <a class=\"id\" href=\"#loopback_idev\">loopback_idev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_hold\">in6_dev_hold</a>(<a class=\"id\" href=\"#loopback_idev\">loopback_idev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a> = (struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *)<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#child\">child</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} while (<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#xfrm\">xfrm</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__in6_dev_put\">__in6_dev_put</a>(<a class=\"id\" href=\"#loopback_idev\">loopback_idev</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_dst_ifdown\">xfrm_dst_ifdown</a>(<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#dst_ops\">dst_ops</a> <a class=\"id\" href=\"#xfrm6_dst_ops\">xfrm6_dst_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#family\">family</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#protocol\">protocol</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cpu_to_be16\">cpu_to_be16</a>(<a class=\"id\" href=\"#ETH_P_IPV6\">ETH_P_IPV6</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#gc\">gc</a> =<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_garbage_collect\">xfrm6_garbage_collect</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#update_pmtu\">update_pmtu</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_update_pmtu\">xfrm6_update_pmtu</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#destroy\">destroy</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_dst_destroy\">xfrm6_dst_destroy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#ifdown\">ifdown</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_dst_ifdown\">xfrm6_dst_ifdown</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#local_out\">local_out</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__ip6_local_out\">__ip6_local_out</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#gc_thresh\">gc_thresh</a> =<span class=\"ts\"/><span class=\"ts\"/>1024,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#entries\">entries</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ATOMIC_INIT\">ATOMIC_INIT</a>(0),", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> <a class=\"id\" href=\"#xfrm6_policy_afinfo\">xfrm6_policy_afinfo</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#family\">family</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dst_ops\">dst_ops</a> =<span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#xfrm6_dst_ops\">xfrm6_dst_ops</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dst_lookup\">dst_lookup</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_dst_lookup\">xfrm6_dst_lookup</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_saddr\">get_saddr</a> = <span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_get_saddr\">xfrm6_get_saddr</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#decode_session\">decode_session</a> =<span class=\"ts\"/><a class=\"id\" href=\"#_decode_session6\">_decode_session6</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_tos\">get_tos</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_get_tos\">xfrm6_get_tos</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#init_path\">init_path</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_init_path\">xfrm6_init_path</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#fill_dst\">fill_dst</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_fill_dst\">xfrm6_fill_dst</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#xfrm6_policy_init\">xfrm6_policy_init</a>(void)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#xfrm_policy_register_afinfo\">xfrm_policy_register_afinfo</a>(&amp;<a class=\"id\" href=\"#xfrm6_policy_afinfo\">xfrm6_policy_afinfo</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm6_policy_fini\">xfrm6_policy_fini</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_unregister_afinfo\">xfrm_policy_unregister_afinfo</a>(&amp;<a class=\"id\" href=\"#xfrm6_policy_afinfo\">xfrm6_policy_afinfo</a>);", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SYSCTL\">CONFIG_SYSCTL</a>", 
"static struct <a class=\"id\" href=\"#ctl_table\">ctl_table</a> <a class=\"id\" href=\"#xfrm6_policy_table\">xfrm6_policy_table</a>[] = {", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#procname\">procname</a>       = \"xfrm6_gc_thresh\",", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#data\">data</a><span class=\"ts\"/>   <span class=\"ts\"/>= &amp;<a class=\"id\" href=\"#init_net\">init_net</a>.<a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#xfrm6_dst_ops\">xfrm6_dst_ops</a>.<a class=\"id\" href=\"#gc_thresh\">gc_thresh</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#maxlen\">maxlen</a><span class=\"ts\"/> <span class=\"ts\"/>= sizeof(int),", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#mode\">mode</a><span class=\"ts\"/>   <span class=\"ts\"/>= 0644,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#proc_handler\">proc_handler</a>   = <a class=\"id\" href=\"#proc_dointvec\">proc_dointvec</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{ }", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#ctl_table_header\">ctl_table_header</a> *<a class=\"id\" href=\"#sysctl_hdr\">sysctl_hdr</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#xfrm6_init\">xfrm6_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#gc_thresh\">gc_thresh</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * We need a good default value for the xfrm6 gc threshold.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * In ipv4 we set it to the route hash table size * 8, which</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * is half the size of the maximaum route cache for ipv4.  It</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * would be good to do the same thing for v6, except the table is</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * constructed differently here.  Here each table for a net namespace</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * can have FIB_TABLE_HASHSZ entries, so lets go with the same</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * computation that we used for ipv4 here.  Also, lets keep the initial</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * gc_thresh to a minimum of 1024, since, the ipv6 route cache defaults</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * to that as a minimum as well</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#gc_thresh\">gc_thresh</a> = <a class=\"id\" href=\"#FIB6_TABLE_HASHSZ\">FIB6_TABLE_HASHSZ</a> * 8;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_dst_ops\">xfrm6_dst_ops</a>.<a class=\"id\" href=\"#gc_thresh\">gc_thresh</a> = (<a class=\"id\" href=\"#gc_thresh\">gc_thresh</a> &lt; 1024) ? 1024 : <a class=\"id\" href=\"#gc_thresh\">gc_thresh</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#xfrm6_policy_init\">xfrm6_policy_init</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#xfrm6_state_init\">xfrm6_state_init</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_policy\">out_policy</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SYSCTL\">CONFIG_SYSCTL</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sysctl_hdr\">sysctl_hdr</a> = <a class=\"id\" href=\"#register_net_sysctl_table\">register_net_sysctl_table</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, <a class=\"id\" href=\"#net_ipv6_ctl_path\">net_ipv6_ctl_path</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_policy_table\">xfrm6_policy_table</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"<a class=\"id\" href=\"#out_policy\">out_policy</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_policy_fini\">xfrm6_policy_fini</a>();", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#xfrm6_fini\">xfrm6_fini</a>(void)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SYSCTL\">CONFIG_SYSCTL</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sysctl_hdr\">sysctl_hdr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#unregister_net_sysctl_table\">unregister_net_sysctl_table</a>(<a class=\"id\" href=\"#sysctl_hdr\">sysctl_hdr</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"comment\">//xfrm6_input_fini();</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_policy_fini\">xfrm6_policy_fini</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm6_state_fini\">xfrm6_state_fini</a>();", 
"}", 
];
xr_frag_insert('l/06/2d6a932313b532bc03c12fa703c408750101d8.xr', __xr_tmp);
