var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * RTC subsystem, initialize system time on startup</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (C) 2005 Tower Technologies</span>", 
"<span class=\"comment\"> * Author: Alessandro Zummo &lt;a.zummo@towertech.it&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of the GNU General Public License version 2 as</span>", 
"<span class=\"comment\"> * published by the Free Software Foundation.</span>", 
"<span class=\"comment\">*/</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#rtc\">rtc</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"<span class=\"comment\">/* IMPORTANT: the RTC only stores whole seconds. It is arbitrary</span>", 
"<span class=\"comment\"> * whether it stores the most close value or the value with partial</span>", 
"<span class=\"comment\"> * seconds truncated. However, it is important that we use it to store</span>", 
"<span class=\"comment\"> * the truncated value. This is because otherwise it is necessary,</span>", 
"<span class=\"comment\"> * in an rtc sync function, to read both xtime.tv_sec and</span>", 
"<span class=\"comment\"> * xtime.tv_nsec. On some processors (i.e. ARM), an atomic read</span>", 
"<span class=\"comment\"> * of &gt;32bits is not possible. So storing the most close value would</span>", 
"<span class=\"comment\"> * slow down the sync API. So here we have the truncated value and</span>", 
"<span class=\"comment\"> * the best guess is to add 0.5s.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#rtc_hctosys_ret\">rtc_hctosys_ret</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#rtc_hctosys\">rtc_hctosys</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtc_time\">rtc_time</a> <a class=\"id\" href=\"#tm\">tm</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#tv\">tv</a> = {", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#tv_nsec\">tv_nsec</a> = <a class=\"id\" href=\"#NSEC_PER_SEC\">NSEC_PER_SEC</a> >> 1,", 
"<span class=\"ts\"/>};", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtc_device\">rtc_device</a> *<a class=\"id\" href=\"#rtc\">rtc</a> = <a class=\"id\" href=\"#rtc_class_open\">rtc_class_open</a>(<a class=\"id\" href=\"#CONFIG_RTC_HCTOSYS_DEVICE\">CONFIG_RTC_HCTOSYS_DEVICE</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rtc\">rtc</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pr_err\">pr_err</a>(\"%s: unable to open rtc device (%s)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__FILE__\">__FILE__</a>, <a class=\"id\" href=\"#CONFIG_RTC_HCTOSYS_DEVICE\">CONFIG_RTC_HCTOSYS_DEVICE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_open\">err_open</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rtc_read_time\">rtc_read_time</a>(<a class=\"id\" href=\"#rtc\">rtc</a>, &amp;<a class=\"id\" href=\"#tm\">tm</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_err\">dev_err</a>(<a class=\"id\" href=\"#rtc\">rtc</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#parent\">parent</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"hctosys: unable to read the hardware clock\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_read\">err_read</a>;", 
"", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rtc_valid_tm\">rtc_valid_tm</a>(&amp;<a class=\"id\" href=\"#tm\">tm</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_err\">dev_err</a>(<a class=\"id\" href=\"#rtc\">rtc</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#parent\">parent</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"hctosys: invalid date/time\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_invalid\">err_invalid</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtc_tm_to_time\">rtc_tm_to_time</a>(&amp;<a class=\"id\" href=\"#tm\">tm</a>, &amp;<a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_sec\">tv_sec</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#do_settimeofday\">do_settimeofday</a>(&amp;<a class=\"id\" href=\"#tv\">tv</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_info\">dev_info</a>(<a class=\"id\" href=\"#rtc\">rtc</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#parent\">parent</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>\"setting system clock to \"", 
"<span class=\"ts\"/><span class=\"ts\"/>\"%d-%02d-%02d %02d:%02d:%02d UTC (%u)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tm\">tm</a>.<a class=\"id\" href=\"#tm_year\">tm_year</a> + 1900, <a class=\"id\" href=\"#tm\">tm</a>.<a class=\"id\" href=\"#tm_mon\">tm_mon</a> + 1, <a class=\"id\" href=\"#tm\">tm</a>.<a class=\"id\" href=\"#tm_mday\">tm_mday</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tm\">tm</a>.<a class=\"id\" href=\"#tm_hour\">tm_hour</a>, <a class=\"id\" href=\"#tm\">tm</a>.<a class=\"id\" href=\"#tm_min\">tm_min</a>, <a class=\"id\" href=\"#tm\">tm</a>.<a class=\"id\" href=\"#tm_sec\">tm_sec</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>(unsigned int) <a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_sec\">tv_sec</a>);", 
"", 
"<a class=\"id\" href=\"#err_invalid\">err_invalid</a>:", 
"<a class=\"id\" href=\"#err_read\">err_read</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtc_class_close\">rtc_class_close</a>(<a class=\"id\" href=\"#rtc\">rtc</a>);", 
"", 
"<a class=\"id\" href=\"#err_open\">err_open</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtc_hctosys_ret\">rtc_hctosys_ret</a> = <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#late_initcall\">late_initcall</a>(<a class=\"id\" href=\"#rtc_hctosys\">rtc_hctosys</a>);", 
];
xr_frag_insert('l/07/d1b383f0dcb38cbc5881da1cb4cb70d8ab21d7.xr', __xr_tmp);
