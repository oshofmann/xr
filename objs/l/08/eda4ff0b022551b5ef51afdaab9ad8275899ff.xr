var __xr_tmp = [
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#ROOTCONTEXT_MNT\">ROOTCONTEXT_MNT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#DEFCONTEXT_MNT\">DEFCONTEXT_MNT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#defcontext_sid\">defcontext_sid</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bad_option\">bad_option</a>(<a class=\"id\" href=\"#sbsec\">sbsec</a>, <a class=\"id\" href=\"#DEFCONTEXT_MNT\">DEFCONTEXT_MNT</a>, <a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#def_sid\">def_sid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#defcontext_sid\">defcontext_sid</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_double_mount\">out_double_mount</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DEFCONTEXT_MNT\">DEFCONTEXT_MNT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#SE_SBINITIALIZED\">SE_SBINITIALIZED</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* previously mounted with options, but not on this attempt? */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#SE_MNTMASK\">SE_MNTMASK</a>) && !<a class=\"id\" href=\"#num_opts\">num_opts</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_double_mount\">out_double_mount</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#sb\">sb</a>-><a class=\"id\" href=\"#s_type\">s_type</a>-><a class=\"id\" href=\"#name\">name</a>, \"proc\") == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#SE_SBPROC\">SE_SBPROC</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Determine the labeling behavior to use for this filesystem type. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#security_fs_use\">security_fs_use</a>((<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#SE_SBPROC\">SE_SBPROC</a>) ? \"proc\" : <a class=\"id\" href=\"#sb\">sb</a>-><a class=\"id\" href=\"#s_type\">s_type</a>-><a class=\"id\" href=\"#name\">name</a>, &amp;<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#behavior\">behavior</a>, &amp;<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"%s: security_fs_use(%s) returned %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#__func__\">__func__</a>, <a class=\"id\" href=\"#sb\">sb</a>-><a class=\"id\" href=\"#s_type\">s_type</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#rc\">rc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* sets the context of the superblock for the fs being mounted. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fscontext_sid\">fscontext_sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#may_context_mount_sb_relabel\">may_context_mount_sb_relabel</a>(<a class=\"id\" href=\"#fscontext_sid\">fscontext_sid</a>, <a class=\"id\" href=\"#sbsec\">sbsec</a>, <a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#fscontext_sid\">fscontext_sid</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Switch to using mount point labeling behavior.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * sets the label used on all file below the mountpoint, and will set</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * the superblock context if not already set.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#context_sid\">context_sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fscontext_sid\">fscontext_sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#may_context_mount_sb_relabel\">may_context_mount_sb_relabel</a>(<a class=\"id\" href=\"#context_sid\">context_sid</a>, <a class=\"id\" href=\"#sbsec\">sbsec</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#context_sid\">context_sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#may_context_mount_inode_relabel\">may_context_mount_inode_relabel</a>(<a class=\"id\" href=\"#context_sid\">context_sid</a>, <a class=\"id\" href=\"#sbsec\">sbsec</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#rootcontext_sid\">rootcontext_sid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rootcontext_sid\">rootcontext_sid</a> = <a class=\"id\" href=\"#context_sid\">context_sid</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#mntpoint_sid\">mntpoint_sid</a> = <a class=\"id\" href=\"#context_sid\">context_sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#behavior\">behavior</a> = <a class=\"id\" href=\"#SECURITY_FS_USE_MNTPOINT\">SECURITY_FS_USE_MNTPOINT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rootcontext_sid\">rootcontext_sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#may_context_mount_inode_relabel\">may_context_mount_inode_relabel</a>(<a class=\"id\" href=\"#rootcontext_sid\">rootcontext_sid</a>, <a class=\"id\" href=\"#sbsec\">sbsec</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#root_isec\">root_isec</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#rootcontext_sid\">rootcontext_sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#root_isec\">root_isec</a>-><a class=\"id\" href=\"#initialized\">initialized</a> = 1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#defcontext_sid\">defcontext_sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#behavior\">behavior</a> != <a class=\"id\" href=\"#SECURITY_FS_USE_XATTR\">SECURITY_FS_USE_XATTR</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"SELinux: defcontext option is \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       \"invalid for this filesystem type\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#defcontext_sid\">defcontext_sid</a> != <a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#def_sid\">def_sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#may_context_mount_inode_relabel\">may_context_mount_inode_relabel</a>(<a class=\"id\" href=\"#defcontext_sid\">defcontext_sid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#sbsec\">sbsec</a>, <a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#def_sid\">def_sid</a> = <a class=\"id\" href=\"#defcontext_sid\">defcontext_sid</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#sb_finish_set_opts\">sb_finish_set_opts</a>(<a class=\"id\" href=\"#sb\">sb</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"<a class=\"id\" href=\"#out_double_mount\">out_double_mount</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"SELinux: mount invalid.  Same superblock, different \"", 
"<span class=\"ts\"/>       \"security settings for (dev %s, type %s)\\n\", <a class=\"id\" href=\"#sb\">sb</a>-><a class=\"id\" href=\"#s_id\">s_id</a>, <a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#selinux_sb_clone_mnt_opts\">selinux_sb_clone_mnt_opts</a>(const struct <a class=\"id\" href=\"#super_block\">super_block</a> *<a class=\"id\" href=\"#oldsb\">oldsb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#super_block\">super_block</a> *<a class=\"id\" href=\"#newsb\">newsb</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#superblock_security_struct\">superblock_security_struct</a> *<a class=\"id\" href=\"#oldsbsec\">oldsbsec</a> = <a class=\"id\" href=\"#oldsb\">oldsb</a>-><a class=\"id\" href=\"#s_security\">s_security</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#superblock_security_struct\">superblock_security_struct</a> *<a class=\"id\" href=\"#newsbsec\">newsbsec</a> = <a class=\"id\" href=\"#newsb\">newsb</a>-><a class=\"id\" href=\"#s_security\">s_security</a>;", 
"", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#set_fscontext\">set_fscontext</a> =<span class=\"ts\"/>(<a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#FSCONTEXT_MNT\">FSCONTEXT_MNT</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#set_context\">set_context</a> =<span class=\"ts\"/>(<a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#CONTEXT_MNT\">CONTEXT_MNT</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#set_rootcontext\">set_rootcontext</a> =<span class=\"ts\"/>(<a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#ROOTCONTEXT_MNT\">ROOTCONTEXT_MNT</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * if the parent was able to be mounted it clearly had no special lsm</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * mount options.  thus we can safely deal with this superblock later</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ss_initialized\">ss_initialized</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* how can we clone if the old one wasn't set up?? */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(!(<a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#SE_SBINITIALIZED\">SE_SBINITIALIZED</a>));", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* if fs is reusing a sb, just let its options stand... */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#SE_SBINITIALIZED\">SE_SBINITIALIZED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#def_sid\">def_sid</a> = <a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#def_sid\">def_sid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#behavior\">behavior</a> = <a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#behavior\">behavior</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#set_context\">set_context</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#oldsbsec\">oldsbsec</a>-><a class=\"id\" href=\"#mntpoint_sid\">mntpoint_sid</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#set_fscontext\">set_fscontext</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#set_rootcontext\">set_rootcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#newinode\">newinode</a> = <a class=\"id\" href=\"#newsb\">newsb</a>-><a class=\"id\" href=\"#s_root\">s_root</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inode_security_struct\">inode_security_struct</a> *<a class=\"id\" href=\"#newisec\">newisec</a> = <a class=\"id\" href=\"#newinode\">newinode</a>-><a class=\"id\" href=\"#i_security\">i_security</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newisec\">newisec</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#mntpoint_sid\">mntpoint_sid</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#set_rootcontext\">set_rootcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#oldinode\">oldinode</a> = <a class=\"id\" href=\"#oldsb\">oldsb</a>-><a class=\"id\" href=\"#s_root\">s_root</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#inode_security_struct\">inode_security_struct</a> *<a class=\"id\" href=\"#oldisec\">oldisec</a> = <a class=\"id\" href=\"#oldinode\">oldinode</a>-><a class=\"id\" href=\"#i_security\">i_security</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#newinode\">newinode</a> = <a class=\"id\" href=\"#newsb\">newsb</a>-><a class=\"id\" href=\"#s_root\">s_root</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inode_security_struct\">inode_security_struct</a> *<a class=\"id\" href=\"#newisec\">newisec</a> = <a class=\"id\" href=\"#newinode\">newinode</a>-><a class=\"id\" href=\"#i_security\">i_security</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newisec\">newisec</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#oldisec\">oldisec</a>-><a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sb_finish_set_opts\">sb_finish_set_opts</a>(<a class=\"id\" href=\"#newsb\">newsb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#newsbsec\">newsbsec</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#selinux_parse_opts_str\">selinux_parse_opts_str</a>(char *<a class=\"id\" href=\"#options\">options</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#security_mnt_opts\">security_mnt_opts</a> *<a class=\"id\" href=\"#opts\">opts</a>)", 
"{", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#context\">context</a> = <a class=\"id\" href=\"#NULL\">NULL</a>, *<a class=\"id\" href=\"#defcontext\">defcontext</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#fscontext\">fscontext</a> = <a class=\"id\" href=\"#NULL\">NULL</a>, *<a class=\"id\" href=\"#rootcontext\">rootcontext</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>, <a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Standard string-based options. */</span>", 
"<span class=\"ts\"/>while ((<a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#strsep\">strsep</a>(&amp;<a class=\"id\" href=\"#options\">options</a>, \"|\")) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#token\">token</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#substring_t\">substring_t</a> <a class=\"id\" href=\"#args\">args</a>[<a class=\"id\" href=\"#MAX_OPT_ARGS\">MAX_OPT_ARGS</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!*<a class=\"id\" href=\"#p\">p</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#token\">token</a> = <a class=\"id\" href=\"#match_token\">match_token</a>(<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#tokens\">tokens</a>, <a class=\"id\" href=\"#args\">args</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#token\">token</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Opt_context\">Opt_context</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#context\">context</a> || <a class=\"id\" href=\"#defcontext\">defcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> <a class=\"id\" href=\"#SEL_MOUNT_FAIL_MSG\">SEL_MOUNT_FAIL_MSG</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a> = <a class=\"id\" href=\"#match_strdup\">match_strdup</a>(&amp;<a class=\"id\" href=\"#args\">args</a>[0]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#context\">context</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Opt_fscontext\">Opt_fscontext</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fscontext\">fscontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> <a class=\"id\" href=\"#SEL_MOUNT_FAIL_MSG\">SEL_MOUNT_FAIL_MSG</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fscontext\">fscontext</a> = <a class=\"id\" href=\"#match_strdup\">match_strdup</a>(&amp;<a class=\"id\" href=\"#args\">args</a>[0]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fscontext\">fscontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Opt_rootcontext\">Opt_rootcontext</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rootcontext\">rootcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> <a class=\"id\" href=\"#SEL_MOUNT_FAIL_MSG\">SEL_MOUNT_FAIL_MSG</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rootcontext\">rootcontext</a> = <a class=\"id\" href=\"#match_strdup\">match_strdup</a>(&amp;<a class=\"id\" href=\"#args\">args</a>[0]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#rootcontext\">rootcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Opt_defcontext\">Opt_defcontext</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#context\">context</a> || <a class=\"id\" href=\"#defcontext\">defcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> <a class=\"id\" href=\"#SEL_MOUNT_FAIL_MSG\">SEL_MOUNT_FAIL_MSG</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#defcontext\">defcontext</a> = <a class=\"id\" href=\"#match_strdup\">match_strdup</a>(&amp;<a class=\"id\" href=\"#args\">args</a>[0]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#defcontext\">defcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Opt_labelsupport\">Opt_labelsupport</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"SELinux:  unknown mount option\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(<a class=\"id\" href=\"#NUM_SEL_MNT_OPTS\">NUM_SEL_MNT_OPTS</a>, sizeof(char *), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts_flags\">mnt_opts_flags</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(<a class=\"id\" href=\"#NUM_SEL_MNT_OPTS\">NUM_SEL_MNT_OPTS</a>, sizeof(int), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts_flags\">mnt_opts_flags</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fscontext\">fscontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>] = <a class=\"id\" href=\"#fscontext\">fscontext</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts_flags\">mnt_opts_flags</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>++] = <a class=\"id\" href=\"#FSCONTEXT_MNT\">FSCONTEXT_MNT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#context\">context</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>] = <a class=\"id\" href=\"#context\">context</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts_flags\">mnt_opts_flags</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>++] = <a class=\"id\" href=\"#CONTEXT_MNT\">CONTEXT_MNT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rootcontext\">rootcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>] = <a class=\"id\" href=\"#rootcontext\">rootcontext</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts_flags\">mnt_opts_flags</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>++] = <a class=\"id\" href=\"#ROOTCONTEXT_MNT\">ROOTCONTEXT_MNT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#defcontext\">defcontext</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>] = <a class=\"id\" href=\"#defcontext\">defcontext</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts_flags\">mnt_opts_flags</a>[<a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>++] = <a class=\"id\" href=\"#DEFCONTEXT_MNT\">DEFCONTEXT_MNT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a> = <a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#out_err\">out_err</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#defcontext\">defcontext</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#fscontext\">fscontext</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#rootcontext\">rootcontext</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * string mount options parsing and call set the sbsec</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#superblock_doinit\">superblock_doinit</a>(struct <a class=\"id\" href=\"#super_block\">super_block</a> *<a class=\"id\" href=\"#sb\">sb</a>, void *<a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#options\">options</a> = <a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#security_mnt_opts\">security_mnt_opts</a> <a class=\"id\" href=\"#opts\">opts</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_init_mnt_opts\">security_init_mnt_opts</a>(&amp;<a class=\"id\" href=\"#opts\">opts</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#data\">data</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#sb\">sb</a>-><a class=\"id\" href=\"#s_type\">s_type</a>-><a class=\"id\" href=\"#fs_flags\">fs_flags</a> &amp; <a class=\"id\" href=\"#FS_BINARY_MOUNTDATA\">FS_BINARY_MOUNTDATA</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#selinux_parse_opts_str\">selinux_parse_opts_str</a>(<a class=\"id\" href=\"#options\">options</a>, &amp;<a class=\"id\" href=\"#opts\">opts</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#selinux_set_mnt_opts\">selinux_set_mnt_opts</a>(<a class=\"id\" href=\"#sb\">sb</a>, &amp;<a class=\"id\" href=\"#opts\">opts</a>);", 
"", 
"<a class=\"id\" href=\"#out_err\">out_err</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_free_mnt_opts\">security_free_mnt_opts</a>(&amp;<a class=\"id\" href=\"#opts\">opts</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#selinux_write_opts\">selinux_write_opts</a>(struct <a class=\"id\" href=\"#seq_file\">seq_file</a> *<a class=\"id\" href=\"#m\">m</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#security_mnt_opts\">security_mnt_opts</a> *<a class=\"id\" href=\"#opts\">opts</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#prefix\">prefix</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#num_mnt_opts\">num_mnt_opts</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>char *<a class=\"id\" href=\"#has_comma\">has_comma</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>[<a class=\"id\" href=\"#i\">i</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#has_comma\">has_comma</a> = <a class=\"id\" href=\"#strchr\">strchr</a>(<a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>[<a class=\"id\" href=\"#i\">i</a>], ',');", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#has_comma\">has_comma</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts_flags\">mnt_opts_flags</a>[<a class=\"id\" href=\"#i\">i</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CONTEXT_MNT\">CONTEXT_MNT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prefix\">prefix</a> = <a class=\"id\" href=\"#CONTEXT_STR\">CONTEXT_STR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#FSCONTEXT_MNT\">FSCONTEXT_MNT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prefix\">prefix</a> = <a class=\"id\" href=\"#FSCONTEXT_STR\">FSCONTEXT_STR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#ROOTCONTEXT_MNT\">ROOTCONTEXT_MNT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prefix\">prefix</a> = <a class=\"id\" href=\"#ROOTCONTEXT_STR\">ROOTCONTEXT_STR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#DEFCONTEXT_MNT\">DEFCONTEXT_MNT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prefix\">prefix</a> = <a class=\"id\" href=\"#DEFCONTEXT_STR\">DEFCONTEXT_STR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SE_SBLABELSUPP\">SE_SBLABELSUPP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_putc\">seq_putc</a>(<a class=\"id\" href=\"#m\">m</a>, ',');", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_puts\">seq_puts</a>(<a class=\"id\" href=\"#m\">m</a>, <a class=\"id\" href=\"#LABELSUPP_STR\">LABELSUPP_STR</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>};", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* we need a comma before each option */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_putc\">seq_putc</a>(<a class=\"id\" href=\"#m\">m</a>, ',');", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_puts\">seq_puts</a>(<a class=\"id\" href=\"#m\">m</a>, <a class=\"id\" href=\"#prefix\">prefix</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#has_comma\">has_comma</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_putc\">seq_putc</a>(<a class=\"id\" href=\"#m\">m</a>, '\\\"');", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_puts\">seq_puts</a>(<a class=\"id\" href=\"#m\">m</a>, <a class=\"id\" href=\"#opts\">opts</a>-><a class=\"id\" href=\"#mnt_opts\">mnt_opts</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#has_comma\">has_comma</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_putc\">seq_putc</a>(<a class=\"id\" href=\"#m\">m</a>, '\\\"');", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static int <a class=\"id\" href=\"#selinux_sb_show_options\">selinux_sb_show_options</a>(struct <a class=\"id\" href=\"#seq_file\">seq_file</a> *<a class=\"id\" href=\"#m\">m</a>, struct <a class=\"id\" href=\"#super_block\">super_block</a> *<a class=\"id\" href=\"#sb\">sb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#security_mnt_opts\">security_mnt_opts</a> <a class=\"id\" href=\"#opts\">opts</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#selinux_get_mnt_opts\">selinux_get_mnt_opts</a>(<a class=\"id\" href=\"#sb\">sb</a>, &amp;<a class=\"id\" href=\"#opts\">opts</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* before policy load we may get EINVAL, don't show anything */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> == -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#selinux_write_opts\">selinux_write_opts</a>(<a class=\"id\" href=\"#m\">m</a>, &amp;<a class=\"id\" href=\"#opts\">opts</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_free_mnt_opts\">security_free_mnt_opts</a>(&amp;<a class=\"id\" href=\"#opts\">opts</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#inode_mode_to_security_class\">inode_mode_to_security_class</a>(<a class=\"id\" href=\"#umode_t\">umode_t</a> <a class=\"id\" href=\"#mode\">mode</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#mode\">mode</a> &amp; <a class=\"id\" href=\"#S_IFMT\">S_IFMT</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#S_IFSOCK\">S_IFSOCK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_SOCK_FILE\">SECCLASS_SOCK_FILE</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#S_IFLNK\">S_IFLNK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_LNK_FILE\">SECCLASS_LNK_FILE</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#S_IFREG\">S_IFREG</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_FILE\">SECCLASS_FILE</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#S_IFBLK\">S_IFBLK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_BLK_FILE\">SECCLASS_BLK_FILE</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#S_IFDIR\">S_IFDIR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_DIR\">SECCLASS_DIR</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#S_IFCHR\">S_IFCHR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_CHR_FILE\">SECCLASS_CHR_FILE</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#S_IFIFO\">S_IFIFO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_FIFO_FILE\">SECCLASS_FIFO_FILE</a>;", 
"", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_FILE\">SECCLASS_FILE</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#default_protocol_stream\">default_protocol_stream</a>(int <a class=\"id\" href=\"#protocol\">protocol</a>)", 
"{", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#protocol\">protocol</a> == <a class=\"id\" href=\"#IPPROTO_IP\">IPPROTO_IP</a> || <a class=\"id\" href=\"#protocol\">protocol</a> == <a class=\"id\" href=\"#IPPROTO_TCP\">IPPROTO_TCP</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#default_protocol_dgram\">default_protocol_dgram</a>(int <a class=\"id\" href=\"#protocol\">protocol</a>)", 
"{", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#protocol\">protocol</a> == <a class=\"id\" href=\"#IPPROTO_IP\">IPPROTO_IP</a> || <a class=\"id\" href=\"#protocol\">protocol</a> == <a class=\"id\" href=\"#IPPROTO_UDP\">IPPROTO_UDP</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#socket_type_to_security_class\">socket_type_to_security_class</a>(int <a class=\"id\" href=\"#family\">family</a>, int <a class=\"id\" href=\"#type\">type</a>, int <a class=\"id\" href=\"#protocol\">protocol</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_UNIX\">PF_UNIX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SOCK_STREAM\">SOCK_STREAM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SOCK_SEQPACKET\">SOCK_SEQPACKET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_UNIX_STREAM_SOCKET\">SECCLASS_UNIX_STREAM_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_UNIX_DGRAM_SOCKET\">SECCLASS_UNIX_DGRAM_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET\">PF_INET</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SOCK_STREAM\">SOCK_STREAM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#default_protocol_stream\">default_protocol_stream</a>(<a class=\"id\" href=\"#protocol\">protocol</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_TCP_SOCKET\">SECCLASS_TCP_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_RAWIP_SOCKET\">SECCLASS_RAWIP_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#default_protocol_dgram\">default_protocol_dgram</a>(<a class=\"id\" href=\"#protocol\">protocol</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_UDP_SOCKET\">SECCLASS_UDP_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_RAWIP_SOCKET\">SECCLASS_RAWIP_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SOCK_DCCP\">SOCK_DCCP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_DCCP_SOCKET\">SECCLASS_DCCP_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_RAWIP_SOCKET\">SECCLASS_RAWIP_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_NETLINK\">PF_NETLINK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#protocol\">protocol</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_ROUTE\">NETLINK_ROUTE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_ROUTE_SOCKET\">SECCLASS_NETLINK_ROUTE_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_FIREWALL\">NETLINK_FIREWALL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_FIREWALL_SOCKET\">SECCLASS_NETLINK_FIREWALL_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_INET_DIAG\">NETLINK_INET_DIAG</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_TCPDIAG_SOCKET\">SECCLASS_NETLINK_TCPDIAG_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_NFLOG\">NETLINK_NFLOG</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_NFLOG_SOCKET\">SECCLASS_NETLINK_NFLOG_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_XFRM\">NETLINK_XFRM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_XFRM_SOCKET\">SECCLASS_NETLINK_XFRM_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_SELINUX\">NETLINK_SELINUX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_SELINUX_SOCKET\">SECCLASS_NETLINK_SELINUX_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_AUDIT\">NETLINK_AUDIT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_AUDIT_SOCKET\">SECCLASS_NETLINK_AUDIT_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_IP6_FW\">NETLINK_IP6_FW</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_IP6FW_SOCKET\">SECCLASS_NETLINK_IP6FW_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_DNRTMSG\">NETLINK_DNRTMSG</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_DNRT_SOCKET\">SECCLASS_NETLINK_DNRT_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_KOBJECT_UEVENT\">NETLINK_KOBJECT_UEVENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_KOBJECT_UEVENT_SOCKET\">SECCLASS_NETLINK_KOBJECT_UEVENT_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_NETLINK_SOCKET\">SECCLASS_NETLINK_SOCKET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_PACKET_SOCKET\">SECCLASS_PACKET_SOCKET</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_KEY\">PF_KEY</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_KEY_SOCKET\">SECCLASS_KEY_SOCKET</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_APPLETALK\">PF_APPLETALK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_APPLETALK_SOCKET\">SECCLASS_APPLETALK_SOCKET</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#SECCLASS_SOCKET\">SECCLASS_SOCKET</a>;", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_PROC_FS\">CONFIG_PROC_FS</a>", 
"static int <a class=\"id\" href=\"#selinux_proc_get_sid\">selinux_proc_get_sid</a>(struct <a class=\"id\" href=\"#proc_dir_entry\">proc_dir_entry</a> *<a class=\"id\" href=\"#de\">de</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#tclass\">tclass</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#buflen\">buflen</a>, <a class=\"id\" href=\"#rc\">rc</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#buffer\">buffer</a>, *<a class=\"id\" href=\"#path\">path</a>, *<a class=\"id\" href=\"#end\">end</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a> = (char *)<a class=\"id\" href=\"#__get_free_page\">__get_free_page</a>(<a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#buffer\">buffer</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buflen\">buflen</a> = <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#end\">end</a> = <a class=\"id\" href=\"#buffer\">buffer</a>+<a class=\"id\" href=\"#buflen\">buflen</a>;", 
"<span class=\"ts\"/>*--<a class=\"id\" href=\"#end\">end</a> = '\\0';", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buflen\">buflen</a>--;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#path\">path</a> = <a class=\"id\" href=\"#end\">end</a>-1;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#path\">path</a> = '/';", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#de\">de</a> && <a class=\"id\" href=\"#de\">de</a> != <a class=\"id\" href=\"#de\">de</a>-><a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#buflen\">buflen</a> -= <a class=\"id\" href=\"#de\">de</a>-><a class=\"id\" href=\"#namelen\">namelen</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#buflen\">buflen</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#end\">end</a> -= <a class=\"id\" href=\"#de\">de</a>-><a class=\"id\" href=\"#namelen\">namelen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#end\">end</a>, <a class=\"id\" href=\"#de\">de</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#de\">de</a>-><a class=\"id\" href=\"#namelen\">namelen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>*--<a class=\"id\" href=\"#end\">end</a> = '/';", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#path\">path</a> = <a class=\"id\" href=\"#end\">end</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#de\">de</a> = <a class=\"id\" href=\"#de\">de</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#security_genfs_sid\">security_genfs_sid</a>(\"proc\", <a class=\"id\" href=\"#path\">path</a>, <a class=\"id\" href=\"#tclass\">tclass</a>, <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_page\">free_page</a>((unsigned long)<a class=\"id\" href=\"#buffer\">buffer</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"#else", 
"static int <a class=\"id\" href=\"#selinux_proc_get_sid\">selinux_proc_get_sid</a>(struct <a class=\"id\" href=\"#proc_dir_entry\">proc_dir_entry</a> *<a class=\"id\" href=\"#de\">de</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#tclass\">tclass</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"comment\">/* The inode's security attributes must be initialized before first use. */</span>", 
"static int <a class=\"id\" href=\"#inode_doinit_with_dentry\">inode_doinit_with_dentry</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>, struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#opt_dentry\">opt_dentry</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#superblock_security_struct\">superblock_security_struct</a> *<a class=\"id\" href=\"#sbsec\">sbsec</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode_security_struct\">inode_security_struct</a> *<a class=\"id\" href=\"#isec\">isec</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_security\">i_security</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>;", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#INITCONTEXTLEN\">INITCONTEXTLEN</a> 255", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#context\">context</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#len\">len</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#isec\">isec</a>-><a class=\"id\" href=\"#initialized\">initialized</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#isec\">isec</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#isec\">isec</a>-><a class=\"id\" href=\"#initialized\">initialized</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sbsec\">sbsec</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_sb\">i_sb</a>-><a class=\"id\" href=\"#s_security\">s_security</a>;", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#sbsec\">sbsec</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#SE_SBINITIALIZED\">SE_SBINITIALIZED</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Defer initialization until selinux_complete_init,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   after the initial policy is loaded and the security</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   server is ready to handle calls. */</span>", 
];
xr_frag_insert('l/08/eda4ff0b022551b5ef51afdaab9ad8275899ff.xr', __xr_tmp);
