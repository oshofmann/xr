var __xr_tmp = [
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#vw\">vw</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vw\">vw</a>-><a class=\"id\" href=\"#done\">done</a> = 0;", 
"<span class=\"ts\"/><span class=\"comment\">/* Queue our event */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#vt_event_lock\">vt_event_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#vw\">vw</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#vt_events\">vt_events</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#vt_event_lock\">vt_event_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* Wait for it to pass */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wait_event_interruptible_tty\">wait_event_interruptible_tty</a>(<a class=\"id\" href=\"#vt_event_waitqueue\">vt_event_waitqueue</a>, <a class=\"id\" href=\"#vw\">vw</a>-><a class=\"id\" href=\"#done\">done</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* Dequeue it */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#vt_event_lock\">vt_event_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#vw\">vw</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#vt_event_lock\">vt_event_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>vt_event_wait_ioctl<span class=\"ts\"/>-<span class=\"ts\"/>event ioctl handler</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@arg: argument to ioctl</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Implement the VT_WAITEVENT ioctl using the VT event interface</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#vt_event_wait_ioctl\">vt_event_wait_ioctl</a>(struct <a class=\"id\" href=\"#vt_event\">vt_event</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#event\">event</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_event_wait\">vt_event_wait</a> <a class=\"id\" href=\"#vw\">vw</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#vw\">vw</a>.<a class=\"id\" href=\"#event\">event</a>, <a class=\"id\" href=\"#event\">event</a>, sizeof(struct <a class=\"id\" href=\"#vt_event\">vt_event</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* Highest supported event for now */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vw\">vw</a>.<a class=\"id\" href=\"#event\">event</a>.<a class=\"id\" href=\"#event\">event</a> &amp; ~<a class=\"id\" href=\"#VT_MAX_EVENT\">VT_MAX_EVENT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vt_event_wait\">vt_event_wait</a>(&amp;<a class=\"id\" href=\"#vw\">vw</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* If it occurred report it */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vw\">vw</a>.<a class=\"id\" href=\"#done\">done</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#event\">event</a>, &amp;<a class=\"id\" href=\"#vw\">vw</a>.<a class=\"id\" href=\"#event\">event</a>, sizeof(struct <a class=\"id\" href=\"#vt_event\">vt_event</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINTR\">EINTR</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>vt_waitactive<span class=\"ts\"/>-<span class=\"ts\"/>active console wait</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@event: event code</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@n: new console</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Helper for event waits. Used to implement the legacy</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>event waiting ioctls in terms of events</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#vt_waitactive\">vt_waitactive</a>(int <a class=\"id\" href=\"#n\">n</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_event_wait\">vt_event_wait</a> <a class=\"id\" href=\"#vw\">vw</a>;", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#n\">n</a> == <a class=\"id\" href=\"#fg_console\">fg_console</a> + 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vw\">vw</a>.<a class=\"id\" href=\"#event\">event</a>.<a class=\"id\" href=\"#event\">event</a> = <a class=\"id\" href=\"#VT_EVENT_SWITCH\">VT_EVENT_SWITCH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vt_event_wait\">vt_event_wait</a>(&amp;<a class=\"id\" href=\"#vw\">vw</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vw\">vw</a>.<a class=\"id\" href=\"#done\">done</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINTR\">EINTR</a>;", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#vw\">vw</a>.<a class=\"id\" href=\"#event\">event</a>.<a class=\"id\" href=\"#newev\">newev</a> != <a class=\"id\" href=\"#n\">n</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * these are the valid i/o ports we're allowed to change. they map all the</span>", 
"<span class=\"comment\"> * video ports</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#GPFIRST\">GPFIRST</a> 0x3b4", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#GPLAST\">GPLAST</a> 0x3df", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#GPNUM\">GPNUM</a> (<a class=\"id\" href=\"#GPLAST\">GPLAST</a> - <a class=\"id\" href=\"#GPFIRST\">GPFIRST</a> + 1)", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#i\">i</a> (<a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#kb_index\">kb_index</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#s\">s</a> (<a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#kb_table\">kb_table</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#v\">v</a> (<a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#kb_value\">kb_value</a>)", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#do_kdsk_ioctl\">do_kdsk_ioctl</a>(int <a class=\"id\" href=\"#cmd\">cmd</a>, struct <a class=\"id\" href=\"#kbentry\">kbentry</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#user_kbe\">user_kbe</a>, int <a class=\"id\" href=\"#perm\">perm</a>, struct <a class=\"id\" href=\"#kbd_struct\">kbd_struct</a> *<a class=\"id\" href=\"#kbd\">kbd</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#kbentry\">kbentry</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ushort\">ushort</a> *<a class=\"id\" href=\"#key_map\">key_map</a>, <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#ov\">ov</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#user_kbe\">user_kbe</a>, sizeof(struct <a class=\"id\" href=\"#kbentry\">kbentry</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_TTY_CONFIG\">CAP_SYS_TTY_CONFIG</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perm\">perm</a> = 0;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBENT\">KDGKBENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#key_map\">key_map</a> = <a class=\"id\" href=\"#key_maps\">key_maps</a>[<a class=\"id\" href=\"#s\">s</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#key_map\">key_map</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#U\">U</a>(<a class=\"id\" href=\"#key_map\">key_map</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> != <a class=\"id\" href=\"#VC_UNICODE\">VC_UNICODE</a> && <a class=\"id\" href=\"#KTYP\">KTYP</a>(<a class=\"id\" href=\"#val\">val</a>) >= <a class=\"id\" href=\"#NR_TYPES\">NR_TYPES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#K_HOLE\">K_HOLE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#val\">val</a> = (<a class=\"id\" href=\"#i\">i</a> ? <a class=\"id\" href=\"#K_HOLE\">K_HOLE</a> : <a class=\"id\" href=\"#K_NOSUCHMAP\">K_NOSUCHMAP</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#val\">val</a>, &amp;<a class=\"id\" href=\"#user_kbe\">user_kbe</a>-><a class=\"id\" href=\"#kb_value\">kb_value</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBENT\">KDSKBENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#i\">i</a> && <a class=\"id\" href=\"#v\">v</a> == <a class=\"id\" href=\"#K_NOSUCHMAP\">K_NOSUCHMAP</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* deallocate map */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#key_map\">key_map</a> = <a class=\"id\" href=\"#key_maps\">key_maps</a>[<a class=\"id\" href=\"#s\">s</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#s\">s</a> && <a class=\"id\" href=\"#key_map\">key_map</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#key_maps\">key_maps</a>[<a class=\"id\" href=\"#s\">s</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#key_map\">key_map</a>[0] == <a class=\"id\" href=\"#U\">U</a>(<a class=\"id\" href=\"#K_ALLOCATED\">K_ALLOCATED</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#key_map\">key_map</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#keymap_count\">keymap_count</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    }", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#KTYP\">KTYP</a>(<a class=\"id\" href=\"#v\">v</a>) &lt; <a class=\"id\" href=\"#NR_TYPES\">NR_TYPES</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#KVAL\">KVAL</a>(<a class=\"id\" href=\"#v\">v</a>) &gt; <a class=\"id\" href=\"#max_vals\">max_vals</a>[<a class=\"id\" href=\"#KTYP\">KTYP</a>(<a class=\"id\" href=\"#v\">v</a>)])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> != <a class=\"id\" href=\"#VC_UNICODE\">VC_UNICODE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* ++Geert: non-PC keyboards may generate keycode zero */</span>", 
"#if !<a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#__mc68000__\">__mc68000__</a>) && !<a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#__powerpc__\">__powerpc__</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* assignment to entry 0 only tests validity of args */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#i\">i</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#key_map\">key_map</a> = <a class=\"id\" href=\"#key_maps\">key_maps</a>[<a class=\"id\" href=\"#s\">s</a>])) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#j\">j</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#keymap_count\">keymap_count</a> >= <a class=\"id\" href=\"#MAX_NR_OF_USER_KEYMAPS\">MAX_NR_OF_USER_KEYMAPS</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_RESOURCE\">CAP_SYS_RESOURCE</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#key_map\">key_map</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(<a class=\"id\" href=\"#plain_map\">plain_map</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#key_map\">key_map</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#key_maps\">key_maps</a>[<a class=\"id\" href=\"#s\">s</a>] = <a class=\"id\" href=\"#key_map\">key_map</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#key_map\">key_map</a>[0] = <a class=\"id\" href=\"#U\">U</a>(<a class=\"id\" href=\"#K_ALLOCATED\">K_ALLOCATED</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a> = 1; <a class=\"id\" href=\"#j\">j</a> &lt; <a class=\"id\" href=\"#NR_KEYS\">NR_KEYS</a>; <a class=\"id\" href=\"#j\">j</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#key_map\">key_map</a>[<a class=\"id\" href=\"#j\">j</a>] = <a class=\"id\" href=\"#U\">U</a>(<a class=\"id\" href=\"#K_HOLE\">K_HOLE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#keymap_count\">keymap_count</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ov\">ov</a> = <a class=\"id\" href=\"#U\">U</a>(<a class=\"id\" href=\"#key_map\">key_map</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#v\">v</a> == <a class=\"id\" href=\"#ov\">ov</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;<span class=\"ts\"/><span class=\"comment\">/* nothing to do */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Attention Key.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (((<a class=\"id\" href=\"#ov\">ov</a> == <a class=\"id\" href=\"#K_SAK\">K_SAK</a>) || (<a class=\"id\" href=\"#v\">v</a> == <a class=\"id\" href=\"#K_SAK\">K_SAK</a>)) && !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_ADMIN\">CAP_SYS_ADMIN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#key_map\">key_map</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#U\">U</a>(<a class=\"id\" href=\"#v\">v</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#s\">s</a> && (<a class=\"id\" href=\"#KTYP\">KTYP</a>(<a class=\"id\" href=\"#ov\">ov</a>) == <a class=\"id\" href=\"#KT_SHIFT\">KT_SHIFT</a> || <a class=\"id\" href=\"#KTYP\">KTYP</a>(<a class=\"id\" href=\"#v\">v</a>) == <a class=\"id\" href=\"#KT_SHIFT\">KT_SHIFT</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#compute_shiftstate\">compute_shiftstate</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#i\">i</a>", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#s\">s</a>", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#v\">v</a>", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int ", 
"<a class=\"id\" href=\"#do_kbkeycode_ioctl\">do_kbkeycode_ioctl</a>(int <a class=\"id\" href=\"#cmd\">cmd</a>, struct <a class=\"id\" href=\"#kbkeycode\">kbkeycode</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#user_kbkc\">user_kbkc</a>, int <a class=\"id\" href=\"#perm\">perm</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#kbkeycode\">kbkeycode</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#kc\">kc</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#user_kbkc\">user_kbkc</a>, sizeof(struct <a class=\"id\" href=\"#kbkeycode\">kbkeycode</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGETKEYCODE\">KDGETKEYCODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kc\">kc</a> = <a class=\"id\" href=\"#getkeycode\">getkeycode</a>(<a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#scancode\">scancode</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#kc\">kc</a> >= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kc\">kc</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#kc\">kc</a>, &amp;<a class=\"id\" href=\"#user_kbkc\">user_kbkc</a>-><a class=\"id\" href=\"#keycode\">keycode</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSETKEYCODE\">KDSETKEYCODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kc\">kc</a> = <a class=\"id\" href=\"#setkeycode\">setkeycode</a>(<a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#scancode\">scancode</a>, <a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#keycode\">keycode</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#kc\">kc</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#do_kdgkb_ioctl\">do_kdgkb_ioctl</a>(int <a class=\"id\" href=\"#cmd\">cmd</a>, struct <a class=\"id\" href=\"#kbsentry\">kbsentry</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#user_kdgkb\">user_kdgkb</a>, int <a class=\"id\" href=\"#perm\">perm</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#kbsentry\">kbsentry</a> *<a class=\"id\" href=\"#kbs\">kbs</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u_char\">u_char</a> *<a class=\"id\" href=\"#q\">q</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u_char\">u_char</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#sz\">sz</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#delta\">delta</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#first_free\">first_free</a>, *<a class=\"id\" href=\"#fj\">fj</a>, *<a class=\"id\" href=\"#fnw\">fnw</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#j\">j</a>, <a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_TTY_CONFIG\">CAP_SYS_TTY_CONFIG</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perm\">perm</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kbs\">kbs</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#kbs\">kbs</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#kbs\">kbs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reterr\">reterr</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* we mostly copy too much here (512bytes), but who cares ;) */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#kbs\">kbs</a>, <a class=\"id\" href=\"#user_kdgkb\">user_kdgkb</a>, sizeof(struct <a class=\"id\" href=\"#kbsentry\">kbsentry</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reterr\">reterr</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kbs\">kbs</a>-><a class=\"id\" href=\"#kb_string\">kb_string</a>[sizeof(<a class=\"id\" href=\"#kbs\">kbs</a>-><a class=\"id\" href=\"#kb_string\">kb_string</a>)-1] = '\\0';", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#kbs\">kbs</a>-><a class=\"id\" href=\"#kb_func\">kb_func</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBSENT\">KDGKBSENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sz\">sz</a> = sizeof(<a class=\"id\" href=\"#kbs\">kbs</a>-><a class=\"id\" href=\"#kb_string\">kb_string</a>) - 1; <span class=\"comment\">/* sz should have been</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  a struct member */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#up\">up</a> = <a class=\"id\" href=\"#user_kdgkb\">user_kdgkb</a>-><a class=\"id\" href=\"#kb_string\">kb_string</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>if(<a class=\"id\" href=\"#p\">p</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for ( ; *<a class=\"id\" href=\"#p\">p</a> && <a class=\"id\" href=\"#sz\">sz</a>; <a class=\"id\" href=\"#p\">p</a>++, <a class=\"id\" href=\"#sz\">sz</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>(*<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#up\">up</a>++)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reterr\">reterr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>('\\0', <a class=\"id\" href=\"#up\">up</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reterr\">reterr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#kbs\">kbs</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return ((<a class=\"id\" href=\"#p\">p</a> && *<a class=\"id\" href=\"#p\">p</a>) ? -<a class=\"id\" href=\"#EOVERFLOW\">EOVERFLOW</a> : 0);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBSENT\">KDSKBSENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reterr\">reterr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#q\">q</a> = <a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#first_free\">first_free</a> = <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a> + (<a class=\"id\" href=\"#funcbufsize\">funcbufsize</a> - <a class=\"id\" href=\"#funcbufleft\">funcbufleft</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a> = <a class=\"id\" href=\"#i\">i</a>+1; <a class=\"id\" href=\"#j\">j</a> &lt; <a class=\"id\" href=\"#MAX_NR_FUNC\">MAX_NR_FUNC</a> && !<a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#j\">j</a>]; <a class=\"id\" href=\"#j\">j</a>++) ", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#j\">j</a> &lt; <a class=\"id\" href=\"#MAX_NR_FUNC\">MAX_NR_FUNC</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fj\">fj</a> = <a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#j\">j</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fj\">fj</a> = <a class=\"id\" href=\"#first_free\">first_free</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#delta\">delta</a> = (<a class=\"id\" href=\"#q\">q</a> ? -<a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#q\">q</a>) : 1) + <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#kbs\">kbs</a>-><a class=\"id\" href=\"#kb_string\">kb_string</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#delta\">delta</a> <= <a class=\"id\" href=\"#funcbufleft\">funcbufleft</a>) { <span class=\"ts\"/><span class=\"comment\">/* it fits in current buf */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#j\">j</a> &lt; <a class=\"id\" href=\"#MAX_NR_FUNC\">MAX_NR_FUNC</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memmove\">memmove</a>(<a class=\"id\" href=\"#fj\">fj</a> + <a class=\"id\" href=\"#delta\">delta</a>, <a class=\"id\" href=\"#fj\">fj</a>, <a class=\"id\" href=\"#first_free\">first_free</a> - <a class=\"id\" href=\"#fj\">fj</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#j\">j</a>; <a class=\"id\" href=\"#k\">k</a> &lt; <a class=\"id\" href=\"#MAX_NR_FUNC\">MAX_NR_FUNC</a>; <a class=\"id\" href=\"#k\">k</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>] += <a class=\"id\" href=\"#delta\">delta</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>    }", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (!<a class=\"id\" href=\"#q\">q</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#fj\">fj</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#funcbufleft\">funcbufleft</a> -= <a class=\"id\" href=\"#delta\">delta</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* allocate a larger buffer */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#sz\">sz</a> = 256;", 
"<span class=\"ts\"/><span class=\"ts\"/>    while (<a class=\"id\" href=\"#sz\">sz</a> &lt; <a class=\"id\" href=\"#funcbufsize\">funcbufsize</a> - <a class=\"id\" href=\"#funcbufleft\">funcbufleft</a> + <a class=\"id\" href=\"#delta\">delta</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#sz\">sz</a> <<= 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#fnw\">fnw</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(<a class=\"id\" href=\"#sz\">sz</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>    if(!<a class=\"id\" href=\"#fnw\">fnw</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>      goto <a class=\"id\" href=\"#reterr\">reterr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>    }", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (!<a class=\"id\" href=\"#q\">q</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#fj\">fj</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#fj\">fj</a> &gt; <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memmove\">memmove</a>(<a class=\"id\" href=\"#fnw\">fnw</a>, <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a>, <a class=\"id\" href=\"#fj\">fj</a> - <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>    for (<a class=\"id\" href=\"#k\">k</a> = 0; <a class=\"id\" href=\"#k\">k</a> &lt; <a class=\"id\" href=\"#j\">j</a>; <a class=\"id\" href=\"#k\">k</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/>      if (<a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>] = <a class=\"id\" href=\"#fnw\">fnw</a> + (<a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>] - <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#first_free\">first_free</a> &gt; <a class=\"id\" href=\"#fj\">fj</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memmove\">memmove</a>(<a class=\"id\" href=\"#fnw\">fnw</a> + (<a class=\"id\" href=\"#fj\">fj</a> - <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a>) + <a class=\"id\" href=\"#delta\">delta</a>, <a class=\"id\" href=\"#fj\">fj</a>, <a class=\"id\" href=\"#first_free\">first_free</a> - <a class=\"id\" href=\"#fj\">fj</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#j\">j</a>; <a class=\"id\" href=\"#k\">k</a> &lt; <a class=\"id\" href=\"#MAX_NR_FUNC\">MAX_NR_FUNC</a>; <a class=\"id\" href=\"#k\">k</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  if (<a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>] = <a class=\"id\" href=\"#fnw\">fnw</a> + (<a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#k\">k</a>] - <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a>) + <a class=\"id\" href=\"#delta\">delta</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>    }", 
"<span class=\"ts\"/><span class=\"ts\"/>    if (<a class=\"id\" href=\"#funcbufptr\">funcbufptr</a> != <a class=\"id\" href=\"#func_buf\">func_buf</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#funcbufptr\">funcbufptr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#funcbufptr\">funcbufptr</a> = <a class=\"id\" href=\"#fnw\">fnw</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#funcbufleft\">funcbufleft</a> = <a class=\"id\" href=\"#funcbufleft\">funcbufleft</a> - <a class=\"id\" href=\"#delta\">delta</a> + <a class=\"id\" href=\"#sz\">sz</a> - <a class=\"id\" href=\"#funcbufsize\">funcbufsize</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#funcbufsize\">funcbufsize</a> = <a class=\"id\" href=\"#sz\">sz</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#func_table\">func_table</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#kbs\">kbs</a>-><a class=\"id\" href=\"#kb_string\">kb_string</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<a class=\"id\" href=\"#reterr\">reterr</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#kbs\">kbs</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int ", 
"<a class=\"id\" href=\"#do_fontx_ioctl\">do_fontx_ioctl</a>(int <a class=\"id\" href=\"#cmd\">cmd</a>, struct <a class=\"id\" href=\"#consolefontdesc\">consolefontdesc</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#user_cfd\">user_cfd</a>, int <a class=\"id\" href=\"#perm\">perm</a>, struct <a class=\"id\" href=\"#console_font_op\">console_font_op</a> *<a class=\"id\" href=\"#op\">op</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#consolefontdesc\">consolefontdesc</a> <a class=\"id\" href=\"#cfdarg\">cfdarg</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#cfdarg\">cfdarg</a>, <a class=\"id\" href=\"#user_cfd\">user_cfd</a>, sizeof(struct <a class=\"id\" href=\"#consolefontdesc\">consolefontdesc</a>))) ", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
" <span class=\"ts\"/>", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_FONTX\">PIO_FONTX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#op\">op</a> = <a class=\"id\" href=\"#KD_FONT_OP_SET\">KD_FONT_OP_SET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#KD_FONT_FLAG_OLD\">KD_FONT_FLAG_OLD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#width\">width</a> = 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#height\">height</a> = <a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#charheight\">charheight</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#charcount\">charcount</a> = <a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#charcount\">charcount</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#chardata\">chardata</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#con_font_op\">con_font_op</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#fg_console\">fg_console</a>].<a class=\"id\" href=\"#d\">d</a>, <a class=\"id\" href=\"#op\">op</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_FONTX\">GIO_FONTX</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#op\">op</a> = <a class=\"id\" href=\"#KD_FONT_OP_GET\">KD_FONT_OP_GET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#KD_FONT_FLAG_OLD\">KD_FONT_FLAG_OLD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#width\">width</a> = 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#height\">height</a> = <a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#charheight\">charheight</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#charcount\">charcount</a> = <a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#charcount\">charcount</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#chardata\">chardata</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#con_font_op\">con_font_op</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#fg_console\">fg_console</a>].<a class=\"id\" href=\"#d\">d</a>, <a class=\"id\" href=\"#op\">op</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#charheight\">charheight</a> = <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#height\">height</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfdarg\">cfdarg</a>.<a class=\"id\" href=\"#charcount\">charcount</a> = <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#charcount\">charcount</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#user_cfd\">user_cfd</a>, &amp;<a class=\"id\" href=\"#cfdarg\">cfdarg</a>, sizeof(struct <a class=\"id\" href=\"#consolefontdesc\">consolefontdesc</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int ", 
"<a class=\"id\" href=\"#do_unimap_ioctl\">do_unimap_ioctl</a>(int <a class=\"id\" href=\"#cmd\">cmd</a>, struct <a class=\"id\" href=\"#unimapdesc\">unimapdesc</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#user_ud\">user_ud</a>, int <a class=\"id\" href=\"#perm\">perm</a>, struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#unimapdesc\">unimapdesc</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#user_ud\">user_ud</a>, sizeof <a class=\"id\" href=\"#tmp\">tmp</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#entries\">entries</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#access_ok\">access_ok</a>(<a class=\"id\" href=\"#VERIFY_WRITE\">VERIFY_WRITE</a>, <a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#entries\">entries</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#entry_ct\">entry_ct</a>*sizeof(struct <a class=\"id\" href=\"#unipair\">unipair</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_UNIMAP\">PIO_UNIMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#con_set_unimap\">con_set_unimap</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#entry_ct\">entry_ct</a>, <a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#entries\">entries</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_UNIMAP\">GIO_UNIMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a> && <a class=\"id\" href=\"#fg_console\">fg_console</a> != <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_num\">vc_num</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#con_get_unimap\">con_get_unimap</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#entry_ct\">entry_ct</a>, &amp;(<a class=\"id\" href=\"#user_ud\">user_ud</a>-><a class=\"id\" href=\"#entry_ct\">entry_ct</a>), <a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#entries\">entries</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * We handle the console-specific ioctl's here.  We allow the</span>", 
"<span class=\"comment\"> * capability to modify any console, not just the fg_console. </span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#vt_ioctl\">vt_ioctl</a>(struct <a class=\"id\" href=\"#tty_struct\">tty_struct</a> *<a class=\"id\" href=\"#tty\">tty</a>, struct <a class=\"id\" href=\"#file\">file</a> * <a class=\"id\" href=\"#file\">file</a>,", 
"<span class=\"ts\"/>     unsigned int <a class=\"id\" href=\"#cmd\">cmd</a>, unsigned long <a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a> = <a class=\"id\" href=\"#tty\">tty</a>-><a class=\"id\" href=\"#driver_data\">driver_data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#console_font_op\">console_font_op</a> <a class=\"id\" href=\"#op\">op</a>;<span class=\"ts\"/><span class=\"comment\">/* used in multiple places here */</span>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#kbd_struct\">kbd_struct</a> * <a class=\"id\" href=\"#kbd\">kbd</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#console\">console</a>;", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#ucval\">ucval</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#up\">up</a> = (void <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#perm\">perm</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#console\">console</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_num\">vc_num</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tty_lock\">tty_lock</a>();", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc_cons_allocated\">vc_cons_allocated</a>(<a class=\"id\" href=\"#console\">console</a>)) { <span class=\"ts\"/><span class=\"comment\">/* impossible? */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENOIOCTLCMD\">ENOIOCTLCMD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * To have permissions to do most of the vt ioctls, we either have</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * to be the owner of the tty, or have CAP_SYS_TTY_CONFIG.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#perm\">perm</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#signal\">signal</a>-><a class=\"id\" href=\"#tty\">tty</a> == <a class=\"id\" href=\"#tty\">tty</a> || <a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_TTY_CONFIG\">CAP_SYS_TTY_CONFIG</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perm\">perm</a> = 1;", 
" ", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kbd\">kbd</a> = <a class=\"id\" href=\"#kbd_table\">kbd_table</a> + <a class=\"id\" href=\"#console\">console</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TIOCLINUX\">TIOCLINUX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#tioclinux\">tioclinux</a>(<a class=\"id\" href=\"#tty\">tty</a>, <a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KIOCSOUND\">KIOCSOUND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * The use of PIT_TICK_RATE is historic, it used to be</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * the platform-dependent CLOCK_TICK_RATE between 2.6.12</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * and 2.6.36, which was a minor but unfortunate ABI</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * change.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> = <a class=\"id\" href=\"#PIT_TICK_RATE\">PIT_TICK_RATE</a> / <a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kd_mksound\">kd_mksound</a>(<a class=\"id\" href=\"#arg\">arg</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDMKTONE\">KDMKTONE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#ticks\">ticks</a>, <a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Generate the tone for the appropriate number of ticks.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * If the time is zero, turn off sound ourselves.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ticks\">ticks</a> = <a class=\"id\" href=\"#HZ\">HZ</a> * ((<a class=\"id\" href=\"#arg\">arg</a> >> 16) &amp; 0xffff) / 1000;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a> = <a class=\"id\" href=\"#ticks\">ticks</a> ? (<a class=\"id\" href=\"#arg\">arg</a> &amp; 0xffff) : 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#count\">count</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a> = <a class=\"id\" href=\"#PIT_TICK_RATE\">PIT_TICK_RATE</a> / <a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kd_mksound\">kd_mksound</a>(<a class=\"id\" href=\"#count\">count</a>, <a class=\"id\" href=\"#ticks\">ticks</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBTYPE\">KDGKBTYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * this is naive.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ucval\">ucval</a> = <a class=\"id\" href=\"#KB_101\">KB_101</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#setchar\">setchar</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * These cannot be implemented on any machine that implements</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * ioperm() in user level (such as Alpha PCs) or not at all.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * XXX: you should never use these, just call ioperm directly..</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86\">CONFIG_X86</a>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDADDIO\">KDADDIO</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDDELIO\">KDDELIO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * KDADDIO and KDDELIO may be able to add ports beyond what</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * we reject here, but to be safe...</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &lt; <a class=\"id\" href=\"#GPFIRST\">GPFIRST</a> || <a class=\"id\" href=\"#arg\">arg</a> &gt; <a class=\"id\" href=\"#GPLAST\">GPLAST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#sys_ioperm\">sys_ioperm</a>(<a class=\"id\" href=\"#arg\">arg</a>, 1, (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#KDADDIO\">KDADDIO</a>)) ? -<a class=\"id\" href=\"#ENXIO\">ENXIO</a> : 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDENABIO\">KDENABIO</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDDISABIO\">KDDISABIO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#sys_ioperm\">sys_ioperm</a>(<a class=\"id\" href=\"#GPFIRST\">GPFIRST</a>, <a class=\"id\" href=\"#GPNUM\">GPNUM</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#KDENABIO\">KDENABIO</a>)) ? -<a class=\"id\" href=\"#ENXIO\">ENXIO</a> : 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Linux m68k/i386 interface for setting the keyboard delay/repeat rate */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDKBDREP\">KDKBDREP</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#kbd_repeat\">kbd_repeat</a> <a class=\"id\" href=\"#kbrep\">kbrep</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_TTY_CONFIG\">CAP_SYS_TTY_CONFIG</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#kbrep\">kbrep</a>, <a class=\"id\" href=\"#up\">up</a>, sizeof(struct <a class=\"id\" href=\"#kbd_repeat\">kbd_repeat</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> =  -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#kbd_rate\">kbd_rate</a>(&amp;<a class=\"id\" href=\"#kbrep\">kbrep</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#up\">up</a>, &amp;<a class=\"id\" href=\"#kbrep\">kbrep</a>, sizeof(struct <a class=\"id\" href=\"#kbd_repeat\">kbd_repeat</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSETMODE\">KDSETMODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * currently, setting the mode from KD_TEXT to KD_GRAPHICS</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * doesn't do a whole lot. i'm not sure if it should do any</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * restoration of modes or what...</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * XXX It should at least call into the driver, fbdev's definitely</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * need to restore their engine state. --BenH</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#arg\">arg</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#KD_GRAPHICS\">KD_GRAPHICS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#KD_TEXT0\">KD_TEXT0</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#KD_TEXT1\">KD_TEXT1</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> = <a class=\"id\" href=\"#KD_TEXT\">KD_TEXT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#KD_TEXT\">KD_TEXT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_mode\">vc_mode</a> == (unsigned char) <a class=\"id\" href=\"#arg\">arg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_mode\">vc_mode</a> = (unsigned char) <a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#console\">console</a> != <a class=\"id\" href=\"#fg_console\">fg_console</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * explicitly blank/unblank the screen if switching modes</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> == <a class=\"id\" href=\"#KD_TEXT\">KD_TEXT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_unblank_screen\">do_unblank_screen</a>(1);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_blank_screen\">do_blank_screen</a>(1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGETMODE\">KDGETMODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ucval\">ucval</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_mode\">vc_mode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#setint\">setint</a>;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDMAPDISP\">KDMAPDISP</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDUNMAPDISP\">KDUNMAPDISP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * these work like a combination of mmap and KDENABIO.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * this could be easily finished.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBMODE\">KDSKBMODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>switch(<a class=\"id\" href=\"#arg\">arg</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>  case <a class=\"id\" href=\"#K_RAW\">K_RAW</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> = <a class=\"id\" href=\"#VC_RAW\">VC_RAW</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>  case <a class=\"id\" href=\"#K_MEDIUMRAW\">K_MEDIUMRAW</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> = <a class=\"id\" href=\"#VC_MEDIUMRAW\">VC_MEDIUMRAW</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>  case <a class=\"id\" href=\"#K_XLATE\">K_XLATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> = <a class=\"id\" href=\"#VC_XLATE\">VC_XLATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#compute_shiftstate\">compute_shiftstate</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>  case <a class=\"id\" href=\"#K_UNICODE\">K_UNICODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> = <a class=\"id\" href=\"#VC_UNICODE\">VC_UNICODE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#compute_shiftstate\">compute_shiftstate</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>  default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tty_ldisc_flush\">tty_ldisc_flush</a>(<a class=\"id\" href=\"#tty\">tty</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBMODE\">KDGKBMODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ucval\">ucval</a> = ((<a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> == <a class=\"id\" href=\"#VC_RAW\">VC_RAW</a>) ? <a class=\"id\" href=\"#K_RAW\">K_RAW</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> (<a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> == <a class=\"id\" href=\"#VC_MEDIUMRAW\">VC_MEDIUMRAW</a>) ? <a class=\"id\" href=\"#K_MEDIUMRAW\">K_MEDIUMRAW</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> (<a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#kbdmode\">kbdmode</a> == <a class=\"id\" href=\"#VC_UNICODE\">VC_UNICODE</a>) ? <a class=\"id\" href=\"#K_UNICODE\">K_UNICODE</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#K_XLATE\">K_XLATE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#setint\">setint</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* this could be folded into KDSKBMODE, but for compatibility</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   reasons it is not so easy to fold KDGKBMETA into KDGKBMODE */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBMETA\">KDSKBMETA</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>switch(<a class=\"id\" href=\"#arg\">arg</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>  case <a class=\"id\" href=\"#K_METABIT\">K_METABIT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clr_vc_kbd_mode\">clr_vc_kbd_mode</a>(<a class=\"id\" href=\"#kbd\">kbd</a>, <a class=\"id\" href=\"#VC_META\">VC_META</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>  case <a class=\"id\" href=\"#K_ESCPREFIX\">K_ESCPREFIX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_vc_kbd_mode\">set_vc_kbd_mode</a>(<a class=\"id\" href=\"#kbd\">kbd</a>, <a class=\"id\" href=\"#VC_META\">VC_META</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>  default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBMETA\">KDGKBMETA</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ucval\">ucval</a> = (<a class=\"id\" href=\"#vc_kbd_mode\">vc_kbd_mode</a>(<a class=\"id\" href=\"#kbd\">kbd</a>, <a class=\"id\" href=\"#VC_META\">VC_META</a>) ? <a class=\"id\" href=\"#K_ESCPREFIX\">K_ESCPREFIX</a> : <a class=\"id\" href=\"#K_METABIT\">K_METABIT</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setint\">setint</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#ucval\">ucval</a>, (int <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGETKEYCODE\">KDGETKEYCODE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSETKEYCODE\">KDSETKEYCODE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if(!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_TTY_CONFIG\">CAP_SYS_TTY_CONFIG</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perm\">perm</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#do_kbkeycode_ioctl\">do_kbkeycode_ioctl</a>(<a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#up\">up</a>, <a class=\"id\" href=\"#perm\">perm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBENT\">KDGKBENT</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBENT\">KDSKBENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#do_kdsk_ioctl\">do_kdsk_ioctl</a>(<a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#up\">up</a>, <a class=\"id\" href=\"#perm\">perm</a>, <a class=\"id\" href=\"#kbd\">kbd</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBSENT\">KDGKBSENT</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBSENT\">KDSKBSENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#do_kdgkb_ioctl\">do_kdgkb_ioctl</a>(<a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#up\">up</a>, <a class=\"id\" href=\"#perm\">perm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBDIACR\">KDGKBDIACR</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#kbdiacrs\">kbdiacrs</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#kbdiacr\">kbdiacr</a> <a class=\"id\" href=\"#diacr\">diacr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#accent_table_size\">accent_table_size</a>, &amp;<a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kb_cnt\">kb_cnt</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#accent_table_size\">accent_table_size</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#diacr\">diacr</a>.<a class=\"id\" href=\"#diacr\">diacr</a> = <a class=\"id\" href=\"#conv_uni_to_8bit\">conv_uni_to_8bit</a>(<a class=\"id\" href=\"#accent_table\">accent_table</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#diacr\">diacr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#diacr\">diacr</a>.<a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#conv_uni_to_8bit\">conv_uni_to_8bit</a>(<a class=\"id\" href=\"#accent_table\">accent_table</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#base\">base</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#diacr\">diacr</a>.<a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#conv_uni_to_8bit\">conv_uni_to_8bit</a>(<a class=\"id\" href=\"#accent_table\">accent_table</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#result\">result</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kbdiacr\">kbdiacr</a> + <a class=\"id\" href=\"#i\">i</a>, &amp;<a class=\"id\" href=\"#diacr\">diacr</a>, sizeof(struct <a class=\"id\" href=\"#kbdiacr\">kbdiacr</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBDIACRUC\">KDGKBDIACRUC</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#kbdiacrsuc\">kbdiacrsuc</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#accent_table_size\">accent_table_size</a>, &amp;<a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kb_cnt\">kb_cnt</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kbdiacruc\">kbdiacruc</a>, <a class=\"id\" href=\"#accent_table\">accent_table</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#accent_table_size\">accent_table_size</a>*sizeof(struct <a class=\"id\" href=\"#kbdiacruc\">kbdiacruc</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBDIACR\">KDSKBDIACR</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#kbdiacrs\">kbdiacrs</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#kbdiacr\">kbdiacr</a> <a class=\"id\" href=\"#diacr\">diacr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#ct\">ct</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#get_user\">get_user</a>(<a class=\"id\" href=\"#ct\">ct</a>,&amp;<a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kb_cnt\">kb_cnt</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ct\">ct</a> >= <a class=\"id\" href=\"#MAX_DIACR\">MAX_DIACR</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#accent_table_size\">accent_table_size</a> = <a class=\"id\" href=\"#ct\">ct</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#ct\">ct</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#diacr\">diacr</a>, <a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kbdiacr\">kbdiacr</a> + <a class=\"id\" href=\"#i\">i</a>, sizeof(struct <a class=\"id\" href=\"#kbdiacr\">kbdiacr</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#accent_table\">accent_table</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#diacr\">diacr</a> = <a class=\"id\" href=\"#conv_8bit_to_uni\">conv_8bit_to_uni</a>(<a class=\"id\" href=\"#diacr\">diacr</a>.<a class=\"id\" href=\"#diacr\">diacr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#accent_table\">accent_table</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#conv_8bit_to_uni\">conv_8bit_to_uni</a>(<a class=\"id\" href=\"#diacr\">diacr</a>.<a class=\"id\" href=\"#base\">base</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#accent_table\">accent_table</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#conv_8bit_to_uni\">conv_8bit_to_uni</a>(<a class=\"id\" href=\"#diacr\">diacr</a>.<a class=\"id\" href=\"#result\">result</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBDIACRUC\">KDSKBDIACRUC</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#kbdiacrsuc\">kbdiacrsuc</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#ct\">ct</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#get_user\">get_user</a>(<a class=\"id\" href=\"#ct\">ct</a>,&amp;<a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kb_cnt\">kb_cnt</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ct\">ct</a> >= <a class=\"id\" href=\"#MAX_DIACR\">MAX_DIACR</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#accent_table_size\">accent_table_size</a> = <a class=\"id\" href=\"#ct\">ct</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#accent_table\">accent_table</a>, <a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#kbdiacruc\">kbdiacruc</a>, <a class=\"id\" href=\"#ct\">ct</a>*sizeof(struct <a class=\"id\" href=\"#kbdiacruc\">kbdiacruc</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* the ioctls below read/set the flags usually shown in the leds */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* don't use them - they will go away without warning */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGKBLED\">KDGKBLED</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ucval\">ucval</a> = <a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#ledflagstate\">ledflagstate</a> | (<a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#default_ledflagstate\">default_ledflagstate</a> << 4);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#setchar\">setchar</a>;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSKBLED\">KDSKBLED</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &amp; ~0x77) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#ledflagstate\">ledflagstate</a> = (<a class=\"id\" href=\"#arg\">arg</a> &amp; 7);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kbd\">kbd</a>-><a class=\"id\" href=\"#default_ledflagstate\">default_ledflagstate</a> = ((<a class=\"id\" href=\"#arg\">arg</a> >> 4) &amp; 7);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_leds\">set_leds</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* the ioctls below only set the lights, not the functions */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* for those, see KDGKBLED and KDSKBLED above */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDGETLED\">KDGETLED</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ucval\">ucval</a> = <a class=\"id\" href=\"#getledstate\">getledstate</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setchar\">setchar</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#ucval\">ucval</a>, (char <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSETLED\">KDSETLED</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#setledstate\">setledstate</a>(<a class=\"id\" href=\"#kbd\">kbd</a>, <a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * A process can indicate its willingness to accept signals</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * generated by pressing an appropriate key combination.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Thus, one can have a daemon that e.g. spawns a new console</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * upon a keypress and then changes to it.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * See also the kbrequest field of inittab(5).</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDSIGACCEPT\">KDSIGACCEPT</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a> || !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_KILL\">CAP_KILL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#valid_signal\">valid_signal</a>(<a class=\"id\" href=\"#arg\">arg</a>) || <a class=\"id\" href=\"#arg\">arg</a> &lt; 1 || <a class=\"id\" href=\"#arg\">arg</a> == <a class=\"id\" href=\"#SIGKILL\">SIGKILL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#vt_spawn_con\">vt_spawn_con</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_pid\">put_pid</a>(<a class=\"id\" href=\"#vt_spawn_con\">vt_spawn_con</a>.<a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vt_spawn_con\">vt_spawn_con</a>.<a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#get_pid\">get_pid</a>(<a class=\"id\" href=\"#task_pid\">task_pid</a>(<a class=\"id\" href=\"#current\">current</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vt_spawn_con\">vt_spawn_con</a>.<a class=\"id\" href=\"#sig\">sig</a> = <a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#vt_spawn_con\">vt_spawn_con</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_SETMODE\">VT_SETMODE</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_mode\">vt_mode</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#up\">up</a>, sizeof(struct <a class=\"id\" href=\"#vt_mode\">vt_mode</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#VT_AUTO\">VT_AUTO</a> && <a class=\"id\" href=\"#tmp\">tmp</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#VT_PROCESS\">VT_PROCESS</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_mode\">vt_mode</a> = <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* the frsig is ignored, so we set it to 0 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_mode\">vt_mode</a>.<a class=\"id\" href=\"#frsig\">frsig</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_pid\">put_pid</a>(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_pid\">vt_pid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_pid\">vt_pid</a> = <a class=\"id\" href=\"#get_pid\">get_pid</a>(<a class=\"id\" href=\"#task_pid\">task_pid</a>(<a class=\"id\" href=\"#current\">current</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* no switch is required -- saw@shade.msu.ru */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_newvt\">vt_newvt</a> = -1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_GETMODE\">VT_GETMODE</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_mode\">vt_mode</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#tmp\">tmp</a>, &amp;<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_mode\">vt_mode</a>, sizeof(struct <a class=\"id\" href=\"#vt_mode\">vt_mode</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#up\">up</a>, &amp;<a class=\"id\" href=\"#tmp\">tmp</a>, sizeof(struct <a class=\"id\" href=\"#vt_mode\">vt_mode</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Returns global vt state. Note that VT 0 is always open, since</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * it's an alias for the current VT, and people can't use it here.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * We cannot return state for more than 16 VTs, since v_state is short.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_GETSTATE\">VT_GETSTATE</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_stat\">vt_stat</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#vtstat\">vtstat</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#state\">state</a>, <a class=\"id\" href=\"#mask\">mask</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#fg_console\">fg_console</a> + 1, &amp;<a class=\"id\" href=\"#vtstat\">vtstat</a>-><a class=\"id\" href=\"#v_active\">v_active</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#state\">state</a> = 1;<span class=\"ts\"/><span class=\"comment\">/* /dev/tty0 is always open */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0, <a class=\"id\" href=\"#mask\">mask</a> = 2; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a> && <a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#mask\">mask</a> <<= 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#VT_IS_IN_USE\">VT_IS_IN_USE</a>(<a class=\"id\" href=\"#i\">i</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#state\">state</a> |= <a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#state\">state</a>, &amp;<a class=\"id\" href=\"#vtstat\">vtstat</a>-><a class=\"id\" href=\"#v_state\">v_state</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Returns the first available (non-opened) console.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_OPENQRY\">VT_OPENQRY</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>; ++<a class=\"id\" href=\"#i\">i</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (! <a class=\"id\" href=\"#VT_IS_IN_USE\">VT_IS_IN_USE</a>(<a class=\"id\" href=\"#i\">i</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ucval\">ucval</a> = <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a> ? (<a class=\"id\" href=\"#i\">i</a>+1) : -1;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#setint\">setint</a>;<span class=\"ts\"/><span class=\"ts\"/> ", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * ioctl(fd, VT_ACTIVATE, num) will cause us to switch to vt # num,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * with num &gt;= 1 (switches to vt 0, our console, are not allowed, just</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * to preserve sanity).</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_ACTIVATE\">VT_ACTIVATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> == 0 || <a class=\"id\" href=\"#arg\">arg</a> &gt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> =  -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#vc_allocate\">vc_allocate</a>(<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_console\">set_console</a>(<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_SETACTIVATE\">VT_SETACTIVATE</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_setactivate\">vt_setactivate</a> <a class=\"id\" href=\"#vsa\">vsa</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#vsa\">vsa</a>, (struct <a class=\"id\" href=\"#vt_setactivate\">vt_setactivate</a> <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(struct <a class=\"id\" href=\"#vt_setactivate\">vt_setactivate</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vsa\">vsa</a>.<a class=\"id\" href=\"#console\">console</a> == 0 || <a class=\"id\" href=\"#vsa\">vsa</a>.<a class=\"id\" href=\"#console\">console</a> &gt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vsa\">vsa</a>.<a class=\"id\" href=\"#console\">console</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#vc_allocate\">vc_allocate</a>(<a class=\"id\" href=\"#vsa\">vsa</a>.<a class=\"id\" href=\"#console\">console</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#nvc\">nvc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* This is safe providing we don't drop the</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   console sem between vc_allocate and</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   finishing referencing nvc */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nvc\">nvc</a> = <a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#vsa\">vsa</a>.<a class=\"id\" href=\"#console\">console</a>].<a class=\"id\" href=\"#d\">d</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nvc\">nvc</a>-><a class=\"id\" href=\"#vt_mode\">vt_mode</a> = <a class=\"id\" href=\"#vsa\">vsa</a>.<a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nvc\">nvc</a>-><a class=\"id\" href=\"#vt_mode\">vt_mode</a>.<a class=\"id\" href=\"#frsig\">frsig</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_pid\">put_pid</a>(<a class=\"id\" href=\"#nvc\">nvc</a>-><a class=\"id\" href=\"#vt_pid\">vt_pid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nvc\">nvc</a>-><a class=\"id\" href=\"#vt_pid\">vt_pid</a> = <a class=\"id\" href=\"#get_pid\">get_pid</a>(<a class=\"id\" href=\"#task_pid\">task_pid</a>(<a class=\"id\" href=\"#current\">current</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Commence switch and lock */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_console\">set_console</a>(<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * wait until the specified VT has been activated</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_WAITACTIVE\">VT_WAITACTIVE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> == 0 || <a class=\"id\" href=\"#arg\">arg</a> &gt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#vt_waitactive\">vt_waitactive</a>(<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * If a vt is under process control, the kernel will not switch to it</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * immediately, but postpone the operation until the process calls this</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * ioctl, allowing the switch to complete.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * According to the X sources this is the behavior:</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>0:<span class=\"ts\"/>pending switch-from not OK</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>1:<span class=\"ts\"/>pending switch-from OK</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>2:<span class=\"ts\"/>completed switch-to OK</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_RELDISP\">VT_RELDISP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_mode\">vt_mode</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#VT_PROCESS\">VT_PROCESS</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Switching-from response</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_newvt\">vt_newvt</a> >= 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Switch disallowed, so forget we were trying</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * to do it.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_newvt\">vt_newvt</a> = -1;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * The current vt has been released, so</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * complete the switch.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#newvt\">newvt</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newvt\">newvt</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_newvt\">vt_newvt</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vt_newvt\">vt_newvt</a> = -1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#vc_allocate\">vc_allocate</a>(<a class=\"id\" href=\"#newvt\">newvt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * When we actually do the console switch,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * make sure we are atomic with respect to</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * other console switches..</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#complete_change_console\">complete_change_console</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#newvt\">newvt</a>].<a class=\"id\" href=\"#d\">d</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Switched-to response</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * If it's just an ACK, ignore it</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> != <a class=\"id\" href=\"#VT_ACKACQ\">VT_ACKACQ</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/> <span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/>  * Disallocate memory associated to VT (but leave VT1)</span>", 
"<span class=\"comment\"><span class=\"ts\"/>  */</span>", 
"<span class=\"ts\"/> case <a class=\"id\" href=\"#VT_DISALLOCATE\">VT_DISALLOCATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &gt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>    <span class=\"comment\">/* deallocate all unused consoles, but leave 0 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=1; <a class=\"id\" href=\"#i\">i</a>&lt;<a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (! <a class=\"id\" href=\"#VT_BUSY\">VT_BUSY</a>(<a class=\"id\" href=\"#i\">i</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_deallocate\">vc_deallocate</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* deallocate a single console, if possible */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#VT_BUSY\">VT_BUSY</a>(<a class=\"id\" href=\"#arg\">arg</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#arg\">arg</a>) {<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <span class=\"comment\">/* leave 0 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_deallocate\">vc_deallocate</a>(<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_RESIZE\">VT_RESIZE</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_sizes\">vt_sizes</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#vtsizes\">vtsizes</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ushort\">ushort</a> <a class=\"id\" href=\"#ll\">ll</a>,<a class=\"id\" href=\"#cc\">cc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#get_user\">get_user</a>(<a class=\"id\" href=\"#ll\">ll</a>, &amp;<a class=\"id\" href=\"#vtsizes\">vtsizes</a>-><a class=\"id\" href=\"#v_rows\">v_rows</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#get_user\">get_user</a>(<a class=\"id\" href=\"#cc\">cc</a>, &amp;<a class=\"id\" href=\"#vtsizes\">vtsizes</a>-><a class=\"id\" href=\"#v_cols\">v_cols</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a> = <a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_resize_user\">vc_resize_user</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_resize\">vc_resize</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>, <a class=\"id\" href=\"#cc\">cc</a>, <a class=\"id\" href=\"#ll\">ll</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#VT_RESIZEX\">VT_RESIZEX</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_consize\">vt_consize</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#vtconsize\">vtconsize</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ushort\">ushort</a> <a class=\"id\" href=\"#ll\">ll</a>,<a class=\"id\" href=\"#cc\">cc</a>,<a class=\"id\" href=\"#vlin\">vlin</a>,<a class=\"id\" href=\"#clin\">clin</a>,<a class=\"id\" href=\"#vcol\">vcol</a>,<a class=\"id\" href=\"#ccol\">ccol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#access_ok\">access_ok</a>(<a class=\"id\" href=\"#VERIFY_READ\">VERIFY_READ</a>, <a class=\"id\" href=\"#vtconsize\">vtconsize</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(struct <a class=\"id\" href=\"#vt_consize\">vt_consize</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* FIXME: Should check the copies properly */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__get_user\">__get_user</a>(<a class=\"id\" href=\"#ll\">ll</a>, &amp;<a class=\"id\" href=\"#vtconsize\">vtconsize</a>-><a class=\"id\" href=\"#v_rows\">v_rows</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__get_user\">__get_user</a>(<a class=\"id\" href=\"#cc\">cc</a>, &amp;<a class=\"id\" href=\"#vtconsize\">vtconsize</a>-><a class=\"id\" href=\"#v_cols\">v_cols</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__get_user\">__get_user</a>(<a class=\"id\" href=\"#vlin\">vlin</a>, &amp;<a class=\"id\" href=\"#vtconsize\">vtconsize</a>-><a class=\"id\" href=\"#v_vlin\">v_vlin</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__get_user\">__get_user</a>(<a class=\"id\" href=\"#clin\">clin</a>, &amp;<a class=\"id\" href=\"#vtconsize\">vtconsize</a>-><a class=\"id\" href=\"#v_clin\">v_clin</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__get_user\">__get_user</a>(<a class=\"id\" href=\"#vcol\">vcol</a>, &amp;<a class=\"id\" href=\"#vtconsize\">vtconsize</a>-><a class=\"id\" href=\"#v_vcol\">v_vcol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__get_user\">__get_user</a>(<a class=\"id\" href=\"#ccol\">ccol</a>, &amp;<a class=\"id\" href=\"#vtconsize\">vtconsize</a>-><a class=\"id\" href=\"#v_ccol\">v_ccol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vlin\">vlin</a> = <a class=\"id\" href=\"#vlin\">vlin</a> ? <a class=\"id\" href=\"#vlin\">vlin</a> : <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_scan_lines\">vc_scan_lines</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#clin\">clin</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ll\">ll</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ll\">ll</a> != <a class=\"id\" href=\"#vlin\">vlin</a>/<a class=\"id\" href=\"#clin\">clin</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Parameters don't add up */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else ", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ll\">ll</a> = <a class=\"id\" href=\"#vlin\">vlin</a>/<a class=\"id\" href=\"#clin\">clin</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vcol\">vcol</a> && <a class=\"id\" href=\"#ccol\">ccol</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cc\">cc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cc\">cc</a> != <a class=\"id\" href=\"#vcol\">vcol</a>/<a class=\"id\" href=\"#ccol\">ccol</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cc\">cc</a> = <a class=\"id\" href=\"#vcol\">vcol</a>/<a class=\"id\" href=\"#ccol\">ccol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#clin\">clin</a> &gt; 32) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> =  -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>    ", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acquire_console_sem\">acquire_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vlin\">vlin</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>-><a class=\"id\" href=\"#vc_scan_lines\">vc_scan_lines</a> = <a class=\"id\" href=\"#vlin\">vlin</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#clin\">clin</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>-><a class=\"id\" href=\"#vc_font\">vc_font</a>.<a class=\"id\" href=\"#height\">height</a> = <a class=\"id\" href=\"#clin\">clin</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>-><a class=\"id\" href=\"#vc_resize_user\">vc_resize_user</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_resize\">vc_resize</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>, <a class=\"id\" href=\"#cc\">cc</a>, <a class=\"id\" href=\"#ll\">ll</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#release_console_sem\">release_console_sem</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_FONT\">PIO_FONT</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#op\">op</a> = <a class=\"id\" href=\"#KD_FONT_OP_SET\">KD_FONT_OP_SET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#KD_FONT_FLAG_OLD\">KD_FONT_FLAG_OLD</a> | <a class=\"id\" href=\"#KD_FONT_FLAG_DONT_RECALC\">KD_FONT_FLAG_DONT_RECALC</a>;<span class=\"ts\"/><span class=\"comment\">/* Compatibility */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#width\">width</a> = 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#height\">height</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#charcount\">charcount</a> = 256;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_font_op\">con_font_op</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#fg_console\">fg_console</a>].<a class=\"id\" href=\"#d\">d</a>, &amp;<a class=\"id\" href=\"#op\">op</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_FONT\">GIO_FONT</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#op\">op</a> = <a class=\"id\" href=\"#KD_FONT_OP_GET\">KD_FONT_OP_GET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#KD_FONT_FLAG_OLD\">KD_FONT_FLAG_OLD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#width\">width</a> = 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#height\">height</a> = 32;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#charcount\">charcount</a> = 256;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#up\">up</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_font_op\">con_font_op</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#fg_console\">fg_console</a>].<a class=\"id\" href=\"#d\">d</a>, &amp;<a class=\"id\" href=\"#op\">op</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_CMAP\">PIO_CMAP</a>:", 
"                if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/>                <a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_set_cmap\">con_set_cmap</a>(<a class=\"id\" href=\"#up\">up</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_CMAP\">GIO_CMAP</a>:", 
"                <a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_get_cmap\">con_get_cmap</a>(<a class=\"id\" href=\"#up\">up</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_FONTX\">PIO_FONTX</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_FONTX\">GIO_FONTX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#do_fontx_ioctl\">do_fontx_ioctl</a>(<a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#up\">up</a>, <a class=\"id\" href=\"#perm\">perm</a>, &amp;<a class=\"id\" href=\"#op\">op</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_FONTRESET\">PIO_FONTRESET</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#BROKEN_GRAPHICS_PROGRAMS\">BROKEN_GRAPHICS_PROGRAMS</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* With BROKEN_GRAPHICS_PROGRAMS defined, the default</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   font is not saved. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENOSYS\">ENOSYS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"#else", 
"<span class=\"ts\"/><span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#op\">op</a> = <a class=\"id\" href=\"#KD_FONT_OP_SET_DEFAULT\">KD_FONT_OP_SET_DEFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_font_op\">con_font_op</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#fg_console\">fg_console</a>].<a class=\"id\" href=\"#d\">d</a>, &amp;<a class=\"id\" href=\"#op\">op</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#con_set_default_unimap\">con_set_default_unimap</a>(<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#fg_console\">fg_console</a>].<a class=\"id\" href=\"#d\">d</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#KDFONTOP\">KDFONTOP</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#op\">op</a>, <a class=\"id\" href=\"#up\">up</a>, sizeof(<a class=\"id\" href=\"#op\">op</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a> && <a class=\"id\" href=\"#op\">op</a>.<a class=\"id\" href=\"#op\">op</a> != <a class=\"id\" href=\"#KD_FONT_OP_GET\">KD_FONT_OP_GET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_font_op\">con_font_op</a>(<a class=\"id\" href=\"#vc\">vc</a>, &amp;<a class=\"id\" href=\"#op\">op</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#up\">up</a>, &amp;<a class=\"id\" href=\"#op\">op</a>, sizeof(<a class=\"id\" href=\"#op\">op</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_SCRNMAP\">PIO_SCRNMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_set_trans_old\">con_set_trans_old</a>(<a class=\"id\" href=\"#up\">up</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_SCRNMAP\">GIO_SCRNMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_get_trans_old\">con_get_trans_old</a>(<a class=\"id\" href=\"#up\">up</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_UNISCRNMAP\">PIO_UNISCRNMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_set_trans_new\">con_set_trans_new</a>(<a class=\"id\" href=\"#up\">up</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_UNISCRNMAP\">GIO_UNISCRNMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#con_get_trans_new\">con_get_trans_new</a>(<a class=\"id\" href=\"#up\">up</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_UNIMAPCLR\">PIO_UNIMAPCLR</a>:", 
"<span class=\"ts\"/>      { struct <a class=\"id\" href=\"#unimapinit\">unimapinit</a> <a class=\"id\" href=\"#ui\">ui</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#perm\">perm</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eperm\">eperm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#ui\">ui</a>, <a class=\"id\" href=\"#up\">up</a>, sizeof(struct <a class=\"id\" href=\"#unimapinit\">unimapinit</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#con_clear_unimap\">con_clear_unimap</a>(<a class=\"id\" href=\"#vc\">vc</a>, &amp;<a class=\"id\" href=\"#ui\">ui</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>      }", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PIO_UNIMAP\">PIO_UNIMAP</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#GIO_UNIMAP\">GIO_UNIMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#do_unimap_ioctl\">do_unimap_ioctl</a>(<a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#up\">up</a>, <a class=\"id\" href=\"#perm\">perm</a>, <a class=\"id\" href=\"#vc\">vc</a>);", 
];
xr_frag_insert('l/0e/dfef4b0ca9fd1c45b33a232236d997c8c65cb7.xr', __xr_tmp);
