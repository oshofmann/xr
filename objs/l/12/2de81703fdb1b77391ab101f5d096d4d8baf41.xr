var __xr_tmp = [
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADFD\">EBADFD</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tun\">tun</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: tun_chr_ioctl cmd %d\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#cmd\">cmd</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNGETIFF\">TUNGETIFF</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#tun_get_iff\">tun_get_iff</a>(<a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#nsproxy\">nsproxy</a>-><a class=\"id\" href=\"#net_ns\">net_ns</a>, <a class=\"id\" href=\"#tun\">tun</a>, &amp;<a class=\"id\" href=\"#ifr\">ifr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#argp\">argp</a>, &amp;<a class=\"id\" href=\"#ifr\">ifr</a>, <a class=\"id\" href=\"#ifreq_len\">ifreq_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETNOCSUM\">TUNSETNOCSUM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Disable/Enable checksum */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_NOCHECKSUM\">TUN_NOCHECKSUM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#TUN_NOCHECKSUM\">TUN_NOCHECKSUM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: checksum %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#arg\">arg</a> ? \"disabled\" : \"enabled\");", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETPERSIST\">TUNSETPERSIST</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Disable/Enable persist mode */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_PERSIST\">TUN_PERSIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#TUN_PERSIST\">TUN_PERSIST</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: persist %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#arg\">arg</a> ? \"enabled\" : \"disabled\");", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETOWNER\">TUNSETOWNER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Set owner of the device */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#owner\">owner</a> = (<a class=\"id\" href=\"#uid_t\">uid_t</a>) <a class=\"id\" href=\"#arg\">arg</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: owner set to %d\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#owner\">owner</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETGROUP\">TUNSETGROUP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Set group of the device */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#group\">group</a>= (<a class=\"id\" href=\"#gid_t\">gid_t</a>) <a class=\"id\" href=\"#arg\">arg</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: group set to %d\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#group\">group</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETLINK\">TUNSETLINK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Only allow setting the type when the interface is down */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFF_UP\">IFF_UP</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: Linktype set failed because interface is up\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a> = (int) <a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: linktype set to %d\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#TUN_DEBUG\">TUN_DEBUG</a>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETDEBUG\">TUNSETDEBUG</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#debug\">debug</a> = <a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETOFFLOAD\">TUNSETOFFLOAD</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#set_offload\">set_offload</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETTXFILTER\">TUNSETTXFILTER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Can be set only for TAPs */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_TYPE_MASK\">TUN_TYPE_MASK</a>) != <a class=\"id\" href=\"#TUN_TAP_DEV\">TUN_TAP_DEV</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#update_filter\">update_filter</a>(&amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#txflt\">txflt</a>, (void <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGIFHWADDR\">SIOCGIFHWADDR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Get hw addres */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#ifr\">ifr</a>.<a class=\"id\" href=\"#ifr_hwaddr\">ifr_hwaddr</a>.<a class=\"id\" href=\"#sa_data\">sa_data</a>, <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev_addr\">dev_addr</a>, <a class=\"id\" href=\"#ETH_ALEN\">ETH_ALEN</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ifr\">ifr</a>.<a class=\"id\" href=\"#ifr_hwaddr\">ifr_hwaddr</a>.<a class=\"id\" href=\"#sa_family\">sa_family</a> = <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#argp\">argp</a>, &amp;<a class=\"id\" href=\"#ifr\">ifr</a>, <a class=\"id\" href=\"#ifreq_len\">ifreq_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSIFHWADDR\">SIOCSIFHWADDR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Set hw address */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"%s: set hw address: %pM\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#ifr\">ifr</a>.<a class=\"id\" href=\"#ifr_hwaddr\">ifr_hwaddr</a>.<a class=\"id\" href=\"#sa_data\">sa_data</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#dev_set_mac_address\">dev_set_mac_address</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#ifr\">ifr</a>.<a class=\"id\" href=\"#ifr_hwaddr\">ifr_hwaddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNGETSNDBUF\">TUNGETSNDBUF</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sndbuf\">sndbuf</a> = <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_sndbuf\">sk_sndbuf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#argp\">argp</a>, &amp;<a class=\"id\" href=\"#sndbuf\">sndbuf</a>, sizeof(<a class=\"id\" href=\"#sndbuf\">sndbuf</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETSNDBUF\">TUNSETSNDBUF</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#sndbuf\">sndbuf</a>, <a class=\"id\" href=\"#argp\">argp</a>, sizeof(<a class=\"id\" href=\"#sndbuf\">sndbuf</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_sndbuf\">sk_sndbuf</a> = <a class=\"id\" href=\"#sndbuf\">sndbuf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNGETVNETHDRSZ\">TUNGETVNETHDRSZ</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a> = <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#argp\">argp</a>, &amp;<a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a>, sizeof(<a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETVNETHDRSZ\">TUNSETVNETHDRSZ</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a>, <a class=\"id\" href=\"#argp\">argp</a>, sizeof(<a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a> &lt; (int)sizeof(struct <a class=\"id\" href=\"#virtio_net_hdr\">virtio_net_hdr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a> = <a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNATTACHFILTER\">TUNATTACHFILTER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Can be set only for TAPs */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_TYPE_MASK\">TUN_TYPE_MASK</a>) != <a class=\"id\" href=\"#TUN_TAP_DEV\">TUN_TAP_DEV</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#fprog\">fprog</a>, <a class=\"id\" href=\"#argp\">argp</a>, sizeof(<a class=\"id\" href=\"#fprog\">fprog</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#sk_attach_filter\">sk_attach_filter</a>(&amp;<a class=\"id\" href=\"#fprog\">fprog</a>, <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNDETACHFILTER\">TUNDETACHFILTER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Can be set only for TAPs */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_TYPE_MASK\">TUN_TYPE_MASK</a>) != <a class=\"id\" href=\"#TUN_TAP_DEV\">TUN_TAP_DEV</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#sk_detach_filter\">sk_detach_filter</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#unlock\">unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tun\">tun</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun_put\">tun_put</a>(<a class=\"id\" href=\"#tun\">tun</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static long <a class=\"id\" href=\"#tun_chr_ioctl\">tun_chr_ioctl</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  unsigned int <a class=\"id\" href=\"#cmd\">cmd</a>, unsigned long <a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__tun_chr_ioctl\">__tun_chr_ioctl</a>(<a class=\"id\" href=\"#file\">file</a>, <a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#arg\">arg</a>, sizeof (struct <a class=\"id\" href=\"#ifreq\">ifreq</a>));", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_COMPAT\">CONFIG_COMPAT</a>", 
"static long <a class=\"id\" href=\"#tun_chr_compat_ioctl\">tun_chr_compat_ioctl</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> unsigned int <a class=\"id\" href=\"#cmd\">cmd</a>, unsigned long <a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETIFF\">TUNSETIFF</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNGETIFF\">TUNGETIFF</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETTXFILTER\">TUNSETTXFILTER</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNGETSNDBUF\">TUNGETSNDBUF</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUNSETSNDBUF\">TUNSETSNDBUF</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGIFHWADDR\">SIOCGIFHWADDR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSIFHWADDR\">SIOCSIFHWADDR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> = (unsigned long)<a class=\"id\" href=\"#compat_ptr\">compat_ptr</a>(<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> = (<a class=\"id\" href=\"#compat_ulong_t\">compat_ulong_t</a>)<a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * compat_ifreq is shorter than ifreq, so we must not access beyond</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * the end of that structure. All fields that are used in this</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * driver are compatible though, we don't need to convert the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * contents.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__tun_chr_ioctl\">__tun_chr_ioctl</a>(<a class=\"id\" href=\"#file\">file</a>, <a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#arg\">arg</a>, sizeof(struct <a class=\"id\" href=\"#compat_ifreq\">compat_ifreq</a>));", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_COMPAT */</span>", 
"", 
"static int <a class=\"id\" href=\"#tun_chr_fasync\">tun_chr_fasync</a>(int <a class=\"id\" href=\"#fd\">fd</a>, struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>, int <a class=\"id\" href=\"#on\">on</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#tun_get\">tun_get</a>(<a class=\"id\" href=\"#file\">file</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tun\">tun</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EBADFD\">EBADFD</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: tun_chr_fasync %d\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#on\">on</a>);", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#fasync_helper\">fasync_helper</a>(<a class=\"id\" href=\"#fd\">fd</a>, <a class=\"id\" href=\"#file\">file</a>, <a class=\"id\" href=\"#on\">on</a>, &amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#fasync\">fasync</a>)) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#on\">on</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#__f_setown\">__f_setown</a>(<a class=\"id\" href=\"#file\">file</a>, <a class=\"id\" href=\"#task_pid\">task_pid</a>(<a class=\"id\" href=\"#current\">current</a>), <a class=\"id\" href=\"#PIDTYPE_PID\">PIDTYPE_PID</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_FASYNC\">TUN_FASYNC</a>;", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#TUN_FASYNC\">TUN_FASYNC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tun_put\">tun_put</a>(<a class=\"id\" href=\"#tun\">tun</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tun_chr_open\">tun_chr_open</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>, struct <a class=\"id\" href=\"#file\">file</a> * <a class=\"id\" href=\"#file\">file</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_file\">tun_file</a> *<a class=\"id\" href=\"#tfile\">tfile</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DBG1\">DBG1</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"tunX: tun_chr_open\\n\");", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tfile\">tfile</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#tfile\">tfile</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tfile\">tfile</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#tfile\">tfile</a>-><a class=\"id\" href=\"#count\">count</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tfile\">tfile</a>-><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tfile\">tfile</a>-><a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#get_net\">get_net</a>(<a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#nsproxy\">nsproxy</a>-><a class=\"id\" href=\"#net_ns\">net_ns</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#file\">file</a>-><a class=\"id\" href=\"#private_data\">private_data</a> = <a class=\"id\" href=\"#tfile\">tfile</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tun_chr_close\">tun_chr_close</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>, struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_file\">tun_file</a> *<a class=\"id\" href=\"#tfile\">tfile</a> = <a class=\"id\" href=\"#file\">file</a>-><a class=\"id\" href=\"#private_data\">private_data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#__tun_get\">__tun_get</a>(<a class=\"id\" href=\"#tfile\">tfile</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tun\">tun</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: tun_chr_close\\n\", <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__tun_detach\">__tun_detach</a>(<a class=\"id\" href=\"#tun\">tun</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* If desirable, unregister the netdevice. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_PERSIST\">TUN_PERSIST</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#reg_state\">reg_state</a> == <a class=\"id\" href=\"#NETREG_REGISTERED\">NETREG_REGISTERED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#unregister_netdevice\">unregister_netdevice</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#tfile\">tfile</a>-><a class=\"id\" href=\"#tun\">tun</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tun\">tun</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_put\">sock_put</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_net\">put_net</a>(<a class=\"id\" href=\"#tfile\">tfile</a>-><a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#tfile\">tfile</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#file_operations\">file_operations</a> <a class=\"id\" href=\"#tun_fops\">tun_fops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a><span class=\"ts\"/>= <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#llseek\">llseek</a> = <a class=\"id\" href=\"#no_llseek\">no_llseek</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#read\">read</a>  = <a class=\"id\" href=\"#do_sync_read\">do_sync_read</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#aio_read\">aio_read</a>  = <a class=\"id\" href=\"#tun_chr_aio_read\">tun_chr_aio_read</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#write\">write</a> = <a class=\"id\" href=\"#do_sync_write\">do_sync_write</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#aio_write\">aio_write</a> = <a class=\"id\" href=\"#tun_chr_aio_write\">tun_chr_aio_write</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#poll\">poll</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_chr_poll\">tun_chr_poll</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#unlocked_ioctl\">unlocked_ioctl</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_chr_ioctl\">tun_chr_ioctl</a>,", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_COMPAT\">CONFIG_COMPAT</a>", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#compat_ioctl\">compat_ioctl</a> = <a class=\"id\" href=\"#tun_chr_compat_ioctl\">tun_chr_compat_ioctl</a>,", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#open\">open</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_chr_open\">tun_chr_open</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#release\">release</a> = <a class=\"id\" href=\"#tun_chr_close\">tun_chr_close</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#fasync\">fasync</a> = <a class=\"id\" href=\"#tun_chr_fasync\">tun_chr_fasync</a>", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#miscdevice\">miscdevice</a> <a class=\"id\" href=\"#tun_miscdev\">tun_miscdev</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#minor\">minor</a> = <a class=\"id\" href=\"#TUN_MINOR\">TUN_MINOR</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = \"tun\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#nodename\">nodename</a> = \"net/tun\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#fops\">fops</a> = &amp;<a class=\"id\" href=\"#tun_fops\">tun_fops</a>,", 
"};", 
"", 
"<span class=\"comment\">/* ethtool interface */</span>", 
"", 
"static int <a class=\"id\" href=\"#tun_get_settings\">tun_get_settings</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#ethtool_cmd\">ethtool_cmd</a> *<a class=\"id\" href=\"#cmd\">cmd</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#supported\">supported</a><span class=\"ts\"/><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#advertising\">advertising</a><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#speed\">speed</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#SPEED_10\">SPEED_10</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#duplex\">duplex</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#DUPLEX_FULL\">DUPLEX_FULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#port\">port</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#PORT_TP\">PORT_TP</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#phy_address\">phy_address</a><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#transceiver\">transceiver</a><span class=\"ts\"/>= <a class=\"id\" href=\"#XCVR_INTERNAL\">XCVR_INTERNAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#autoneg\">autoneg</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#AUTONEG_DISABLE\">AUTONEG_DISABLE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#maxtxpkt\">maxtxpkt</a><span class=\"ts\"/><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#maxrxpkt\">maxrxpkt</a><span class=\"ts\"/><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tun_get_drvinfo\">tun_get_drvinfo</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#ethtool_drvinfo\">ethtool_drvinfo</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#driver\">driver</a>, <a class=\"id\" href=\"#DRV_NAME\">DRV_NAME</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#version\">version</a>, <a class=\"id\" href=\"#DRV_VERSION\">DRV_VERSION</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fw_version\">fw_version</a>, \"N/A\");", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_TYPE_MASK\">TUN_TYPE_MASK</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUN_TUN_DEV\">TUN_TUN_DEV</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#bus_info\">bus_info</a>, \"tun\");", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TUN_TAP_DEV\">TUN_TAP_DEV</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#bus_info\">bus_info</a>, \"tap\");", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tun_get_msglevel\">tun_get_msglevel</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#TUN_DEBUG\">TUN_DEBUG</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#debug\">debug</a>;", 
"#else", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EOPNOTSUPP\">EOPNOTSUPP</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tun_set_msglevel\">tun_set_msglevel</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#value\">value</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#TUN_DEBUG\">TUN_DEBUG</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#debug\">debug</a> = <a class=\"id\" href=\"#value\">value</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"", 
"static <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tun_get_rx_csum\">tun_get_rx_csum</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_NOCHECKSUM\">TUN_NOCHECKSUM</a>) == 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tun_set_rx_csum\">tun_set_rx_csum</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#data\">data</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#TUN_NOCHECKSUM\">TUN_NOCHECKSUM</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_NOCHECKSUM\">TUN_NOCHECKSUM</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#ethtool_ops\">ethtool_ops</a> <a class=\"id\" href=\"#tun_ethtool_ops\">tun_ethtool_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_settings\">get_settings</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_get_settings\">tun_get_settings</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_drvinfo\">get_drvinfo</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_get_drvinfo\">tun_get_drvinfo</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_msglevel\">get_msglevel</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_get_msglevel\">tun_get_msglevel</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#set_msglevel\">set_msglevel</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_set_msglevel\">tun_set_msglevel</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_link\">get_link</a><span class=\"ts\"/>= <a class=\"id\" href=\"#ethtool_op_get_link\">ethtool_op_get_link</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_rx_csum\">get_rx_csum</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_get_rx_csum\">tun_get_rx_csum</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#set_rx_csum\">set_rx_csum</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tun_set_rx_csum\">tun_set_rx_csum</a>", 
"};", 
"", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#tun_init\">tun_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"tun: %s, %s\\n\", <a class=\"id\" href=\"#DRV_DESCRIPTION\">DRV_DESCRIPTION</a>, <a class=\"id\" href=\"#DRV_VERSION\">DRV_VERSION</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"tun: %s\\n\", <a class=\"id\" href=\"#DRV_COPYRIGHT\">DRV_COPYRIGHT</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#rtnl_link_register\">rtnl_link_register</a>(&amp;<a class=\"id\" href=\"#tun_link_ops\">tun_link_ops</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"tun: Can't register link_ops\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_linkops\">err_linkops</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#misc_register\">misc_register</a>(&amp;<a class=\"id\" href=\"#tun_miscdev\">tun_miscdev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"tun: Can't register misc device %d\\n\", <a class=\"id\" href=\"#TUN_MINOR\">TUN_MINOR</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_misc\">err_misc</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return  0;", 
"<a class=\"id\" href=\"#err_misc\">err_misc</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_link_unregister\">rtnl_link_unregister</a>(&amp;<a class=\"id\" href=\"#tun_link_ops\">tun_link_ops</a>);", 
"<a class=\"id\" href=\"#err_linkops\">err_linkops</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tun_cleanup\">tun_cleanup</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#misc_deregister\">misc_deregister</a>(&amp;<a class=\"id\" href=\"#tun_miscdev\">tun_miscdev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_link_unregister\">rtnl_link_unregister</a>(&amp;<a class=\"id\" href=\"#tun_link_ops\">tun_link_ops</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Get an underlying socket object from tun file.  Returns error unless file is</span>", 
"<span class=\"comment\"> * attached to a device.  The returned object works like a packet socket, it</span>", 
"<span class=\"comment\"> * can be used for sock_sendmsg/sock_recvmsg.  The caller is responsible for</span>", 
"<span class=\"comment\"> * holding a reference to the file for as long as the socket is in use. */</span>", 
"struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#tun_get_socket\">tun_get_socket</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#file\">file</a>-><a class=\"id\" href=\"#f_op\">f_op</a> != &amp;<a class=\"id\" href=\"#tun_fops\">tun_fops</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#EINVAL\">EINVAL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#tun_get\">tun_get</a>(<a class=\"id\" href=\"#file\">file</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tun\">tun</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#EBADFD\">EBADFD</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tun_put\">tun_put</a>(<a class=\"id\" href=\"#tun\">tun</a>);", 
"<span class=\"ts\"/>return &amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#tun_get_socket\">tun_get_socket</a>);", 
"", 
"<a class=\"id\" href=\"#module_init\">module_init</a>(<a class=\"id\" href=\"#tun_init\">tun_init</a>);", 
"<a class=\"id\" href=\"#module_exit\">module_exit</a>(<a class=\"id\" href=\"#tun_cleanup\">tun_cleanup</a>);", 
"<a class=\"id\" href=\"#MODULE_DESCRIPTION\">MODULE_DESCRIPTION</a>(<a class=\"id\" href=\"#DRV_DESCRIPTION\">DRV_DESCRIPTION</a>);", 
"<a class=\"id\" href=\"#MODULE_AUTHOR\">MODULE_AUTHOR</a>(<a class=\"id\" href=\"#DRV_COPYRIGHT\">DRV_COPYRIGHT</a>);", 
"<a class=\"id\" href=\"#MODULE_LICENSE\">MODULE_LICENSE</a>(\"GPL\");", 
"<a class=\"id\" href=\"#MODULE_ALIAS_MISCDEV\">MODULE_ALIAS_MISCDEV</a>(<a class=\"id\" href=\"#TUN_MINOR\">TUN_MINOR</a>);", 
"<a class=\"id\" href=\"#MODULE_ALIAS\">MODULE_ALIAS</a>(\"devname:net/tun\");", 
];
xr_frag_insert('l/12/2de81703fdb1b77391ab101f5d096d4d8baf41.xr', __xr_tmp);
