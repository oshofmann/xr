var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * PCI Express Hot Plug Controller Driver</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (C) 1995,2001 Compaq Computer Corporation</span>", 
"<span class=\"comment\"> * Copyright (C) 2001 Greg Kroah-Hartman (greg@kroah.com)</span>", 
"<span class=\"comment\"> * Copyright (C) 2001 IBM Corp.</span>", 
"<span class=\"comment\"> * Copyright (C) 2003-2004 Intel Corporation</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * All rights reserved.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of the GNU General Public License as published by</span>", 
"<span class=\"comment\"> * the Free Software Foundation; either version 2 of the License, or (at</span>", 
"<span class=\"comment\"> * your option) any later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is distributed in the hope that it will be useful, but</span>", 
"<span class=\"comment\"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>", 
"<span class=\"comment\"> * MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, GOOD TITLE or</span>", 
"<span class=\"comment\"> * NON INFRINGEMENT.  See the GNU General Public License for more</span>", 
"<span class=\"comment\"> * details.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * You should have received a copy of the GNU General Public License</span>", 
"<span class=\"comment\"> * along with this program; if not, write to the Free Software</span>", 
"<span class=\"comment\"> * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Send feedback to &lt;greg@kroah.com&gt;, &lt;kristen.c.accardi@intel.com&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci\">pci</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#workqueue\">workqueue</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"../pci.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"pciehp.h\"", 
"", 
"static void <a class=\"id\" href=\"#interrupt_event_handler\">interrupt_event_handler</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>);", 
"", 
"static int <a class=\"id\" href=\"#queue_interrupt_event\">queue_interrupt_event</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event_type\">event_type</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#event_info\">event_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#info\">info</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#event_type\">event_type</a> = <a class=\"id\" href=\"#event_type\">event_type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#p_slot\">p_slot</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_WORK\">INIT_WORK</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#work\">work</a>, <a class=\"id\" href=\"#interrupt_event_handler\">interrupt_event_handler</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#schedule_work\">schedule_work</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#work\">work</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#pciehp_handle_attention_button\">pciehp_handle_attention_button</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event_type\">event_type</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Attention Button Change */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Attention button interrupt received\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *  Button pressed - See if need to TAKE ACTION!!!</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Button pressed on Slot(%s)\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#event_type\">event_type</a> = <a class=\"id\" href=\"#INT_BUTTON_PRESS\">INT_BUTTON_PRESS</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_interrupt_event\">queue_interrupt_event</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, <a class=\"id\" href=\"#event_type\">event_type</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#pciehp_handle_switch_change\">pciehp_handle_switch_change</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#getstatus\">getstatus</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event_type\">event_type</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Switch Change */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Switch interrupt received\\n\");", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pciehp_get_latch_status\">pciehp_get_latch_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Switch opened</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Latch open on Slot(%s)\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#event_type\">event_type</a> = <a class=\"id\" href=\"#INT_SWITCH_OPEN\">INT_SWITCH_OPEN</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *  Switch closed</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Latch close on Slot(%s)\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#event_type\">event_type</a> = <a class=\"id\" href=\"#INT_SWITCH_CLOSE\">INT_SWITCH_CLOSE</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_interrupt_event\">queue_interrupt_event</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, <a class=\"id\" href=\"#event_type\">event_type</a>);", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#pciehp_handle_presence_change\">pciehp_handle_presence_change</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event_type\">event_type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#presence_save\">presence_save</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Presence Change */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Presence/Notify input change\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Switch is open, assume a presence change</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Save the presence state</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pciehp_get_adapter_status\">pciehp_get_adapter_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#presence_save\">presence_save</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#presence_save\">presence_save</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Card Present</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Card present on Slot(%s)\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#event_type\">event_type</a> = <a class=\"id\" href=\"#INT_PRESENCE_ON\">INT_PRESENCE_ON</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Not Present</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Card not present on Slot(%s)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#event_type\">event_type</a> = <a class=\"id\" href=\"#INT_PRESENCE_OFF\">INT_PRESENCE_OFF</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_interrupt_event\">queue_interrupt_event</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, <a class=\"id\" href=\"#event_type\">event_type</a>);", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#pciehp_handle_power_fault\">pciehp_handle_power_fault</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event_type\">event_type</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* power fault */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Power fault interrupt received\\n\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Power fault on slot %s\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#event_type\">event_type</a> = <a class=\"id\" href=\"#INT_POWER_FAULT\">INT_POWER_FAULT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Power fault bit %x set\\n\", 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_interrupt_event\">queue_interrupt_event</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, <a class=\"id\" href=\"#event_type\">event_type</a>);", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"<span class=\"comment\">/* The following routines constitute the bulk of the</span>", 
"<span class=\"comment\">   hotplug controller logic</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#set_slot_off\">set_slot_off</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>, struct <a class=\"id\" href=\"#slot\">slot</a> * <a class=\"id\" href=\"#pslot\">pslot</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* turn off slot, turn on Amber LED, turn off Green LED if supported*/</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pciehp_power_off_slot\">pciehp_power_off_slot</a>(<a class=\"id\" href=\"#pslot\">pslot</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"Issue of Slot Power Off command failed\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * After turning power off, we must wait for at least 1 second</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * before taking any action that relies on power having been</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * removed from the slot/adapter.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msleep\">msleep</a>(1000);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_off\">pciehp_green_led_off</a>(<a class=\"id\" href=\"#pslot\">pslot</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ATTN_LED\">ATTN_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pciehp_set_attention_status\">pciehp_set_attention_status</a>(<a class=\"id\" href=\"#pslot\">pslot</a>, 1)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"Issue of Set Attention Led command failed\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * board_added - Called after a board has been added to the system.</span>", 
"<span class=\"comment\"> * @p_slot: &amp;slot where board is added</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Turns power on for the board.</span>", 
"<span class=\"comment\"> * Configures board.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#board_added\">board_added</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_bus\">pci_bus</a> *<a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#subordinate\">subordinate</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Power on slot */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_power_on_slot\">pciehp_power_on_slot</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_blink\">pciehp_green_led_blink</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check link training status */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_check_link_status\">pciehp_check_link_status</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Failed to check link status\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_exit\">err_exit</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check for a power fault */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#power_fault_detected\">power_fault_detected</a> || <a class=\"id\" href=\"#pciehp_query_power_fault\">pciehp_query_power_fault</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Power fault on slot %s\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EIO\">EIO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_exit\">err_exit</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_configure_device\">pciehp_configure_device</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Cannot add device at %04x:%02x:00\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_domain_nr\">pci_domain_nr</a>(<a class=\"id\" href=\"#parent\">parent</a>), <a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#number\">number</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_exit\">err_exit</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_on\">pciehp_green_led_on</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#err_exit\">err_exit</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_slot_off\">set_slot_off</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * remove_board - Turns off slot and LEDs</span>", 
"<span class=\"comment\"> * @p_slot: slot where board is being removed</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#remove_board\">remove_board</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_unconfigure_device\">pciehp_unconfigure_device</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* power off slot */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_power_off_slot\">pciehp_power_off_slot</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"Issue of Slot Disable command failed\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * After turning power off, we must wait for at least 1 second</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * before taking any action that relies on power having been</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * removed from the slot/adapter.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msleep\">msleep</a>(1000);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* turn off Green LED */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_off\">pciehp_green_led_off</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"struct <a class=\"id\" href=\"#power_work_info\">power_work_info</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#work_struct\">work_struct</a> <a class=\"id\" href=\"#work\">work</a>;", 
"};", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pciehp_power_thread - handle pushbutton events</span>", 
"<span class=\"comment\"> * @work: &amp;struct work_struct describing work to be done</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Scheduled procedure to handle blocking stuff for the pushbuttons.</span>", 
"<span class=\"comment\"> * Handles all pending events and exits.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#pciehp_power_thread\">pciehp_power_thread</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#power_work_info\">power_work_info</a> *<a class=\"id\" href=\"#info\">info</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#work\">work</a>, struct <a class=\"id\" href=\"#power_work_info\">power_work_info</a>, <a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#p_slot\">p_slot</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWEROFF_STATE\">POWEROFF_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"Disabling domain:bus:device=%04x:%02x:00\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_domain_nr\">pci_domain_nr</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#subordinate\">subordinate</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#subordinate\">subordinate</a>-><a class=\"id\" href=\"#number\">number</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_disable_slot\">pciehp_disable_slot</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWERON_STATE\">POWERON_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pciehp_enable_slot\">pciehp_enable_slot</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>) && <a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_off\">pciehp_green_led_off</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#pciehp_queue_pushbutton_work\">pciehp_queue_pushbutton_work</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#work\">work</a>, struct <a class=\"id\" href=\"#slot\">slot</a>, <a class=\"id\" href=\"#work\">work</a>.<a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#power_work_info\">power_work_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#info\">info</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot allocate memory\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#p_slot\">p_slot</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_WORK\">INIT_WORK</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#work\">work</a>, <a class=\"id\" href=\"#pciehp_power_thread\">pciehp_power_thread</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGOFF_STATE\">BLINKINGOFF_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#POWEROFF_STATE\">POWEROFF_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGON_STATE\">BLINKINGON_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#POWERON_STATE\">POWERON_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_work\">queue_work</a>(<a class=\"id\" href=\"#pciehp_wq\">pciehp_wq</a>, &amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#work\">work</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Note: This function must be called with slot-&gt;lock held</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#handle_button_press_event\">handle_button_press_event</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#getstatus\">getstatus</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_get_power_status\">pciehp_get_power_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#BLINKINGOFF_STATE\">BLINKINGOFF_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"PCI slot #%s - powering off due to button \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"press.\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#BLINKINGON_STATE\">BLINKINGON_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"PCI slot #%s - powering on due to button \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"press.\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* blink green LED and turn off amber */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_blink\">pciehp_green_led_blink</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ATTN_LED\">ATTN_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_set_attention_status\">pciehp_set_attention_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, 0);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule_delayed_work\">schedule_delayed_work</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#work\">work</a>, 5*<a class=\"id\" href=\"#HZ\">HZ</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGOFF_STATE\">BLINKINGOFF_STATE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGON_STATE\">BLINKINGON_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Cancel if we are still blinking; this means that we</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * press the attention again before the 5 sec. limit</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * expires to cancel hot-add or hot-remove</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Button cancel on Slot(%s)\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cancel_delayed_work\">cancel_delayed_work</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#BLINKINGOFF_STATE\">BLINKINGOFF_STATE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_on\">pciehp_green_led_on</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_off\">pciehp_green_led_off</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ATTN_LED\">ATTN_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_set_attention_status\">pciehp_set_attention_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"PCI slot #%s - action canceled \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"due to button press\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWEROFF_STATE\">POWEROFF_STATE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWERON_STATE\">POWERON_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Ignore if the slot is on power-on or power-off state;</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * this means that the previous attention button action</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * to hot-add or hot-remove is undergoing</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Button ignore on Slot(%s)\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_warn\">ctrl_warn</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Not a valid state\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Note: This function must be called with slot-&gt;lock held</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#handle_surprise_event\">handle_surprise_event</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#getstatus\">getstatus</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#power_work_info\">power_work_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#info\">info</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot allocate memory\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#p_slot\">p_slot</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_WORK\">INIT_WORK</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#work\">work</a>, <a class=\"id\" href=\"#pciehp_power_thread\">pciehp_power_thread</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pciehp_get_adapter_status\">pciehp_get_adapter_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#getstatus\">getstatus</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#POWEROFF_STATE\">POWEROFF_STATE</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#POWERON_STATE\">POWERON_STATE</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_work\">queue_work</a>(<a class=\"id\" href=\"#pciehp_wq\">pciehp_wq</a>, &amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#work\">work</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#interrupt_event_handler\">interrupt_event_handler</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#event_info\">event_info</a> *<a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#work\">work</a>, struct <a class=\"id\" href=\"#event_info\">event_info</a>, <a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#p_slot\">p_slot</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#event_type\">event_type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#INT_BUTTON_PRESS\">INT_BUTTON_PRESS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#handle_button_press_event\">handle_button_press_event</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#INT_POWER_FAULT\">INT_POWER_FAULT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ATTN_LED\">ATTN_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_set_attention_status\">pciehp_set_attention_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_green_led_off\">pciehp_green_led_off</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#INT_PRESENCE_ON\">INT_PRESENCE_ON</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#INT_PRESENCE_OFF\">INT_PRESENCE_OFF</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#HP_SUPR_RM\">HP_SUPR_RM</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Surprise Removal\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#handle_surprise_event\">handle_surprise_event</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_enable_slot\">pciehp_enable_slot</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#getstatus\">getstatus</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#pciehp_get_adapter_status\">pciehp_get_adapter_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> || !<a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"No adapter on slot(%s)\\n\", <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#MRL_SENS\">MRL_SENS</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#pciehp_get_latch_status\">pciehp_get_latch_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> || <a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Latch open on slot(%s)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#pciehp_get_power_status\">pciehp_get_power_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> || <a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Already enabled on slot(%s)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pciehp_get_latch_status\">pciehp_get_latch_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#board_added\">board_added</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_get_latch_status\">pciehp_get_latch_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"", 
"int <a class=\"id\" href=\"#pciehp_disable_slot\">pciehp_disable_slot</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#getstatus\">getstatus</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#HP_SUPR_RM\">HP_SUPR_RM</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#pciehp_get_adapter_status\">pciehp_get_adapter_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> || !<a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"No adapter on slot(%s)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#MRL_SENS\">MRL_SENS</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#pciehp_get_latch_status\">pciehp_get_latch_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> || <a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Latch open on slot(%s)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#pciehp_get_power_status\">pciehp_get_power_status</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>, &amp;<a class=\"id\" href=\"#getstatus\">getstatus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> || !<a class=\"id\" href=\"#getstatus\">getstatus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Already disabled on slot(%s)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#remove_board\">remove_board</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_sysfs_enable_slot\">pciehp_sysfs_enable_slot</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGON_STATE\">BLINKINGON_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cancel_delayed_work\">cancel_delayed_work</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#POWERON_STATE\">POWERON_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_enable_slot\">pciehp_enable_slot</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWERON_STATE\">POWERON_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Slot %s is already in powering on state\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGOFF_STATE\">BLINKINGOFF_STATE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWEROFF_STATE\">POWEROFF_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Already enabled on slot %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Not a valid state on slot %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_sysfs_disable_slot\">pciehp_sysfs_disable_slot</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#p_slot\">p_slot</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGOFF_STATE\">BLINKINGOFF_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cancel_delayed_work\">cancel_delayed_work</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#POWEROFF_STATE\">POWEROFF_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_disable_slot\">pciehp_disable_slot</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATIC_STATE\">STATIC_STATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWEROFF_STATE\">POWEROFF_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Slot %s is already in powering off state\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BLINKINGON_STATE\">BLINKINGON_STATE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#POWERON_STATE\">POWERON_STATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Already disabled on slot %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Not a valid state on slot %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#slot_name\">slot_name</a>(<a class=\"id\" href=\"#p_slot\">p_slot</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#p_slot\">p_slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
];
xr_frag_insert('l/12/83685e596ee1954ddae4a844f2359dd726a9b5.xr', __xr_tmp);
