var __xr_tmp = [
"};", 
"", 
"static void <a class=\"id\" href=\"#otherend_changed\">otherend_changed</a>(struct <a class=\"id\" href=\"#xenbus_watch\">xenbus_watch</a> *<a class=\"id\" href=\"#watch\">watch</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const char **<a class=\"id\" href=\"#vec\">vec</a>, unsigned int <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xenbus_device\">xenbus_device</a> *<a class=\"id\" href=\"#dev\">dev</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#watch\">watch</a>, struct <a class=\"id\" href=\"#xenbus_device\">xenbus_device</a>, <a class=\"id\" href=\"#otherend_watch\">otherend_watch</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xenbus_driver\">xenbus_driver</a> *<a class=\"id\" href=\"#drv\">drv</a> = <a class=\"id\" href=\"#to_xenbus_driver\">to_xenbus_driver</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#driver\">driver</a>);", 
"<span class=\"ts\"/>enum <a class=\"id\" href=\"#xenbus_state\">xenbus_state</a> <a class=\"id\" href=\"#state\">state</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Protect us against watches firing on old details when the otherend</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   details change, say immediately after a resume. */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#otherend\">otherend</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#strncmp\">strncmp</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#otherend\">otherend</a>, <a class=\"id\" href=\"#vec\">vec</a>[<a class=\"id\" href=\"#XS_WATCH_PATH\">XS_WATCH_PATH</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#otherend\">otherend</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_dbg\">dev_dbg</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, \"Ignoring watch at %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vec\">vec</a>[<a class=\"id\" href=\"#XS_WATCH_PATH\">XS_WATCH_PATH</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#xenbus_read_driver_state\">xenbus_read_driver_state</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#otherend\">otherend</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_dbg\">dev_dbg</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, \"state is %d, (%s), %s, %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#state\">state</a>, <a class=\"id\" href=\"#xenbus_strstate\">xenbus_strstate</a>(<a class=\"id\" href=\"#state\">state</a>), <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#otherend_watch\">otherend_watch</a>.<a class=\"id\" href=\"#node\">node</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vec\">vec</a>[<a class=\"id\" href=\"#XS_WATCH_PATH\">XS_WATCH_PATH</a>]);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Ignore xenbus transitions during shutdown. This prevents us doing</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * work that can fail e.g., when the rootfs is gone.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#system_state\">system_state</a> &gt; <a class=\"id\" href=\"#SYSTEM_RUNNING\">SYSTEM_RUNNING</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xen_bus_type\">xen_bus_type</a> *<a class=\"id\" href=\"#bus\">bus</a> = <a class=\"id\" href=\"#bus\">bus</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus\">bus</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#bus\">bus</a>, struct <a class=\"id\" href=\"#xen_bus_type\">xen_bus_type</a>, <a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* If we're frontend, drive the state machine to Closed. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* This should cause the backend to release our resources. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#bus\">bus</a> == &amp;<a class=\"id\" href=\"#xenbus_frontend\">xenbus_frontend</a>) && (<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XenbusStateClosing\">XenbusStateClosing</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xenbus_frontend_closed\">xenbus_frontend_closed</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#otherend_changed\">otherend_changed</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#otherend_changed\">otherend_changed</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#state\">state</a>);", 
"}", 
"", 
"", 
"static int <a class=\"id\" href=\"#talk_to_otherend\">talk_to_otherend</a>(struct <a class=\"id\" href=\"#xenbus_device\">xenbus_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xenbus_driver\">xenbus_driver</a> *<a class=\"id\" href=\"#drv\">drv</a> = <a class=\"id\" href=\"#to_xenbus_driver\">to_xenbus_driver</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#driver\">driver</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_otherend_watch\">free_otherend_watch</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_otherend_details\">free_otherend_details</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#read_otherend_details\">read_otherend_details</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"}", 
"", 
"", 
"static int <a class=\"id\" href=\"#watch_otherend\">watch_otherend</a>(struct <a class=\"id\" href=\"#xenbus_device\">xenbus_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#xenbus_watch_pathfmt\">xenbus_watch_pathfmt</a>(<a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#otherend_watch\">otherend_watch</a>, <a class=\"id\" href=\"#otherend_changed\">otherend_changed</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    \"%s/%s\", <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#otherend\">otherend</a>, \"state\");", 
"}", 
"", 
"", 
"int <a class=\"id\" href=\"#xenbus_dev_probe\">xenbus_dev_probe</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#_dev\">_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xenbus_device\">xenbus_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#to_xenbus_device\">to_xenbus_device</a>(<a class=\"id\" href=\"#_dev\">_dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xenbus_driver\">xenbus_driver</a> *<a class=\"id\" href=\"#drv\">drv</a> = <a class=\"id\" href=\"#to_xenbus_driver\">to_xenbus_driver</a>(<a class=\"id\" href=\"#_dev\">_dev</a>-><a class=\"id\" href=\"#driver\">driver</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#xenbus_device_id\">xenbus_device_id</a> *<a class=\"id\" href=\"#id\">id</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DPRINTK\">DPRINTK</a>(\"%s\", <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#nodename\">nodename</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#probe\">probe</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#match_device\">match_device</a>(<a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#ids\">ids</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#id\">id</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#talk_to_otherend\">talk_to_otherend</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_warn\">dev_warn</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, \"talk_to_otherend on %s failed.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#nodename\">nodename</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#probe\">probe</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#watch_otherend\">watch_otherend</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_warn\">dev_warn</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, \"watch_otherend on %s failed.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#nodename\">nodename</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
];
xr_frag_insert('l/17/5e2b865b6679db8010d2ac80735b89a0322a9a.xr', __xr_tmp);
