var __xr_tmp = [
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#i8042_lock\">i8042_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#__i8042_command\">__i8042_command</a>(<a class=\"id\" href=\"#param\">param</a>, <a class=\"id\" href=\"#command\">command</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#i8042_lock\">i8042_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#i8042_command\">i8042_command</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * i8042_kbd_write() sends a byte out through the keyboard interface.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#i8042_kbd_write\">i8042_kbd_write</a>(struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#port\">port</a>, unsigned char <a class=\"id\" href=\"#c\">c</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#i8042_lock\">i8042_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#i8042_wait_write\">i8042_wait_write</a>())) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dbg\">dbg</a>(\"%02x -> i8042 (kbd-data)\", <a class=\"id\" href=\"#c\">c</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_write_data\">i8042_write_data</a>(<a class=\"id\" href=\"#c\">c</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#i8042_lock\">i8042_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * i8042_aux_write() sends a byte out through the aux interface.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#i8042_aux_write\">i8042_aux_write</a>(struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#serio\">serio</a>, unsigned char <a class=\"id\" href=\"#c\">c</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i8042_port\">i8042_port</a> *<a class=\"id\" href=\"#port\">port</a> = <a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#port_data\">port_data</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#i8042_command\">i8042_command</a>(&amp;<a class=\"id\" href=\"#c\">c</a>, <a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#mux\">mux</a> == -1 ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#I8042_CMD_AUX_SEND\">I8042_CMD_AUX_SEND</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#I8042_CMD_MUX_SEND\">I8042_CMD_MUX_SEND</a> + <a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#mux\">mux</a>);", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * i8042_aux_close attempts to clear AUX or KBD port state by disabling</span>", 
"<span class=\"comment\"> * and then re-enabling it.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#i8042_port_close\">i8042_port_close</a>(struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#serio\">serio</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#irq_bit\">irq_bit</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#disable_bit\">disable_bit</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#port_name\">port_name</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#serio\">serio</a> == <a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#I8042_AUX_PORT_NO\">I8042_AUX_PORT_NO</a>].<a class=\"id\" href=\"#serio\">serio</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#irq_bit\">irq_bit</a> = <a class=\"id\" href=\"#I8042_CTR_AUXINT\">I8042_CTR_AUXINT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#disable_bit\">disable_bit</a> = <a class=\"id\" href=\"#I8042_CTR_AUXDIS\">I8042_CTR_AUXDIS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#port_name\">port_name</a> = \"AUX\";", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#irq_bit\">irq_bit</a> = <a class=\"id\" href=\"#I8042_CTR_KBDINT\">I8042_CTR_KBDINT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#disable_bit\">disable_bit</a> = <a class=\"id\" href=\"#I8042_CTR_KBDDIS\">I8042_CTR_KBDDIS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#port_name\">port_name</a> = \"KBD\";", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a> &= ~<a class=\"id\" href=\"#irq_bit\">irq_bit</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_command\">i8042_command</a>(&amp;<a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a>, <a class=\"id\" href=\"#I8042_CMD_CTL_WCTR\">I8042_CMD_CTL_WCTR</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"i8042.c: Can't write CTR while closing %s port.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#port_name\">port_name</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#udelay\">udelay</a>(50);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a> &= ~<a class=\"id\" href=\"#disable_bit\">disable_bit</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a> |= <a class=\"id\" href=\"#irq_bit\">irq_bit</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_command\">i8042_command</a>(&amp;<a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a>, <a class=\"id\" href=\"#I8042_CMD_CTL_WCTR\">I8042_CMD_CTL_WCTR</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"i8042.c: Can't reactivate %s port.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#port_name\">port_name</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * See if there is any data appeared while we were messing with</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * port state.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_interrupt\">i8042_interrupt</a>(0, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * i8042_start() is called by serio core when port is about to finish</span>", 
"<span class=\"comment\"> * registering. It will mark port as existing so i8042_interrupt can</span>", 
"<span class=\"comment\"> * start sending data through it.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#i8042_start\">i8042_start</a>(struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#serio\">serio</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i8042_port\">i8042_port</a> *<a class=\"id\" href=\"#port\">port</a> = <a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#port_data\">port_data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#exists\">exists</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mb\">mb</a>();", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * i8042_stop() marks serio port as non-existing so i8042_interrupt</span>", 
"<span class=\"comment\"> * will not try to send data to the port that is about to go away.</span>", 
"<span class=\"comment\"> * The function is called by serio core as part of unregister procedure.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#i8042_stop\">i8042_stop</a>(struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#serio\">serio</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i8042_port\">i8042_port</a> *<a class=\"id\" href=\"#port\">port</a> = <a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#port_data\">port_data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#exists\">exists</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * We synchronize with both AUX and KBD IRQs because there is</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * a (very unlikely) chance that AUX IRQ is raised for KBD port</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * and vice versa.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#synchronize_irq\">synchronize_irq</a>(<a class=\"id\" href=\"#I8042_AUX_IRQ\">I8042_AUX_IRQ</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#synchronize_irq\">synchronize_irq</a>(<a class=\"id\" href=\"#I8042_KBD_IRQ\">I8042_KBD_IRQ</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
];
xr_frag_insert('l/1b/06487558025162752633acf5ae7f7e26a77389.xr', __xr_tmp);
