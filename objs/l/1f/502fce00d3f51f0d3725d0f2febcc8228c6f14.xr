var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#convert_from_fxsr\">convert_from_fxsr</a>(&amp;<a class=\"id\" href=\"#env\">env</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#user_regset_copyin\">user_regset_copyin</a>(&amp;<a class=\"id\" href=\"#pos\">pos</a>, &amp;<a class=\"id\" href=\"#count\">count</a>, &amp;<a class=\"id\" href=\"#kbuf\">kbuf</a>, &amp;<a class=\"id\" href=\"#ubuf\">ubuf</a>, &amp;<a class=\"id\" href=\"#env\">env</a>, 0, -1);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#convert_to_fxsr\">convert_to_fxsr</a>(<a class=\"id\" href=\"#target\">target</a>, &amp;<a class=\"id\" href=\"#env\">env</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * update the header bit in the xsave header, indicating the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * presence of FP.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cpu_has_xsave\">cpu_has_xsave</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#xsave\">xsave</a>.<a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>.<a class=\"id\" href=\"#xstate_bv\">xstate_bv</a> |= <a class=\"id\" href=\"#XSTATE_FP\">XSTATE_FP</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Signal frame handlers.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#save_i387_fsave\">save_i387_fsave</a>(struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i387_fsave_struct\">i387_fsave_struct</a> *<a class=\"id\" href=\"#fp\">fp</a> = &amp;<a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#fsave\">fsave</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#swd\">swd</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#__copy_to_user\">__copy_to_user</a>(<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#fp\">fp</a>, sizeof(struct <a class=\"id\" href=\"#i387_fsave_struct\">i387_fsave_struct</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#save_i387_fxsave\">save_i387_fxsave</a>(struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i387_fxsave_struct\">i387_fxsave_struct</a> *<a class=\"id\" href=\"#fx\">fx</a> = &amp;<a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#fxsave\">fxsave</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#user_i387_ia32_struct\">user_i387_ia32_struct</a> <a class=\"id\" href=\"#env\">env</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#convert_from_fxsr\">convert_from_fxsr</a>(&amp;<a class=\"id\" href=\"#env\">env</a>, <a class=\"id\" href=\"#tsk\">tsk</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#__copy_to_user\">__copy_to_user</a>(<a class=\"id\" href=\"#buf\">buf</a>, &amp;<a class=\"id\" href=\"#env\">env</a>, sizeof(<a class=\"id\" href=\"#env\">env</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> |= <a class=\"id\" href=\"#__put_user\">__put_user</a>(<a class=\"id\" href=\"#fx\">fx</a>-><a class=\"id\" href=\"#swd\">swd</a>, &amp;<a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#status\">status</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> |= <a class=\"id\" href=\"#__put_user\">__put_user</a>(<a class=\"id\" href=\"#X86_FXSR_MAGIC\">X86_FXSR_MAGIC</a>, &amp;<a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#magic\">magic</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#__copy_to_user\">__copy_to_user</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#_fxsr_env\">_fxsr_env</a>[0], <a class=\"id\" href=\"#fx\">fx</a>, <a class=\"id\" href=\"#xstate_size\">xstate_size</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#save_i387_xsave\">save_i387_xsave</a>(void <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#fx\">fx</a> = <a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sanitize_i387_state\">sanitize_i387_state</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * For legacy compatible, we always set FP/SSE bits in the bit</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * vector while saving the state to the user context.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * This will enable us capturing any changes(during sigreturn) to</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * the FP/SSE bits by the legacy applications which don't touch</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * xstate_bv in the xsave header.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * xsave aware applications can change the xstate_bv in the xsave</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * header as well as change any contents in the memory layout.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * xrestore as part of sigreturn will capture all the changes.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#xsave\">xsave</a>.<a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>.<a class=\"id\" href=\"#xstate_bv\">xstate_bv</a> |= <a class=\"id\" href=\"#XSTATE_FPSSE\">XSTATE_FPSSE</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#save_i387_fxsave\">save_i387_fxsave</a>(<a class=\"id\" href=\"#fx\">fx</a>) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__copy_to_user\">__copy_to_user</a>(&amp;<a class=\"id\" href=\"#fx\">fx</a>-><a class=\"id\" href=\"#sw_reserved\">sw_reserved</a>, &amp;<a class=\"id\" href=\"#fx_sw_reserved_ia32\">fx_sw_reserved_ia32</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     sizeof(struct <a class=\"id\" href=\"#_fpx_sw_bytes\">_fpx_sw_bytes</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> |= <a class=\"id\" href=\"#__put_user\">__put_user</a>(<a class=\"id\" href=\"#FP_XSTATE_MAGIC2\">FP_XSTATE_MAGIC2</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  (<a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#__user\">__user</a> *) (<a class=\"id\" href=\"#buf\">buf</a> + <a class=\"id\" href=\"#sig_xstate_ia32_size\">sig_xstate_ia32_size</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    - <a class=\"id\" href=\"#FP_XSTATE_MAGIC2_SIZE\">FP_XSTATE_MAGIC2_SIZE</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"int <a class=\"id\" href=\"#save_i387_xstate_ia32\">save_i387_xstate_ia32</a>(void <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#fp\">fp</a> = (struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *) <a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#used_math\">used_math</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#access_ok\">access_ok</a>(<a class=\"id\" href=\"#VERIFY_WRITE\">VERIFY_WRITE</a>, <a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#sig_xstate_ia32_size\">sig_xstate_ia32_size</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EACCES\">EACCES</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * This will cause a \"finit\" to be triggered by the next</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * attempted FPU operation by the 'current' process.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#clear_used_math\">clear_used_math</a>();", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#HAVE_HWFP\">HAVE_HWFP</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#fpregs_soft_get\">fpregs_soft_get</a>(<a class=\"id\" href=\"#current\">current</a>, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       0, sizeof(struct <a class=\"id\" href=\"#user_i387_ia32_struct\">user_i387_ia32_struct</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#fp\">fp</a>) ? -1 : 1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unlazy_fpu\">unlazy_fpu</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cpu_has_xsave\">cpu_has_xsave</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#save_i387_xsave\">save_i387_xsave</a>(<a class=\"id\" href=\"#fp\">fp</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cpu_has_fxsr\">cpu_has_fxsr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#save_i387_fxsave\">save_i387_fxsave</a>(<a class=\"id\" href=\"#fp\">fp</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#save_i387_fsave\">save_i387_fsave</a>(<a class=\"id\" href=\"#fp\">fp</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#restore_i387_fsave\">restore_i387_fsave</a>(struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__copy_from_user\">__copy_from_user</a>(&amp;<a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#fsave\">fsave</a>, <a class=\"id\" href=\"#buf\">buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(struct <a class=\"id\" href=\"#i387_fsave_struct\">i387_fsave_struct</a>));", 
"}", 
"", 
"static int <a class=\"id\" href=\"#restore_i387_fxsave\">restore_i387_fxsave</a>(struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       unsigned int <a class=\"id\" href=\"#size\">size</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#user_i387_ia32_struct\">user_i387_ia32_struct</a> <a class=\"id\" href=\"#env\">env</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__copy_from_user\">__copy_from_user</a>(&amp;<a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#fxsave\">fxsave</a>, &amp;<a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#_fxsr_env\">_fxsr_env</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#size\">size</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* mxcsr reserved bits must be masked to zero for security reasons */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#fxsave\">fxsave</a>.<a class=\"id\" href=\"#mxcsr\">mxcsr</a> &= <a class=\"id\" href=\"#mxcsr_feature_mask\">mxcsr_feature_mask</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> || <a class=\"id\" href=\"#__copy_from_user\">__copy_from_user</a>(&amp;<a class=\"id\" href=\"#env\">env</a>, <a class=\"id\" href=\"#buf\">buf</a>, sizeof(<a class=\"id\" href=\"#env\">env</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#convert_to_fxsr\">convert_to_fxsr</a>(<a class=\"id\" href=\"#tsk\">tsk</a>, &amp;<a class=\"id\" href=\"#env\">env</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#restore_i387_xsave\">restore_i387_xsave</a>(void <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#_fpx_sw_bytes\">_fpx_sw_bytes</a> <a class=\"id\" href=\"#fx_sw_user\">fx_sw_user</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#fx_user\">fx_user</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>((struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *) <a class=\"id\" href=\"#buf\">buf</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i387_fxsave_struct\">i387_fxsave_struct</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#fx\">fx</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/>(struct <a class=\"id\" href=\"#i387_fxsave_struct\">i387_fxsave_struct</a> <a class=\"id\" href=\"#__user\">__user</a> *) &amp;<a class=\"id\" href=\"#fx_user\">fx_user</a>-><a class=\"id\" href=\"#_fxsr_env\">_fxsr_env</a>[0];", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xsave_hdr_struct\">xsave_hdr_struct</a> *<a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#thread\">thread</a>.<a class=\"id\" href=\"#fpu\">fpu</a>.<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#xsave\">xsave</a>.<a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#check_for_xstate\">check_for_xstate</a>(<a class=\"id\" href=\"#fx\">fx</a>, <a class=\"id\" href=\"#buf\">buf</a>, &amp;<a class=\"id\" href=\"#fx_sw_user\">fx_sw_user</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fx_only\">fx_only</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#fx_sw_user\">fx_sw_user</a>.<a class=\"id\" href=\"#xstate_bv\">xstate_bv</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#restore_i387_fxsave\">restore_i387_fxsave</a>(<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#fx_sw_user\">fx_sw_user</a>.<a class=\"id\" href=\"#xstate_size\">xstate_size</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>-><a class=\"id\" href=\"#xstate_bv\">xstate_bv</a> &= <a class=\"id\" href=\"#pcntxt_mask\">pcntxt_mask</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * These bits must be zero.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>-><a class=\"id\" href=\"#reserved1\">reserved1</a>[0] = <a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>-><a class=\"id\" href=\"#reserved1\">reserved1</a>[1] = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Init the state that is not present in the memory layout</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * and enabled by the OS.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = ~(<a class=\"id\" href=\"#pcntxt_mask\">pcntxt_mask</a> &amp; ~<a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>-><a class=\"id\" href=\"#xstate_bv\">xstate_bv</a> &= <a class=\"id\" href=\"#mask\">mask</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<a class=\"id\" href=\"#fx_only\">fx_only</a>:", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Couldn't find the extended state information in the memory</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * layout. Restore the FP/SSE and init the other extended state</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * enabled by the OS.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xsave_hdr\">xsave_hdr</a>-><a class=\"id\" href=\"#xstate_bv\">xstate_bv</a> = <a class=\"id\" href=\"#XSTATE_FPSSE\">XSTATE_FPSSE</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#restore_i387_fxsave\">restore_i387_fxsave</a>(<a class=\"id\" href=\"#buf\">buf</a>, sizeof(struct <a class=\"id\" href=\"#i387_fxsave_struct\">i387_fxsave_struct</a>));", 
"}", 
"", 
"int <a class=\"id\" href=\"#restore_i387_xstate_ia32\">restore_i387_xstate_ia32</a>(void <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#fp\">fp</a> = (struct <a class=\"id\" href=\"#_fpstate_ia32\">_fpstate_ia32</a> <a class=\"id\" href=\"#__user\">__user</a> *) <a class=\"id\" href=\"#buf\">buf</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#HAVE_HWFP\">HAVE_HWFP</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_fpu\">clear_fpu</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#buf\">buf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#used_math\">used_math</a>()) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_fpu\">clear_fpu</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_used_math\">clear_used_math</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#access_ok\">access_ok</a>(<a class=\"id\" href=\"#VERIFY_READ\">VERIFY_READ</a>, <a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#sig_xstate_ia32_size\">sig_xstate_ia32_size</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EACCES\">EACCES</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#used_math\">used_math</a>()) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#init_fpu\">init_fpu</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#HAVE_HWFP\">HAVE_HWFP</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cpu_has_xsave\">cpu_has_xsave</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#restore_i387_xsave\">restore_i387_xsave</a>(<a class=\"id\" href=\"#buf\">buf</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#cpu_has_fxsr\">cpu_has_fxsr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#restore_i387_fxsave\">restore_i387_fxsave</a>(<a class=\"id\" href=\"#fp\">fp</a>, sizeof(struct", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#i387_fxsave_struct\">i387_fxsave_struct</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#restore_i387_fsave\">restore_i387_fsave</a>(<a class=\"id\" href=\"#fp\">fp</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fpregs_soft_set\">fpregs_soft_set</a>(<a class=\"id\" href=\"#current\">current</a>, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      0, sizeof(struct <a class=\"id\" href=\"#user_i387_ia32_struct\">user_i387_ia32_struct</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#fp\">fp</a>) != 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_used_math\">set_used_math</a>();", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * FPU state for core dumps.</span>", 
"<span class=\"comment\"> * This is only used for a.out dumps now.</span>", 
"<span class=\"comment\"> * It is declared generically using elf_fpregset_t (which is</span>", 
"<span class=\"comment\"> * struct user_i387_struct) but is in fact only used for 32-bit</span>", 
"<span class=\"comment\"> * dumps, so on 64-bit it is really struct user_i387_ia32_struct.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#dump_fpu\">dump_fpu</a>(struct <a class=\"id\" href=\"#pt_regs\">pt_regs</a> *<a class=\"id\" href=\"#regs\">regs</a>, struct <a class=\"id\" href=\"#user_i387_struct\">user_i387_struct</a> *<a class=\"id\" href=\"#fpu\">fpu</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#fpvalid\">fpvalid</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fpvalid\">fpvalid</a> = !!<a class=\"id\" href=\"#used_math\">used_math</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fpvalid\">fpvalid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fpvalid\">fpvalid</a> = !<a class=\"id\" href=\"#fpregs_get\">fpregs_get</a>(<a class=\"id\" href=\"#tsk\">tsk</a>, <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      0, sizeof(struct <a class=\"id\" href=\"#user_i387_ia32_struct\">user_i387_ia32_struct</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#fpu\">fpu</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#fpvalid\">fpvalid</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#dump_fpu\">dump_fpu</a>);", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a><span class=\"ts\"/><span class=\"comment\">/* CONFIG_X86_32 || CONFIG_IA32_EMULATION */</span>", 
];
xr_frag_insert('l/1f/502fce00d3f51f0d3725d0f2febcc8228c6f14.xr', __xr_tmp);
