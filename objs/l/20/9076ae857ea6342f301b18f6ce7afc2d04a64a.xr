var __xr_tmp = [
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_set_attention_status\">pciehp_set_attention_status</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#value\">value</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd_mask\">cmd_mask</a> = <a class=\"id\" href=\"#PCI_EXP_SLTCTL_AIC\">PCI_EXP_SLTCTL_AIC</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#value\">value</a>) {", 
"<span class=\"ts\"/>case 0 :<span class=\"ts\"/><span class=\"comment\">/* turn off */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = 0x00C0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 1:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* turn on */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = 0x0040;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 2:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* turn blink */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = 0x0080;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: SLOTCTRL %x write cmd %x\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>) + <a class=\"id\" href=\"#PCI_EXP_SLTCTL\">PCI_EXP_SLTCTL</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>, <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#pciehp_green_led_on\">pciehp_green_led_on</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = 0x0100;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd_mask\">cmd_mask</a> = <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PIC\">PCI_EXP_SLTCTL_PIC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>, <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: SLOTCTRL %x write cmd %x\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>) + <a class=\"id\" href=\"#PCI_EXP_SLTCTL\">PCI_EXP_SLTCTL</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#pciehp_green_led_off\">pciehp_green_led_off</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = 0x0300;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd_mask\">cmd_mask</a> = <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PIC\">PCI_EXP_SLTCTL_PIC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>, <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: SLOTCTRL %x write cmd %x\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>) + <a class=\"id\" href=\"#PCI_EXP_SLTCTL\">PCI_EXP_SLTCTL</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#pciehp_green_led_blink\">pciehp_green_led_blink</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = 0x0200;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd_mask\">cmd_mask</a> = <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PIC\">PCI_EXP_SLTCTL_PIC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>, <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: SLOTCTRL %x write cmd %x\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>) + <a class=\"id\" href=\"#PCI_EXP_SLTCTL\">PCI_EXP_SLTCTL</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_power_on_slot\">pciehp_power_on_slot</a>(struct <a class=\"id\" href=\"#slot\">slot</a> * <a class=\"id\" href=\"#slot\">slot</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#slot_status\">slot_status</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#lnk_status\">lnk_status</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Clear sticky power-fault bit from previous power failures */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_readw\">pciehp_readw</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTSTA\">PCI_EXP_SLTSTA</a>, &amp;<a class=\"id\" href=\"#slot_status\">slot_status</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot read SLOTSTATUS register\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot_status\">slot_status</a> &= <a class=\"id\" href=\"#PCI_EXP_SLTSTA_PFD\">PCI_EXP_SLTSTA_PFD</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#slot_status\">slot_status</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_writew\">pciehp_writew</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTSTA\">PCI_EXP_SLTSTA</a>, <a class=\"id\" href=\"#slot_status\">slot_status</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"%s: Cannot write to SLOTSTATUS register\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#power_fault_detected\">power_fault_detected</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = <a class=\"id\" href=\"#POWER_ON\">POWER_ON</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd_mask\">cmd_mask</a> = <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PCC\">PCI_EXP_SLTCTL_PCC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>, <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Write %x command failed!\\n\", <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: SLOTCTRL %x write cmd %x\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>) + <a class=\"id\" href=\"#PCI_EXP_SLTCTL\">PCI_EXP_SLTCTL</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_readw\">pciehp_readw</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_LNKSTA\">PCI_EXP_LNKSTA</a>, &amp;<a class=\"id\" href=\"#lnk_status\">lnk_status</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot read LNKSTA register\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pcie_update_link_speed\">pcie_update_link_speed</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#subordinate\">subordinate</a>, <a class=\"id\" href=\"#lnk_status\">lnk_status</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_power_off_slot\">pciehp_power_off_slot</a>(struct <a class=\"id\" href=\"#slot\">slot</a> * <a class=\"id\" href=\"#slot\">slot</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot_cmd\">slot_cmd</a> = <a class=\"id\" href=\"#POWER_OFF\">POWER_OFF</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd_mask\">cmd_mask</a> = <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PCC\">PCI_EXP_SLTCTL_PCC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>, <a class=\"id\" href=\"#cmd_mask\">cmd_mask</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Write command failed!\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: SLOTCTRL %x write cmd %x\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>) + <a class=\"id\" href=\"#PCI_EXP_SLTCTL\">PCI_EXP_SLTCTL</a>, <a class=\"id\" href=\"#slot_cmd\">slot_cmd</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#irqreturn_t\">irqreturn_t</a> <a class=\"id\" href=\"#pcie_isr\">pcie_isr</a>(int <a class=\"id\" href=\"#irq\">irq</a>, void *<a class=\"id\" href=\"#dev_id\">dev_id</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = (struct <a class=\"id\" href=\"#controller\">controller</a> *)<a class=\"id\" href=\"#dev_id\">dev_id</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a> = <a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#slot\">slot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#detected\">detected</a>, <a class=\"id\" href=\"#intr_loc\">intr_loc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * In order to guarantee that all interrupt events are</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * serviced, we need to re-inspect Slot Status register after</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * clearing what is presumed to be the last pending interrupt.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#intr_loc\">intr_loc</a> = 0;", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pciehp_readw\">pciehp_readw</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTSTA\">PCI_EXP_SLTSTA</a>, &amp;<a class=\"id\" href=\"#detected\">detected</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot read SLOTSTATUS\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#IRQ_NONE\">IRQ_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#detected\">detected</a> &= (<a class=\"id\" href=\"#PCI_EXP_SLTSTA_ABP\">PCI_EXP_SLTSTA_ABP</a> | <a class=\"id\" href=\"#PCI_EXP_SLTSTA_PFD\">PCI_EXP_SLTSTA_PFD</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#PCI_EXP_SLTSTA_MRLSC\">PCI_EXP_SLTSTA_MRLSC</a> | <a class=\"id\" href=\"#PCI_EXP_SLTSTA_PDC\">PCI_EXP_SLTSTA_PDC</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#PCI_EXP_SLTSTA_CC\">PCI_EXP_SLTSTA_CC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#detected\">detected</a> &= ~<a class=\"id\" href=\"#intr_loc\">intr_loc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#intr_loc\">intr_loc</a> |= <a class=\"id\" href=\"#detected\">detected</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#intr_loc\">intr_loc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#IRQ_NONE\">IRQ_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#detected\">detected</a> && <a class=\"id\" href=\"#pciehp_writew\">pciehp_writew</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTSTA\">PCI_EXP_SLTSTA</a>, <a class=\"id\" href=\"#intr_loc\">intr_loc</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot write to SLOTSTATUS\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#IRQ_NONE\">IRQ_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#detected\">detected</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: intr_loc %x\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>, <a class=\"id\" href=\"#intr_loc\">intr_loc</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check Command Complete Interrupt Pending */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#intr_loc\">intr_loc</a> &amp; <a class=\"id\" href=\"#PCI_EXP_SLTSTA_CC\">PCI_EXP_SLTSTA_CC</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#cmd_busy\">cmd_busy</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#smp_mb\">smp_mb</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#queue\">queue</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#intr_loc\">intr_loc</a> &amp; ~<a class=\"id\" href=\"#PCI_EXP_SLTSTA_CC\">PCI_EXP_SLTSTA_CC</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#IRQ_HANDLED\">IRQ_HANDLED</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check MRL Sensor Changed */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#intr_loc\">intr_loc</a> &amp; <a class=\"id\" href=\"#PCI_EXP_SLTSTA_MRLSC\">PCI_EXP_SLTSTA_MRLSC</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_handle_switch_change\">pciehp_handle_switch_change</a>(<a class=\"id\" href=\"#slot\">slot</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check Attention Button Pressed */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#intr_loc\">intr_loc</a> &amp; <a class=\"id\" href=\"#PCI_EXP_SLTSTA_ABP\">PCI_EXP_SLTSTA_ABP</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_handle_attention_button\">pciehp_handle_attention_button</a>(<a class=\"id\" href=\"#slot\">slot</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check Presence Detect Changed */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#intr_loc\">intr_loc</a> &amp; <a class=\"id\" href=\"#PCI_EXP_SLTSTA_PDC\">PCI_EXP_SLTSTA_PDC</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_handle_presence_change\">pciehp_handle_presence_change</a>(<a class=\"id\" href=\"#slot\">slot</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check Power Fault Detected */</span>", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#intr_loc\">intr_loc</a> &amp; <a class=\"id\" href=\"#PCI_EXP_SLTSTA_PFD\">PCI_EXP_SLTSTA_PFD</a>) && !<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#power_fault_detected\">power_fault_detected</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#power_fault_detected\">power_fault_detected</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_handle_power_fault\">pciehp_handle_power_fault</a>(<a class=\"id\" href=\"#slot\">slot</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#IRQ_HANDLED\">IRQ_HANDLED</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_get_max_lnk_width\">pciehp_get_max_lnk_width</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> enum <a class=\"id\" href=\"#pcie_link_width\">pcie_link_width</a> *<a class=\"id\" href=\"#value\">value</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/>enum <a class=\"id\" href=\"#pcie_link_width\">pcie_link_width</a> <a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a><span class=\"ts\"/><a class=\"id\" href=\"#lnk_cap\">lnk_cap</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_readl\">pciehp_readl</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_LNKCAP\">PCI_EXP_LNKCAP</a>, &amp;<a class=\"id\" href=\"#lnk_cap\">lnk_cap</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot read LNKCAP register\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>switch ((<a class=\"id\" href=\"#lnk_cap\">lnk_cap</a> &amp; <a class=\"id\" href=\"#PCI_EXP_LNKSTA_NLW\">PCI_EXP_LNKSTA_NLW</a>) >> 4){", 
"<span class=\"ts\"/>case 0:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_WIDTH_RESRV\">PCIE_LNK_WIDTH_RESRV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 1:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X1\">PCIE_LNK_X1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 2:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X2\">PCIE_LNK_X2</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 4:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X4\">PCIE_LNK_X4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 8:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X8\">PCIE_LNK_X8</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 12:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X12\">PCIE_LNK_X12</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 16:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X16\">PCIE_LNK_X16</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 32:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X32\">PCIE_LNK_X32</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_WIDTH_UNKNOWN\">PCIE_LNK_WIDTH_UNKNOWN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#value\">value</a> = <a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Max link width = %d\\n\", <a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#pciehp_get_cur_lnk_width\">pciehp_get_cur_lnk_width</a>(struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> enum <a class=\"id\" href=\"#pcie_link_width\">pcie_link_width</a> *<a class=\"id\" href=\"#value\">value</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/>enum <a class=\"id\" href=\"#pcie_link_width\">pcie_link_width</a> <a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_WIDTH_UNKNOWN\">PCIE_LNK_WIDTH_UNKNOWN</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#lnk_status\">lnk_status</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#pciehp_readw\">pciehp_readw</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_LNKSTA\">PCI_EXP_LNKSTA</a>, &amp;<a class=\"id\" href=\"#lnk_status\">lnk_status</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot read LNKSTATUS register\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>switch ((<a class=\"id\" href=\"#lnk_status\">lnk_status</a> &amp; <a class=\"id\" href=\"#PCI_EXP_LNKSTA_NLW\">PCI_EXP_LNKSTA_NLW</a>) >> 4){", 
"<span class=\"ts\"/>case 0:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_WIDTH_RESRV\">PCIE_LNK_WIDTH_RESRV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 1:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X1\">PCIE_LNK_X1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 2:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X2\">PCIE_LNK_X2</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 4:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X4\">PCIE_LNK_X4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 8:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X8\">PCIE_LNK_X8</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 12:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X12\">PCIE_LNK_X12</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 16:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X16\">PCIE_LNK_X16</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 32:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_X32\">PCIE_LNK_X32</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a> = <a class=\"id\" href=\"#PCIE_LNK_WIDTH_UNKNOWN\">PCIE_LNK_WIDTH_UNKNOWN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#value\">value</a> = <a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Current link width = %d\\n\", <a class=\"id\" href=\"#lnk_wdth\">lnk_wdth</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#pcie_enable_notification\">pcie_enable_notification</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#mask\">mask</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * TBD: Power fault detected software notification support.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Power fault detected software notification is not enabled</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * now, because it caused power fault detected interrupt storm</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * on some machines. On those machines, power fault detected</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * bit in the slot status register was set again immediately</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * when it is cleared in the interrupt service routine, and</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * next power fault detected interrupt was notified again.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PDCE\">PCI_EXP_SLTCTL_PDCE</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ATTN_BUTTN\">ATTN_BUTTN</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a> |= <a class=\"id\" href=\"#PCI_EXP_SLTCTL_ABPE\">PCI_EXP_SLTCTL_ABPE</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#MRL_SENS\">MRL_SENS</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a> |= <a class=\"id\" href=\"#PCI_EXP_SLTCTL_MRLSCE\">PCI_EXP_SLTCTL_MRLSCE</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pciehp_poll_mode\">pciehp_poll_mode</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a> |= <a class=\"id\" href=\"#PCI_EXP_SLTCTL_HPIE\">PCI_EXP_SLTCTL_HPIE</a> | <a class=\"id\" href=\"#PCI_EXP_SLTCTL_CCIE\">PCI_EXP_SLTCTL_CCIE</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = (<a class=\"id\" href=\"#PCI_EXP_SLTCTL_PDCE\">PCI_EXP_SLTCTL_PDCE</a> | <a class=\"id\" href=\"#PCI_EXP_SLTCTL_ABPE\">PCI_EXP_SLTCTL_ABPE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#PCI_EXP_SLTCTL_MRLSCE\">PCI_EXP_SLTCTL_MRLSCE</a> | <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PFDE\">PCI_EXP_SLTCTL_PFDE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#PCI_EXP_SLTCTL_HPIE\">PCI_EXP_SLTCTL_HPIE</a> | <a class=\"id\" href=\"#PCI_EXP_SLTCTL_CCIE\">PCI_EXP_SLTCTL_CCIE</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#mask\">mask</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Cannot enable software notification\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#pcie_disable_notification\">pcie_disable_notification</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = (<a class=\"id\" href=\"#PCI_EXP_SLTCTL_PDCE\">PCI_EXP_SLTCTL_PDCE</a> | <a class=\"id\" href=\"#PCI_EXP_SLTCTL_ABPE\">PCI_EXP_SLTCTL_ABPE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#PCI_EXP_SLTCTL_MRLSCE\">PCI_EXP_SLTCTL_MRLSCE</a> | <a class=\"id\" href=\"#PCI_EXP_SLTCTL_PFDE\">PCI_EXP_SLTCTL_PFDE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#PCI_EXP_SLTCTL_HPIE\">PCI_EXP_SLTCTL_HPIE</a> | <a class=\"id\" href=\"#PCI_EXP_SLTCTL_CCIE\">PCI_EXP_SLTCTL_CCIE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#PCI_EXP_SLTCTL_DLLSCE\">PCI_EXP_SLTCTL_DLLSCE</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pcie_write_cmd\">pcie_write_cmd</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, 0, <a class=\"id\" href=\"#mask\">mask</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_warn\">ctrl_warn</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Cannot disable software notification\\n\");", 
"}", 
"", 
"int <a class=\"id\" href=\"#pcie_init_notification\">pcie_init_notification</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pciehp_request_irq\">pciehp_request_irq</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pcie_enable_notification\">pcie_enable_notification</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_free_irq\">pciehp_free_irq</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#notification_enabled\">notification_enabled</a> = 1;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#pcie_shutdown_notification\">pcie_shutdown_notification</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#notification_enabled\">notification_enabled</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pcie_disable_notification\">pcie_disable_notification</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_free_irq\">pciehp_free_irq</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#notification_enabled\">notification_enabled</a> = 0;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static int <a class=\"id\" href=\"#pcie_init_slot\">pcie_init_slot</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot\">slot</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#slot\">slot</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#slot\">slot</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_init\">mutex_init</a>(&amp;<a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_DELAYED_WORK\">INIT_DELAYED_WORK</a>(&amp;<a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#work\">work</a>, <a class=\"id\" href=\"#pciehp_queue_pushbutton_work\">pciehp_queue_pushbutton_work</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#slot\">slot</a> = <a class=\"id\" href=\"#slot\">slot</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#pcie_cleanup_slot\">pcie_cleanup_slot</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#slot\">slot</a> *<a class=\"id\" href=\"#slot\">slot</a> = <a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#slot\">slot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cancel_delayed_work\">cancel_delayed_work</a>(&amp;<a class=\"id\" href=\"#slot\">slot</a>-><a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#flush_scheduled_work\">flush_scheduled_work</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#flush_workqueue\">flush_workqueue</a>(<a class=\"id\" href=\"#pciehp_wq\">pciehp_wq</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#slot\">slot</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#dbg_ctrl\">dbg_ctrl</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#reg16\">reg16</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#pdev\">pdev</a> = <a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a>-><a class=\"id\" href=\"#port\">port</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pciehp_debug\">pciehp_debug</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Hotplug Controller:\\n\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Seg/Bus/Dev/Func/IRQ : %s IRQ %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#pci_name\">pci_name</a>(<a class=\"id\" href=\"#pdev\">pdev</a>), <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#irq\">irq</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Vendor ID            : 0x%04x\\n\", <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#vendor\">vendor</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Device ID            : 0x%04x\\n\", <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#device\">device</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Subsystem ID         : 0x%04x\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#subsystem_device\">subsystem_device</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Subsystem Vendor ID  : 0x%04x\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#subsystem_vendor\">subsystem_vendor</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  PCIe Cap offset      : 0x%02x\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#pdev\">pdev</a>));", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#DEVICE_COUNT_RESOURCE\">DEVICE_COUNT_RESOURCE</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#pci_resource_len\">pci_resource_len</a>(<a class=\"id\" href=\"#pdev\">pdev</a>, <a class=\"id\" href=\"#i\">i</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  PCI resource [%d]     : %pR\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#i\">i</a>, &amp;<a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#resource\">resource</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Slot Capabilities      : 0x%08x\\n\", <a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#slot_cap\">slot_cap</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Physical Slot Number : %d\\n\", <a class=\"id\" href=\"#PSN\">PSN</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Attention Button     : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#ATTN_BUTTN\">ATTN_BUTTN</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) ? \"yes\" : \"no\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Power Controller     : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) ? \"yes\" : \"no\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  MRL Sensor           : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#MRL_SENS\">MRL_SENS</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)   ? \"yes\" : \"no\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Attention Indicator  : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#ATTN_LED\">ATTN_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)   ? \"yes\" : \"no\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Power Indicator      : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)    ? \"yes\" : \"no\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Hot-Plug Surprise    : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#HP_SUPR_RM\">HP_SUPR_RM</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) ? \"yes\" : \"no\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  EMI Present          : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#EMI\">EMI</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)        ? \"yes\" : \"no\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"  Command Completed    : %3s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NO_CMD_CMPL\">NO_CMD_CMPL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) ? \"no\" : \"yes\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pciehp_readw\">pciehp_readw</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTSTA\">PCI_EXP_SLTSTA</a>, &amp;<a class=\"id\" href=\"#reg16\">reg16</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Slot Status            : 0x%04x\\n\", <a class=\"id\" href=\"#reg16\">reg16</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pciehp_readw\">pciehp_readw</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTCTL\">PCI_EXP_SLTCTL</a>, &amp;<a class=\"id\" href=\"#reg16\">reg16</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Slot Control           : 0x%04x\\n\", <a class=\"id\" href=\"#reg16\">reg16</a>);", 
"}", 
"", 
"struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#pcie_init\">pcie_init</a>(struct <a class=\"id\" href=\"#pcie_device\">pcie_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#slot_cap\">slot_cap</a>, <a class=\"id\" href=\"#link_cap\">link_cap</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#pdev\">pdev</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#port\">port</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#ctrl\">ctrl</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ctrl\">ctrl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_err\">dev_err</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#device\">device</a>, \"%s: Out of memory\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#abort\">abort</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#pcie\">pcie</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pci_pcie_cap\">pci_pcie_cap</a>(<a class=\"id\" href=\"#pdev\">pdev</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Cannot find PCI Express capability\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#abort_ctrl\">abort_ctrl</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pciehp_readl\">pciehp_readl</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTCAP\">PCI_EXP_SLTCAP</a>, &amp;<a class=\"id\" href=\"#slot_cap\">slot_cap</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Cannot read SLOTCAP register\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#abort_ctrl\">abort_ctrl</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#slot_cap\">slot_cap</a> = <a class=\"id\" href=\"#slot_cap\">slot_cap</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_init\">mutex_init</a>(&amp;<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#ctrl_lock\">ctrl_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#init_waitqueue_head\">init_waitqueue_head</a>(&amp;<a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#queue\">queue</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dbg_ctrl\">dbg_ctrl</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Controller doesn't notify of command completion if the \"No</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Command Completed Support\" bit is set in Slot Capability</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * register or the controller supports none of power</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * controller, attention led, power led and EMI.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#NO_CMD_CMPL\">NO_CMD_CMPL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) ||", 
"<span class=\"ts\"/>    !(<a class=\"id\" href=\"#POWER_CTRL\">POWER_CTRL</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) | <a class=\"id\" href=\"#ATTN_LED\">ATTN_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) | <a class=\"id\" href=\"#PWR_LED\">PWR_LED</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>) | <a class=\"id\" href=\"#EMI\">EMI</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>)))", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#no_cmd_complete\">no_cmd_complete</a> = 1;", 
"", 
"        <span class=\"comment\">/* Check if Data Link Layer Link Active Reporting is implemented */</span>", 
"        if (<a class=\"id\" href=\"#pciehp_readl\">pciehp_readl</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_LNKCAP\">PCI_EXP_LNKCAP</a>, &amp;<a class=\"id\" href=\"#link_cap\">link_cap</a>)) {", 
"                <a class=\"id\" href=\"#ctrl_err\">ctrl_err</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"%s: Cannot read LNKCAP register\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"                goto <a class=\"id\" href=\"#abort_ctrl\">abort_ctrl</a>;", 
"        }", 
"        if (<a class=\"id\" href=\"#link_cap\">link_cap</a> &amp; <a class=\"id\" href=\"#PCI_EXP_LNKCAP_DLLLARC\">PCI_EXP_LNKCAP_DLLLARC</a>) {", 
"                <a class=\"id\" href=\"#ctrl_dbg\">ctrl_dbg</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"Link Active Reporting supported\\n\");", 
"                <a class=\"id\" href=\"#ctrl\">ctrl</a>-><a class=\"id\" href=\"#link_active_reporting\">link_active_reporting</a> = 1;", 
"        }", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Clear all remaining event bits in Slot Status register */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pciehp_writew\">pciehp_writew</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, <a class=\"id\" href=\"#PCI_EXP_SLTSTA\">PCI_EXP_SLTSTA</a>, 0x1f))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#abort_ctrl\">abort_ctrl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Disable sotfware notification */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pcie_disable_notification\">pcie_disable_notification</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * If this is the first controller to be initialized,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * initialize the pciehp work queue</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_add_return\">atomic_add_return</a>(1, &amp;<a class=\"id\" href=\"#pciehp_num_controllers\">pciehp_num_controllers</a>) == 1) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pciehp_wq\">pciehp_wq</a> = <a class=\"id\" href=\"#create_singlethread_workqueue\">create_singlethread_workqueue</a>(\"pciehpd\");", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#pciehp_wq\">pciehp_wq</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#abort_ctrl\">abort_ctrl</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctrl_info\">ctrl_info</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>, \"HPC vendor_id %x device_id %x ss_vid %x ss_did %x\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#vendor\">vendor</a>, <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#device\">device</a>, <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#subsystem_vendor\">subsystem_vendor</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#subsystem_device\">subsystem_device</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pcie_init_slot\">pcie_init_slot</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#abort_ctrl\">abort_ctrl</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ctrl\">ctrl</a>;", 
"", 
"<a class=\"id\" href=\"#abort_ctrl\">abort_ctrl</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<a class=\"id\" href=\"#abort\">abort</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#pciehp_release_ctrl\">pciehp_release_ctrl</a>(struct <a class=\"id\" href=\"#controller\">controller</a> *<a class=\"id\" href=\"#ctrl\">ctrl</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pcie_shutdown_notification\">pcie_shutdown_notification</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pcie_cleanup_slot\">pcie_cleanup_slot</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * If this is the last controller to be released, destroy the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * pciehp work queue</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_dec_and_test\">atomic_dec_and_test</a>(&amp;<a class=\"id\" href=\"#pciehp_num_controllers\">pciehp_num_controllers</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#destroy_workqueue\">destroy_workqueue</a>(<a class=\"id\" href=\"#pciehp_wq\">pciehp_wq</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#ctrl\">ctrl</a>);", 
"}", 
];
xr_frag_insert('l/20/9076ae857ea6342f301b18f6ce7afc2d04a64a.xr', __xr_tmp);
