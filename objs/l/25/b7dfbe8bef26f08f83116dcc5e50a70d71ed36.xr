var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * inet_diag.c<span class=\"ts\"/>Module for monitoring INET transport protocols sockets.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Authors:<span class=\"ts\"/>Alexey Kuznetsov, &lt;kuznet@ms2.inr.ac.ru&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>This program is free software; you can redistribute it and/or</span>", 
"<span class=\"comment\"> *      modify it under the terms of the GNU General Public License</span>", 
"<span class=\"comment\"> *      as published by the Free Software Foundation; either version</span>", 
"<span class=\"comment\"> *      2 of the License, or (at your option) any later version.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#fcntl\">fcntl</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#random\">random</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#cache\">cache</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#time\">time</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#icmp\">icmp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#tcp\">tcp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#inet_common\">inet_common</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#inet_connection_sock\">inet_connection_sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#inet_hashtables\">inet_hashtables</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#inet_timewait_sock\">inet_timewait_sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#inet6_hashtables\">inet6_hashtables</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#netlink\">netlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inet\">inet</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#stddef\">stddef</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inet_diag\">inet_diag</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"static const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> **<a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>;", 
"", 
"struct <a class=\"id\" href=\"#inet_diag_entry\">inet_diag_entry</a> {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#sport\">sport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#dport\">dport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#userlocks\">userlocks</a>;", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#idiagnl\">idiagnl</a>;", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#INET_DIAG_PUT\">INET_DIAG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#attrtype\">attrtype</a>, <a class=\"id\" href=\"#attrlen\">attrlen</a>) \\", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RTA_DATA\">RTA_DATA</a>(<a class=\"id\" href=\"#__RTA_PUT\">__RTA_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#attrtype\">attrtype</a>, <a class=\"id\" href=\"#attrlen\">attrlen</a>))", 
"", 
"static <a class=\"id\" href=\"#DEFINE_MUTEX\">DEFINE_MUTEX</a>(<a class=\"id\" href=\"#inet_diag_table_mutex\">inet_diag_table_mutex</a>);", 
"", 
"static const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *<a class=\"id\" href=\"#inet_diag_lock_handler\">inet_diag_lock_handler</a>(int <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>[<a class=\"id\" href=\"#type\">type</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#request_module\">request_module</a>(\"net-pf-%d-proto-%d-type-%d\", <a class=\"id\" href=\"#PF_NETLINK\">PF_NETLINK</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#NETLINK_INET_DIAG\">NETLINK_INET_DIAG</a>, <a class=\"id\" href=\"#type\">type</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#inet_diag_table_mutex\">inet_diag_table_mutex</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>[<a class=\"id\" href=\"#type\">type</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#ENOENT\">ENOENT</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>[<a class=\"id\" href=\"#type\">type</a>];", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#inet_diag_unlock_handler\">inet_diag_unlock_handler</a>(", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *<a class=\"id\" href=\"#handler\">handler</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#inet_diag_table_mutex\">inet_diag_table_mutex</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_csk_diag_fill\">inet_csk_diag_fill</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      int <a class=\"id\" href=\"#ext\">ext</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#unlh\">unlh</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_connection_sock\">inet_connection_sock</a> *<a class=\"id\" href=\"#icsk\">icsk</a> = <a class=\"id\" href=\"#inet_csk\">inet_csk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_msg\">inet_diag_msg</a> *<a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a>  *<a class=\"id\" href=\"#nlh\">nlh</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_meminfo\">inet_diag_meminfo</a>  *<a class=\"id\" href=\"#minfo\">minfo</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>unsigned char<span class=\"ts\"/> *<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *<a class=\"id\" href=\"#handler\">handler</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#handler\">handler</a> = <a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>[<a class=\"id\" href=\"#unlh\">unlh</a>-><a class=\"id\" href=\"#nlmsg_type\">nlmsg_type</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#handler\">handler</a> == <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#NLMSG_PUT\">NLMSG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#unlh\">unlh</a>-><a class=\"id\" href=\"#nlmsg_type\">nlmsg_type</a>, sizeof(*<a class=\"id\" href=\"#r\">r</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a> = <a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_state\">sk_state</a> == <a class=\"id\" href=\"#TCP_TIME_WAIT\">TCP_TIME_WAIT</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ext\">ext</a> &amp; (1 << (<a class=\"id\" href=\"#INET_DIAG_MEMINFO\">INET_DIAG_MEMINFO</a> - 1)))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#minfo\">minfo</a> = <a class=\"id\" href=\"#INET_DIAG_PUT\">INET_DIAG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#INET_DIAG_MEMINFO\">INET_DIAG_MEMINFO</a>, sizeof(*<a class=\"id\" href=\"#minfo\">minfo</a>));", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ext\">ext</a> &amp; (1 << (<a class=\"id\" href=\"#INET_DIAG_INFO\">INET_DIAG_INFO</a> - 1)))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#INET_DIAG_PUT\">INET_DIAG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#INET_DIAG_INFO\">INET_DIAG_INFO</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#handler\">handler</a>-><a class=\"id\" href=\"#idiag_info_size\">idiag_info_size</a>);", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#ext\">ext</a> &amp; (1 << (<a class=\"id\" href=\"#INET_DIAG_CONG\">INET_DIAG_CONG</a> - 1))) && <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_ca_ops\">icsk_ca_ops</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_ca_ops\">icsk_ca_ops</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#INET_DIAG_PUT\">INET_DIAG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#INET_DIAG_CONG\">INET_DIAG_CONG</a>, <a class=\"id\" href=\"#len\">len</a> + 1),", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_ca_ops\">icsk_ca_ops</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_family\">idiag_family</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_family\">sk_family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_state\">idiag_state</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_state\">sk_state</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_timer\">idiag_timer</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_retrans\">idiag_retrans</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_if\">idiag_if</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_bound_dev_if\">sk_bound_dev_if</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[0] = (<a class=\"id\" href=\"#u32\">u32</a>)(unsigned long)<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[1] = (<a class=\"id\" href=\"#u32\">u32</a>)(((unsigned long)<a class=\"id\" href=\"#sk\">sk</a> >> 31) >> 1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a> = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_sport\">inet_sport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a> = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_dport\">inet_dport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>[0] = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_rcv_saddr\">inet_rcv_saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>[0] = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_daddr\">inet_daddr</a>;", 
"", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_family\">idiag_family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ipv6_pinfo\">ipv6_pinfo</a> *<a class=\"id\" href=\"#np\">np</a> = <a class=\"id\" href=\"#inet6_sk\">inet6_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#np\">np</a>-><a class=\"id\" href=\"#rcv_saddr\">rcv_saddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#np\">np</a>-><a class=\"id\" href=\"#daddr\">daddr</a>);", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#EXPIRES_IN_MS\">EXPIRES_IN_MS</a>(<a class=\"id\" href=\"#tmo\">tmo</a>)  <a class=\"id\" href=\"#DIV_ROUND_UP\">DIV_ROUND_UP</a>((<a class=\"id\" href=\"#tmo\">tmo</a> - <a class=\"id\" href=\"#jiffies\">jiffies</a>) * 1000, <a class=\"id\" href=\"#HZ\">HZ</a>)", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_pending\">icsk_pending</a> == <a class=\"id\" href=\"#ICSK_TIME_RETRANS\">ICSK_TIME_RETRANS</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_timer\">idiag_timer</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_retrans\">idiag_retrans</a> = <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_retransmits\">icsk_retransmits</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_expires\">idiag_expires</a> = <a class=\"id\" href=\"#EXPIRES_IN_MS\">EXPIRES_IN_MS</a>(<a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_timeout\">icsk_timeout</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_pending\">icsk_pending</a> == <a class=\"id\" href=\"#ICSK_TIME_PROBE0\">ICSK_TIME_PROBE0</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_timer\">idiag_timer</a> = 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_retrans\">idiag_retrans</a> = <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_probes_out\">icsk_probes_out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_expires\">idiag_expires</a> = <a class=\"id\" href=\"#EXPIRES_IN_MS\">EXPIRES_IN_MS</a>(<a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_timeout\">icsk_timeout</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#timer_pending\">timer_pending</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_timer\">sk_timer</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_timer\">idiag_timer</a> = 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_retrans\">idiag_retrans</a> = <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_probes_out\">icsk_probes_out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_expires\">idiag_expires</a> = <a class=\"id\" href=\"#EXPIRES_IN_MS\">EXPIRES_IN_MS</a>(<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_timer\">sk_timer</a>.<a class=\"id\" href=\"#expires\">expires</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_timer\">idiag_timer</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_expires\">idiag_expires</a> = 0;", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#EXPIRES_IN_MS\">EXPIRES_IN_MS</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_uid\">idiag_uid</a> = <a class=\"id\" href=\"#sock_i_uid\">sock_i_uid</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_inode\">idiag_inode</a> = <a class=\"id\" href=\"#sock_i_ino\">sock_i_ino</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#minfo\">minfo</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#minfo\">minfo</a>-><a class=\"id\" href=\"#idiag_rmem\">idiag_rmem</a> = <a class=\"id\" href=\"#sk_rmem_alloc_get\">sk_rmem_alloc_get</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#minfo\">minfo</a>-><a class=\"id\" href=\"#idiag_wmem\">idiag_wmem</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_wmem_queued\">sk_wmem_queued</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#minfo\">minfo</a>-><a class=\"id\" href=\"#idiag_fmem\">idiag_fmem</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_forward_alloc\">sk_forward_alloc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#minfo\">minfo</a>-><a class=\"id\" href=\"#idiag_tmem\">idiag_tmem</a> = <a class=\"id\" href=\"#sk_wmem_alloc_get\">sk_wmem_alloc_get</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#handler\">handler</a>-><a class=\"id\" href=\"#idiag_get_info\">idiag_get_info</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#info\">info</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_state\">sk_state</a> &lt; <a class=\"id\" href=\"#TCP_TIME_WAIT\">TCP_TIME_WAIT</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_ca_ops\">icsk_ca_ops</a> && <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_ca_ops\">icsk_ca_ops</a>-><a class=\"id\" href=\"#get_info\">get_info</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_ca_ops\">icsk_ca_ops</a>-><a class=\"id\" href=\"#get_info\">get_info</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#ext\">ext</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> = <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>) - <a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<a class=\"id\" href=\"#rtattr_failure\">rtattr_failure</a>:", 
"<a class=\"id\" href=\"#nlmsg_failure\">nlmsg_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlmsg_trim\">nlmsg_trim</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#b\">b</a>);", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_twsk_diag_fill\">inet_twsk_diag_fill</a>(struct <a class=\"id\" href=\"#inet_timewait_sock\">inet_timewait_sock</a> *<a class=\"id\" href=\"#tw\">tw</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, int <a class=\"id\" href=\"#ext\">ext</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#unlh\">unlh</a>)", 
"{", 
"<span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_msg\">inet_diag_msg</a> *<a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>const unsigned char *<a class=\"id\" href=\"#previous_tail\">previous_tail</a> = <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#NLMSG_PUT\">NLMSG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#unlh\">unlh</a>-><a class=\"id\" href=\"#nlmsg_type\">nlmsg_type</a>, sizeof(*<a class=\"id\" href=\"#r\">r</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_state\">tw_state</a> != <a class=\"id\" href=\"#TCP_TIME_WAIT\">TCP_TIME_WAIT</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a> = <a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_ttd\">tw_ttd</a> - <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmo\">tmo</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_family\">idiag_family</a><span class=\"ts\"/>      = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_family\">tw_family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_retrans\">idiag_retrans</a>      = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_if\">idiag_if</a><span class=\"ts\"/>      = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_bound_dev_if\">tw_bound_dev_if</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[0] = (<a class=\"id\" href=\"#u32\">u32</a>)(unsigned long)<a class=\"id\" href=\"#tw\">tw</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[1] = (<a class=\"id\" href=\"#u32\">u32</a>)(((unsigned long)<a class=\"id\" href=\"#tw\">tw</a> >> 31) >> 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a>     = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_sport\">tw_sport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a>     = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_dport\">tw_dport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>[0]    = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_rcv_saddr\">tw_rcv_saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>[0]    = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_daddr\">tw_daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_state\">idiag_state</a><span class=\"ts\"/>      = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_substate\">tw_substate</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_timer\">idiag_timer</a><span class=\"ts\"/>      = 3;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_expires\">idiag_expires</a>      = <a class=\"id\" href=\"#DIV_ROUND_UP\">DIV_ROUND_UP</a>(<a class=\"id\" href=\"#tmo\">tmo</a> * 1000, <a class=\"id\" href=\"#HZ\">HZ</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_rqueue\">idiag_rqueue</a><span class=\"ts\"/>      = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_wqueue\">idiag_wqueue</a><span class=\"ts\"/>      = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_uid\">idiag_uid</a><span class=\"ts\"/>      = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_inode\">idiag_inode</a><span class=\"ts\"/>      = 0;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_family\">tw_family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet6_timewait_sock\">inet6_timewait_sock</a> *<a class=\"id\" href=\"#tw6\">tw6</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet6_twsk\">inet6_twsk</a>((struct <a class=\"id\" href=\"#sock\">sock</a> *)<a class=\"id\" href=\"#tw\">tw</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#tw6\">tw6</a>-><a class=\"id\" href=\"#tw_v6_rcv_saddr\">tw_v6_rcv_saddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#tw6\">tw6</a>-><a class=\"id\" href=\"#tw_v6_daddr\">tw_v6_daddr</a>);", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> = <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>) - <a class=\"id\" href=\"#previous_tail\">previous_tail</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<a class=\"id\" href=\"#nlmsg_failure\">nlmsg_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlmsg_trim\">nlmsg_trim</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#previous_tail\">previous_tail</a>);", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#sk_diag_fill\">sk_diag_fill</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#ext\">ext</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#unlh\">unlh</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_state\">sk_state</a> == <a class=\"id\" href=\"#TCP_TIME_WAIT\">TCP_TIME_WAIT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#inet_twsk_diag_fill\">inet_twsk_diag_fill</a>((struct <a class=\"id\" href=\"#inet_timewait_sock\">inet_timewait_sock</a> *)<a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ext\">ext</a>, <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#unlh\">unlh</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#inet_csk_diag_fill\">inet_csk_diag_fill</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ext\">ext</a>, <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>, <a class=\"id\" href=\"#unlh\">unlh</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_diag_get_exact\">inet_diag_get_exact</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#in_skb\">in_skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_req\">inet_diag_req</a> *<a class=\"id\" href=\"#req\">req</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#rep\">rep</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_hashinfo\">inet_hashinfo</a> *<a class=\"id\" href=\"#hashinfo\">hashinfo</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *<a class=\"id\" href=\"#handler\">handler</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#handler\">handler</a> = <a class=\"id\" href=\"#inet_diag_lock_handler\">inet_diag_lock_handler</a>(<a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_type\">nlmsg_type</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#handler\">handler</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#handler\">handler</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hashinfo\">hashinfo</a> = <a class=\"id\" href=\"#handler\">handler</a>-><a class=\"id\" href=\"#idiag_hashinfo\">idiag_hashinfo</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#idiag_family\">idiag_family</a> == <a class=\"id\" href=\"#AF_INET\">AF_INET</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#inet_lookup\">inet_lookup</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, <a class=\"id\" href=\"#hashinfo\">hashinfo</a>, <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a>, <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a>, <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_if\">idiag_if</a>);", 
"<span class=\"ts\"/>}", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#idiag_family\">idiag_family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#inet6_lookup\">inet6_lookup</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, <a class=\"id\" href=\"#hashinfo\">hashinfo</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_if\">idiag_if</a>);", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESTALE\">ESTALE</a>;", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[0] != <a class=\"id\" href=\"#INET_DIAG_NOCOOKIE\">INET_DIAG_NOCOOKIE</a> ||", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[1] != <a class=\"id\" href=\"#INET_DIAG_NOCOOKIE\">INET_DIAG_NOCOOKIE</a>) &&", 
"<span class=\"ts\"/>    ((<a class=\"id\" href=\"#u32\">u32</a>)(unsigned long)<a class=\"id\" href=\"#sk\">sk</a> != <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[0] ||", 
"<span class=\"ts\"/>     (<a class=\"id\" href=\"#u32\">u32</a>)((((unsigned long)<a class=\"id\" href=\"#sk\">sk</a>) >> 31) >> 1) != <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[1]))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rep\">rep</a> = <a class=\"id\" href=\"#alloc_skb\">alloc_skb</a>(<a class=\"id\" href=\"#NLMSG_SPACE\">NLMSG_SPACE</a>((sizeof(struct <a class=\"id\" href=\"#inet_diag_msg\">inet_diag_msg</a>) +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     sizeof(struct <a class=\"id\" href=\"#inet_diag_meminfo\">inet_diag_meminfo</a>) +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#handler\">handler</a>-><a class=\"id\" href=\"#idiag_info_size\">idiag_info_size</a> + 64)),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rep\">rep</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#sk_diag_fill\">sk_diag_fill</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#rep\">rep</a>, <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#idiag_ext\">idiag_ext</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#in_skb\">in_skb</a>).<a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_seq\">nlmsg_seq</a>, 0, <a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(<a class=\"id\" href=\"#err\">err</a> == -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#rep\">rep</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#netlink_unicast\">netlink_unicast</a>(<a class=\"id\" href=\"#idiagnl\">idiagnl</a>, <a class=\"id\" href=\"#rep\">rep</a>, <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#in_skb\">in_skb</a>).<a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_state\">sk_state</a> == <a class=\"id\" href=\"#TCP_TIME_WAIT\">TCP_TIME_WAIT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet_twsk_put\">inet_twsk_put</a>((struct <a class=\"id\" href=\"#inet_timewait_sock\">inet_timewait_sock</a> *)<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_put\">sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#unlock\">unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inet_diag_unlock_handler\">inet_diag_unlock_handler</a>(<a class=\"id\" href=\"#handler\">handler</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#bitstring_match\">bitstring_match</a>(const <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#a1\">a1</a>, const <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#a2\">a2</a>, int <a class=\"id\" href=\"#bits\">bits</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#words\">words</a> = <a class=\"id\" href=\"#bits\">bits</a> >> 5;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bits\">bits</a> &= 0x1f;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#words\">words</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#memcmp\">memcmp</a>(<a class=\"id\" href=\"#a1\">a1</a>, <a class=\"id\" href=\"#a2\">a2</a>, <a class=\"id\" href=\"#words\">words</a> << 2))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#bits\">bits</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#w1\">w1</a>, <a class=\"id\" href=\"#w2\">w2</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#mask\">mask</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#w1\">w1</a> = <a class=\"id\" href=\"#a1\">a1</a>[<a class=\"id\" href=\"#words\">words</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#w2\">w2</a> = <a class=\"id\" href=\"#a2\">a2</a>[<a class=\"id\" href=\"#words\">words</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#htonl\">htonl</a>((0xffffffff) << (32 - <a class=\"id\" href=\"#bits\">bits</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#w1\">w1</a> ^ <a class=\"id\" href=\"#w2\">w2</a>) &amp; <a class=\"id\" href=\"#mask\">mask</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"", 
"static int <a class=\"id\" href=\"#inet_diag_bc_run\">inet_diag_bc_run</a>(const void *<a class=\"id\" href=\"#bc\">bc</a>, int <a class=\"id\" href=\"#len\">len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const struct <a class=\"id\" href=\"#inet_diag_entry\">inet_diag_entry</a> *<a class=\"id\" href=\"#entry\">entry</a>)", 
"{", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#len\">len</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#yes\">yes</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_diag_bc_op\">inet_diag_bc_op</a> *<a class=\"id\" href=\"#op\">op</a> = <a class=\"id\" href=\"#bc\">bc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#code\">code</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_NOP\">INET_DIAG_BC_NOP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_JMP\">INET_DIAG_BC_JMP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_S_GE\">INET_DIAG_BC_S_GE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#sport\">sport</a> >= <a class=\"id\" href=\"#op\">op</a>[1].<a class=\"id\" href=\"#no\">no</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_S_LE\">INET_DIAG_BC_S_LE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#sport\">sport</a> <= <a class=\"id\" href=\"#op\">op</a>[1].<a class=\"id\" href=\"#no\">no</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_D_GE\">INET_DIAG_BC_D_GE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#dport\">dport</a> >= <a class=\"id\" href=\"#op\">op</a>[1].<a class=\"id\" href=\"#no\">no</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_D_LE\">INET_DIAG_BC_D_LE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#dport\">dport</a> <= <a class=\"id\" href=\"#op\">op</a>[1].<a class=\"id\" href=\"#no\">no</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_AUTO\">INET_DIAG_BC_AUTO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = !(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#userlocks\">userlocks</a> &amp; <a class=\"id\" href=\"#SOCK_BINDPORT_LOCK\">SOCK_BINDPORT_LOCK</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_S_COND\">INET_DIAG_BC_S_COND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_D_COND\">INET_DIAG_BC_D_COND</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_hostcond\">inet_diag_hostcond</a> *<a class=\"id\" href=\"#cond\">cond</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#addr\">addr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cond\">cond</a> = (struct <a class=\"id\" href=\"#inet_diag_hostcond\">inet_diag_hostcond</a> *)(<a class=\"id\" href=\"#op\">op</a> + 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#port\">port</a> != -1 &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#port\">port</a> != (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#code\">code</a> == <a class=\"id\" href=\"#INET_DIAG_BC_S_COND\">INET_DIAG_BC_S_COND</a> ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#sport\">sport</a> : <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#dport\">dport</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#prefix_len\">prefix_len</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#code\">code</a> == <a class=\"id\" href=\"#INET_DIAG_BC_S_COND\">INET_DIAG_BC_S_COND</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#daddr\">daddr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bitstring_match\">bitstring_match</a>(<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#prefix_len\">prefix_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#AF_INET\">AF_INET</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addr\">addr</a>[0] == 0 && <a class=\"id\" href=\"#addr\">addr</a>[1] == 0 &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#addr\">addr</a>[2] == <a class=\"id\" href=\"#htonl\">htonl</a>(0xffff) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#bitstring_match\">bitstring_match</a>(<a class=\"id\" href=\"#addr\">addr</a> + 3, <a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#cond\">cond</a>-><a class=\"id\" href=\"#prefix_len\">prefix_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yes\">yes</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#yes\">yes</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> -= <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bc\">bc</a> += <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> -= <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#no\">no</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bc\">bc</a> += <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#no\">no</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#len\">len</a> == 0);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#valid_cc\">valid_cc</a>(const void *<a class=\"id\" href=\"#bc\">bc</a>, int <a class=\"id\" href=\"#len\">len</a>, int <a class=\"id\" href=\"#cc\">cc</a>)", 
"{", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#len\">len</a> >= 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_diag_bc_op\">inet_diag_bc_op</a> *<a class=\"id\" href=\"#op\">op</a> = <a class=\"id\" href=\"#bc\">bc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cc\">cc</a> &gt; <a class=\"id\" href=\"#len\">len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cc\">cc</a> == <a class=\"id\" href=\"#len\">len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a> &lt; 4)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> -= <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bc\">bc</a>  += <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_diag_bc_audit\">inet_diag_bc_audit</a>(const void *<a class=\"id\" href=\"#bytecode\">bytecode</a>, int <a class=\"id\" href=\"#bytecode_len\">bytecode_len</a>)", 
"{", 
"<span class=\"ts\"/>const unsigned char *<a class=\"id\" href=\"#bc\">bc</a> = <a class=\"id\" href=\"#bytecode\">bytecode</a>;", 
"<span class=\"ts\"/>int  <a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#bytecode_len\">bytecode_len</a>;", 
"", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#len\">len</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_bc_op\">inet_diag_bc_op</a> *<a class=\"id\" href=\"#op\">op</a> = (struct <a class=\"id\" href=\"#inet_diag_bc_op\">inet_diag_bc_op</a> *)<a class=\"id\" href=\"#bc\">bc</a>;", 
"", 
"<span class=\"comment\">//printk(\"BC: %d %d %d {%d} / %d\\n\", op-&gt;code, op-&gt;yes, op-&gt;no, op[1].no, len);</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#code\">code</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_AUTO\">INET_DIAG_BC_AUTO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_S_COND\">INET_DIAG_BC_S_COND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_D_COND\">INET_DIAG_BC_D_COND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_S_GE\">INET_DIAG_BC_S_GE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_S_LE\">INET_DIAG_BC_S_LE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_D_GE\">INET_DIAG_BC_D_GE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_D_LE\">INET_DIAG_BC_D_LE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a> &lt; 4 || <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a> &gt; <a class=\"id\" href=\"#len\">len</a> + 4)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_JMP\">INET_DIAG_BC_JMP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#no\">no</a> &lt; 4 || <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#no\">no</a> &gt; <a class=\"id\" href=\"#len\">len</a> + 4)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#no\">no</a> &lt; <a class=\"id\" href=\"#len\">len</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#valid_cc\">valid_cc</a>(<a class=\"id\" href=\"#bytecode\">bytecode</a>, <a class=\"id\" href=\"#bytecode_len\">bytecode_len</a>, <a class=\"id\" href=\"#len\">len</a> - <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#no\">no</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#INET_DIAG_BC_NOP\">INET_DIAG_BC_NOP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a> &lt; 4 || <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a> &gt; <a class=\"id\" href=\"#len\">len</a> + 4)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bc\">bc</a>  += <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> -= <a class=\"id\" href=\"#op\">op</a>-><a class=\"id\" href=\"#yes\">yes</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#len\">len</a> == 0 ? 0 : -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_csk_diag_dump\">inet_csk_diag_dump</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_req\">inet_diag_req</a> *<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> &gt; 4 + <a class=\"id\" href=\"#NLMSG_SPACE\">NLMSG_SPACE</a>(sizeof(*<a class=\"id\" href=\"#r\">r</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_entry\">inet_diag_entry</a> <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#rtattr\">rtattr</a> *<a class=\"id\" href=\"#bc\">bc</a> = (struct <a class=\"id\" href=\"#rtattr\">rtattr</a> *)(<a class=\"id\" href=\"#r\">r</a> + 1);", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_family\">sk_family</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ipv6_pinfo\">ipv6_pinfo</a> *<a class=\"id\" href=\"#np\">np</a> = <a class=\"id\" href=\"#inet6_sk\">inet6_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#np\">np</a>-><a class=\"id\" href=\"#rcv_saddr\">rcv_saddr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#np\">np</a>-><a class=\"id\" href=\"#daddr\">daddr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#saddr\">saddr</a> = &amp;<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_rcv_saddr\">inet_rcv_saddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#daddr\">daddr</a> = &amp;<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_daddr\">inet_daddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#sport\">sport</a> = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_num\">inet_num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#dport\">dport</a> = <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_dport\">inet_dport</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#userlocks\">userlocks</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_userlocks\">sk_userlocks</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#inet_diag_bc_run\">inet_diag_bc_run</a>(<a class=\"id\" href=\"#RTA_DATA\">RTA_DATA</a>(<a class=\"id\" href=\"#bc\">bc</a>), <a class=\"id\" href=\"#RTA_PAYLOAD\">RTA_PAYLOAD</a>(<a class=\"id\" href=\"#bc\">bc</a>), &amp;<a class=\"id\" href=\"#entry\">entry</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#inet_csk_diag_fill\">inet_csk_diag_fill</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_ext\">idiag_ext</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_seq\">nlmsg_seq</a>, <a class=\"id\" href=\"#NLM_F_MULTI\">NLM_F_MULTI</a>, <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_twsk_diag_dump\">inet_twsk_diag_dump</a>(struct <a class=\"id\" href=\"#inet_timewait_sock\">inet_timewait_sock</a> *<a class=\"id\" href=\"#tw\">tw</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_req\">inet_diag_req</a> *<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> &gt; 4 + <a class=\"id\" href=\"#NLMSG_SPACE\">NLMSG_SPACE</a>(sizeof(*<a class=\"id\" href=\"#r\">r</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_entry\">inet_diag_entry</a> <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#rtattr\">rtattr</a> *<a class=\"id\" href=\"#bc\">bc</a> = (struct <a class=\"id\" href=\"#rtattr\">rtattr</a> *)(<a class=\"id\" href=\"#r\">r</a> + 1);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_family\">tw_family</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_family\">tw_family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet6_timewait_sock\">inet6_timewait_sock</a> *<a class=\"id\" href=\"#tw6\">tw6</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet6_twsk\">inet6_twsk</a>((struct <a class=\"id\" href=\"#sock\">sock</a> *)<a class=\"id\" href=\"#tw\">tw</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#tw6\">tw6</a>-><a class=\"id\" href=\"#tw_v6_rcv_saddr\">tw_v6_rcv_saddr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#tw6\">tw6</a>-><a class=\"id\" href=\"#tw_v6_daddr\">tw_v6_daddr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#saddr\">saddr</a> = &amp;<a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_rcv_saddr\">tw_rcv_saddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#daddr\">daddr</a> = &amp;<a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_daddr\">tw_daddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#sport\">sport</a> = <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_num\">tw_num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#dport\">dport</a> = <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_dport\">tw_dport</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#userlocks\">userlocks</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#inet_diag_bc_run\">inet_diag_bc_run</a>(<a class=\"id\" href=\"#RTA_DATA\">RTA_DATA</a>(<a class=\"id\" href=\"#bc\">bc</a>), <a class=\"id\" href=\"#RTA_PAYLOAD\">RTA_PAYLOAD</a>(<a class=\"id\" href=\"#bc\">bc</a>), &amp;<a class=\"id\" href=\"#entry\">entry</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#inet_twsk_diag_fill\">inet_twsk_diag_fill</a>(<a class=\"id\" href=\"#tw\">tw</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_ext\">idiag_ext</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_seq\">nlmsg_seq</a>, <a class=\"id\" href=\"#NLM_F_MULTI\">NLM_F_MULTI</a>, <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_diag_fill_req\">inet_diag_fill_req</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#request_sock\">request_sock</a> *<a class=\"id\" href=\"#req\">req</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#unlh\">unlh</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_request_sock\">inet_request_sock</a> *<a class=\"id\" href=\"#ireq\">ireq</a> = <a class=\"id\" href=\"#inet_rsk\">inet_rsk</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_msg\">inet_diag_msg</a> *<a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>;", 
"<span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#NLMSG_PUT\">NLMSG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#unlh\">unlh</a>-><a class=\"id\" href=\"#nlmsg_type\">nlmsg_type</a>, sizeof(*<a class=\"id\" href=\"#r\">r</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a> = <a class=\"id\" href=\"#NLM_F_MULTI\">NLM_F_MULTI</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_family\">idiag_family</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_family\">sk_family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_state\">idiag_state</a> = <a class=\"id\" href=\"#TCP_SYN_RECV\">TCP_SYN_RECV</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_timer\">idiag_timer</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_retrans\">idiag_retrans</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#retrans\">retrans</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_if\">idiag_if</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_bound_dev_if\">sk_bound_dev_if</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[0] = (<a class=\"id\" href=\"#u32\">u32</a>)(unsigned long)<a class=\"id\" href=\"#req\">req</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_cookie\">idiag_cookie</a>[1] = (<a class=\"id\" href=\"#u32\">u32</a>)(((unsigned long)<a class=\"id\" href=\"#req\">req</a> >> 31) >> 1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#expires\">expires</a> - <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmo\">tmo</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a> = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_sport\">inet_sport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a> = <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_port\">rmt_port</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>[0] = <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#loc_addr\">loc_addr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>[0] = <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_addr\">rmt_addr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_expires\">idiag_expires</a> = <a class=\"id\" href=\"#jiffies_to_msecs\">jiffies_to_msecs</a>(<a class=\"id\" href=\"#tmo\">tmo</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_rqueue\">idiag_rqueue</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_wqueue\">idiag_wqueue</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_uid\">idiag_uid</a> = <a class=\"id\" href=\"#sock_i_uid\">sock_i_uid</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_inode\">idiag_inode</a> = 0;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_family\">idiag_family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_src\">idiag_src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#inet6_rsk\">inet6_rsk</a>(<a class=\"id\" href=\"#req\">req</a>)-><a class=\"id\" href=\"#loc_addr\">loc_addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dst\">idiag_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#inet6_rsk\">inet6_rsk</a>(<a class=\"id\" href=\"#req\">req</a>)-><a class=\"id\" href=\"#rmt_addr\">rmt_addr</a>);", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> = <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>) - <a class=\"id\" href=\"#b\">b</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<a class=\"id\" href=\"#nlmsg_failure\">nlmsg_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlmsg_trim\">nlmsg_trim</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#b\">b</a>);", 
"<span class=\"ts\"/>return -1;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_diag_dump_reqs\">inet_diag_dump_reqs</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_entry\">inet_diag_entry</a> <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_req\">inet_diag_req</a> *<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_connection_sock\">inet_connection_sock</a> *<a class=\"id\" href=\"#icsk\">icsk</a> = <a class=\"id\" href=\"#inet_csk\">inet_csk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#listen_sock\">listen_sock</a> *<a class=\"id\" href=\"#lopt\">lopt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtattr\">rtattr</a> *<a class=\"id\" href=\"#bc\">bc</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#j\">j</a>, <a class=\"id\" href=\"#s_j\">s_j</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#reqnum\">reqnum</a>, <a class=\"id\" href=\"#s_reqnum\">s_reqnum</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s_j\">s_j</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[3];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s_reqnum\">s_reqnum</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[4];", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#s_j\">s_j</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s_j\">s_j</a>--;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_family\">sk_family</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock_bh\">read_lock_bh</a>(&amp;<a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_accept_queue\">icsk_accept_queue</a>.<a class=\"id\" href=\"#syn_wait_lock\">syn_wait_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#lopt\">lopt</a> = <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_accept_queue\">icsk_accept_queue</a>.<a class=\"id\" href=\"#listen_opt\">listen_opt</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#lopt\">lopt</a> || !<a class=\"id\" href=\"#lopt\">lopt</a>-><a class=\"id\" href=\"#qlen\">qlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> &gt; 4 + <a class=\"id\" href=\"#NLMSG_SPACE\">NLMSG_SPACE</a>(sizeof(*<a class=\"id\" href=\"#r\">r</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bc\">bc</a> = (struct <a class=\"id\" href=\"#rtattr\">rtattr</a> *)(<a class=\"id\" href=\"#r\">r</a> + 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#sport\">sport</a> = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_num\">inet_num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#userlocks\">userlocks</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_userlocks\">sk_userlocks</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a> = <a class=\"id\" href=\"#s_j\">s_j</a>; <a class=\"id\" href=\"#j\">j</a> &lt; <a class=\"id\" href=\"#lopt\">lopt</a>-><a class=\"id\" href=\"#nr_table_entries\">nr_table_entries</a>; <a class=\"id\" href=\"#j\">j</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#request_sock\">request_sock</a> *<a class=\"id\" href=\"#req\">req</a>, *<a class=\"id\" href=\"#head\">head</a> = <a class=\"id\" href=\"#lopt\">lopt</a>-><a class=\"id\" href=\"#syn_table\">syn_table</a>[<a class=\"id\" href=\"#j\">j</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reqnum\">reqnum</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#req\">req</a> = <a class=\"id\" href=\"#head\">head</a>; <a class=\"id\" href=\"#req\">req</a>; <a class=\"id\" href=\"#reqnum\">reqnum</a>++, <a class=\"id\" href=\"#req\">req</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#dl_next\">dl_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_request_sock\">inet_request_sock</a> *<a class=\"id\" href=\"#ireq\">ireq</a> = <a class=\"id\" href=\"#inet_rsk\">inet_rsk</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#reqnum\">reqnum</a> &lt; <a class=\"id\" href=\"#s_reqnum\">s_reqnum</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a> != <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_port\">rmt_port</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bc\">bc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#saddr\">saddr</a> =", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet6_rsk\">inet6_rsk</a>(<a class=\"id\" href=\"#req\">req</a>)-><a class=\"id\" href=\"#loc_addr\">loc_addr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a> :", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#loc_addr\">loc_addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#daddr\">daddr</a> =", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a> (<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet6_rsk\">inet6_rsk</a>(<a class=\"id\" href=\"#req\">req</a>)-><a class=\"id\" href=\"#rmt_addr\">rmt_addr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a> :", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_addr\">rmt_addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>.<a class=\"id\" href=\"#dport\">dport</a> = <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_port\">rmt_port</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#inet_diag_bc_run\">inet_diag_bc_run</a>(<a class=\"id\" href=\"#RTA_DATA\">RTA_DATA</a>(<a class=\"id\" href=\"#bc\">bc</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#RTA_PAYLOAD\">RTA_PAYLOAD</a>(<a class=\"id\" href=\"#bc\">bc</a>), &amp;<a class=\"id\" href=\"#entry\">entry</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#inet_diag_fill_req\">inet_diag_fill_req</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#req\">req</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_seq\">nlmsg_seq</a>, <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[3] = <a class=\"id\" href=\"#j\">j</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[4] = <a class=\"id\" href=\"#reqnum\">reqnum</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s_reqnum\">s_reqnum</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock_bh\">read_unlock_bh</a>(&amp;<a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_accept_queue\">icsk_accept_queue</a>.<a class=\"id\" href=\"#syn_wait_lock\">syn_wait_lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_diag_dump\">inet_diag_dump</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#s_i\">s_i</a>, <a class=\"id\" href=\"#s_num\">s_num</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_diag_req\">inet_diag_req</a> *<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *<a class=\"id\" href=\"#handler\">handler</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_hashinfo\">inet_hashinfo</a> *<a class=\"id\" href=\"#hashinfo\">hashinfo</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#handler\">handler</a> = <a class=\"id\" href=\"#inet_diag_lock_handler\">inet_diag_lock_handler</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_type\">nlmsg_type</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#handler\">handler</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hashinfo\">hashinfo</a> = <a class=\"id\" href=\"#handler\">handler</a>-><a class=\"id\" href=\"#idiag_hashinfo\">idiag_hashinfo</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s_i\">s_i</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s_num\">s_num</a> = <a class=\"id\" href=\"#num\">num</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[2];", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0] == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_states\">idiag_states</a> &amp; (<a class=\"id\" href=\"#TCPF_LISTEN\">TCPF_LISTEN</a> | <a class=\"id\" href=\"#TCPF_SYN_RECV\">TCPF_SYN_RECV</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#skip_listen_ht\">skip_listen_ht</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#s_i\">s_i</a>; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#INET_LHTABLE_SIZE\">INET_LHTABLE_SIZE</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_nulls_node\">hlist_nulls_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_listen_hashbucket\">inet_listen_hashbucket</a> *<a class=\"id\" href=\"#ilb\">ilb</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#num\">num</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ilb\">ilb</a> = &amp;<a class=\"id\" href=\"#hashinfo\">hashinfo</a>-><a class=\"id\" href=\"#listening_hash\">listening_hash</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#ilb\">ilb</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk_nulls_for_each\">sk_nulls_for_each</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#node\">node</a>, &amp;<a class=\"id\" href=\"#ilb\">ilb</a>-><a class=\"id\" href=\"#head\">head</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#num\">num</a> &lt; <a class=\"id\" href=\"#s_num\">s_num</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#num\">num</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a> != <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_sport\">inet_sport</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_listen\">next_listen</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_states\">idiag_states</a> &amp; <a class=\"id\" href=\"#TCPF_LISTEN\">TCPF_LISTEN</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[3] &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#syn_recv\">syn_recv</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_csk_diag_dump\">inet_csk_diag_dump</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cb\">cb</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#ilb\">ilb</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#syn_recv\">syn_recv</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_states\">idiag_states</a> &amp; <a class=\"id\" href=\"#TCPF_SYN_RECV\">TCPF_SYN_RECV</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_listen\">next_listen</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_diag_dump_reqs\">inet_diag_dump_reqs</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#cb\">cb</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#ilb\">ilb</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#next_listen\">next_listen</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[3] = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[4] = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#ilb\">ilb</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s_num\">s_num</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[3] = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[4] = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#skip_listen_ht\">skip_listen_ht</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0] = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s_i\">s_i</a> = <a class=\"id\" href=\"#num\">num</a> = <a class=\"id\" href=\"#s_num\">s_num</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_states\">idiag_states</a> &amp; ~(<a class=\"id\" href=\"#TCPF_LISTEN\">TCPF_LISTEN</a> | <a class=\"id\" href=\"#TCPF_SYN_RECV\">TCPF_SYN_RECV</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#s_i\">s_i</a>; <a class=\"id\" href=\"#i\">i</a> <= <a class=\"id\" href=\"#hashinfo\">hashinfo</a>-><a class=\"id\" href=\"#ehash_mask\">ehash_mask</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_ehash_bucket\">inet_ehash_bucket</a> *<a class=\"id\" href=\"#head\">head</a> = &amp;<a class=\"id\" href=\"#hashinfo\">hashinfo</a>-><a class=\"id\" href=\"#ehash\">ehash</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spinlock_t\">spinlock_t</a> *<a class=\"id\" href=\"#lock\">lock</a> = <a class=\"id\" href=\"#inet_ehash_lockp\">inet_ehash_lockp</a>(<a class=\"id\" href=\"#hashinfo\">hashinfo</a>, <a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_nulls_node\">hlist_nulls_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#num\">num</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#hlist_nulls_empty\">hlist_nulls_empty</a>(&amp;<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#chain\">chain</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_nulls_empty\">hlist_nulls_empty</a>(&amp;<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#twchain\">twchain</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> &gt; <a class=\"id\" href=\"#s_i\">s_i</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s_num\">s_num</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk_nulls_for_each\">sk_nulls_for_each</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#node\">node</a>, &amp;<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#chain\">chain</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#num\">num</a> &lt; <a class=\"id\" href=\"#s_num\">s_num</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_normal\">next_normal</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_states\">idiag_states</a> &amp; (1 << <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_state\">sk_state</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_normal\">next_normal</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a> != <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_sport\">inet_sport</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_normal\">next_normal</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a> != <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#inet_dport\">inet_dport</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_normal\">next_normal</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_csk_diag_dump\">inet_csk_diag_dump</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cb\">cb</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#next_normal\">next_normal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#idiag_states\">idiag_states</a> &amp; <a class=\"id\" href=\"#TCPF_TIME_WAIT\">TCPF_TIME_WAIT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_timewait_sock\">inet_timewait_sock</a> *<a class=\"id\" href=\"#tw\">tw</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet_twsk_for_each\">inet_twsk_for_each</a>(<a class=\"id\" href=\"#tw\">tw</a>, <a class=\"id\" href=\"#node\">node</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#twchain\">twchain</a>) {", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#num\">num</a> &lt; <a class=\"id\" href=\"#s_num\">s_num</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_dying\">next_dying</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a> != <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_sport\">tw_sport</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_sport\">idiag_sport</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_dying\">next_dying</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a> != <a class=\"id\" href=\"#tw\">tw</a>-><a class=\"id\" href=\"#tw_dport\">tw_dport</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#idiag_dport\">idiag_dport</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next_dying\">next_dying</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_twsk_diag_dump\">inet_twsk_diag_dump</a>(<a class=\"id\" href=\"#tw\">tw</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cb\">cb</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#next_dying\">next_dying</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#done\">done</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1] = <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[2] = <a class=\"id\" href=\"#num\">num</a>;", 
"<a class=\"id\" href=\"#unlock\">unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inet_diag_unlock_handler\">inet_diag_unlock_handler</a>(<a class=\"id\" href=\"#handler\">handler</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_diag_rcv_msg\">inet_diag_rcv_msg</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#hdrlen\">hdrlen</a> = sizeof(struct <a class=\"id\" href=\"#inet_diag_req\">inet_diag_req</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_type\">nlmsg_type</a> >= <a class=\"id\" href=\"#INET_DIAG_GETSOCK_MAX\">INET_DIAG_GETSOCK_MAX</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a>(<a class=\"id\" href=\"#nlh\">nlh</a>) &lt; <a class=\"id\" href=\"#hdrlen\">hdrlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a> &amp; <a class=\"id\" href=\"#NLM_F_DUMP\">NLM_F_DUMP</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nlmsg_attrlen\">nlmsg_attrlen</a>(<a class=\"id\" href=\"#nlh\">nlh</a>, <a class=\"id\" href=\"#hdrlen\">hdrlen</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#attr\">attr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#attr\">attr</a> = <a class=\"id\" href=\"#nlmsg_find_attr\">nlmsg_find_attr</a>(<a class=\"id\" href=\"#nlh\">nlh</a>, <a class=\"id\" href=\"#hdrlen\">hdrlen</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#INET_DIAG_REQ_BYTECODE\">INET_DIAG_REQ_BYTECODE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#attr\">attr</a> == <a class=\"id\" href=\"#NULL\">NULL</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#attr\">attr</a>) &lt; sizeof(struct <a class=\"id\" href=\"#inet_diag_bc_op\">inet_diag_bc_op</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#inet_diag_bc_audit\">inet_diag_bc_audit</a>(<a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#attr\">attr</a>), <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#attr\">attr</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#netlink_dump_start\">netlink_dump_start</a>(<a class=\"id\" href=\"#idiagnl\">idiagnl</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nlh\">nlh</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#inet_diag_dump\">inet_diag_dump</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#inet_diag_get_exact\">inet_diag_get_exact</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nlh\">nlh</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#DEFINE_MUTEX\">DEFINE_MUTEX</a>(<a class=\"id\" href=\"#inet_diag_mutex\">inet_diag_mutex</a>);", 
"", 
"static void <a class=\"id\" href=\"#inet_diag_rcv\">inet_diag_rcv</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#inet_diag_mutex\">inet_diag_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_rcv_skb\">netlink_rcv_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#inet_diag_rcv_msg\">inet_diag_rcv_msg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#inet_diag_mutex\">inet_diag_mutex</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#inet_diag_register\">inet_diag_register</a>(const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *<a class=\"id\" href=\"#h\">h</a>)", 
"{", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#__u16\">__u16</a> <a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#h\">h</a>-><a class=\"id\" href=\"#idiag_type\">idiag_type</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> >= <a class=\"id\" href=\"#INET_DIAG_GETSOCK_MAX\">INET_DIAG_GETSOCK_MAX</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#inet_diag_table_mutex\">inet_diag_table_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>[<a class=\"id\" href=\"#type\">type</a>] == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>[<a class=\"id\" href=\"#type\">type</a>] = <a class=\"id\" href=\"#h\">h</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#inet_diag_table_mutex\">inet_diag_table_mutex</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#inet_diag_register\">inet_diag_register</a>);", 
"", 
"void <a class=\"id\" href=\"#inet_diag_unregister\">inet_diag_unregister</a>(const struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *<a class=\"id\" href=\"#h\">h</a>)", 
"{", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#__u16\">__u16</a> <a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#h\">h</a>-><a class=\"id\" href=\"#idiag_type\">idiag_type</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> >= <a class=\"id\" href=\"#INET_DIAG_GETSOCK_MAX\">INET_DIAG_GETSOCK_MAX</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#inet_diag_table_mutex\">inet_diag_table_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>[<a class=\"id\" href=\"#type\">type</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#inet_diag_table_mutex\">inet_diag_table_mutex</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#inet_diag_unregister\">inet_diag_unregister</a>);", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#inet_diag_init\">inet_diag_init</a>(void)", 
"{", 
"<span class=\"ts\"/>const int <a class=\"id\" href=\"#inet_diag_table_size\">inet_diag_table_size</a> = (<a class=\"id\" href=\"#INET_DIAG_GETSOCK_MAX\">INET_DIAG_GETSOCK_MAX</a> *", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  sizeof(struct <a class=\"id\" href=\"#inet_diag_handler\">inet_diag_handler</a> *));", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(<a class=\"id\" href=\"#inet_diag_table_size\">inet_diag_table_size</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idiagnl\">idiagnl</a> = <a class=\"id\" href=\"#netlink_kernel_create\">netlink_kernel_create</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, <a class=\"id\" href=\"#NETLINK_INET_DIAG\">NETLINK_INET_DIAG</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet_diag_rcv\">inet_diag_rcv</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#idiagnl\">idiagnl</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free_table\">out_free_table</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<a class=\"id\" href=\"#out_free_table\">out_free_table</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__exit\">__exit</a> <a class=\"id\" href=\"#inet_diag_exit\">inet_diag_exit</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_kernel_release\">netlink_kernel_release</a>(<a class=\"id\" href=\"#idiagnl\">idiagnl</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#inet_diag_table\">inet_diag_table</a>);", 
"}", 
"", 
"<a class=\"id\" href=\"#module_init\">module_init</a>(<a class=\"id\" href=\"#inet_diag_init\">inet_diag_init</a>);", 
"<a class=\"id\" href=\"#module_exit\">module_exit</a>(<a class=\"id\" href=\"#inet_diag_exit\">inet_diag_exit</a>);", 
"<a class=\"id\" href=\"#MODULE_LICENSE\">MODULE_LICENSE</a>(\"GPL\");", 
"<a class=\"id\" href=\"#MODULE_ALIAS_NET_PF_PROTO\">MODULE_ALIAS_NET_PF_PROTO</a>(<a class=\"id\" href=\"#PF_NETLINK\">PF_NETLINK</a>, <a class=\"id\" href=\"#NETLINK_INET_DIAG\">NETLINK_INET_DIAG</a>);", 
];
xr_frag_insert('l/25/b7dfbe8bef26f08f83116dcc5e50a70d71ed36.xr', __xr_tmp);
