var __xr_tmp = [
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> &lt; sizeof(struct <a class=\"id\" href=\"#nd_msg\">nd_msg</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NA: packet too short\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_addr_is_multicast\">ipv6_addr_is_multicast</a>(&amp;<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#target\">target</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NA: target address is multicast.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_addr_is_multicast\">ipv6_addr_is_multicast</a>(<a class=\"id\" href=\"#daddr\">daddr</a>) &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_solicited\">icmp6_solicited</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NA: solicited NA is multicasted.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ndisc_parse_options\">ndisc_parse_options</a>(<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#ndoptlen\">ndoptlen</a>, &amp;<a class=\"id\" href=\"#ndopts\">ndopts</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NS: invalid ND option\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_tgt_lladdr\">nd_opts_tgt_lladdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lladdr\">lladdr</a> = <a class=\"id\" href=\"#ndisc_opt_addr_data\">ndisc_opt_addr_data</a>(<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_tgt_lladdr\">nd_opts_tgt_lladdr</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#lladdr\">lladdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NA: invalid link-layer address length\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ifp\">ifp</a> = <a class=\"id\" href=\"#ipv6_get_ifaddr\">ipv6_get_ifaddr</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), &amp;<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#target\">target</a>, <a class=\"id\" href=\"#dev\">dev</a>, 1);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ifp\">ifp</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifp\">ifp</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFA_F_TENTATIVE\">IFA_F_TENTATIVE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addrconf_dad_failure\">addrconf_dad_failure</a>(<a class=\"id\" href=\"#ifp\">ifp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* What should we make now? The advertisement</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   is invalid, but ndisc specs say nothing</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   about it. It could be misconfiguration, or</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   an smart proxy agent tries to help us :-)</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   We should not print the error if NA has been</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   received from loopback - it is just our own</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   unsolicited advertisement.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a> != <a class=\"id\" href=\"#PACKET_LOOPBACK\">PACKET_LOOPBACK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK1\">ND_PRINTK1</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NA: someone advertises our address %pI6 on %s!\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#ifp\">ifp</a>-><a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#ifp\">ifp</a>-><a class=\"id\" href=\"#idev\">idev</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_ifa_put\">in6_ifa_put</a>(<a class=\"id\" href=\"#ifp\">ifp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#neigh\">neigh</a> = <a class=\"id\" href=\"#neigh_lookup\">neigh_lookup</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>, &amp;<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#target\">target</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#neigh\">neigh</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#old_flags\">old_flags</a> = <a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#nud_state\">nud_state</a> &amp; <a class=\"id\" href=\"#NUD_FAILED\">NUD_FAILED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Don't update the neighbor cache entry on a proxy NA from</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * ourselves because either the proxied node is off link or it</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * has already sent a NA to us.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#lladdr\">lladdr</a> && !<a class=\"id\" href=\"#memcmp\">memcmp</a>(<a class=\"id\" href=\"#lladdr\">lladdr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev_addr\">dev_addr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#devconf_all\">devconf_all</a>-><a class=\"id\" href=\"#forwarding\">forwarding</a> && <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#devconf_all\">devconf_all</a>-><a class=\"id\" href=\"#proxy_ndp\">proxy_ndp</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#pneigh_lookup\">pneigh_lookup</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>, <a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#target\">target</a>, <a class=\"id\" href=\"#dev\">dev</a>, 0)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* XXX: idev-&gt;cnf.prixy_ndp */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_update\">neigh_update</a>(<a class=\"id\" href=\"#neigh\">neigh</a>, <a class=\"id\" href=\"#lladdr\">lladdr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_solicited\">icmp6_solicited</a> ? <a class=\"id\" href=\"#NUD_REACHABLE\">NUD_REACHABLE</a> : <a class=\"id\" href=\"#NUD_STALE\">NUD_STALE</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_WEAK_OVERRIDE\">NEIGH_UPDATE_F_WEAK_OVERRIDE</a>|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_override\">icmp6_override</a> ? <a class=\"id\" href=\"#NEIGH_UPDATE_F_OVERRIDE\">NEIGH_UPDATE_F_OVERRIDE</a> : 0)|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_OVERRIDE_ISROUTER\">NEIGH_UPDATE_F_OVERRIDE_ISROUTER</a>|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_router\">icmp6_router</a> ? <a class=\"id\" href=\"#NEIGH_UPDATE_F_ISROUTER\">NEIGH_UPDATE_F_ISROUTER</a> : 0));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#old_flags\">old_flags</a> &amp; ~<a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#flags\">flags</a>) &amp; <a class=\"id\" href=\"#NTF_ROUTER\">NTF_ROUTER</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Change: router to host</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#rt6_get_dflt_router\">rt6_get_dflt_router</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip6_del_rt\">ip6_del_rt</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_release\">neigh_release</a>(<a class=\"id\" href=\"#neigh\">neigh</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ndisc_recv_rs\">ndisc_recv_rs</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rs_msg\">rs_msg</a> *<a class=\"id\" href=\"#rs_msg\">rs_msg</a> = (struct <a class=\"id\" href=\"#rs_msg\">rs_msg</a> *)<a class=\"id\" href=\"#skb_transport_header\">skb_transport_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#ndoptlen\">ndoptlen</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> - sizeof(*<a class=\"id\" href=\"#rs_msg\">rs_msg</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#neighbour\">neighbour</a> *<a class=\"id\" href=\"#neigh\">neigh</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet6_dev\">inet6_dev</a> *<a class=\"id\" href=\"#idev\">idev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#saddr\">saddr</a> = &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ndisc_options\">ndisc_options</a> <a class=\"id\" href=\"#ndopts\">ndopts</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#lladdr\">lladdr</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> &lt; sizeof(*<a class=\"id\" href=\"#rs_msg\">rs_msg</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#in6_dev_get\">in6_dev_get</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#idev\">idev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK1\">ND_PRINTK1</a>(\"ICMP6 RS: can't find in6 device\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Don't accept RS if we're not in router mode */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#idev\">idev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#forwarding\">forwarding</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Don't update NCE if src = ::;</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * this implies that the source node has no ip address assigned yet.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_addr_any\">ipv6_addr_any</a>(<a class=\"id\" href=\"#saddr\">saddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Parse ND options */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ndisc_parse_options\">ndisc_parse_options</a>(<a class=\"id\" href=\"#rs_msg\">rs_msg</a>-><a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#ndoptlen\">ndoptlen</a>, &amp;<a class=\"id\" href=\"#ndopts\">ndopts</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(\"ICMP6 NS: invalid ND option, ignored\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_src_lladdr\">nd_opts_src_lladdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lladdr\">lladdr</a> = <a class=\"id\" href=\"#ndisc_opt_addr_data\">ndisc_opt_addr_data</a>(<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_src_lladdr\">nd_opts_src_lladdr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#lladdr\">lladdr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#neigh\">neigh</a> = <a class=\"id\" href=\"#__neigh_lookup\">__neigh_lookup</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>, 1);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#neigh\">neigh</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_update\">neigh_update</a>(<a class=\"id\" href=\"#neigh\">neigh</a>, <a class=\"id\" href=\"#lladdr\">lladdr</a>, <a class=\"id\" href=\"#NUD_STALE\">NUD_STALE</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_WEAK_OVERRIDE\">NEIGH_UPDATE_F_WEAK_OVERRIDE</a>|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_OVERRIDE\">NEIGH_UPDATE_F_OVERRIDE</a>|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_OVERRIDE_ISROUTER\">NEIGH_UPDATE_F_OVERRIDE_ISROUTER</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_release\">neigh_release</a>(<a class=\"id\" href=\"#neigh\">neigh</a>);", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#idev\">idev</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ndisc_ra_useropt\">ndisc_ra_useropt</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#ra\">ra</a>, struct <a class=\"id\" href=\"#nd_opt_hdr\">nd_opt_hdr</a> *<a class=\"id\" href=\"#opt\">opt</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#icmp6hdr\">icmp6hdr</a> *<a class=\"id\" href=\"#icmp6h\">icmp6h</a> = (struct <a class=\"id\" href=\"#icmp6hdr\">icmp6hdr</a> *)<a class=\"id\" href=\"#skb_transport_header\">skb_transport_header</a>(<a class=\"id\" href=\"#ra\">ra</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nduseroptmsg\">nduseroptmsg</a> *<a class=\"id\" href=\"#ndmsg\">ndmsg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#ra\">ra</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#base_size\">base_size</a> = <a class=\"id\" href=\"#NLMSG_ALIGN\">NLMSG_ALIGN</a>(sizeof(struct <a class=\"id\" href=\"#nduseroptmsg\">nduseroptmsg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    + (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#nd_opt_len\">nd_opt_len</a> << 3));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#msg_size\">msg_size</a> = <a class=\"id\" href=\"#base_size\">base_size</a> + <a class=\"id\" href=\"#nla_total_size\">nla_total_size</a>(sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#nlmsg_new\">nlmsg_new</a>(<a class=\"id\" href=\"#msg_size\">msg_size</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#nlmsg_put\">nlmsg_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, 0, 0, <a class=\"id\" href=\"#RTM_NEWNDUSEROPT\">RTM_NEWNDUSEROPT</a>, <a class=\"id\" href=\"#base_size\">base_size</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlh\">nlh</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#nla_put_failure\">nla_put_failure</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndmsg\">ndmsg</a> = <a class=\"id\" href=\"#nlmsg_data\">nlmsg_data</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndmsg\">ndmsg</a>-><a class=\"id\" href=\"#nduseropt_family\">nduseropt_family</a> = <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndmsg\">ndmsg</a>-><a class=\"id\" href=\"#nduseropt_ifindex\">nduseropt_ifindex</a> = <a class=\"id\" href=\"#ra\">ra</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndmsg\">ndmsg</a>-><a class=\"id\" href=\"#nduseropt_icmp_type\">nduseropt_icmp_type</a> = <a class=\"id\" href=\"#icmp6h\">icmp6h</a>-><a class=\"id\" href=\"#icmp6_type\">icmp6_type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndmsg\">ndmsg</a>-><a class=\"id\" href=\"#nduseropt_icmp_code\">nduseropt_icmp_code</a> = <a class=\"id\" href=\"#icmp6h\">icmp6h</a>-><a class=\"id\" href=\"#icmp6_code\">icmp6_code</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndmsg\">ndmsg</a>-><a class=\"id\" href=\"#nduseropt_opts_len\">nduseropt_opts_len</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#nd_opt_len\">nd_opt_len</a> << 3;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#ndmsg\">ndmsg</a> + 1, <a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#nd_opt_len\">nd_opt_len</a> << 3);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NLA_PUT\">NLA_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#NDUSEROPT_SRCADDR\">NDUSEROPT_SRCADDR</a>, sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#ra\">ra</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlmsg_end\">nlmsg_end</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nlh\">nlh</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_notify\">rtnl_notify</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#net\">net</a>, 0, <a class=\"id\" href=\"#RTNLGRP_ND_USEROPT\">RTNLGRP_ND_USEROPT</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>return;", 
"", 
"<a class=\"id\" href=\"#nla_put_failure\">nla_put_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlmsg_free\">nlmsg_free</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"<a class=\"id\" href=\"#errout\">errout</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_set_sk_err\">rtnl_set_sk_err</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#RTNLGRP_ND_USEROPT\">RTNLGRP_ND_USEROPT</a>, <a class=\"id\" href=\"#err\">err</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ndisc_router_discovery\">ndisc_router_discovery</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ra_msg\">ra_msg</a> *<a class=\"id\" href=\"#ra_msg\">ra_msg</a> = (struct <a class=\"id\" href=\"#ra_msg\">ra_msg</a> *)<a class=\"id\" href=\"#skb_transport_header\">skb_transport_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#neighbour\">neighbour</a> *<a class=\"id\" href=\"#neigh\">neigh</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet6_dev\">inet6_dev</a> *<a class=\"id\" href=\"#in6_dev\">in6_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a> *<a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#lifetime\">lifetime</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ndisc_options\">ndisc_options</a> <a class=\"id\" href=\"#ndopts\">ndopts</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#pref\">pref</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__u8\">__u8</a> * <a class=\"id\" href=\"#opt\">opt</a> = (<a class=\"id\" href=\"#__u8\">__u8</a> *)(<a class=\"id\" href=\"#ra_msg\">ra_msg</a> + 1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a> = (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tail\">tail</a> - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#transport_header\">transport_header</a>) - sizeof(struct <a class=\"id\" href=\"#ra_msg\">ra_msg</a>);", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#ipv6_addr_type\">ipv6_addr_type</a>(&amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>) &amp; <a class=\"id\" href=\"#IPV6_ADDR_LINKLOCAL\">IPV6_ADDR_LINKLOCAL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: source address is not link-local.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: packet too short\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IPV6_NDISC_NODETYPE\">CONFIG_IPV6_NDISC_NODETYPE</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ndisc_nodetype\">ndisc_nodetype</a> == <a class=\"id\" href=\"#NDISC_NODETYPE_HOST\">NDISC_NODETYPE_HOST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: from host or unauthorized router\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>set the RA_RECV flag in the interface</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a> = <a class=\"id\" href=\"#in6_dev_get\">in6_dev_get</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK0\">ND_PRINTK0</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: can't find inet6 device for %s.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ndisc_parse_options\">ndisc_parse_options</a>(<a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#optlen\">optlen</a>, &amp;<a class=\"id\" href=\"#ndopts\">ndopts</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMP6 RA: invalid ND options\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* skip route and link configuration on routers */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#forwarding\">forwarding</a> || !<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_ra\">accept_ra</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#skip_linkparms\">skip_linkparms</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IPV6_NDISC_NODETYPE\">CONFIG_IPV6_NDISC_NODETYPE</a>", 
"<span class=\"ts\"/><span class=\"comment\">/* skip link-specific parameters from interior routers */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ndisc_nodetype\">ndisc_nodetype</a> == <a class=\"id\" href=\"#NDISC_NODETYPE_NODEFAULT\">NDISC_NODETYPE_NODEFAULT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#skip_linkparms\">skip_linkparms</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#if_flags\">if_flags</a> &amp; <a class=\"id\" href=\"#IF_RS_SENT\">IF_RS_SENT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *<span class=\"ts\"/>flag that an RA was received after an RS was sent</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *<span class=\"ts\"/>out on this interface.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#if_flags\">if_flags</a> |= <a class=\"id\" href=\"#IF_RA_RCVD\">IF_RA_RCVD</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Remember the managed/otherconf flags from most recently</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * received RA message (RFC 2462) -- yoshfuji</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#if_flags\">if_flags</a> = (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#if_flags\">if_flags</a> &amp; ~(<a class=\"id\" href=\"#IF_RA_MANAGED\">IF_RA_MANAGED</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IF_RA_OTHERCONF\">IF_RA_OTHERCONF</a>)) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_addrconf_managed\">icmp6_addrconf_managed</a> ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IF_RA_MANAGED\">IF_RA_MANAGED</a> : 0) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_addrconf_other\">icmp6_addrconf_other</a> ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IF_RA_OTHERCONF\">IF_RA_OTHERCONF</a> : 0);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_ra_defrtr\">accept_ra_defrtr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#skip_defrtr\">skip_defrtr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#lifetime\">lifetime</a> = <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_rt_lifetime\">icmp6_rt_lifetime</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IPV6_ROUTER_PREF\">CONFIG_IPV6_ROUTER_PREF</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = <a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_router_pref\">icmp6_router_pref</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* 10b is handled as if it were 00b (medium) */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pref\">pref</a> == <a class=\"id\" href=\"#ICMPV6_ROUTER_PREF_INVALID\">ICMPV6_ROUTER_PREF_INVALID</a> ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_ra_rtr_pref\">accept_ra_rtr_pref</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = <a class=\"id\" href=\"#ICMPV6_ROUTER_PREF_MEDIUM\">ICMPV6_ROUTER_PREF_MEDIUM</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#rt6_get_dflt_router\">rt6_get_dflt_router</a>(&amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh\">neigh</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_nexthop\">rt6i_nexthop</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a> && <a class=\"id\" href=\"#lifetime\">lifetime</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_clone\">neigh_clone</a>(<a class=\"id\" href=\"#neigh\">neigh</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip6_del_rt\">ip6_del_rt</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a> == <a class=\"id\" href=\"#NULL\">NULL</a> && <a class=\"id\" href=\"#lifetime\">lifetime</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK3\">ND_PRINTK3</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: adding default router.\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#rt6_add_dflt_router\">rt6_add_dflt_router</a>(&amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pref\">pref</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK0\">ND_PRINTK0</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: %s() failed to add default route.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh\">neigh</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_nexthop\">rt6i_nexthop</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#neigh\">neigh</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK0\">ND_PRINTK0</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: %s() got default router without neighbour.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_release\">dst_release</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NTF_ROUTER\">NTF_ROUTER</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#rt\">rt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_flags\">rt6i_flags</a> = (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_flags\">rt6i_flags</a> &amp; ~<a class=\"id\" href=\"#RTF_PREF_MASK\">RTF_PREF_MASK</a>) | <a class=\"id\" href=\"#RTF_PREF\">RTF_PREF</a>(<a class=\"id\" href=\"#pref\">pref</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_expires\">rt6i_expires</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a> + (<a class=\"id\" href=\"#HZ\">HZ</a> * <a class=\"id\" href=\"#lifetime\">lifetime</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_hop_limit\">icmp6_hop_limit</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#hop_limit\">hop_limit</a> = <a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_hop_limit\">icmp6_hop_limit</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_HOPLIMIT\">RTAX_HOPLIMIT</a>-1] = <a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_hop_limit\">icmp6_hop_limit</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#skip_defrtr\">skip_defrtr</a>:", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Update Reachable Time and Retrans Timer</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#rtime\">rtime</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#retrans_timer\">retrans_timer</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rtime\">rtime</a> && <a class=\"id\" href=\"#rtime\">rtime</a>/1000 &lt; <a class=\"id\" href=\"#MAX_SCHEDULE_TIMEOUT\">MAX_SCHEDULE_TIMEOUT</a>/<a class=\"id\" href=\"#HZ\">HZ</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtime\">rtime</a> = (<a class=\"id\" href=\"#rtime\">rtime</a>*<a class=\"id\" href=\"#HZ\">HZ</a>)/1000;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rtime\">rtime</a> &lt; <a class=\"id\" href=\"#HZ\">HZ</a>/10)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtime\">rtime</a> = <a class=\"id\" href=\"#HZ\">HZ</a>/10;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#retrans_time\">retrans_time</a> = <a class=\"id\" href=\"#rtime\">rtime</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#tstamp\">tstamp</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet6_ifinfo_notify\">inet6_ifinfo_notify</a>(<a class=\"id\" href=\"#RTM_NEWLINK\">RTM_NEWLINK</a>, <a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtime\">rtime</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#ra_msg\">ra_msg</a>-><a class=\"id\" href=\"#reachable_time\">reachable_time</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rtime\">rtime</a> && <a class=\"id\" href=\"#rtime\">rtime</a>/1000 &lt; <a class=\"id\" href=\"#MAX_SCHEDULE_TIMEOUT\">MAX_SCHEDULE_TIMEOUT</a>/(3*<a class=\"id\" href=\"#HZ\">HZ</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtime\">rtime</a> = (<a class=\"id\" href=\"#rtime\">rtime</a>*<a class=\"id\" href=\"#HZ\">HZ</a>)/1000;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rtime\">rtime</a> &lt; <a class=\"id\" href=\"#HZ\">HZ</a>/10)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtime\">rtime</a> = <a class=\"id\" href=\"#HZ\">HZ</a>/10;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rtime\">rtime</a> != <a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#base_reachable_time\">base_reachable_time</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#base_reachable_time\">base_reachable_time</a> = <a class=\"id\" href=\"#rtime\">rtime</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#gc_staletime\">gc_staletime</a> = 3 * <a class=\"id\" href=\"#rtime\">rtime</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#reachable_time\">reachable_time</a> = <a class=\"id\" href=\"#neigh_rand_reach_time\">neigh_rand_reach_time</a>(<a class=\"id\" href=\"#rtime\">rtime</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#tstamp\">tstamp</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet6_ifinfo_notify\">inet6_ifinfo_notify</a>(<a class=\"id\" href=\"#RTM_NEWLINK\">RTM_NEWLINK</a>, <a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#skip_linkparms\">skip_linkparms</a>:", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Process options.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#neigh\">neigh</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh\">neigh</a> = <a class=\"id\" href=\"#__neigh_lookup\">__neigh_lookup</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>, &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>, 1);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#neigh\">neigh</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#lladdr\">lladdr</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_src_lladdr\">nd_opts_src_lladdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lladdr\">lladdr</a> = <a class=\"id\" href=\"#ndisc_opt_addr_data\">ndisc_opt_addr_data</a>(<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_src_lladdr\">nd_opts_src_lladdr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#lladdr\">lladdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: invalid link-layer address length\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_update\">neigh_update</a>(<a class=\"id\" href=\"#neigh\">neigh</a>, <a class=\"id\" href=\"#lladdr\">lladdr</a>, <a class=\"id\" href=\"#NUD_STALE\">NUD_STALE</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_WEAK_OVERRIDE\">NEIGH_UPDATE_F_WEAK_OVERRIDE</a>|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_OVERRIDE\">NEIGH_UPDATE_F_OVERRIDE</a>|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_OVERRIDE_ISROUTER\">NEIGH_UPDATE_F_OVERRIDE_ISROUTER</a>|", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NEIGH_UPDATE_F_ISROUTER\">NEIGH_UPDATE_F_ISROUTER</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* skip route and link configuration on routers */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#forwarding\">forwarding</a> || !<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_ra\">accept_ra</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IPV6_ROUTE_INFO\">CONFIG_IPV6_ROUTE_INFO</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_ra_rtr_pref\">accept_ra_rtr_pref</a> && <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_ri\">nd_opts_ri</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nd_opt_hdr\">nd_opt_hdr</a> *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_ri\">nd_opts_ri</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#ndisc_next_option\">ndisc_next_option</a>(<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_ri_end\">nd_opts_ri_end</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#route_info\">route_info</a> *<a class=\"id\" href=\"#ri\">ri</a> = (struct <a class=\"id\" href=\"#route_info\">route_info</a> *)<a class=\"id\" href=\"#p\">p</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IPV6_NDISC_NODETYPE\">CONFIG_IPV6_NDISC_NODETYPE</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ndisc_nodetype\">ndisc_nodetype</a> == <a class=\"id\" href=\"#NDISC_NODETYPE_NODEFAULT\">NDISC_NODETYPE_NODEFAULT</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ri\">ri</a>-><a class=\"id\" href=\"#prefix_len\">prefix_len</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ri\">ri</a>-><a class=\"id\" href=\"#prefix_len\">prefix_len</a> &gt; <a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_ra_rt_info_max_plen\">accept_ra_rt_info_max_plen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt6_route_rcv\">rt6_route_rcv</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>, (<a class=\"id\" href=\"#u8\">u8</a>*)<a class=\"id\" href=\"#p\">p</a>, (<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#nd_opt_len\">nd_opt_len</a>) << 3,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IPV6_NDISC_NODETYPE\">CONFIG_IPV6_NDISC_NODETYPE</a>", 
"<span class=\"ts\"/><span class=\"comment\">/* skip link-specific ndopts from interior routers */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ndisc_nodetype\">ndisc_nodetype</a> == <a class=\"id\" href=\"#NDISC_NODETYPE_NODEFAULT\">NDISC_NODETYPE_NODEFAULT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_ra_pinfo\">accept_ra_pinfo</a> && <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_pi\">nd_opts_pi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nd_opt_hdr\">nd_opt_hdr</a> *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_pi\">nd_opts_pi</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#ndisc_next_option\">ndisc_next_option</a>(<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_pi_end\">nd_opts_pi_end</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addrconf_prefix_rcv\">addrconf_prefix_rcv</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>, (<a class=\"id\" href=\"#u8\">u8</a>*)<a class=\"id\" href=\"#p\">p</a>, (<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#nd_opt_len\">nd_opt_len</a>) << 3);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_mtu\">nd_opts_mtu</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#n\">n</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mtu\">mtu</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#n\">n</a>, ((<a class=\"id\" href=\"#u8\">u8</a>*)(<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_mtu\">nd_opts_mtu</a>+1))+2, sizeof(<a class=\"id\" href=\"#mtu\">mtu</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mtu\">mtu</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#n\">n</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mtu\">mtu</a> &lt; <a class=\"id\" href=\"#IPV6_MIN_MTU\">IPV6_MIN_MTU</a> || <a class=\"id\" href=\"#mtu\">mtu</a> &gt; <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: invalid mtu: %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#mtu\">mtu</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#mtu6\">mtu6</a> != <a class=\"id\" href=\"#mtu\">mtu</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#mtu6\">mtu6</a> = <a class=\"id\" href=\"#mtu\">mtu</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>-1] = <a class=\"id\" href=\"#mtu\">mtu</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt6_mtu_change\">rt6_mtu_change</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#mtu\">mtu</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_useropts\">nd_useropts</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nd_opt_hdr\">nd_opt_hdr</a> *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_useropts\">nd_useropts</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#ndisc_next_useropt\">ndisc_next_useropt</a>(<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_useropts_end\">nd_useropts_end</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ndisc_ra_useropt\">ndisc_ra_useropt</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_tgt_lladdr\">nd_opts_tgt_lladdr</a> || <a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_rh\">nd_opts_rh</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 RA: invalid RA options\");", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_release\">dst_release</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#neigh\">neigh</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_release\">neigh_release</a>(<a class=\"id\" href=\"#neigh\">neigh</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ndisc_redirect_rcv\">ndisc_redirect_rcv</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet6_dev\">inet6_dev</a> *<a class=\"id\" href=\"#in6_dev\">in6_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#icmp6hdr\">icmp6hdr</a> *<a class=\"id\" href=\"#icmph\">icmph</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#dest\">dest</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#target\">target</a>;<span class=\"ts\"/><span class=\"comment\">/* new first hop to destination */</span>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#neighbour\">neighbour</a> *<a class=\"id\" href=\"#neigh\">neigh</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#on_link\">on_link</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ndisc_options\">ndisc_options</a> <a class=\"id\" href=\"#ndopts\">ndopts</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#lladdr\">lladdr</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IPV6_NDISC_NODETYPE\">CONFIG_IPV6_NDISC_NODETYPE</a>", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ndisc_nodetype\">ndisc_nodetype</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NDISC_NODETYPE_HOST\">NDISC_NODETYPE_HOST</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NDISC_NODETYPE_NODEFAULT\">NDISC_NODETYPE_NODEFAULT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: from host or unauthorized router\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#ipv6_addr_type\">ipv6_addr_type</a>(&amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>) &amp; <a class=\"id\" href=\"#IPV6_ADDR_LINKLOCAL\">IPV6_ADDR_LINKLOCAL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: source address is not link-local.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tail\">tail</a> - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#transport_header\">transport_header</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a> -= sizeof(struct <a class=\"id\" href=\"#icmp6hdr\">icmp6hdr</a>) + 2 * sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: packet too short\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#icmph\">icmph</a> = <a class=\"id\" href=\"#icmp6_hdr\">icmp6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *) (<a class=\"id\" href=\"#icmph\">icmph</a> + 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dest\">dest</a> = <a class=\"id\" href=\"#target\">target</a> + 1;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_addr_is_multicast\">ipv6_addr_is_multicast</a>(<a class=\"id\" href=\"#dest\">dest</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: destination address is multicast.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_addr_equal\">ipv6_addr_equal</a>(<a class=\"id\" href=\"#dest\">dest</a>, <a class=\"id\" href=\"#target\">target</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#on_link\">on_link</a> = 1;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#ipv6_addr_type\">ipv6_addr_type</a>(<a class=\"id\" href=\"#target\">target</a>) !=", 
"<span class=\"ts\"/><span class=\"ts\"/>   (<a class=\"id\" href=\"#IPV6_ADDR_UNICAST\">IPV6_ADDR_UNICAST</a>|<a class=\"id\" href=\"#IPV6_ADDR_LINKLOCAL\">IPV6_ADDR_LINKLOCAL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: target address is not link-local unicast.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in6_dev\">in6_dev</a> = <a class=\"id\" href=\"#in6_dev_get\">in6_dev_get</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in6_dev\">in6_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#forwarding\">forwarding</a> || !<a class=\"id\" href=\"#in6_dev\">in6_dev</a>-><a class=\"id\" href=\"#cnf\">cnf</a>.<a class=\"id\" href=\"#accept_redirects\">accept_redirects</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* RFC2461 8.1:</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>The IP source address of the Redirect MUST be the same as the current</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>first-hop router for the specified ICMP Destination Address.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ndisc_parse_options\">ndisc_parse_options</a>((<a class=\"id\" href=\"#u8\">u8</a>*)(<a class=\"id\" href=\"#dest\">dest</a> + 1), <a class=\"id\" href=\"#optlen\">optlen</a>, &amp;<a class=\"id\" href=\"#ndopts\">ndopts</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: invalid ND options\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_tgt_lladdr\">nd_opts_tgt_lladdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lladdr\">lladdr</a> = <a class=\"id\" href=\"#ndisc_opt_addr_data\">ndisc_opt_addr_data</a>(<a class=\"id\" href=\"#ndopts\">ndopts</a>.<a class=\"id\" href=\"#nd_opts_tgt_lladdr\">nd_opts_tgt_lladdr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#lladdr\">lladdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: invalid link-layer address length\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#neigh\">neigh</a> = <a class=\"id\" href=\"#__neigh_lookup\">__neigh_lookup</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>, <a class=\"id\" href=\"#target\">target</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>, 1);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#neigh\">neigh</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt6_redirect\">rt6_redirect</a>(<a class=\"id\" href=\"#dest\">dest</a>, &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#neigh\">neigh</a>, <a class=\"id\" href=\"#lladdr\">lladdr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#on_link\">on_link</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_release\">neigh_release</a>(<a class=\"id\" href=\"#neigh\">neigh</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#in6_dev\">in6_dev</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#ndisc_send_redirect\">ndisc_send_redirect</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#neighbour\">neighbour</a> *<a class=\"id\" href=\"#neigh\">neigh</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#target\">target</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#ndisc_sk\">ndisc_sk</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a> = sizeof(struct <a class=\"id\" href=\"#icmp6hdr\">icmp6hdr</a>) + 2 * sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#buff\">buff</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#icmp6hdr\">icmp6hdr</a> *<a class=\"id\" href=\"#icmph\">icmph</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> <a class=\"id\" href=\"#saddr_buf\">saddr_buf</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#addrp\">addrp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet6_dev\">inet6_dev</a> *<a class=\"id\" href=\"#idev\">idev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#opt\">opt</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rd_len\">rd_len</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#ha_buf\">ha_buf</a>[<a class=\"id\" href=\"#MAX_ADDR_LEN\">MAX_ADDR_LEN</a>], *<a class=\"id\" href=\"#ha\">ha</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_get_lladdr\">ipv6_get_lladdr</a>(<a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#saddr_buf\">saddr_buf</a>, <a class=\"id\" href=\"#IFA_F_TENTATIVE\">IFA_F_TENTATIVE</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: no link-local address on %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv6_addr_equal\">ipv6_addr_equal</a>(&amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#target\">target</a>) &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#ipv6_addr_type\">ipv6_addr_type</a>(<a class=\"id\" href=\"#target\">target</a>) != (<a class=\"id\" href=\"#IPV6_ADDR_UNICAST\">IPV6_ADDR_UNICAST</a>|<a class=\"id\" href=\"#IPV6_ADDR_LINKLOCAL\">IPV6_ADDR_LINKLOCAL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"ICMPv6 Redirect: target address is not link-local unicast.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#icmpv6_flow_init\">icmpv6_flow_init</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#NDISC_REDIRECT\">NDISC_REDIRECT</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#saddr_buf\">saddr_buf</a>, &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#ip6_route_output\">ip6_route_output</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst\">dst</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_lookup\">xfrm_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#dst\">dst</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rt6_info\">rt6_info</a> *) <a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt6i_flags\">rt6i_flags</a> &amp; <a class=\"id\" href=\"#RTF_GATEWAY\">RTF_GATEWAY</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: destination is not a neighbour.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#release\">release</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#xrlim_allow\">xrlim_allow</a>(<a class=\"id\" href=\"#dst\">dst</a>, 1*<a class=\"id\" href=\"#HZ\">HZ</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#release\">release</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_lock_bh\">read_lock_bh</a>(&amp;<a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#nud_state\">nud_state</a> &amp; <a class=\"id\" href=\"#NUD_VALID\">NUD_VALID</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#ha_buf\">ha_buf</a>, <a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#ha\">ha</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_unlock_bh\">read_unlock_bh</a>(&amp;<a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ha\">ha</a> = <a class=\"id\" href=\"#ha_buf\">ha_buf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> += <a class=\"id\" href=\"#ndisc_opt_addr_space\">ndisc_opt_addr_space</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_unlock_bh\">read_unlock_bh</a>(&amp;<a class=\"id\" href=\"#neigh\">neigh</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rd_len\">rd_len</a> = <a class=\"id\" href=\"#min_t\">min_t</a>(unsigned int,", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#IPV6_MIN_MTU\">IPV6_MIN_MTU</a>-sizeof(struct <a class=\"id\" href=\"#ipv6hdr\">ipv6hdr</a>)-<a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> + 8);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rd_len\">rd_len</a> &= ~0x7;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> += <a class=\"id\" href=\"#rd_len\">rd_len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buff\">buff</a> = <a class=\"id\" href=\"#sock_alloc_send_skb\">sock_alloc_send_skb</a>(<a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   (<a class=\"id\" href=\"#MAX_HEADER\">MAX_HEADER</a> + sizeof(struct <a class=\"id\" href=\"#ipv6hdr\">ipv6hdr</a>) +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#len\">len</a> + <a class=\"id\" href=\"#LL_ALLOCATED_SPACE\">LL_ALLOCATED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>)),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   1, &amp;<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#buff\">buff</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK0\">ND_PRINTK0</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 Redirect: %s() failed to allocate an skb, err=%d.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#__func__\">__func__</a>, <a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#release\">release</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reserve\">skb_reserve</a>(<a class=\"id\" href=\"#buff\">buff</a>, <a class=\"id\" href=\"#LL_RESERVED_SPACE\">LL_RESERVED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip6_nd_hdr\">ip6_nd_hdr</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#buff\">buff</a>, <a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#saddr_buf\">saddr_buf</a>, &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#IPPROTO_ICMPV6\">IPPROTO_ICMPV6</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_set_transport_header\">skb_set_transport_header</a>(<a class=\"id\" href=\"#buff\">buff</a>, <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#buff\">buff</a>) - <a class=\"id\" href=\"#buff\">buff</a>-><a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#buff\">buff</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#icmph\">icmph</a> = <a class=\"id\" href=\"#icmp6_hdr\">icmp6_hdr</a>(<a class=\"id\" href=\"#buff\">buff</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#icmph\">icmph</a>, 0, sizeof(struct <a class=\"id\" href=\"#icmp6hdr\">icmp6hdr</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#icmph\">icmph</a>-><a class=\"id\" href=\"#icmp6_type\">icmp6_type</a> = <a class=\"id\" href=\"#NDISC_REDIRECT\">NDISC_REDIRECT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>copy target and destination addresses</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addrp\">addrp</a> = (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)(<a class=\"id\" href=\"#icmph\">icmph</a> + 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>(<a class=\"id\" href=\"#addrp\">addrp</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addrp\">addrp</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>(<a class=\"id\" href=\"#addrp\">addrp</a>, &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#daddr\">daddr</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a> = (<a class=\"id\" href=\"#u8\">u8</a>*) (<a class=\"id\" href=\"#addrp\">addrp</a> + 1);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>include target_address option</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ha\">ha</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a> = <a class=\"id\" href=\"#ndisc_fill_addr_option\">ndisc_fill_addr_option</a>(<a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#ND_OPT_TARGET_LL_ADDR\">ND_OPT_TARGET_LL_ADDR</a>, <a class=\"id\" href=\"#ha\">ha</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>build redirect option and copy skb over to the new packet.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#opt\">opt</a>, 0, 8);", 
"<span class=\"ts\"/>*(<a class=\"id\" href=\"#opt\">opt</a>++) = <a class=\"id\" href=\"#ND_OPT_REDIRECT_HDR\">ND_OPT_REDIRECT_HDR</a>;", 
"<span class=\"ts\"/>*(<a class=\"id\" href=\"#opt\">opt</a>++) = (<a class=\"id\" href=\"#rd_len\">rd_len</a> >> 3);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a> += 6;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>), <a class=\"id\" href=\"#rd_len\">rd_len</a> - 8);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#icmph\">icmph</a>-><a class=\"id\" href=\"#icmp6_cksum\">icmp6_cksum</a> = <a class=\"id\" href=\"#csum_ipv6_magic\">csum_ipv6_magic</a>(&amp;<a class=\"id\" href=\"#saddr_buf\">saddr_buf</a>, &amp;<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#IPPROTO_ICMPV6\">IPPROTO_ICMPV6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#csum_partial\">csum_partial</a>(<a class=\"id\" href=\"#icmph\">icmph</a>, <a class=\"id\" href=\"#len\">len</a>, 0));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_set\">skb_dst_set</a>(<a class=\"id\" href=\"#buff\">buff</a>, <a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#in6_dev_get\">in6_dev_get</a>(<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#IP6_UPD_PO_STATS\">IP6_UPD_PO_STATS</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#idev\">idev</a>, <a class=\"id\" href=\"#IPSTATS_MIB_OUT\">IPSTATS_MIB_OUT</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#NF_HOOK\">NF_HOOK</a>(<a class=\"id\" href=\"#NFPROTO_IPV6\">NFPROTO_IPV6</a>, <a class=\"id\" href=\"#NF_INET_LOCAL_OUT\">NF_INET_LOCAL_OUT</a>, <a class=\"id\" href=\"#buff\">buff</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#dst_output\">dst_output</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ICMP6MSGOUT_INC_STATS\">ICMP6MSGOUT_INC_STATS</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#idev\">idev</a>, <a class=\"id\" href=\"#NDISC_REDIRECT\">NDISC_REDIRECT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ICMP6_INC_STATS\">ICMP6_INC_STATS</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#idev\">idev</a>, <a class=\"id\" href=\"#ICMP6_MIB_OUTMSGS\">ICMP6_MIB_OUTMSGS</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#idev\">idev</a> != <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/>return;", 
"", 
"<a class=\"id\" href=\"#release\">release</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst_release\">dst_release</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#pndisc_redo\">pndisc_redo</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndisc_recv_ns\">ndisc_recv_ns</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#ndisc_rcv\">ndisc_rcv</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nd_msg\">nd_msg</a> *<a class=\"id\" href=\"#msg\">msg</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pskb_may_pull\">pskb_may_pull</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a> = (struct <a class=\"id\" href=\"#nd_msg\">nd_msg</a> *)<a class=\"id\" href=\"#skb_transport_header\">skb_transport_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__skb_push\">__skb_push</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> - <a class=\"id\" href=\"#skb_transport_header\">skb_transport_header</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#hop_limit\">hop_limit</a> != 255) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NDISC: invalid hop-limit: %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#hop_limit\">hop_limit</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_code\">icmp6_code</a> != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK2\">ND_PRINTK2</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NDISC: invalid ICMPv6 code: %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_code\">icmp6_code</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#NEIGH_CB\">NEIGH_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>), 0, sizeof(struct <a class=\"id\" href=\"#neighbour_cb\">neighbour_cb</a>));", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#icmph\">icmph</a>.<a class=\"id\" href=\"#icmp6_type\">icmp6_type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NDISC_NEIGHBOUR_SOLICITATION\">NDISC_NEIGHBOUR_SOLICITATION</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ndisc_recv_ns\">ndisc_recv_ns</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NDISC_NEIGHBOUR_ADVERTISEMENT\">NDISC_NEIGHBOUR_ADVERTISEMENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ndisc_recv_na\">ndisc_recv_na</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NDISC_ROUTER_SOLICITATION\">NDISC_ROUTER_SOLICITATION</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ndisc_recv_rs\">ndisc_recv_rs</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NDISC_ROUTER_ADVERTISEMENT\">NDISC_ROUTER_ADVERTISEMENT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ndisc_router_discovery\">ndisc_router_discovery</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NDISC_REDIRECT\">NDISC_REDIRECT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ndisc_redirect_rcv\">ndisc_redirect_rcv</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#ndisc_netdev_event\">ndisc_netdev_event</a>(struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> *<a class=\"id\" href=\"#this\">this</a>, unsigned long <a class=\"id\" href=\"#event\">event</a>, void *<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#event\">event</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_CHANGEADDR\">NETDEV_CHANGEADDR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_changeaddr\">neigh_changeaddr</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib6_run_gc\">fib6_run_gc</a>(~0UL, <a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_DOWN\">NETDEV_DOWN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_ifdown\">neigh_ifdown</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib6_run_gc\">fib6_run_gc</a>(~0UL, <a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> <a class=\"id\" href=\"#ndisc_netdev_notifier\">ndisc_netdev_notifier</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#notifier_call\">notifier_call</a> = <a class=\"id\" href=\"#ndisc_netdev_event\">ndisc_netdev_event</a>,", 
"};", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SYSCTL\">CONFIG_SYSCTL</a>", 
"static void <a class=\"id\" href=\"#ndisc_warn_deprecated_sysctl\">ndisc_warn_deprecated_sysctl</a>(struct <a class=\"id\" href=\"#ctl_table\">ctl_table</a> *<a class=\"id\" href=\"#ctl\">ctl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const char *<a class=\"id\" href=\"#func\">func</a>, const char *<a class=\"id\" href=\"#dev_name\">dev_name</a>)", 
"{", 
"<span class=\"ts\"/>static char <a class=\"id\" href=\"#warncomm\">warncomm</a>[<a class=\"id\" href=\"#TASK_COMM_LEN\">TASK_COMM_LEN</a>];", 
"<span class=\"ts\"/>static int <a class=\"id\" href=\"#warned\">warned</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#warncomm\">warncomm</a>, <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#comm\">comm</a>) && <a class=\"id\" href=\"#warned\">warned</a> &lt; 5) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#warncomm\">warncomm</a>, <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#comm\">comm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"process `%s' is using deprecated sysctl (%s) \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"net.ipv6.neigh.%s.%s; \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"Use net.ipv6.neigh.%s.%s_ms \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"instead.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#warncomm\">warncomm</a>, <a class=\"id\" href=\"#func\">func</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_name\">dev_name</a>, <a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_name\">dev_name</a>, <a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#warned\">warned</a>++;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"int <a class=\"id\" href=\"#ndisc_ifinfo_sysctl_change\">ndisc_ifinfo_sysctl_change</a>(struct <a class=\"id\" href=\"#ctl_table\">ctl_table</a> *<a class=\"id\" href=\"#ctl\">ctl</a>, int <a class=\"id\" href=\"#write\">write</a>, void <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#buffer\">buffer</a>, <a class=\"id\" href=\"#size_t\">size_t</a> *<a class=\"id\" href=\"#lenp\">lenp</a>, <a class=\"id\" href=\"#loff_t\">loff_t</a> *<a class=\"id\" href=\"#ppos\">ppos</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#extra1\">extra1</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet6_dev\">inet6_dev</a> *<a class=\"id\" href=\"#idev\">idev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>, \"retrans_time\") == 0) ||", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>, \"base_reachable_time\") == 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ndisc_warn_deprecated_sysctl\">ndisc_warn_deprecated_sysctl</a>(<a class=\"id\" href=\"#ctl\">ctl</a>, \"syscall\", <a class=\"id\" href=\"#dev\">dev</a> ? <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a> : \"default\");", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>, \"retrans_time\") == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#proc_dointvec\">proc_dointvec</a>(<a class=\"id\" href=\"#ctl\">ctl</a>, <a class=\"id\" href=\"#write\">write</a>, <a class=\"id\" href=\"#buffer\">buffer</a>, <a class=\"id\" href=\"#lenp\">lenp</a>, <a class=\"id\" href=\"#ppos\">ppos</a>);", 
"", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>, \"base_reachable_time\") == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#proc_dointvec_jiffies\">proc_dointvec_jiffies</a>(<a class=\"id\" href=\"#ctl\">ctl</a>, <a class=\"id\" href=\"#write\">write</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#buffer\">buffer</a>, <a class=\"id\" href=\"#lenp\">lenp</a>, <a class=\"id\" href=\"#ppos\">ppos</a>);", 
"", 
"<span class=\"ts\"/>else if ((<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>, \"retrans_time_ms\") == 0) ||", 
"<span class=\"ts\"/><span class=\"ts\"/> (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#procname\">procname</a>, \"base_reachable_time_ms\") == 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#proc_dointvec_ms_jiffies\">proc_dointvec_ms_jiffies</a>(<a class=\"id\" href=\"#ctl\">ctl</a>, <a class=\"id\" href=\"#write\">write</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#buffer\">buffer</a>, <a class=\"id\" href=\"#lenp\">lenp</a>, <a class=\"id\" href=\"#ppos\">ppos</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -1;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#write\">write</a> && <a class=\"id\" href=\"#ret\">ret</a> == 0 && <a class=\"id\" href=\"#dev\">dev</a> && (<a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#in6_dev_get\">in6_dev_get</a>(<a class=\"id\" href=\"#dev\">dev</a>)) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ctl\">ctl</a>-><a class=\"id\" href=\"#data\">data</a> == &amp;<a class=\"id\" href=\"#idev\">idev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#base_reachable_time\">base_reachable_time</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idev\">idev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#reachable_time\">reachable_time</a> = <a class=\"id\" href=\"#neigh_rand_reach_time\">neigh_rand_reach_time</a>(<a class=\"id\" href=\"#idev\">idev</a>-><a class=\"id\" href=\"#nd_parms\">nd_parms</a>-><a class=\"id\" href=\"#base_reachable_time\">base_reachable_time</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idev\">idev</a>-><a class=\"id\" href=\"#tstamp\">tstamp</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet6_ifinfo_notify\">inet6_ifinfo_notify</a>(<a class=\"id\" href=\"#RTM_NEWLINK\">RTM_NEWLINK</a>, <a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in6_dev_put\">in6_dev_put</a>(<a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#ndisc_net_init\">ndisc_net_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipv6_pinfo\">ipv6_pinfo</a> *<a class=\"id\" href=\"#np\">np</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#inet_ctl_sock_create\">inet_ctl_sock_create</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#SOCK_RAW\">SOCK_RAW</a>, <a class=\"id\" href=\"#IPPROTO_ICMPV6\">IPPROTO_ICMPV6</a>, <a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ND_PRINTK0\">ND_PRINTK0</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"ICMPv6 NDISC: Failed to initialize the control socket (err %d).\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#ndisc_sk\">ndisc_sk</a> = <a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#np\">np</a> = <a class=\"id\" href=\"#inet6_sk\">inet6_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#np\">np</a>-><a class=\"id\" href=\"#hop_limit\">hop_limit</a> = 255;", 
"<span class=\"ts\"/><span class=\"comment\">/* Do not loopback ndisc messages */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#np\">np</a>-><a class=\"id\" href=\"#mc_loop\">mc_loop</a> = 0;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__net_exit\">__net_exit</a> <a class=\"id\" href=\"#ndisc_net_exit\">ndisc_net_exit</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inet_ctl_sock_destroy\">inet_ctl_sock_destroy</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#ndisc_sk\">ndisc_sk</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#pernet_operations\">pernet_operations</a> <a class=\"id\" href=\"#ndisc_net_ops\">ndisc_net_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#init\">init</a> = <a class=\"id\" href=\"#ndisc_net_init\">ndisc_net_init</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#exit\">exit</a> = <a class=\"id\" href=\"#ndisc_net_exit\">ndisc_net_exit</a>,", 
"};", 
"", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#ndisc_init\">ndisc_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#register_pernet_subsys\">register_pernet_subsys</a>(&amp;<a class=\"id\" href=\"#ndisc_net_ops\">ndisc_net_ops</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Initialize the neighbour table</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#neigh_table_init\">neigh_table_init</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SYSCTL\">CONFIG_SYSCTL</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#neigh_sysctl_register\">neigh_sysctl_register</a>(<a class=\"id\" href=\"#NULL\">NULL</a>, &amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>.<a class=\"id\" href=\"#parms\">parms</a>, \"ipv6\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#ndisc_ifinfo_sysctl_change\">ndisc_ifinfo_sysctl_change</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unregister_pernet\">out_unregister_pernet</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#register_netdevice_notifier\">register_netdevice_notifier</a>(&amp;<a class=\"id\" href=\"#ndisc_netdev_notifier\">ndisc_netdev_notifier</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unregister_sysctl\">out_unregister_sysctl</a>;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<a class=\"id\" href=\"#out_unregister_sysctl\">out_unregister_sysctl</a>:", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SYSCTL\">CONFIG_SYSCTL</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#neigh_sysctl_unregister\">neigh_sysctl_unregister</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>.<a class=\"id\" href=\"#parms\">parms</a>);", 
"<a class=\"id\" href=\"#out_unregister_pernet\">out_unregister_pernet</a>:", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unregister_pernet_subsys\">unregister_pernet_subsys</a>(&amp;<a class=\"id\" href=\"#ndisc_net_ops\">ndisc_net_ops</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#ndisc_cleanup\">ndisc_cleanup</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unregister_netdevice_notifier\">unregister_netdevice_notifier</a>(&amp;<a class=\"id\" href=\"#ndisc_netdev_notifier\">ndisc_netdev_notifier</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SYSCTL\">CONFIG_SYSCTL</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#neigh_sysctl_unregister\">neigh_sysctl_unregister</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>.<a class=\"id\" href=\"#parms\">parms</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#neigh_table_clear\">neigh_table_clear</a>(&amp;<a class=\"id\" href=\"#nd_tbl\">nd_tbl</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unregister_pernet_subsys\">unregister_pernet_subsys</a>(&amp;<a class=\"id\" href=\"#ndisc_net_ops\">ndisc_net_ops</a>);", 
"}", 
];
xr_frag_insert('l/27/48bceaac73a13c0d0f9064dadb1ecb9bc20888.xr', __xr_tmp);
