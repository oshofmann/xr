var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * security/tomoyo/common.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Common functions for TOMOYO.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (C) 2005-2010  NTT DATA CORPORATION</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#security\">security</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"common.h\"", 
"", 
"static struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> <a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#learning\">learning</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#permissive\">permissive</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#enforcing\">enforcing</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#enforcing_verbose\">enforcing_verbose</a> = <a class=\"id\" href=\"#true\">true</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#learning_max_entry\">learning_max_entry</a> = 2048,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#learning_verbose\">learning_verbose</a> = <a class=\"id\" href=\"#false\">false</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#permissive_verbose\">permissive_verbose</a> = <a class=\"id\" href=\"#true\">true</a>", 
"};", 
"", 
"<span class=\"comment\">/* Profile version. Currently only 20090903 is defined. */</span>", 
"static unsigned int <a class=\"id\" href=\"#tomoyo_profile_version\">tomoyo_profile_version</a>;", 
"", 
"<span class=\"comment\">/* Profile table. Memory is allocated as needed. */</span>", 
"static struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#TOMOYO_MAX_PROFILES\">TOMOYO_MAX_PROFILES</a>];", 
"", 
"<span class=\"comment\">/* String table for functionality that takes 4 modes. */</span>", 
"static const char *<a class=\"id\" href=\"#tomoyo_mode\">tomoyo_mode</a>[4] = {", 
"<span class=\"ts\"/>\"disabled\", \"learning\", \"permissive\", \"enforcing\"", 
"};", 
"", 
"<span class=\"comment\">/* String table for /sys/kernel/security/tomoyo/profile */</span>", 
"static const char *<a class=\"id\" href=\"#tomoyo_mac_keywords\">tomoyo_mac_keywords</a>[<a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       + <a class=\"id\" href=\"#TOMOYO_MAX_MAC_CATEGORY_INDEX\">TOMOYO_MAX_MAC_CATEGORY_INDEX</a>] = {", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_EXECUTE\">TOMOYO_MAC_FILE_EXECUTE</a>]    = \"file::execute\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_OPEN\">TOMOYO_MAC_FILE_OPEN</a>]       = \"file::open\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_CREATE\">TOMOYO_MAC_FILE_CREATE</a>]     = \"file::create\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_UNLINK\">TOMOYO_MAC_FILE_UNLINK</a>]     = \"file::unlink\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_MKDIR\">TOMOYO_MAC_FILE_MKDIR</a>]      = \"file::mkdir\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_RMDIR\">TOMOYO_MAC_FILE_RMDIR</a>]      = \"file::rmdir\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_MKFIFO\">TOMOYO_MAC_FILE_MKFIFO</a>]     = \"file::mkfifo\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_MKSOCK\">TOMOYO_MAC_FILE_MKSOCK</a>]     = \"file::mksock\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_TRUNCATE\">TOMOYO_MAC_FILE_TRUNCATE</a>]   = \"file::truncate\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_SYMLINK\">TOMOYO_MAC_FILE_SYMLINK</a>]    = \"file::symlink\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_REWRITE\">TOMOYO_MAC_FILE_REWRITE</a>]    = \"file::rewrite\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_MKBLOCK\">TOMOYO_MAC_FILE_MKBLOCK</a>]    = \"file::mkblock\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_MKCHAR\">TOMOYO_MAC_FILE_MKCHAR</a>]     = \"file::mkchar\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_LINK\">TOMOYO_MAC_FILE_LINK</a>]       = \"file::link\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_RENAME\">TOMOYO_MAC_FILE_RENAME</a>]     = \"file::rename\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_CHMOD\">TOMOYO_MAC_FILE_CHMOD</a>]      = \"file::chmod\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_CHOWN\">TOMOYO_MAC_FILE_CHOWN</a>]      = \"file::chown\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_CHGRP\">TOMOYO_MAC_FILE_CHGRP</a>]      = \"file::chgrp\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_IOCTL\">TOMOYO_MAC_FILE_IOCTL</a>]      = \"file::ioctl\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_CHROOT\">TOMOYO_MAC_FILE_CHROOT</a>]     = \"file::chroot\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_MOUNT\">TOMOYO_MAC_FILE_MOUNT</a>]      = \"file::mount\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_UMOUNT\">TOMOYO_MAC_FILE_UMOUNT</a>]     = \"file::umount\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAC_FILE_PIVOT_ROOT\">TOMOYO_MAC_FILE_PIVOT_ROOT</a>] = \"file::pivot_root\",", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a> + <a class=\"id\" href=\"#TOMOYO_MAC_CATEGORY_FILE\">TOMOYO_MAC_CATEGORY_FILE</a>] = \"file\",", 
"};", 
"", 
"<span class=\"comment\">/* Permit policy management by non-root user? */</span>", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_manage_by_non_root\">tomoyo_manage_by_non_root</a>;", 
"", 
"<span class=\"comment\">/* Utility functions. */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_yesno - Return \"yes\" or \"no\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @value: Bool value.</span>", 
"<span class=\"comment\"> */</span>", 
"static const char *<a class=\"id\" href=\"#tomoyo_yesno\">tomoyo_yesno</a>(const unsigned int <a class=\"id\" href=\"#value\">value</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#value\">value</a> ? \"yes\" : \"no\";", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tomoyo_addprintf\">tomoyo_addprintf</a>(char *<a class=\"id\" href=\"#buffer\">buffer</a>, int <a class=\"id\" href=\"#len\">len</a>, const char *<a class=\"id\" href=\"#fmt\">fmt</a>, ...)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#va_list\">va_list</a> <a class=\"id\" href=\"#args\">args</a>;", 
"<span class=\"ts\"/>const int <a class=\"id\" href=\"#pos\">pos</a> = <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#buffer\">buffer</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#va_start\">va_start</a>(<a class=\"id\" href=\"#args\">args</a>, <a class=\"id\" href=\"#fmt\">fmt</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vsnprintf\">vsnprintf</a>(<a class=\"id\" href=\"#buffer\">buffer</a> + <a class=\"id\" href=\"#pos\">pos</a>, <a class=\"id\" href=\"#len\">len</a> - <a class=\"id\" href=\"#pos\">pos</a> - 1, <a class=\"id\" href=\"#fmt\">fmt</a>, <a class=\"id\" href=\"#args\">args</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#va_end\">va_end</a>(<a class=\"id\" href=\"#args\">args</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_flush - Flush queued string to userspace's buffer.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head:   Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns true if all data was flushed, false otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_flush\">tomoyo_flush</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>)", 
"{", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w_pos\">w_pos</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const char *<a class=\"id\" href=\"#w\">w</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w\">w</a>[0];", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#w\">w</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &gt; <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf_avail\">read_user_buf_avail</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf_avail\">read_user_buf_avail</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#len\">len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf\">read_user_buf</a>, <a class=\"id\" href=\"#w\">w</a>, <a class=\"id\" href=\"#len\">len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf_avail\">read_user_buf_avail</a> -= <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf\">read_user_buf</a> += <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#w\">w</a> += <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#w\">w</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w\">w</a>[0] = <a class=\"id\" href=\"#w\">w</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Add '\\0' for query. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#poll\">poll</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf_avail\">read_user_buf_avail</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf\">read_user_buf</a>, \"\", 1))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf_avail\">read_user_buf_avail</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_user_buf\">read_user_buf</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w_pos\">w_pos</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#len\">len</a> = 0; <a class=\"id\" href=\"#len\">len</a> &lt; <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w_pos\">w_pos</a>; <a class=\"id\" href=\"#len\">len</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w\">w</a>[<a class=\"id\" href=\"#len\">len</a>] = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w\">w</a>[<a class=\"id\" href=\"#len\">len</a> + 1];", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#avail\">avail</a> = 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#true\">true</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_set_string - Queue string to \"struct tomoyo_io_buffer\" structure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head:   Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> * @string: String to print.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Note that @string has to be kept valid until @head is kfree()d.</span>", 
"<span class=\"comment\"> * This means that char[] allocated on stack memory cannot be passed to</span>", 
"<span class=\"comment\"> * this function. Use tomoyo_io_printf() for char[] allocated on stack memory.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>, const char *<a class=\"id\" href=\"#string\">string</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w_pos\">w_pos</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_IO_READ_QUEUE\">TOMOYO_MAX_IO_READ_QUEUE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w\">w</a>[<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w_pos\">w_pos</a>++] = <a class=\"id\" href=\"#string\">string</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_flush\">tomoyo_flush</a>(<a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(1);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_io_printf - printf() to \"struct tomoyo_io_buffer\" structure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head: Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> * @fmt:  The printf()'s format string, followed by parameters.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>, const char *<a class=\"id\" href=\"#fmt\">fmt</a>, ...)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#va_list\">va_list</a> <a class=\"id\" href=\"#args\">args</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#pos\">pos</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#avail\">avail</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#size\">size</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#readbuf_size\">readbuf_size</a> - <a class=\"id\" href=\"#pos\">pos</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#size\">size</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#va_start\">va_start</a>(<a class=\"id\" href=\"#args\">args</a>, <a class=\"id\" href=\"#fmt\">fmt</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#vsnprintf\">vsnprintf</a>(<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_buf\">read_buf</a> + <a class=\"id\" href=\"#pos\">pos</a>, <a class=\"id\" href=\"#size\">size</a>, <a class=\"id\" href=\"#fmt\">fmt</a>, <a class=\"id\" href=\"#args\">args</a>) + 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#va_end\">va_end</a>(<a class=\"id\" href=\"#args\">args</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pos\">pos</a> + <a class=\"id\" href=\"#len\">len</a> >= <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#readbuf_size\">readbuf_size</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(1);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#avail\">avail</a> += <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#read_buf\">read_buf</a> + <a class=\"id\" href=\"#pos\">pos</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tomoyo_set_space\">tomoyo_set_space</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, \" \");", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_set_lf\">tomoyo_set_lf</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, \"\\n\");", 
"<span class=\"ts\"/>return !<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#w_pos\">w_pos</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_print_name_union - Print a tomoyo_name_union.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head: Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> * @ptr:  Pointer to \"struct tomoyo_name_union\".</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#tomoyo_print_name_union\">tomoyo_print_name_union</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const struct <a class=\"id\" href=\"#tomoyo_name_union\">tomoyo_name_union</a> *<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_space\">tomoyo_set_space</a>(<a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#is_group\">is_group</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, \"@\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#group\">group</a>-><a class=\"id\" href=\"#group_name\">group_name</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#filename\">filename</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_print_number_union - Print a tomoyo_number_union.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head:       Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> * @ptr:        Pointer to \"struct tomoyo_number_union\".</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#tomoyo_print_number_union\">tomoyo_print_number_union</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const struct <a class=\"id\" href=\"#tomoyo_number_union\">tomoyo_number_union</a> *<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_space\">tomoyo_set_space</a>(<a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#is_group\">is_group</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, \"@\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#group\">group</a>-><a class=\"id\" href=\"#group_name\">group_name</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#min\">min</a> = <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#values\">values</a>[0];", 
"<span class=\"ts\"/><span class=\"ts\"/>const unsigned long <a class=\"id\" href=\"#max\">max</a> = <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#values\">values</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#min_type\">min_type</a> = <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#min_type\">min_type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#max_type\">max_type</a> = <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#max_type\">max_type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>char <a class=\"id\" href=\"#buffer\">buffer</a>[128];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[0] = '\\0';", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; 2; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#min_type\">min_type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#TOMOYO_VALUE_TYPE_HEXADECIMAL\">TOMOYO_VALUE_TYPE_HEXADECIMAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_addprintf\">tomoyo_addprintf</a>(<a class=\"id\" href=\"#buffer\">buffer</a>, sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"0x%lX\", <a class=\"id\" href=\"#min\">min</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#TOMOYO_VALUE_TYPE_OCTAL\">TOMOYO_VALUE_TYPE_OCTAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_addprintf\">tomoyo_addprintf</a>(<a class=\"id\" href=\"#buffer\">buffer</a>, sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"0%lo\", <a class=\"id\" href=\"#min\">min</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_addprintf\">tomoyo_addprintf</a>(<a class=\"id\" href=\"#buffer\">buffer</a>, sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"%lu\", <a class=\"id\" href=\"#min\">min</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#min\">min</a> == <a class=\"id\" href=\"#max\">max</a> && <a class=\"id\" href=\"#min_type\">min_type</a> == <a class=\"id\" href=\"#max_type\">max_type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_addprintf\">tomoyo_addprintf</a>(<a class=\"id\" href=\"#buffer\">buffer</a>, sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>), \"-\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#min_type\">min_type</a> = <a class=\"id\" href=\"#max_type\">max_type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#min\">min</a> = <a class=\"id\" href=\"#max\">max</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"%s\", <a class=\"id\" href=\"#buffer\">buffer</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_assign_profile - Create a new profile.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @profile: Profile number to create.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns pointer to \"struct tomoyo_profile\" on success, NULL otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"static struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#tomoyo_assign_profile\">tomoyo_assign_profile</a>(const unsigned int <a class=\"id\" href=\"#profile\">profile</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#profile\">profile</a> >= <a class=\"id\" href=\"#TOMOYO_MAX_PROFILES\">TOMOYO_MAX_PROFILES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#profile\">profile</a>];", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#entry\">entry</a>), <a class=\"id\" href=\"#GFP_NOFS\">GFP_NOFS</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#mutex_lock_interruptible\">mutex_lock_interruptible</a>(&amp;<a class=\"id\" href=\"#tomoyo_policy_lock\">tomoyo_policy_lock</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#profile\">profile</a>];", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ptr\">ptr</a> && <a class=\"id\" href=\"#tomoyo_memory_ok\">tomoyo_memory_ok</a>(<a class=\"id\" href=\"#entry\">entry</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#learning\">learning</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#permissive\">permissive</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#enforcing\">enforcing</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#default_config\">default_config</a> = <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#config\">config</a>, <a class=\"id\" href=\"#TOMOYO_CONFIG_USE_DEFAULT\">TOMOYO_CONFIG_USE_DEFAULT</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       sizeof(<a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#config\">config</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mb\">mb</a>(); <span class=\"comment\">/* Avoid out-of-order execution. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#profile\">profile</a>] = <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#tomoyo_policy_lock\">tomoyo_policy_lock</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_profile - Find a profile.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @profile: Profile number to find.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns pointer to \"struct tomoyo_profile\".</span>", 
"<span class=\"comment\"> */</span>", 
"struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a>(const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#profile\">profile</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#profile\">profile</a>];", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_policy_loaded\">tomoyo_policy_loaded</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(!<a class=\"id\" href=\"#ptr\">ptr</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#s8\">s8</a> <a class=\"id\" href=\"#tomoyo_find_yesno\">tomoyo_find_yesno</a>(const char *<a class=\"id\" href=\"#string\">string</a>, const char *<a class=\"id\" href=\"#find\">find</a>)", 
"{", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#cp\">cp</a> = <a class=\"id\" href=\"#strstr\">strstr</a>(<a class=\"id\" href=\"#string\">string</a>, <a class=\"id\" href=\"#find\">find</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cp\">cp</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cp\">cp</a> += <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#find\">find</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#strncmp\">strncmp</a>(<a class=\"id\" href=\"#cp\">cp</a>, \"=yes\", 4))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (!<a class=\"id\" href=\"#strncmp\">strncmp</a>(<a class=\"id\" href=\"#cp\">cp</a>, \"=no\", 3))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -1;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tomoyo_set_bool\">tomoyo_set_bool</a>(<a class=\"id\" href=\"#bool\">bool</a> *<a class=\"id\" href=\"#b\">b</a>, const char *<a class=\"id\" href=\"#string\">string</a>, const char *<a class=\"id\" href=\"#find\">find</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#tomoyo_find_yesno\">tomoyo_find_yesno</a>(<a class=\"id\" href=\"#string\">string</a>, <a class=\"id\" href=\"#find\">find</a>)) {", 
"<span class=\"ts\"/>case 1:", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 0:", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tomoyo_set_uint\">tomoyo_set_uint</a>(unsigned int *<a class=\"id\" href=\"#i\">i</a>, const char *<a class=\"id\" href=\"#string\">string</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const char *<a class=\"id\" href=\"#find\">find</a>)", 
"{", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#cp\">cp</a> = <a class=\"id\" href=\"#strstr\">strstr</a>(<a class=\"id\" href=\"#string\">string</a>, <a class=\"id\" href=\"#find\">find</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cp\">cp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sscanf\">sscanf</a>(<a class=\"id\" href=\"#cp\">cp</a> + <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#find\">find</a>), \"=%u\", <a class=\"id\" href=\"#i\">i</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tomoyo_set_pref\">tomoyo_set_pref</a>(const char *<a class=\"id\" href=\"#name\">name</a>, const char *<a class=\"id\" href=\"#value\">value</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#use_default\">use_default</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#profile\">profile</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_preference\">tomoyo_preference</a> **<a class=\"id\" href=\"#pref\">pref</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> *<a class=\"id\" href=\"#verbose\">verbose</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#name\">name</a>, \"enforcing\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#use_default\">use_default</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#enforcing\">enforcing</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#set_default\">set_default</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#enforcing\">enforcing</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#verbose\">verbose</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#enforcing_verbose\">enforcing_verbose</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#set_verbose\">set_verbose</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#name\">name</a>, \"permissive\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#use_default\">use_default</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#permissive\">permissive</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#set_default\">set_default</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#permissive\">permissive</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#verbose\">verbose</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#permissive_verbose\">permissive_verbose</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#set_verbose\">set_verbose</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#name\">name</a>, \"learning\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#use_default\">use_default</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#learning\">learning</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#set_default\">set_default</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#learning\">learning</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_uint\">tomoyo_set_uint</a>(&amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#learning_max_entry\">learning_max_entry</a>, <a class=\"id\" href=\"#value\">value</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     \"max_entry\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#verbose\">verbose</a> = &amp;<a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#preference\">preference</a>.<a class=\"id\" href=\"#learning_verbose\">learning_verbose</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#set_verbose\">set_verbose</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return;", 
" <a class=\"id\" href=\"#set_default\">set_default</a>:", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#pref\">pref</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/>return;", 
" <a class=\"id\" href=\"#set_verbose\">set_verbose</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_bool\">tomoyo_set_bool</a>(<a class=\"id\" href=\"#verbose\">verbose</a>, <a class=\"id\" href=\"#value\">value</a>, \"verbose\");", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tomoyo_set_mode\">tomoyo_set_mode</a>(char *<a class=\"id\" href=\"#name\">name</a>, const char *<a class=\"id\" href=\"#value\">value</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   const <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#use_default\">use_default</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#profile\">profile</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#config\">config</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#name\">name</a>, \"CONFIG\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a> + <a class=\"id\" href=\"#TOMOYO_MAX_MAC_CATEGORY_INDEX\">TOMOYO_MAX_MAC_CATEGORY_INDEX</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#config\">config</a> = <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#default_config\">default_config</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#tomoyo_str_starts\">tomoyo_str_starts</a>(&amp;<a class=\"id\" href=\"#name\">name</a>, \"CONFIG::\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#config\">config</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     + <a class=\"id\" href=\"#TOMOYO_MAX_MAC_CATEGORY_INDEX\">TOMOYO_MAX_MAC_CATEGORY_INDEX</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#tomoyo_mac_keywords\">tomoyo_mac_keywords</a>[<a class=\"id\" href=\"#i\">i</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#config\">config</a> = <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#config\">config</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> == <a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a> + <a class=\"id\" href=\"#TOMOYO_MAX_MAC_CATEGORY_INDEX\">TOMOYO_MAX_MAC_CATEGORY_INDEX</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#use_default\">use_default</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#config\">config</a> = <a class=\"id\" href=\"#TOMOYO_CONFIG_USE_DEFAULT\">TOMOYO_CONFIG_USE_DEFAULT</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#mode\">mode</a> = 0; <a class=\"id\" href=\"#mode\">mode</a> &lt; 4; <a class=\"id\" href=\"#mode\">mode</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strstr\">strstr</a>(<a class=\"id\" href=\"#value\">value</a>, <a class=\"id\" href=\"#tomoyo_mode\">tomoyo_mode</a>[<a class=\"id\" href=\"#mode\">mode</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Update lower 3 bits in order to distinguish</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * 'config' from 'TOMOYO_CONFIG_USE_DEAFULT'.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#config\">config</a> = (<a class=\"id\" href=\"#config\">config</a> &amp; ~7) | <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a> + <a class=\"id\" href=\"#TOMOYO_MAX_MAC_CATEGORY_INDEX\">TOMOYO_MAX_MAC_CATEGORY_INDEX</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#config\">config</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#config\">config</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#config\">config</a> != <a class=\"id\" href=\"#TOMOYO_CONFIG_USE_DEFAULT\">TOMOYO_CONFIG_USE_DEFAULT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#default_config\">default_config</a> = <a class=\"id\" href=\"#config\">config</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_write_profile - Write profile table.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head: Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#tomoyo_write_profile\">tomoyo_write_profile</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>)", 
"{", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#write_buf\">write_buf</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#use_default\">use_default</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#cp\">cp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#profile\">profile</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sscanf\">sscanf</a>(<a class=\"id\" href=\"#data\">data</a>, \"PROFILE_VERSION=%u\", &amp;<a class=\"id\" href=\"#tomoyo_profile_version\">tomoyo_profile_version</a>) == 1)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#simple_strtoul\">simple_strtoul</a>(<a class=\"id\" href=\"#data\">data</a>, &amp;<a class=\"id\" href=\"#cp\">cp</a>, 10);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#data\">data</a> == <a class=\"id\" href=\"#cp\">cp</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#cp\">cp</a> != '-')", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#cp\">cp</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a> = <a class=\"id\" href=\"#tomoyo_assign_profile\">tomoyo_assign_profile</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#profile\">profile</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cp\">cp</a> = <a class=\"id\" href=\"#strchr\">strchr</a>(<a class=\"id\" href=\"#data\">data</a>, '=');", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#cp\">cp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#cp\">cp</a>++ = '\\0';", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#profile\">profile</a> != &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#use_default\">use_default</a> = <a class=\"id\" href=\"#strstr\">strstr</a>(<a class=\"id\" href=\"#cp\">cp</a>, \"use_default\") != <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_str_starts\">tomoyo_str_starts</a>(&amp;<a class=\"id\" href=\"#data\">data</a>, \"PREFERENCE::\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_pref\">tomoyo_set_pref</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#cp\">cp</a>, <a class=\"id\" href=\"#use_default\">use_default</a>, <a class=\"id\" href=\"#profile\">profile</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#profile\">profile</a> == &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#data\">data</a>, \"COMMENT\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> *<a class=\"id\" href=\"#old_comment\">old_comment</a> = <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#comment\">comment</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#comment\">comment</a> = <a class=\"id\" href=\"#tomoyo_get_name\">tomoyo_get_name</a>(<a class=\"id\" href=\"#cp\">cp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_name\">tomoyo_put_name</a>(<a class=\"id\" href=\"#old_comment\">old_comment</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_set_mode\">tomoyo_set_mode</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#cp\">cp</a>, <a class=\"id\" href=\"#use_default\">use_default</a>, <a class=\"id\" href=\"#profile\">profile</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tomoyo_print_preference\">tomoyo_print_preference</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const int <a class=\"id\" href=\"#idx\">idx</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_preference\">tomoyo_preference</a> *<a class=\"id\" href=\"#pref\">pref</a> = &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#profile\">profile</a> = <a class=\"id\" href=\"#idx\">idx</a> >= 0 ?", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#idx\">idx</a>] : <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#buffer\">buffer</a>[16] = \"\";", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#profile\">profile</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>) - 1] = '\\0';", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snprintf\">snprintf</a>(<a class=\"id\" href=\"#buffer\">buffer</a>, sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>) - 1, \"%u-\", <a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#profile\">profile</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#learning\">learning</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pref\">pref</a> == &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#skip1\">skip1</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"%sPREFERENCE::%s={ \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \"verbose=%s max_entry=%u }\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#buffer\">buffer</a>, \"learning\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tomoyo_yesno\">tomoyo_yesno</a>(<a class=\"id\" href=\"#pref\">pref</a>-><a class=\"id\" href=\"#learning_verbose\">learning_verbose</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pref\">pref</a>-><a class=\"id\" href=\"#learning_max_entry\">learning_max_entry</a>);", 
" <a class=\"id\" href=\"#skip1\">skip1</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#profile\">profile</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#permissive\">permissive</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pref\">pref</a> == &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#skip2\">skip2</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"%sPREFERENCE::%s={ verbose=%s }\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#buffer\">buffer</a>, \"permissive\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tomoyo_yesno\">tomoyo_yesno</a>(<a class=\"id\" href=\"#pref\">pref</a>-><a class=\"id\" href=\"#permissive_verbose\">permissive_verbose</a>));", 
" <a class=\"id\" href=\"#skip2\">skip2</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#profile\">profile</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pref\">pref</a> = <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#enforcing\">enforcing</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pref\">pref</a> == &amp;<a class=\"id\" href=\"#tomoyo_default_profile\">tomoyo_default_profile</a>.<a class=\"id\" href=\"#preference\">preference</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"%sPREFERENCE::%s={ verbose=%s }\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#buffer\">buffer</a>, \"enforcing\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tomoyo_yesno\">tomoyo_yesno</a>(<a class=\"id\" href=\"#pref\">pref</a>-><a class=\"id\" href=\"#enforcing_verbose\">enforcing_verbose</a>));", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tomoyo_print_config\">tomoyo_print_config</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>, const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#config\">config</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"={ mode=%s }\\n\", <a class=\"id\" href=\"#tomoyo_mode\">tomoyo_mode</a>[<a class=\"id\" href=\"#config\">config</a> &amp; 3]);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_read_profile - Read profile table.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head: Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#tomoyo_read_profile\">tomoyo_read_profile</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#index\">index</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_profile\">tomoyo_profile</a> *<a class=\"id\" href=\"#profile\">profile</a>;", 
" <a class=\"id\" href=\"#next\">next</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#index\">index</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#index\">index</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a> = <a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#index\">index</a>];", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#step\">step</a>) {", 
"<span class=\"ts\"/>case 0:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"PROFILE_VERSION=%s\\n\", \"20090903\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_print_preference\">tomoyo_print_preference</a>(<a class=\"id\" href=\"#head\">head</a>, -1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#step\">step</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 1:", 
"<span class=\"ts\"/><span class=\"ts\"/>for ( ; <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#index\">index</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_PROFILES\">TOMOYO_MAX_PROFILES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#index\">index</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_profile_ptr\">tomoyo_profile_ptr</a>[<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#index\">index</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#index\">index</a> == <a class=\"id\" href=\"#TOMOYO_MAX_PROFILES\">TOMOYO_MAX_PROFILES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#step\">step</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 2:", 
"<span class=\"ts\"/><span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> *<a class=\"id\" href=\"#comment\">comment</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#comment\">comment</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"%u-COMMENT=\", <a class=\"id\" href=\"#index\">index</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#comment\">comment</a> ? <a class=\"id\" href=\"#comment\">comment</a>-><a class=\"id\" href=\"#name\">name</a> : \"\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_lf\">tomoyo_set_lf</a>(<a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#step\">step</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 3:", 
"<span class=\"ts\"/><span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"%u-%s\", <a class=\"id\" href=\"#index\">index</a>, \"CONFIG\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_print_config\">tomoyo_print_config</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#default_config\">default_config</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#bit\">bit</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#step\">step</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 4:", 
"<span class=\"ts\"/><span class=\"ts\"/>for ( ; <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#bit\">bit</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      + <a class=\"id\" href=\"#TOMOYO_MAX_MAC_CATEGORY_INDEX\">TOMOYO_MAX_MAC_CATEGORY_INDEX</a>; <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#bit\">bit</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#bit\">bit</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#config\">config</a> = <a class=\"id\" href=\"#profile\">profile</a>-><a class=\"id\" href=\"#config\">config</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#config\">config</a> == <a class=\"id\" href=\"#TOMOYO_CONFIG_USE_DEFAULT\">TOMOYO_CONFIG_USE_DEFAULT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_io_printf\">tomoyo_io_printf</a>(<a class=\"id\" href=\"#head\">head</a>, \"%u-%s%s\", <a class=\"id\" href=\"#index\">index</a>, \"CONFIG::\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tomoyo_mac_keywords\">tomoyo_mac_keywords</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_print_config\">tomoyo_print_config</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#config\">config</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#bit\">bit</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#bit\">bit</a> == <a class=\"id\" href=\"#TOMOYO_MAX_MAC_INDEX\">TOMOYO_MAX_MAC_INDEX</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>    + <a class=\"id\" href=\"#TOMOYO_MAX_MAC_CATEGORY_INDEX\">TOMOYO_MAX_MAC_CATEGORY_INDEX</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_print_preference\">tomoyo_print_preference</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#index\">index</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#index\">index</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#step\">step</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_flush\">tomoyo_flush</a>(<a class=\"id\" href=\"#head\">head</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next\">next</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_same_manager\">tomoyo_same_manager</a>(const struct <a class=\"id\" href=\"#tomoyo_acl_head\">tomoyo_acl_head</a> *<a class=\"id\" href=\"#a\">a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_acl_head\">tomoyo_acl_head</a> *<a class=\"id\" href=\"#b\">b</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#a\">a</a>, struct <a class=\"id\" href=\"#tomoyo_manager\">tomoyo_manager</a>, <a class=\"id\" href=\"#head\">head</a>)-><a class=\"id\" href=\"#manager\">manager</a> ==", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#b\">b</a>, struct <a class=\"id\" href=\"#tomoyo_manager\">tomoyo_manager</a>, <a class=\"id\" href=\"#head\">head</a>)-><a class=\"id\" href=\"#manager\">manager</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_update_manager_entry - Add a manager entry.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @manager:   The path to manager or the domainnamme.</span>", 
"<span class=\"comment\"> * @is_delete: True if it is a delete request.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Caller holds tomoyo_read_lock().</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#tomoyo_update_manager_entry\">tomoyo_update_manager_entry</a>(const char *<a class=\"id\" href=\"#manager\">manager</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#is_delete\">is_delete</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_manager\">tomoyo_manager</a> <a class=\"id\" href=\"#e\">e</a> = { };", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_domain_def\">tomoyo_domain_def</a>(<a class=\"id\" href=\"#manager\">manager</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_correct_domain\">tomoyo_correct_domain</a>(<a class=\"id\" href=\"#manager\">manager</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#is_domain\">is_domain</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_correct_path\">tomoyo_correct_path</a>(<a class=\"id\" href=\"#manager\">manager</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#manager\">manager</a> = <a class=\"id\" href=\"#tomoyo_get_name\">tomoyo_get_name</a>(<a class=\"id\" href=\"#manager\">manager</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#manager\">manager</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_update_policy\">tomoyo_update_policy</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#head\">head</a>, sizeof(<a class=\"id\" href=\"#e\">e</a>), <a class=\"id\" href=\"#is_delete\">is_delete</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#tomoyo_policy_list\">tomoyo_policy_list</a>[<a class=\"id\" href=\"#TOMOYO_ID_MANAGER\">TOMOYO_ID_MANAGER</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#tomoyo_same_manager\">tomoyo_same_manager</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_name\">tomoyo_put_name</a>(<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#manager\">manager</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_write_manager - Write manager policy.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head: Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Caller holds tomoyo_read_lock().</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#tomoyo_write_manager\">tomoyo_write_manager</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>)", 
"{", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#write_buf\">write_buf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#is_delete\">is_delete</a> = <a class=\"id\" href=\"#tomoyo_str_starts\">tomoyo_str_starts</a>(&amp;<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#TOMOYO_KEYWORD_DELETE\">TOMOYO_KEYWORD_DELETE</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#data\">data</a>, \"manage_by_non_root\")) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_manage_by_non_root\">tomoyo_manage_by_non_root</a> = !<a class=\"id\" href=\"#is_delete\">is_delete</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_update_manager_entry\">tomoyo_update_manager_entry</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#is_delete\">is_delete</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_read_manager - Read manager policy.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @head: Pointer to \"struct tomoyo_io_buffer\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Caller holds tomoyo_read_lock().</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#tomoyo_read_manager\">tomoyo_read_manager</a>(struct <a class=\"id\" href=\"#tomoyo_io_buffer\">tomoyo_io_buffer</a> *<a class=\"id\" href=\"#head\">head</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#eof\">eof</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_cookie\">list_for_each_cookie</a>(<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#acl\">acl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#tomoyo_policy_list\">tomoyo_policy_list</a>[<a class=\"id\" href=\"#TOMOYO_ID_MANAGER\">TOMOYO_ID_MANAGER</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_manager\">tomoyo_manager</a> *<a class=\"id\" href=\"#ptr\">ptr</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_entry\">list_entry</a>(<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#acl\">acl</a>, <a class=\"id\" href=\"#typeof\">typeof</a>(*<a class=\"id\" href=\"#ptr\">ptr</a>), <a class=\"id\" href=\"#head\">head</a>.<a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#head\">head</a>.<a class=\"id\" href=\"#is_deleted\">is_deleted</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_flush\">tomoyo_flush</a>(<a class=\"id\" href=\"#head\">head</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_string\">tomoyo_set_string</a>(<a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#manager\">manager</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_set_lf\">tomoyo_set_lf</a>(<a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#eof\">eof</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_manager - Check whether the current process is a policy manager.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns true if the current process is permitted to modify policy</span>", 
"<span class=\"comment\"> * via /sys/kernel/security/tomoyo/ interface.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Caller holds tomoyo_read_lock().</span>", 
];
xr_frag_insert('l/27/954dd78fb465efc08f8554b071aadd42e3f0cc.xr', __xr_tmp);
