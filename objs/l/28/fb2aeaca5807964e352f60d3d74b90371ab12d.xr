var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#closing_wait\">closing_wait</a> != <a class=\"id\" href=\"#ASYNC_CLOSING_WAIT_NONE\">ASYNC_CLOSING_WAIT_NONE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tty_wait_until_sent\">tty_wait_until_sent</a>(<a class=\"id\" href=\"#tty\">tty</a>, <a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#closing_wait\">closing_wait</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#drain_delay\">drain_delay</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#bps\">bps</a> = <a class=\"id\" href=\"#tty_get_baud_rate\">tty_get_baud_rate</a>(<a class=\"id\" href=\"#tty\">tty</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#timeout\">timeout</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bps\">bps</a> &gt; 1200)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = <a class=\"id\" href=\"#max_t\">max_t</a>(long,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#HZ\">HZ</a> * 10 * <a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#drain_delay\">drain_delay</a>) / <a class=\"id\" href=\"#bps\">bps</a>, <a class=\"id\" href=\"#HZ\">HZ</a> / 10);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = 2 * <a class=\"id\" href=\"#HZ\">HZ</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule_timeout_interruptible\">schedule_timeout_interruptible</a>(<a class=\"id\" href=\"#timeout\">timeout</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"comment\">/* Flush the ldisc buffering */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tty_ldisc_flush\">tty_ldisc_flush</a>(<a class=\"id\" href=\"#tty\">tty</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Drop DTR/RTS if HUPCL is set. This causes any attached modem to</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   hang up the line */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tty\">tty</a>-><a class=\"id\" href=\"#termios\">termios</a>-><a class=\"id\" href=\"#c_cflag\">c_cflag</a> &amp; <a class=\"id\" href=\"#HUPCL\">HUPCL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tty_port_lower_dtr_rts\">tty_port_lower_dtr_rts</a>(<a class=\"id\" href=\"#port\">port</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Don't call port-&gt;drop for the last reference. Callers will want</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   to drop the last active reference in -&gt;shutdown() or the tty</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   shutdown path */</span>", 
"<span class=\"ts\"/>return 1;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#tty_port_close_start\">tty_port_close_start</a>);", 
"", 
"void <a class=\"id\" href=\"#tty_port_close_end\">tty_port_close_end</a>(struct <a class=\"id\" href=\"#tty_port\">tty_port</a> *<a class=\"id\" href=\"#port\">port</a>, struct <a class=\"id\" href=\"#tty_struct\">tty_struct</a> *<a class=\"id\" href=\"#tty\">tty</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tty\">tty</a>-><a class=\"id\" href=\"#closing\">closing</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#blocked_open\">blocked_open</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#close_delay\">close_delay</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msleep_interruptible\">msleep_interruptible</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#jiffies_to_msecs\">jiffies_to_msecs</a>(<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#close_delay\">close_delay</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up_interruptible\">wake_up_interruptible</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#open_wait\">open_wait</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~(<a class=\"id\" href=\"#ASYNC_NORMAL_ACTIVE\">ASYNC_NORMAL_ACTIVE</a> | <a class=\"id\" href=\"#ASYNC_CLOSING\">ASYNC_CLOSING</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up_interruptible\">wake_up_interruptible</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#close_wait\">close_wait</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#tty_port_close_end\">tty_port_close_end</a>);", 
"", 
"void <a class=\"id\" href=\"#tty_port_close\">tty_port_close</a>(struct <a class=\"id\" href=\"#tty_port\">tty_port</a> *<a class=\"id\" href=\"#port\">port</a>, struct <a class=\"id\" href=\"#tty_struct\">tty_struct</a> *<a class=\"id\" href=\"#tty\">tty</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tty_port_close_start\">tty_port_close_start</a>(<a class=\"id\" href=\"#port\">port</a>, <a class=\"id\" href=\"#tty\">tty</a>, <a class=\"id\" href=\"#filp\">filp</a>) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tty_port_shutdown\">tty_port_shutdown</a>(<a class=\"id\" href=\"#port\">port</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_bit\">set_bit</a>(<a class=\"id\" href=\"#TTY_IO_ERROR\">TTY_IO_ERROR</a>, &amp;<a class=\"id\" href=\"#tty\">tty</a>-><a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tty_port_close_end\">tty_port_close_end</a>(<a class=\"id\" href=\"#port\">port</a>, <a class=\"id\" href=\"#tty\">tty</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tty_port_tty_set\">tty_port_tty_set</a>(<a class=\"id\" href=\"#port\">port</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#tty_port_close\">tty_port_close</a>);", 
"", 
"int <a class=\"id\" href=\"#tty_port_open\">tty_port_open</a>(struct <a class=\"id\" href=\"#tty_port\">tty_port</a> *<a class=\"id\" href=\"#port\">port</a>, struct <a class=\"id\" href=\"#tty_struct\">tty_struct</a> *<a class=\"id\" href=\"#tty\">tty</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tty_hung_up_p\">tty_hung_up_p</a>(<a class=\"id\" href=\"#filp\">filp</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tty_port_tty_set\">tty_port_tty_set</a>(<a class=\"id\" href=\"#port\">port</a>, <a class=\"id\" href=\"#tty\">tty</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Do the device-specific open only if the hardware isn't</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * already initialized. Serialize open and shutdown using the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * port mutex.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#mutex\">mutex</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#ASYNCB_INITIALIZED\">ASYNCB_INITIALIZED</a>, &amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#flags\">flags</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_bit\">clear_bit</a>(<a class=\"id\" href=\"#TTY_IO_ERROR\">TTY_IO_ERROR</a>, &amp;<a class=\"id\" href=\"#tty\">tty</a>-><a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#activate\">activate</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#activate\">activate</a>(<a class=\"id\" href=\"#port\">port</a>, <a class=\"id\" href=\"#tty\">tty</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#mutex\">mutex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_bit\">set_bit</a>(<a class=\"id\" href=\"#ASYNCB_INITIALIZED\">ASYNCB_INITIALIZED</a>, &amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#mutex\">mutex</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tty_port_block_til_ready\">tty_port_block_til_ready</a>(<a class=\"id\" href=\"#port\">port</a>, <a class=\"id\" href=\"#tty\">tty</a>, <a class=\"id\" href=\"#filp\">filp</a>);", 
"}", 
"", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#tty_port_open\">tty_port_open</a>);", 
];
xr_frag_insert('l/28/fb2aeaca5807964e352f60d3d74b90371ab12d.xr', __xr_tmp);
