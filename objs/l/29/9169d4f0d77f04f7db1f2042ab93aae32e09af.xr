var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * xfrm_policy.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Changes:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Mitsuru KANDA @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>Kazunori MIYAZAWA @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>Kunihiro Ishiguro &lt;kunihiro@ipinfusion.com&gt;</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/><span class=\"ts\"/>IPv6 support</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>Kazunori MIYAZAWA @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>YOSHIFUJI Hideaki</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/><span class=\"ts\"/>Split up af-specific portion</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Derek Atkins &lt;derek@ihtfp.com&gt;<span class=\"ts\"/><span class=\"ts\"/>Add the post_input processor</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#err\">err</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kmod\">kmod</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#spinlock\">spinlock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#workqueue\">workqueue</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#notifier\">notifier</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netfilter\">netfilter</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#cache\">cache</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#audit\">audit</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_XFRM_STATISTICS\">CONFIG_XFRM_STATISTICS</a>", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#snmp\">snmp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> \"xfrm_hash.h\"", 
"", 
"<a class=\"id\" href=\"#DEFINE_MUTEX\">DEFINE_MUTEX</a>(<a class=\"id\" href=\"#xfrm_cfg_mutex\">xfrm_cfg_mutex</a>);", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_cfg_mutex\">xfrm_cfg_mutex</a>);", 
"", 
"static <a class=\"id\" href=\"#DEFINE_SPINLOCK\">DEFINE_SPINLOCK</a>(<a class=\"id\" href=\"#xfrm_policy_sk_bundle_lock\">xfrm_policy_sk_bundle_lock</a>);", 
"static struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#xfrm_policy_sk_bundles\">xfrm_policy_sk_bundles</a>;", 
"static <a class=\"id\" href=\"#DEFINE_RWLOCK\">DEFINE_RWLOCK</a>(<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"static <a class=\"id\" href=\"#DEFINE_RWLOCK\">DEFINE_RWLOCK</a>(<a class=\"id\" href=\"#xfrm_policy_afinfo_lock\">xfrm_policy_afinfo_lock</a>);", 
"static struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a>[<a class=\"id\" href=\"#NPROTO\">NPROTO</a>];", 
"", 
"static struct <a class=\"id\" href=\"#kmem_cache\">kmem_cache</a> *<a class=\"id\" href=\"#xfrm_dst_cache\">xfrm_dst_cache</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a>;", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#xfrm_policy_get_afinfo\">xfrm_policy_get_afinfo</a>(unsigned short <a class=\"id\" href=\"#family\">family</a>);", 
"static void <a class=\"id\" href=\"#xfrm_policy_put_afinfo\">xfrm_policy_put_afinfo</a>(struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"static void <a class=\"id\" href=\"#xfrm_init_pmtu\">xfrm_init_pmtu</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>);", 
"static int <a class=\"id\" href=\"#stale_bundle\">stale_bundle</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>);", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#dir\">dir</a>);", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#__xfrm4_selector_match\">__xfrm4_selector_match</a>(struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>)", 
"{", 
"<span class=\"ts\"/>return  <a class=\"id\" href=\"#addr_match\">addr_match</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>, &amp;<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#prefixlen_d\">prefixlen_d</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr_match\">addr_match</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>, &amp;<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#prefixlen_s\">prefixlen_s</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>!((<a class=\"id\" href=\"#xfrm_flowi_dport\">xfrm_flowi_dport</a>(<a class=\"id\" href=\"#fl\">fl</a>) ^ <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#dport\">dport</a>) &amp; <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#dport_mask\">dport_mask</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>!((<a class=\"id\" href=\"#xfrm_flowi_sport\">xfrm_flowi_sport</a>(<a class=\"id\" href=\"#fl\">fl</a>) ^ <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#sport\">sport</a>) &amp; <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#sport_mask\">sport_mask</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#proto\">proto</a> == <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#proto\">proto</a> || !<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#proto\">proto</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#oif\">oif</a> == <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> || !<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#__xfrm6_selector_match\">__xfrm6_selector_match</a>(struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>)", 
"{", 
"<span class=\"ts\"/>return  <a class=\"id\" href=\"#addr_match\">addr_match</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl6_dst\">fl6_dst</a>, &amp;<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#prefixlen_d\">prefixlen_d</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr_match\">addr_match</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl6_src\">fl6_src</a>, &amp;<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#prefixlen_s\">prefixlen_s</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>!((<a class=\"id\" href=\"#xfrm_flowi_dport\">xfrm_flowi_dport</a>(<a class=\"id\" href=\"#fl\">fl</a>) ^ <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#dport\">dport</a>) &amp; <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#dport_mask\">dport_mask</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>!((<a class=\"id\" href=\"#xfrm_flowi_sport\">xfrm_flowi_sport</a>(<a class=\"id\" href=\"#fl\">fl</a>) ^ <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#sport\">sport</a>) &amp; <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#sport_mask\">sport_mask</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#proto\">proto</a> == <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#proto\">proto</a> || !<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#proto\">proto</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#oif\">oif</a> == <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> || !<a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#xfrm_selector_match\">xfrm_selector_match</a>(struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET\">AF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#__xfrm4_selector_match\">__xfrm4_selector_match</a>(<a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#fl\">fl</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#__xfrm6_selector_match\">__xfrm6_selector_match</a>(<a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#fl\">fl</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#__xfrm_dst_lookup\">__xfrm_dst_lookup</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#tos\">tos</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_policy_get_afinfo\">xfrm_policy_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#dst_lookup\">dst_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#tos\">tos</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_put_afinfo\">xfrm_policy_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#dst\">dst</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#xfrm_dst_lookup\">xfrm_dst_lookup</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#tos\">tos</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#prev_saddr\">prev_saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#prev_daddr\">prev_daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a> = &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a> = &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_TYPE_LOCAL_COADDR\">XFRM_TYPE_LOCAL_COADDR</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#prev_daddr\">prev_daddr</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_TYPE_REMOTE_COADDR\">XFRM_TYPE_REMOTE_COADDR</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#prev_saddr\">prev_saddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#__xfrm_dst_lookup\">__xfrm_dst_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#tos\">tos</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#dst\">dst</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev_saddr\">prev_saddr</a> != <a class=\"id\" href=\"#saddr\">saddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#prev_saddr\">prev_saddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>,  sizeof(*<a class=\"id\" href=\"#prev_saddr\">prev_saddr</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev_daddr\">prev_daddr</a> != <a class=\"id\" href=\"#daddr\">daddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#prev_daddr\">prev_daddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>,  sizeof(*<a class=\"id\" href=\"#prev_daddr\">prev_daddr</a>));", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#dst\">dst</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned long <a class=\"id\" href=\"#make_jiffies\">make_jiffies</a>(long <a class=\"id\" href=\"#secs\">secs</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secs\">secs</a> >= (<a class=\"id\" href=\"#MAX_SCHEDULE_TIMEOUT\">MAX_SCHEDULE_TIMEOUT</a>-1)/<a class=\"id\" href=\"#HZ\">HZ</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#MAX_SCHEDULE_TIMEOUT\">MAX_SCHEDULE_TIMEOUT</a>-1;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#secs\">secs</a>*<a class=\"id\" href=\"#HZ\">HZ</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_policy_timer\">xfrm_policy_timer</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#xp\">xp</a> = (struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a>*)<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#now\">now</a> = <a class=\"id\" href=\"#get_seconds\">get_seconds</a>();", 
"<span class=\"ts\"/>long <a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#LONG_MAX\">LONG_MAX</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#warn\">warn</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#dir\">dir</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#dead\">dead</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dir\">dir</a> = <a class=\"id\" href=\"#xfrm_policy_id2dir\">xfrm_policy_id2dir</a>(<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#index\">index</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_add_expires_seconds\">hard_add_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_add_expires_seconds\">hard_add_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#expired\">expired</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_use_expires_seconds\">hard_use_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_use_expires_seconds\">hard_use_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a> ? : <a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a>) - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#expired\">expired</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_add_expires_seconds\">soft_add_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_add_expires_seconds\">soft_add_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#warn\">warn</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#XFRM_KM_TIMEOUT\">XFRM_KM_TIMEOUT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_use_expires_seconds\">soft_use_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_use_expires_seconds\">soft_use_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a> ? : <a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a>) - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#warn\">warn</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#XFRM_KM_TIMEOUT\">XFRM_KM_TIMEOUT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#warn\">warn</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#km_policy_expired\">km_policy_expired</a>(<a class=\"id\" href=\"#xp\">xp</a>, <a class=\"id\" href=\"#dir\">dir</a>, 0, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#next\">next</a> != <a class=\"id\" href=\"#LONG_MAX\">LONG_MAX</a> &&", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#timer\">timer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a> + <a class=\"id\" href=\"#make_jiffies\">make_jiffies</a>(<a class=\"id\" href=\"#next\">next</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#xp\">xp</a>);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#xp\">xp</a>);", 
"<span class=\"ts\"/>return;", 
"", 
"<a class=\"id\" href=\"#expired\">expired</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xp\">xp</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#xfrm_policy_delete\">xfrm_policy_delete</a>(<a class=\"id\" href=\"#xp\">xp</a>, <a class=\"id\" href=\"#dir\">dir</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#km_policy_expired\">km_policy_expired</a>(<a class=\"id\" href=\"#xp\">xp</a>, <a class=\"id\" href=\"#dir\">dir</a>, 1, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#xp\">xp</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#xfrm_policy_flo_get\">xfrm_policy_flo_get</a>(struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#flo\">flo</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#flo\">flo</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a>, <a class=\"id\" href=\"#flo\">flo</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#dead\">dead</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flo\">flo</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#flo\">flo</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#xfrm_policy_flo_check\">xfrm_policy_flo_check</a>(struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#flo\">flo</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#flo\">flo</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a>, <a class=\"id\" href=\"#flo\">flo</a>);", 
"", 
"<span class=\"ts\"/>return !<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#dead\">dead</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_policy_flo_delete\">xfrm_policy_flo_delete</a>(struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#flo\">flo</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#flo\">flo</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a>, <a class=\"id\" href=\"#flo\">flo</a>));", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#flow_cache_ops\">flow_cache_ops</a> <a class=\"id\" href=\"#xfrm_policy_fc_ops\">xfrm_policy_fc_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get\">get</a> = <a class=\"id\" href=\"#xfrm_policy_flo_get\">xfrm_policy_flo_get</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#check\">check</a> = <a class=\"id\" href=\"#xfrm_policy_flo_check\">xfrm_policy_flo_check</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#delete\">delete</a> = <a class=\"id\" href=\"#xfrm_policy_flo_delete\">xfrm_policy_flo_delete</a>,", 
"};", 
"", 
"<span class=\"comment\">/* Allocate xfrm_policy. Not used here, it is supposed to be used by pfkeyv2</span>", 
"<span class=\"comment\"> * SPD calls.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#xfrm_policy_alloc\">xfrm_policy_alloc</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#gfp_t\">gfp_t</a> <a class=\"id\" href=\"#gfp\">gfp</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#policy\">policy</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a>), <a class=\"id\" href=\"#gfp\">gfp</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#policy\">policy</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_pnet\">write_pnet</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#xp_net\">xp_net</a>, <a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_NODE\">INIT_HLIST_NODE</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#bydst\">bydst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_NODE\">INIT_HLIST_NODE</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#byidx\">byidx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rwlock_init\">rwlock_init</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#setup_timer\">setup_timer</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#timer\">timer</a>, <a class=\"id\" href=\"#xfrm_policy_timer\">xfrm_policy_timer</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned long)<a class=\"id\" href=\"#policy\">policy</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#flo\">flo</a>.<a class=\"id\" href=\"#ops\">ops</a> = &amp;<a class=\"id\" href=\"#xfrm_policy_fc_ops\">xfrm_policy_fc_ops</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#policy\">policy</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_alloc\">xfrm_policy_alloc</a>);", 
"", 
"<span class=\"comment\">/* Destroy xfrm_policy: descendant resources must be released to this moment. */</span>", 
"", 
"void <a class=\"id\" href=\"#xfrm_policy_destroy\">xfrm_policy_destroy</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#policy\">policy</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(!<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#dead\">dead</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#del_timer\">del_timer</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#timer\">timer</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_xfrm_policy_free\">security_xfrm_policy_free</a>(<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#security\">security</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_destroy\">xfrm_policy_destroy</a>);", 
"", 
"<span class=\"comment\">/* Rule must be locked. Release descentant resources, announce</span>", 
"<span class=\"comment\"> * entry dead. The rule must be unlinked from lists to the moment.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#policy\">policy</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#dead\">dead</a> = 1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#genid\">genid</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#del_timer\">del_timer</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#timer\">timer</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"}", 
"", 
"static unsigned int <a class=\"id\" href=\"#xfrm_policy_hashmax\">xfrm_policy_hashmax</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = 1 * 1024 * 1024;", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned int <a class=\"id\" href=\"#idx_hash\">idx_hash</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#index\">index</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__idx_hash\">__idx_hash</a>(<a class=\"id\" href=\"#index\">index</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_idx_hmask\">policy_idx_hmask</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#policy_hash_bysel\">policy_hash_bysel</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hmask\">hmask</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#hmask\">hmask</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#__sel_hash\">__sel_hash</a>(<a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#hmask\">hmask</a>);", 
"", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#hash\">hash</a> == <a class=\"id\" href=\"#hmask\">hmask</a> + 1 ?", 
"<span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_inexact\">policy_inexact</a>[<a class=\"id\" href=\"#dir\">dir</a>] :", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#table\">table</a> + <a class=\"id\" href=\"#hash\">hash</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#policy_hash_direct\">policy_hash_direct</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hmask\">hmask</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#hmask\">hmask</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#__addr_hash\">__addr_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#hmask\">hmask</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#table\">table</a> + <a class=\"id\" href=\"#hash\">hash</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_dst_hash_transfer\">xfrm_dst_hash_transfer</a>(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#list\">list</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#ndsttable\">ndsttable</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   unsigned int <a class=\"id\" href=\"#nhashmask\">nhashmask</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>, *<a class=\"id\" href=\"#entry0\">entry0</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h0\">h0</a> = 0;", 
"", 
"<a class=\"id\" href=\"#redo\">redo</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry_safe\">hlist_for_each_entry_safe</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#__addr_hash\">__addr_hash</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#selector\">selector</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#selector\">selector</a>.<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#entry0\">entry0</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#bydst\">bydst</a>, <a class=\"id\" href=\"#ndsttable\">ndsttable</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h0\">h0</a> = <a class=\"id\" href=\"#h\">h</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#h\">h</a> != <a class=\"id\" href=\"#h0\">h0</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_after\">hlist_add_after</a>(<a class=\"id\" href=\"#entry0\">entry0</a>, &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#bydst\">bydst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry0\">entry0</a> = <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#hlist_empty\">hlist_empty</a>(<a class=\"id\" href=\"#list\">list</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry0\">entry0</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#redo\">redo</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_idx_hash_transfer\">xfrm_idx_hash_transfer</a>(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#list\">list</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#nidxtable\">nidxtable</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   unsigned int <a class=\"id\" href=\"#nhashmask\">nhashmask</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry_safe\">hlist_for_each_entry_safe</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#byidx\">byidx</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#__idx_hash\">__idx_hash</a>(<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#index\">index</a>, <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#byidx\">byidx</a>, <a class=\"id\" href=\"#nidxtable\">nidxtable</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static unsigned long <a class=\"id\" href=\"#xfrm_new_hash_mask\">xfrm_new_hash_mask</a>(unsigned int <a class=\"id\" href=\"#old_hmask\">old_hmask</a>)", 
"{", 
"<span class=\"ts\"/>return ((<a class=\"id\" href=\"#old_hmask\">old_hmask</a> + 1) << 1) - 1;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_bydst_resize\">xfrm_bydst_resize</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hmask\">hmask</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#hmask\">hmask</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#nhashmask\">nhashmask</a> = <a class=\"id\" href=\"#xfrm_new_hash_mask\">xfrm_new_hash_mask</a>(<a class=\"id\" href=\"#hmask\">hmask</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#nsize\">nsize</a> = (<a class=\"id\" href=\"#nhashmask\">nhashmask</a> + 1) * sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#odst\">odst</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#table\">table</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#ndst\">ndst</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ndst\">ndst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#hmask\">hmask</a>; <a class=\"id\" href=\"#i\">i</a> >= 0; <a class=\"id\" href=\"#i\">i</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_dst_hash_transfer\">xfrm_dst_hash_transfer</a>(<a class=\"id\" href=\"#odst\">odst</a> + <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#ndst\">ndst</a>, <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#table\">table</a> = <a class=\"id\" href=\"#ndst\">ndst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#hmask\">hmask</a> = <a class=\"id\" href=\"#nhashmask\">nhashmask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#odst\">odst</a>, (<a class=\"id\" href=\"#hmask\">hmask</a> + 1) * sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>));", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_byidx_resize\">xfrm_byidx_resize</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#total\">total</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hmask\">hmask</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_idx_hmask\">policy_idx_hmask</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#nhashmask\">nhashmask</a> = <a class=\"id\" href=\"#xfrm_new_hash_mask\">xfrm_new_hash_mask</a>(<a class=\"id\" href=\"#hmask\">hmask</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#nsize\">nsize</a> = (<a class=\"id\" href=\"#nhashmask\">nhashmask</a> + 1) * sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#oidx\">oidx</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_byidx\">policy_byidx</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#nidx\">nidx</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#nidx\">nidx</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#hmask\">hmask</a>; <a class=\"id\" href=\"#i\">i</a> >= 0; <a class=\"id\" href=\"#i\">i</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_idx_hash_transfer\">xfrm_idx_hash_transfer</a>(<a class=\"id\" href=\"#oidx\">oidx</a> + <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#nidx\">nidx</a>, <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_byidx\">policy_byidx</a> = <a class=\"id\" href=\"#nidx\">nidx</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_idx_hmask\">policy_idx_hmask</a> = <a class=\"id\" href=\"#nhashmask\">nhashmask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#oidx\">oidx</a>, (<a class=\"id\" href=\"#hmask\">hmask</a> + 1) * sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>));", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#xfrm_bydst_should_resize\">xfrm_bydst_should_resize</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#dir\">dir</a>, int *<a class=\"id\" href=\"#total\">total</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#cnt\">cnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#dir\">dir</a>];", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hmask\">hmask</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#hmask\">hmask</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#total\">total</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#total\">total</a> += <a class=\"id\" href=\"#cnt\">cnt</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#hmask\">hmask</a> + 1) &lt; <a class=\"id\" href=\"#xfrm_policy_hashmax\">xfrm_policy_hashmax</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#cnt\">cnt</a> &gt; <a class=\"id\" href=\"#hmask\">hmask</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#xfrm_byidx_should_resize\">xfrm_byidx_should_resize</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#total\">total</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hmask\">hmask</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_idx_hmask\">policy_idx_hmask</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#hmask\">hmask</a> + 1) &lt; <a class=\"id\" href=\"#xfrm_policy_hashmax\">xfrm_policy_hashmax</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#total\">total</a> &gt; <a class=\"id\" href=\"#hmask\">hmask</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"void <a class=\"id\" href=\"#xfrm_spd_getinfo\">xfrm_spd_getinfo</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#xfrmk_spdinfo\">xfrmk_spdinfo</a> *<a class=\"id\" href=\"#si\">si</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock_bh\">read_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#incnt\">incnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#XFRM_POLICY_IN\">XFRM_POLICY_IN</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#outcnt\">outcnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#XFRM_POLICY_OUT\">XFRM_POLICY_OUT</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#fwdcnt\">fwdcnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#XFRM_POLICY_FWD\">XFRM_POLICY_FWD</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#inscnt\">inscnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#XFRM_POLICY_IN\">XFRM_POLICY_IN</a>+<a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#outscnt\">outscnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#XFRM_POLICY_OUT\">XFRM_POLICY_OUT</a>+<a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#fwdscnt\">fwdscnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#XFRM_POLICY_FWD\">XFRM_POLICY_FWD</a>+<a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#spdhcnt\">spdhcnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_idx_hmask\">policy_idx_hmask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#spdhmcnt\">spdhmcnt</a> = <a class=\"id\" href=\"#xfrm_policy_hashmax\">xfrm_policy_hashmax</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock_bh\">read_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_spd_getinfo\">xfrm_spd_getinfo</a>);", 
"", 
"static <a class=\"id\" href=\"#DEFINE_MUTEX\">DEFINE_MUTEX</a>(<a class=\"id\" href=\"#hash_resize_mutex\">hash_resize_mutex</a>);", 
"static void <a class=\"id\" href=\"#xfrm_hash_resize\">xfrm_hash_resize</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#work\">work</a>, struct <a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_hash_work\">policy_hash_work</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#total\">total</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#hash_resize_mutex\">hash_resize_mutex</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#total\">total</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#dir\">dir</a> = 0; <a class=\"id\" href=\"#dir\">dir</a> &lt; <a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a> * 2; <a class=\"id\" href=\"#dir\">dir</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_bydst_should_resize\">xfrm_bydst_should_resize</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#dir\">dir</a>, &amp;<a class=\"id\" href=\"#total\">total</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_bydst_resize\">xfrm_bydst_resize</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_byidx_should_resize\">xfrm_byidx_should_resize</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#total\">total</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_byidx_resize\">xfrm_byidx_resize</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#total\">total</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#hash_resize_mutex\">hash_resize_mutex</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Generate new index... KAME seems to generate them ordered by cost</span>", 
"<span class=\"comment\"> * of an absolute inpredictability of ordering of rules. This will not pass. */</span>", 
"static <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#xfrm_gen_index\">xfrm_gen_index</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>static <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#idx_generator\">idx_generator</a>;", 
"", 
"<span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#list\">list</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#idx\">idx</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#found\">found</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = (<a class=\"id\" href=\"#idx_generator\">idx_generator</a> | <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx_generator\">idx_generator</a> += 8;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#idx\">idx</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list\">list</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_byidx\">policy_byidx</a> + <a class=\"id\" href=\"#idx_hash\">idx_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#found\">found</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#byidx\">byidx</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#index\">index</a> == <a class=\"id\" href=\"#idx\">idx</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#found\">found</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#found\">found</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#idx\">idx</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#selector_cmp\">selector_cmp</a>(struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#s1\">s1</a>, struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#s2\">s2</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#p1\">p1</a> = (<a class=\"id\" href=\"#u32\">u32</a> *) <a class=\"id\" href=\"#s1\">s1</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#p2\">p2</a> = (<a class=\"id\" href=\"#u32\">u32</a> *) <a class=\"id\" href=\"#s2\">s2</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a> = sizeof(struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a>) / sizeof(<a class=\"id\" href=\"#u32\">u32</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#len\">len</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#p1\">p1</a>[<a class=\"id\" href=\"#i\">i</a>] != <a class=\"id\" href=\"#p2\">p2</a>[<a class=\"id\" href=\"#i\">i</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#xfrm_policy_insert\">xfrm_policy_insert</a>(int <a class=\"id\" href=\"#dir\">dir</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#policy\">policy</a>, int <a class=\"id\" href=\"#excl\">excl</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#delpol\">delpol</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#chain\">chain</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>, *<a class=\"id\" href=\"#newpos\">newpos</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &amp; <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#chain\">chain</a> = <a class=\"id\" href=\"#policy_hash_bysel\">policy_hash_bysel</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#selector\">selector</a>, <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#delpol\">delpol</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newpos\">newpos</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#chain\">chain</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#type\">type</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#selector_cmp\">selector_cmp</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#selector\">selector</a>, &amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#selector\">selector</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_sec_ctx_match\">xfrm_sec_ctx_match</a>(<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>, <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#security\">security</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(<a class=\"id\" href=\"#delpol\">delpol</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#excl\">excl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#delpol\">delpol</a> = <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#priority\">priority</a> &gt; <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#priority\">priority</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#priority\">priority</a> >= <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#priority\">priority</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpos\">newpos</a> = &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#bydst\">bydst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#delpol\">delpol</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#newpos\">newpos</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_after\">hlist_add_after</a>(<a class=\"id\" href=\"#newpos\">newpos</a>, &amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#bydst\">bydst</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#bydst\">bydst</a>, <a class=\"id\" href=\"#chain\">chain</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#dir\">dir</a>]++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#flow_cache_genid\">flow_cache_genid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#delpol\">delpol</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(<a class=\"id\" href=\"#delpol\">delpol</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#index\">index</a> = <a class=\"id\" href=\"#delpol\">delpol</a> ? <a class=\"id\" href=\"#delpol\">delpol</a>-><a class=\"id\" href=\"#index\">index</a> : <a class=\"id\" href=\"#xfrm_gen_index\">xfrm_gen_index</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#byidx\">byidx</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_byidx\">policy_byidx</a>+<a class=\"id\" href=\"#idx_hash\">idx_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#index\">index</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> = <a class=\"id\" href=\"#get_seconds\">get_seconds</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a> = 0;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#timer\">timer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a> + <a class=\"id\" href=\"#HZ\">HZ</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_all\">policy_all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#delpol\">delpol</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(<a class=\"id\" href=\"#delpol\">delpol</a>);", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#xfrm_bydst_should_resize\">xfrm_bydst_should_resize</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule_work\">schedule_work</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_hash_work\">policy_hash_work</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_insert\">xfrm_policy_insert</a>);", 
"", 
"struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#xfrm_policy_bysel_ctx\">xfrm_policy_bysel_ctx</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  int <a class=\"id\" href=\"#dir\">dir</a>, struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#xfrm_sec_ctx\">xfrm_sec_ctx</a> *<a class=\"id\" href=\"#ctx\">ctx</a>, int <a class=\"id\" href=\"#delete\">delete</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  int *<a class=\"id\" href=\"#err\">err</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, *<a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#chain\">chain</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#chain\">chain</a> = <a class=\"id\" href=\"#policy_hash_bysel\">policy_hash_bysel</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#sel\">sel</a>-><a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#chain\">chain</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#type\">type</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#selector_cmp\">selector_cmp</a>(<a class=\"id\" href=\"#sel\">sel</a>, &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#selector\">selector</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_sec_ctx_match\">xfrm_sec_ctx_match</a>(<a class=\"id\" href=\"#ctx\">ctx</a>, <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#delete\">delete</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_xfrm_policy_delete\">security_xfrm_policy_delete</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> && <a class=\"id\" href=\"#delete\">delete</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(<a class=\"id\" href=\"#ret\">ret</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_bysel_ctx\">xfrm_policy_bysel_ctx</a>);", 
"", 
"struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#xfrm_policy_byid\">xfrm_policy_byid</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     int <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#id\">id</a>, int <a class=\"id\" href=\"#delete\">delete</a>, int *<a class=\"id\" href=\"#err\">err</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, *<a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#chain\">chain</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_policy_id2dir\">xfrm_policy_id2dir</a>(<a class=\"id\" href=\"#id\">id</a>) != <a class=\"id\" href=\"#dir\">dir</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#chain\">chain</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_byidx\">policy_byidx</a> + <a class=\"id\" href=\"#idx_hash\">idx_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#chain\">chain</a>, <a class=\"id\" href=\"#byidx\">byidx</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#type\">type</a> && <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#index\">index</a> == <a class=\"id\" href=\"#id\">id</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#delete\">delete</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_xfrm_policy_delete\">security_xfrm_policy_delete</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> && <a class=\"id\" href=\"#delete\">delete</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(<a class=\"id\" href=\"#ret\">ret</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_byid\">xfrm_policy_byid</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SECURITY_NETWORK_XFRM\">CONFIG_SECURITY_NETWORK_XFRM</a>", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#xfrm_policy_flush_secctx_check\">xfrm_policy_flush_secctx_check</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>, struct <a class=\"id\" href=\"#xfrm_audit\">xfrm_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#dir\">dir</a> = 0; <a class=\"id\" href=\"#dir\">dir</a> &lt; <a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>; <a class=\"id\" href=\"#dir\">dir</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_inexact\">policy_inexact</a>[<a class=\"id\" href=\"#dir\">dir</a>], <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_xfrm_policy_delete\">security_xfrm_policy_delete</a>(<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_policy_delete\">xfrm_audit_policy_delete</a>(<a class=\"id\" href=\"#pol\">pol</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#loginuid\">loginuid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#sessionid\">sessionid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#hmask\">hmask</a>; <a class=\"id\" href=\"#i\">i</a> >= 0; <a class=\"id\" href=\"#i\">i</a>--) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#table\">table</a> + <a class=\"id\" href=\"#i\">i</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_xfrm_policy_delete\">security_xfrm_policy_delete</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_policy_delete\">xfrm_audit_policy_delete</a>(<a class=\"id\" href=\"#pol\">pol</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#loginuid\">loginuid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#sessionid\">sessionid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"#else", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#xfrm_policy_flush_secctx_check\">xfrm_policy_flush_secctx_check</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>, struct <a class=\"id\" href=\"#xfrm_audit\">xfrm_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>return 0;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"int <a class=\"id\" href=\"#xfrm_policy_flush\">xfrm_policy_flush</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>, struct <a class=\"id\" href=\"#xfrm_audit\">xfrm_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#err\">err</a> = 0, <a class=\"id\" href=\"#cnt\">cnt</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_policy_flush_secctx_check\">xfrm_policy_flush_secctx_check</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#dir\">dir</a> = 0; <a class=\"id\" href=\"#dir\">dir</a> &lt; <a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>; <a class=\"id\" href=\"#dir\">dir</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#again1\">again1</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_inexact\">policy_inexact</a>[<a class=\"id\" href=\"#dir\">dir</a>], <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cnt\">cnt</a>++;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_policy_delete\">xfrm_audit_policy_delete</a>(<a class=\"id\" href=\"#pol\">pol</a>, 1, <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#loginuid\">loginuid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#sessionid\">sessionid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#again1\">again1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#hmask\">hmask</a>; <a class=\"id\" href=\"#i\">i</a> >= 0; <a class=\"id\" href=\"#i\">i</a>--) {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#again2\">again2</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_bydst\">policy_bydst</a>[<a class=\"id\" href=\"#dir\">dir</a>].<a class=\"id\" href=\"#table\">table</a> + <a class=\"id\" href=\"#i\">i</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cnt\">cnt</a>++;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_policy_delete\">xfrm_audit_policy_delete</a>(<a class=\"id\" href=\"#pol\">pol</a>, 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#loginuid\">loginuid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#sessionid\">sessionid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#again2\">again2</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#cnt\">cnt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_flush\">xfrm_policy_flush</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_policy_walk\">xfrm_policy_walk</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#xfrm_policy_walk\">xfrm_policy_walk</a> *<a class=\"id\" href=\"#walk\">walk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>     int (*<a class=\"id\" href=\"#func\">func</a>)(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *, int, int, void*),", 
"<span class=\"ts\"/><span class=\"ts\"/>     void *<a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy_walk_entry\">xfrm_policy_walk_entry</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> >= <a class=\"id\" href=\"#XFRM_POLICY_TYPE_MAX\">XFRM_POLICY_TYPE_MAX</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#XFRM_POLICY_TYPE_ANY\">XFRM_POLICY_TYPE_ANY</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>) && <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#list_first_entry\">list_first_entry</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_all\">policy_all</a>, struct <a class=\"id\" href=\"#xfrm_policy_walk_entry\">xfrm_policy_walk_entry</a>, <a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#list_entry\">list_entry</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>, struct <a class=\"id\" href=\"#xfrm_policy_walk_entry\">xfrm_policy_walk_entry</a>, <a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_from\">list_for_each_entry_from</a>(<a class=\"id\" href=\"#x\">x</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_all\">policy_all</a>, <a class=\"id\" href=\"#all\">all</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#dead\">dead</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#x\">x</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a>, <a class=\"id\" href=\"#walk\">walk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#XFRM_POLICY_TYPE_ANY\">XFRM_POLICY_TYPE_ANY</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#func\">func</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#xfrm_policy_id2dir\">xfrm_policy_id2dir</a>(<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#index\">index</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_move_tail\">list_move_tail</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del_init\">list_del_init</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_walk\">xfrm_policy_walk</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_policy_walk_init\">xfrm_policy_walk_init</a>(struct <a class=\"id\" href=\"#xfrm_policy_walk\">xfrm_policy_walk</a> *<a class=\"id\" href=\"#walk\">walk</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#dead\">dead</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a> = 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_walk_init\">xfrm_policy_walk_init</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_policy_walk_done\">xfrm_policy_walk_done</a>(struct <a class=\"id\" href=\"#xfrm_policy_walk\">xfrm_policy_walk</a> *<a class=\"id\" href=\"#walk\">walk</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_walk_done\">xfrm_policy_walk_done</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Find policy to apply to this flow.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 if policy found, else an -errno.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#xfrm_policy_match\">xfrm_policy_match</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a> = &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#selector\">selector</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#match\">match</a>, <a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#family\">family</a> ||", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) != <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = <a class=\"id\" href=\"#xfrm_selector_match\">xfrm_selector_match</a>(<a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#match\">match</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#security_xfrm_policy_lookup\">security_xfrm_policy_lookup</a>(<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>, <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#secid\">secid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#dir\">dir</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#xfrm_policy_lookup_bytype\">xfrm_policy_lookup_bytype</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, *<a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, *<a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#chain\">chain</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#priority\">priority</a> = ~0U;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#xfrm_flowi_daddr\">xfrm_flowi_daddr</a>(<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#xfrm_flowi_saddr\">xfrm_flowi_saddr</a>(<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#daddr\">daddr</a> || !<a class=\"id\" href=\"#saddr\">saddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock_bh\">read_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#chain\">chain</a> = <a class=\"id\" href=\"#policy_hash_direct\">policy_hash_direct</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#chain\">chain</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_policy_match\">xfrm_policy_match</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> == -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#priority\">priority</a> = <a class=\"id\" href=\"#ret\">ret</a>-><a class=\"id\" href=\"#priority\">priority</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#chain\">chain</a> = &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_inexact\">policy_inexact</a>[<a class=\"id\" href=\"#dir\">dir</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#chain\">chain</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_policy_match\">xfrm_policy_match</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> == -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#priority\">priority</a> &lt; <a class=\"id\" href=\"#priority\">priority</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#ret\">ret</a>);", 
"<a class=\"id\" href=\"#fail\">fail</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock_bh\">read_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *", 
"<a class=\"id\" href=\"#__xfrm_policy_lookup\">__xfrm_policy_lookup</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_XFRM_SUB_POLICY\">CONFIG_XFRM_SUB_POLICY</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#xfrm_policy_lookup_bytype\">xfrm_policy_lookup_bytype</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#XFRM_POLICY_TYPE_SUB\">XFRM_POLICY_TYPE_SUB</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#pol\">pol</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#xfrm_policy_lookup_bytype\">xfrm_policy_lookup_bytype</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#XFRM_POLICY_TYPE_MAIN\">XFRM_POLICY_TYPE_MAIN</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *", 
"<a class=\"id\" href=\"#xfrm_policy_lookup\">xfrm_policy_lookup</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#dir\">dir</a>, struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#old_obj\">old_obj</a>, void *<a class=\"id\" href=\"#ctx\">ctx</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#old_obj\">old_obj</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#old_obj\">old_obj</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a>, <a class=\"id\" href=\"#flo\">flo</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#__xfrm_policy_lookup\">__xfrm_policy_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR_OR_NULL\">IS_ERR_OR_NULL</a>(<a class=\"id\" href=\"#pol\">pol</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_CAST\">ERR_CAST</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Resolver returns two references:</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * one for cache and one for caller of flow_cache_lookup() */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"", 
"<span class=\"ts\"/>return &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#flo\">flo</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#policy_to_flow_dir\">policy_to_flow_dir</a>(int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#XFRM_POLICY_IN\">XFRM_POLICY_IN</a> == <a class=\"id\" href=\"#FLOW_DIR_IN\">FLOW_DIR_IN</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#XFRM_POLICY_OUT\">XFRM_POLICY_OUT</a> == <a class=\"id\" href=\"#FLOW_DIR_OUT\">FLOW_DIR_OUT</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#XFRM_POLICY_FWD\">XFRM_POLICY_FWD</a> == <a class=\"id\" href=\"#FLOW_DIR_FWD\">FLOW_DIR_FWD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dir\">dir</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#dir\">dir</a>) {", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#XFRM_POLICY_IN\">XFRM_POLICY_IN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#FLOW_DIR_IN\">FLOW_DIR_IN</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#XFRM_POLICY_OUT\">XFRM_POLICY_OUT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#FLOW_DIR_OUT\">FLOW_DIR_OUT</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#XFRM_POLICY_FWD\">XFRM_POLICY_FWD</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#FLOW_DIR_FWD\">FLOW_DIR_FWD</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#xfrm_sk_policy_lookup\">xfrm_sk_policy_lookup</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, int <a class=\"id\" href=\"#dir\">dir</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock_bh\">read_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[<a class=\"id\" href=\"#dir\">dir</a>]) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#match\">match</a> = <a class=\"id\" href=\"#xfrm_selector_match\">xfrm_selector_match</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#selector\">selector</a>, <a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_family\">sk_family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#match\">match</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_mark\">sk_mark</a> &amp; <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) != <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_xfrm_policy_lookup\">security_xfrm_policy_lookup</a>(<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#secid\">secid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#policy_to_flow_dir\">policy_to_flow_dir</a>(<a class=\"id\" href=\"#dir\">dir</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#err\">err</a> == -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock_bh\">read_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#pol\">pol</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__xfrm_policy_link\">__xfrm_policy_link</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#chain\">chain</a> = <a class=\"id\" href=\"#policy_hash_bysel\">policy_hash_bysel</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#selector\">selector</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_all\">policy_all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#bydst\">bydst</a>, <a class=\"id\" href=\"#chain\">chain</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#byidx\">byidx</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_byidx\">policy_byidx</a>+<a class=\"id\" href=\"#idx_hash\">idx_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#index\">index</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#dir\">dir</a>]++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_hold\">xfrm_pol_hold</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_bydst_should_resize\">xfrm_bydst_should_resize</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule_work\">schedule_work</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_hash_work\">policy_hash_work</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hlist_unhashed\">hlist_unhashed</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#bydst\">bydst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#bydst\">bydst</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#byidx\">byidx</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#walk\">walk</a>.<a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#policy_count\">policy_count</a>[<a class=\"id\" href=\"#dir\">dir</a>]--;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#pol\">pol</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#xfrm_policy_delete\">xfrm_policy_delete</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_policy_delete\">xfrm_policy_delete</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_sk_policy_insert\">xfrm_sk_policy_insert</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, int <a class=\"id\" href=\"#dir\">dir</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#old_pol\">old_pol</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_XFRM_SUB_POLICY\">CONFIG_XFRM_SUB_POLICY</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a> && <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#XFRM_POLICY_TYPE_MAIN\">XFRM_POLICY_TYPE_MAIN</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_pol\">old_pol</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[<a class=\"id\" href=\"#dir\">dir</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[<a class=\"id\" href=\"#dir\">dir</a>] = <a class=\"id\" href=\"#pol\">pol</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pol\">pol</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> = <a class=\"id\" href=\"#get_seconds\">get_seconds</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#index\">index</a> = <a class=\"id\" href=\"#xfrm_gen_index\">xfrm_gen_index</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>+<a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_link\">__xfrm_policy_link</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>+<a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#old_pol\">old_pol</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Unlinking succeeds always. This is the only function</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * allowed to delete or replace socket policy.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_unlink\">__xfrm_policy_unlink</a>(<a class=\"id\" href=\"#old_pol\">old_pol</a>, <a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>+<a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#old_pol\">old_pol</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_kill\">xfrm_policy_kill</a>(<a class=\"id\" href=\"#old_pol\">old_pol</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#clone_policy\">clone_policy</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#old\">old</a>, int <a class=\"id\" href=\"#dir\">dir</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#newp\">newp</a> = <a class=\"id\" href=\"#xfrm_policy_alloc\">xfrm_policy_alloc</a>(<a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#old\">old</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#newp\">newp</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#selector\">selector</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#selector\">selector</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#security_xfrm_policy_clone\">security_xfrm_policy_clone</a>(<a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#security\">security</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#security\">security</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#newp\">newp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;  <span class=\"comment\">/* ENOMEM */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#lft\">lft</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#lft\">lft</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#curlft\">curlft</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#curlft\">curlft</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#mark\">mark</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#action\">action</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#action\">action</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#xfrm_nr\">xfrm_nr</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#xfrm_nr\">xfrm_nr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#index\">index</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#index\">index</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#xfrm_vec\">xfrm_vec</a>, <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#xfrm_vec\">xfrm_vec</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#newp\">newp</a>-><a class=\"id\" href=\"#xfrm_nr\">xfrm_nr</a>*sizeof(struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_policy_link\">__xfrm_policy_link</a>(<a class=\"id\" href=\"#newp\">newp</a>, <a class=\"id\" href=\"#XFRM_POLICY_MAX\">XFRM_POLICY_MAX</a>+<a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_policy_lock\">xfrm_policy_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#newp\">newp</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#newp\">newp</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#__xfrm_sk_clone_policy\">__xfrm_sk_clone_policy</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#p0\">p0</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   *<a class=\"id\" href=\"#p1\">p1</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[1];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[0] = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[1] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#p0\">p0</a> && (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[0] = <a class=\"id\" href=\"#clone_policy\">clone_policy</a>(<a class=\"id\" href=\"#p0\">p0</a>, 0)) == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#p1\">p1</a> && (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_policy\">sk_policy</a>[1] = <a class=\"id\" href=\"#clone_policy\">clone_policy</a>(<a class=\"id\" href=\"#p1\">p1</a>, 1)) == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int", 
"<a class=\"id\" href=\"#xfrm_get_saddr\">xfrm_get_saddr</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#local\">local</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#remote\">remote</a>,", 
"<span class=\"ts\"/>       unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_policy_get_afinfo\">xfrm_policy_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#get_saddr\">get_saddr</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#local\">local</a>, <a class=\"id\" href=\"#remote\">remote</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_put_afinfo\">xfrm_policy_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Resolve list of templates for the flow, given policy. */</span>", 
"", 
"static int", 
"<a class=\"id\" href=\"#xfrm_tmpl_resolve_one\">xfrm_tmpl_resolve_one</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#policy\">policy</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> **<a class=\"id\" href=\"#xfrm\">xfrm</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nx\">nx</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#xfrm_flowi_daddr\">xfrm_flowi_daddr</a>(<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#xfrm_flowi_saddr\">xfrm_flowi_saddr</a>(<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#nx\">nx</a>=0, <a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#xfrm_nr\">xfrm_nr</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#remote\">remote</a> = <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#local\">local</a>  = <a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a> *<a class=\"id\" href=\"#tmpl\">tmpl</a> = &amp;<a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#xfrm_vec\">xfrm_vec</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#mode\">mode</a> == <a class=\"id\" href=\"#XFRM_MODE_TUNNEL\">XFRM_MODE_TUNNEL</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#mode\">mode</a> == <a class=\"id\" href=\"#XFRM_MODE_BEET\">XFRM_MODE_BEET</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#remote\">remote</a> = &amp;<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#local\">local</a> = &amp;<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_addr_any\">xfrm_addr_any</a>(<a class=\"id\" href=\"#local\">local</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#encap_family\">encap_family</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#xfrm_get_saddr\">xfrm_get_saddr</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#remote\">remote</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#encap_family\">encap_family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#local\">local</a> = &amp;<a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#xfrm_state_find\">xfrm_state_find</a>(<a class=\"id\" href=\"#remote\">remote</a>, <a class=\"id\" href=\"#local\">local</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>, <a class=\"id\" href=\"#policy\">policy</a>, &amp;<a class=\"id\" href=\"#error\">error</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a> && <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#nx\">nx</a>++] = <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#remote\">remote</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#local\">local</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_ERROR\">XFRM_STATE_ERROR</a> ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> -<a class=\"id\" href=\"#EINVAL\">EINVAL</a> : -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#error\">error</a> == -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#optional\">optional</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#nx\">nx</a>;", 
"", 
"<a class=\"id\" href=\"#fail\">fail</a>:", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#nx\">nx</a>--; <a class=\"id\" href=\"#nx\">nx</a>>=0; <a class=\"id\" href=\"#nx\">nx</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#nx\">nx</a>]);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static int", 
"<a class=\"id\" href=\"#xfrm_tmpl_resolve\">xfrm_tmpl_resolve</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> **<a class=\"id\" href=\"#pols\">pols</a>, int <a class=\"id\" href=\"#npols\">npols</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> **<a class=\"id\" href=\"#xfrm\">xfrm</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>  unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#tp\">tp</a>[<a class=\"id\" href=\"#XFRM_MAX_DEPTH\">XFRM_MAX_DEPTH</a>];", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> **<a class=\"id\" href=\"#tpp\">tpp</a> = (<a class=\"id\" href=\"#npols\">npols</a> &gt; 1) ? <a class=\"id\" href=\"#tp\">tp</a> : <a class=\"id\" href=\"#xfrm\">xfrm</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#cnx\">cnx</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#npols\">npols</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cnx\">cnx</a> + <a class=\"id\" href=\"#pols\">pols</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#xfrm_nr\">xfrm_nr</a> >= <a class=\"id\" href=\"#XFRM_MAX_DEPTH\">XFRM_MAX_DEPTH</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#xfrm_tmpl_resolve_one\">xfrm_tmpl_resolve_one</a>(<a class=\"id\" href=\"#pols\">pols</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#tpp\">tpp</a>[<a class=\"id\" href=\"#cnx\">cnx</a>], <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cnx\">cnx</a> += <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* found states are sorted for outbound processing */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#npols\">npols</a> &gt; 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_sort\">xfrm_state_sort</a>(<a class=\"id\" href=\"#xfrm\">xfrm</a>, <a class=\"id\" href=\"#tpp\">tpp</a>, <a class=\"id\" href=\"#cnx\">cnx</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#cnx\">cnx</a>;", 
"", 
" <a class=\"id\" href=\"#fail\">fail</a>:", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#cnx\">cnx</a>--; <a class=\"id\" href=\"#cnx\">cnx</a>>=0; <a class=\"id\" href=\"#cnx\">cnx</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#tpp\">tpp</a>[<a class=\"id\" href=\"#cnx\">cnx</a>]);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"}", 
"", 
"<span class=\"comment\">/* Check that the bundle accepts the flow and its components are</span>", 
"<span class=\"comment\"> * still valid.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#xfrm_get_tos\">xfrm_get_tos</a>(struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>, int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_policy_get_afinfo\">xfrm_policy_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#tos\">tos</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#get_tos\">get_tos</a>(<a class=\"id\" href=\"#fl\">fl</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_put_afinfo\">xfrm_policy_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tos\">tos</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#xfrm_bundle_flo_get\">xfrm_bundle_flo_get</a>(struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#flo\">flo</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#flo\">flo</a>, struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a>, <a class=\"id\" href=\"#flo\">flo</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a> = &amp;<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#route\">route</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Dummy bundle - if it has xfrms we were not</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * able to build bundle as template resolution failed.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * It means we need to try again resolving. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#num_xfrms\">num_xfrms</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Real bundle */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#stale_bundle\">stale_bundle</a>(<a class=\"id\" href=\"#dst\">dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst_hold\">dst_hold</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#flo\">flo</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#xfrm_bundle_flo_check\">xfrm_bundle_flo_check</a>(struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#flo\">flo</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#flo\">flo</a>, struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a>, <a class=\"id\" href=\"#flo\">flo</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a> = &amp;<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#route\">route</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#stale_bundle\">stale_bundle</a>(<a class=\"id\" href=\"#dst\">dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_bundle_flo_delete\">xfrm_bundle_flo_delete</a>(struct <a class=\"id\" href=\"#flow_cache_object\">flow_cache_object</a> *<a class=\"id\" href=\"#flo\">flo</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#flo\">flo</a>, struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a>, <a class=\"id\" href=\"#flo\">flo</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a> = &amp;<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst_free\">dst_free</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#flow_cache_ops\">flow_cache_ops</a> <a class=\"id\" href=\"#xfrm_bundle_fc_ops\">xfrm_bundle_fc_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get\">get</a> = <a class=\"id\" href=\"#xfrm_bundle_flo_get\">xfrm_bundle_flo_get</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#check\">check</a> = <a class=\"id\" href=\"#xfrm_bundle_flo_check\">xfrm_bundle_flo_check</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#delete\">delete</a> = <a class=\"id\" href=\"#xfrm_bundle_flo_delete\">xfrm_bundle_flo_delete</a>,", 
"};", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xfrm_alloc_dst\">xfrm_alloc_dst</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_policy_get_afinfo\">xfrm_policy_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_ops\">dst_ops</a> *<a class=\"id\" href=\"#dst_ops\">dst_ops</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#EINVAL\">EINVAL</a>);", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET\">AF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_ops\">dst_ops</a> = &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#xfrm4_dst_ops\">xfrm4_dst_ops</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_ops\">dst_ops</a> = &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#xfrm6_dst_ops\">xfrm6_dst_ops</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a> = <a class=\"id\" href=\"#dst_alloc\">dst_alloc</a>(<a class=\"id\" href=\"#dst_ops\">dst_ops</a>) ?: <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_put_afinfo\">xfrm_policy_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#flo\">flo</a>.<a class=\"id\" href=\"#ops\">ops</a> = &amp;<a class=\"id\" href=\"#xfrm_bundle_fc_ops\">xfrm_bundle_fc_ops</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#xdst\">xdst</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#xfrm_init_path\">xfrm_init_path</a>(struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#path\">path</a>, struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> int <a class=\"id\" href=\"#nfheader_len\">nfheader_len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_get_afinfo\">xfrm_policy_get_afinfo</a>(<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#init_path\">init_path</a>(<a class=\"id\" href=\"#path\">path</a>, <a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#nfheader_len\">nfheader_len</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_put_afinfo\">xfrm_policy_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#xfrm_fill_dst\">xfrm_fill_dst</a>(struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy_afinfo\">xfrm_policy_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_get_afinfo\">xfrm_policy_get_afinfo</a>(<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#fill_dst\">fill_dst</a>(<a class=\"id\" href=\"#xdst\">xdst</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#fl\">fl</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_policy_put_afinfo\">xfrm_policy_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"", 
"<span class=\"comment\">/* Allocate chain of dst_entry's, attach known xfrm's, calculate</span>", 
"<span class=\"comment\"> * all the metrics... Shortly, bundle a bundle.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#xfrm_bundle_create\">xfrm_bundle_create</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#policy\">policy</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> **<a class=\"id\" href=\"#xfrm\">xfrm</a>, int <a class=\"id\" href=\"#nx\">nx</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#policy\">policy</a>);", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#now\">now</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst_prev\">dst_prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst0\">dst0</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#header_len\">header_len</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nfheader_len\">nfheader_len</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#trailer_len\">trailer_len</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#tos\">tos</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#policy\">policy</a>-><a class=\"id\" href=\"#selector\">selector</a>.<a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_flowi_addr_get\">xfrm_flowi_addr_get</a>(<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#saddr\">saddr</a>, &amp;<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#xfrm_get_tos\">xfrm_get_tos</a>(<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#tos\">tos</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tos\">tos</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#put_states\">put_states</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst_hold\">dst_hold</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"", 
"<span class=\"ts\"/>for (; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#nx\">nx</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a> = <a class=\"id\" href=\"#xfrm_alloc_dst\">xfrm_alloc_dst</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst1\">dst1</a> = &amp;<a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#xdst\">xdst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#xdst\">xdst</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_release\">dst_release</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#put_states\">put_states</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dst_prev\">dst_prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst0\">dst0</a> = <a class=\"id\" href=\"#dst1\">dst1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_prev\">dst_prev</a>-><a class=\"id\" href=\"#child\">child</a> = <a class=\"id\" href=\"#dst_clone\">dst_clone</a>(<a class=\"id\" href=\"#dst1\">dst1</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_NOHASH\">DST_NOHASH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#route\">route</a> = <a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#metrics\">metrics</a>, &amp;<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#metrics\">metrics</a>, sizeof(<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#metrics\">metrics</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#XFRM_MODE_TRANSPORT\">XFRM_MODE_TRANSPORT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#xfrm_dst_lookup\">xfrm_dst_lookup</a>(<a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#tos\">tos</a>, &amp;<a class=\"id\" href=\"#saddr\">saddr</a>, &amp;<a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#dst\">dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#put_states\">put_states</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_hold\">dst_hold</a>(<a class=\"id\" href=\"#dst\">dst</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a> = <a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#xfrm_genid\">xfrm_genid</a> = <a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#genid\">genid</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#obsolete\">obsolete</a> = -1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_HOST\">DST_HOST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#lastuse\">lastuse</a> = <a class=\"id\" href=\"#now\">now</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#input\">input</a> = <a class=\"id\" href=\"#dst_discard\">dst_discard</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#output\">output</a> = <a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#outer_mode\">outer_mode</a>-><a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#output\">output</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst1\">dst1</a>-><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#dst_prev\">dst_prev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_prev\">dst_prev</a> = <a class=\"id\" href=\"#dst1\">dst1</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#header_len\">header_len</a> += <a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#header_len\">header_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_TYPE_NON_FRAGMENT\">XFRM_TYPE_NON_FRAGMENT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nfheader_len\">nfheader_len</a> += <a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#header_len\">header_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#trailer_len\">trailer_len</a> += <a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#trailer_len\">trailer_len</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst_prev\">dst_prev</a>-><a class=\"id\" href=\"#child\">child</a> = <a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst0\">dst0</a>-><a class=\"id\" href=\"#path\">path</a> = <a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#free_dst\">free_dst</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Copy neighbour for reachability confirmation */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst0\">dst0</a>-><a class=\"id\" href=\"#neighbour\">neighbour</a> = <a class=\"id\" href=\"#neigh_clone\">neigh_clone</a>(<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#neighbour\">neighbour</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_init_path\">xfrm_init_path</a>((struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *)<a class=\"id\" href=\"#dst0\">dst0</a>, <a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#nfheader_len\">nfheader_len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_init_pmtu\">xfrm_init_pmtu</a>(<a class=\"id\" href=\"#dst_prev\">dst_prev</a>);", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#dst_prev\">dst_prev</a> = <a class=\"id\" href=\"#dst0\">dst0</a>; <a class=\"id\" href=\"#dst_prev\">dst_prev</a> != <a class=\"id\" href=\"#dst\">dst</a>; <a class=\"id\" href=\"#dst_prev\">dst_prev</a> = <a class=\"id\" href=\"#dst_prev\">dst_prev</a>-><a class=\"id\" href=\"#child\">child</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *<a class=\"id\" href=\"#xdst\">xdst</a> = (struct <a class=\"id\" href=\"#xfrm_dst\">xfrm_dst</a> *)<a class=\"id\" href=\"#dst_prev\">dst_prev</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_fill_dst\">xfrm_fill_dst</a>(<a class=\"id\" href=\"#xdst\">xdst</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#fl\">fl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#free_dst\">free_dst</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_prev\">dst_prev</a>-><a class=\"id\" href=\"#header_len\">header_len</a> = <a class=\"id\" href=\"#header_len\">header_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_prev\">dst_prev</a>-><a class=\"id\" href=\"#trailer_len\">trailer_len</a> = <a class=\"id\" href=\"#trailer_len\">trailer_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#header_len\">header_len</a> -= <a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#xfrm\">xfrm</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#header_len\">header_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#trailer_len\">trailer_len</a> -= <a class=\"id\" href=\"#xdst\">xdst</a>-><a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#xfrm\">xfrm</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#trailer_len\">trailer_len</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#dst0\">dst0</a>;", 
"", 
"<a class=\"id\" href=\"#put_states\">put_states</a>:", 
"<span class=\"ts\"/>for (; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#nx\">nx</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#xfrm\">xfrm</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
];
xr_frag_insert('l/29/9169d4f0d77f04f7db1f2042ab93aae32e09af.xr', __xr_tmp);
