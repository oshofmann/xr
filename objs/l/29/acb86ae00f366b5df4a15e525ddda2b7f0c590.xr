var __xr_tmp = [
"", 
"<span class=\"comment\">/* Argument struct for netlbl_domhsh_walk() */</span>", 
"struct <a class=\"id\" href=\"#netlbl_domhsh_walk_arg\">netlbl_domhsh_walk_arg</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi\">doi</a>;", 
"};", 
"", 
"<span class=\"comment\">/* NetLabel Generic NETLINK CIPSOv4 family */</span>", 
"static struct <a class=\"id\" href=\"#genl_family\">genl_family</a> <a class=\"id\" href=\"#netlbl_cipsov4_gnl_family\">netlbl_cipsov4_gnl_family</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#GENL_ID_GENERATE\">GENL_ID_GENERATE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#hdrsize\">hdrsize</a> = 0,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_CIPSOV4_NAME\">NETLBL_NLTYPE_CIPSOV4_NAME</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#version\">version</a> = <a class=\"id\" href=\"#NETLBL_PROTO_VERSION\">NETLBL_PROTO_VERSION</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#maxattr\">maxattr</a> = <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MAX\">NLBL_CIPSOV4_A_MAX</a>,", 
"};", 
"", 
"<span class=\"comment\">/* NetLabel Netlink attribute policy */</span>", 
"static const struct <a class=\"id\" href=\"#nla_policy\">nla_policy</a> <a class=\"id\" href=\"#netlbl_cipsov4_genl_policy\">netlbl_cipsov4_genl_policy</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MAX\">NLBL_CIPSOV4_A_MAX</a> + 1] = {", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_DOI\">NLBL_CIPSOV4_A_DOI</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MTYPE\">NLBL_CIPSOV4_A_MTYPE</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAG\">NLBL_CIPSOV4_A_TAG</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U8\">NLA_U8</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAGLST\">NLBL_CIPSOV4_A_TAGLST</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_NESTED\">NLA_NESTED</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLOC\">NLBL_CIPSOV4_A_MLSLVLLOC</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLREM\">NLBL_CIPSOV4_A_MLSLVLREM</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVL\">NLBL_CIPSOV4_A_MLSLVL</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_NESTED\">NLA_NESTED</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLST\">NLBL_CIPSOV4_A_MLSLVLLST</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_NESTED\">NLA_NESTED</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLOC\">NLBL_CIPSOV4_A_MLSCATLOC</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATREM\">NLBL_CIPSOV4_A_MLSCATREM</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCAT\">NLBL_CIPSOV4_A_MLSCAT</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_NESTED\">NLA_NESTED</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLST\">NLBL_CIPSOV4_A_MLSCATLST</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_NESTED\">NLA_NESTED</a> },", 
"};", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Helper Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_add_common - Parse the common sections of a ADD message</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> * @doi_def: the CIPSO V4 DOI definition</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Parse the common sections of a ADD message and fill in the related values</span>", 
"<span class=\"comment\"> * in @doi_def.  Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_add_common\">netlbl_cipsov4_add_common</a>(struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla\">nla</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nla_rem\">nla_rem</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#doi\">doi</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_DOI\">NLBL_CIPSOV4_A_DOI</a>]);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_validate_nested\">nla_validate_nested</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAGLST\">NLBL_CIPSOV4_A_TAGLST</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NLBL_CIPSOV4_A_MAX\">NLBL_CIPSOV4_A_MAX</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_cipsov4_genl_policy\">netlbl_cipsov4_genl_policy</a>) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla_for_each_nested\">nla_for_each_nested</a>(<a class=\"id\" href=\"#nla\">nla</a>, <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAGLST\">NLBL_CIPSOV4_A_TAGLST</a>], <a class=\"id\" href=\"#nla_rem\">nla_rem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#nla\">nla</a>) == <a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAG\">NLBL_CIPSOV4_A_TAG</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter\">iter</a> >= <a class=\"id\" href=\"#CIPSO_V4_TAG_MAXCNT\">CIPSO_V4_TAG_MAXCNT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#tags\">tags</a>[<a class=\"id\" href=\"#iter\">iter</a>++] = <a class=\"id\" href=\"#nla_get_u8\">nla_get_u8</a>(<a class=\"id\" href=\"#nla\">nla</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#CIPSO_V4_TAG_MAXCNT\">CIPSO_V4_TAG_MAXCNT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#tags\">tags</a>[<a class=\"id\" href=\"#iter\">iter</a>++] = <a class=\"id\" href=\"#CIPSO_V4_TAG_INVALID\">CIPSO_V4_TAG_INVALID</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * NetLabel Command Handlers</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_add_std - Adds a CIPSO V4 DOI definition</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Create a new CIPSO_V4_MAP_TRANS DOI definition based on the given ADD</span>", 
"<span class=\"comment\"> * message and add it to the CIPSO V4 engine.  Return zero on success and</span>", 
"<span class=\"comment\"> * non-zero on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_add_std\">netlbl_cipsov4_add_std</a>(struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla_a\">nla_a</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla_b\">nla_b</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nla_a_rem\">nla_a_rem</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nla_b_rem\">nla_b_rem</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAGLST\">NLBL_CIPSOV4_A_TAGLST</a>] ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLST\">NLBL_CIPSOV4_A_MLSLVLLST</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_validate_nested\">nla_validate_nested</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLST\">NLBL_CIPSOV4_A_MLSLVLLST</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NLBL_CIPSOV4_A_MAX\">NLBL_CIPSOV4_A_MAX</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_cipsov4_genl_policy\">netlbl_cipsov4_genl_policy</a>) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#doi_def\">doi_def</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#CIPSO_V4_MAP_TRANS\">CIPSO_V4_MAP_TRANS</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_cipsov4_add_common\">netlbl_cipsov4_add_common</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla_for_each_nested\">nla_for_each_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLST\">NLBL_CIPSOV4_A_MLSLVLLST</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nla_a_rem\">nla_a_rem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>) == <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVL\">NLBL_CIPSOV4_A_MLSLVL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_validate_nested\">nla_validate_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MAX\">NLBL_CIPSOV4_A_MAX</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#netlbl_cipsov4_genl_policy\">netlbl_cipsov4_genl_policy</a>) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_for_each_nested\">nla_for_each_nested</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>, <a class=\"id\" href=\"#nla_a\">nla_a</a>, <a class=\"id\" href=\"#nla_b_rem\">nla_b_rem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLOC\">NLBL_CIPSOV4_A_MLSLVLLOC</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) &gt;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#CIPSO_V4_MAX_LOC_LVLS\">CIPSO_V4_MAX_LOC_LVLS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) >=", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local_size\">local_size</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local_size\">local_size</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLREM\">NLBL_CIPSOV4_A_MLSLVLREM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) &gt;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#CIPSO_V4_MAX_REM_LVLS\">CIPSO_V4_MAX_REM_LVLS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) >=", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local\">local</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local_size\">local_size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      sizeof(<a class=\"id\" href=\"#u32\">u32</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local\">local</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso\">cipso</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      sizeof(<a class=\"id\" href=\"#u32\">u32</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso\">cipso</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local_size\">local_size</a>; <a class=\"id\" href=\"#iter\">iter</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local\">local</a>[<a class=\"id\" href=\"#iter\">iter</a>] = <a class=\"id\" href=\"#CIPSO_V4_INV_LVL\">CIPSO_V4_INV_LVL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a>; <a class=\"id\" href=\"#iter\">iter</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso\">cipso</a>[<a class=\"id\" href=\"#iter\">iter</a>] = <a class=\"id\" href=\"#CIPSO_V4_INV_LVL\">CIPSO_V4_INV_LVL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla_for_each_nested\">nla_for_each_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLST\">NLBL_CIPSOV4_A_MLSLVLLST</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nla_a_rem\">nla_a_rem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>) == <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVL\">NLBL_CIPSOV4_A_MLSLVL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#lvl_loc\">lvl_loc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#lvl_rem\">lvl_rem</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lvl_loc\">lvl_loc</a> = <a class=\"id\" href=\"#nla_find_nested\">nla_find_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLOC\">NLBL_CIPSOV4_A_MLSLVLLOC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lvl_rem\">lvl_rem</a> = <a class=\"id\" href=\"#nla_find_nested\">nla_find_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLREM\">NLBL_CIPSOV4_A_MLSLVLREM</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#lvl_loc\">lvl_loc</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || <a class=\"id\" href=\"#lvl_rem\">lvl_rem</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local\">local</a>[<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#lvl_loc\">lvl_loc</a>)] =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#lvl_rem\">lvl_rem</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso\">cipso</a>[<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#lvl_rem\">lvl_rem</a>)] =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#lvl_loc\">lvl_loc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLST\">NLBL_CIPSOV4_A_MLSCATLST</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_validate_nested\">nla_validate_nested</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLST\">NLBL_CIPSOV4_A_MLSCATLST</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NLBL_CIPSOV4_A_MAX\">NLBL_CIPSOV4_A_MAX</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_cipsov4_genl_policy\">netlbl_cipsov4_genl_policy</a>) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_for_each_nested\">nla_for_each_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLST\">NLBL_CIPSOV4_A_MLSCATLST</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nla_a_rem\">nla_a_rem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>) == <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCAT\">NLBL_CIPSOV4_A_MLSCAT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_validate_nested\">nla_validate_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MAX\">NLBL_CIPSOV4_A_MAX</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#netlbl_cipsov4_genl_policy\">netlbl_cipsov4_genl_policy</a>) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_for_each_nested\">nla_for_each_nested</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>, <a class=\"id\" href=\"#nla_a\">nla_a</a>, <a class=\"id\" href=\"#nla_b_rem\">nla_b_rem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLOC\">NLBL_CIPSOV4_A_MLSCATLOC</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) &gt;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#CIPSO_V4_MAX_LOC_CATS\">CIPSO_V4_MAX_LOC_CATS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) >=", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local_size\">local_size</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local_size\">local_size</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATREM\">NLBL_CIPSOV4_A_MLSCATREM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) &gt;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#CIPSO_V4_MAX_REM_CATS\">CIPSO_V4_MAX_REM_CATS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) >=", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#nla_b\">nla_b</a>) + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local\">local</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local_size\">local_size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      sizeof(<a class=\"id\" href=\"#u32\">u32</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local\">local</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso\">cipso</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      sizeof(<a class=\"id\" href=\"#u32\">u32</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso\">cipso</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local_size\">local_size</a>; <a class=\"id\" href=\"#iter\">iter</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local\">local</a>[<a class=\"id\" href=\"#iter\">iter</a>] = <a class=\"id\" href=\"#CIPSO_V4_INV_CAT\">CIPSO_V4_INV_CAT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a>; <a class=\"id\" href=\"#iter\">iter</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso\">cipso</a>[<a class=\"id\" href=\"#iter\">iter</a>] = <a class=\"id\" href=\"#CIPSO_V4_INV_CAT\">CIPSO_V4_INV_CAT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_for_each_nested\">nla_for_each_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLST\">NLBL_CIPSOV4_A_MLSCATLST</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nla_a_rem\">nla_a_rem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>) == <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCAT\">NLBL_CIPSOV4_A_MLSCAT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#cat_loc\">cat_loc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#cat_rem\">cat_rem</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_loc\">cat_loc</a> = <a class=\"id\" href=\"#nla_find_nested\">nla_find_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLOC\">NLBL_CIPSOV4_A_MLSCATLOC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_rem\">cat_rem</a> = <a class=\"id\" href=\"#nla_find_nested\">nla_find_nested</a>(<a class=\"id\" href=\"#nla_a\">nla_a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATREM\">NLBL_CIPSOV4_A_MLSCATREM</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cat_loc\">cat_loc</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || <a class=\"id\" href=\"#cat_rem\">cat_rem</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local\">local</a>[", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#cat_loc\">cat_loc</a>)] =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#cat_rem\">cat_rem</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso\">cipso</a>[", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#cat_rem\">cat_rem</a>)] =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#cat_loc\">cat_loc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_doi_add\">cipso_v4_doi_add</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#add_std_failure\">add_std_failure</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_free\">cipso_v4_doi_free</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_add_pass - Adds a CIPSO V4 DOI definition</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Create a new CIPSO_V4_MAP_PASS DOI definition based on the given ADD message</span>", 
"<span class=\"comment\"> * and add it to the CIPSO V4 engine.  Return zero on success and non-zero on</span>", 
"<span class=\"comment\"> * error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_add_pass\">netlbl_cipsov4_add_pass</a>(struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAGLST\">NLBL_CIPSOV4_A_TAGLST</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#doi_def\">doi_def</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#CIPSO_V4_MAP_PASS\">CIPSO_V4_MAP_PASS</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_cipsov4_add_common\">netlbl_cipsov4_add_common</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_pass_failure\">add_pass_failure</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_doi_add\">cipso_v4_doi_add</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_pass_failure\">add_pass_failure</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#add_pass_failure\">add_pass_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_free\">cipso_v4_doi_free</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_add_local - Adds a CIPSO V4 DOI definition</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Create a new CIPSO_V4_MAP_LOCAL DOI definition based on the given ADD</span>", 
"<span class=\"comment\"> * message and add it to the CIPSO V4 engine.  Return zero on success and</span>", 
"<span class=\"comment\"> * non-zero on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_add_local\">netlbl_cipsov4_add_local</a>(struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAGLST\">NLBL_CIPSOV4_A_TAGLST</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#doi_def\">doi_def</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#CIPSO_V4_MAP_LOCAL\">CIPSO_V4_MAP_LOCAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_cipsov4_add_common\">netlbl_cipsov4_add_common</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_local_failure\">add_local_failure</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_doi_add\">cipso_v4_doi_add</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_local_failure\">add_local_failure</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#add_local_failure\">add_local_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_free\">cipso_v4_doi_free</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_add - Handle an ADD message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Create a new DOI definition based on the given ADD message and add it to the</span>", 
"<span class=\"comment\"> * CIPSO V4 engine.  Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_add\">netlbl_cipsov4_add</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#type_str\">type_str</a> = \"(unknown)\";", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_DOI\">NLBL_CIPSOV4_A_DOI</a>] ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MTYPE\">NLBL_CIPSOV4_A_MTYPE</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_netlink_auditinfo\">netlbl_netlink_auditinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_MTYPE\">NLBL_CIPSOV4_A_MTYPE</a>])) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_TRANS\">CIPSO_V4_MAP_TRANS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type_str\">type_str</a> = \"trans\";", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_cipsov4_add_std\">netlbl_cipsov4_add_std</a>(<a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_PASS\">CIPSO_V4_MAP_PASS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type_str\">type_str</a> = \"pass\";", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_cipsov4_add_pass\">netlbl_cipsov4_add_pass</a>(<a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_LOCAL\">CIPSO_V4_MAP_LOCAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type_str\">type_str</a> = \"local\";", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_cipsov4_add_local\">netlbl_cipsov4_add_local</a>(<a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#netlabel_mgmt_protocount\">netlabel_mgmt_protocount</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_list - Handle a LIST message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated LIST message and respond accordingly.  While the</span>", 
"<span class=\"comment\"> * response message generated by the kernel is straightforward, determining</span>", 
"<span class=\"comment\"> * before hand the size of the buffer to allocate is not (we have to generate</span>", 
"<span class=\"comment\"> * the message to know the size).  In order to keep this function sane what we</span>", 
"<span class=\"comment\"> * do is allocate a buffer of NLMSG_GOODSIZE and try to fit the response in</span>", 
"<span class=\"comment\"> * that size, if we fail then we restart with a larger buffer and try again.</span>", 
"<span class=\"comment\"> * We continue in this manner until we hit a limit of failed attempts then we</span>", 
"<span class=\"comment\"> * give up and just send an error message.  Returns zero on success and</span>", 
"<span class=\"comment\"> * negative values on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_list\">netlbl_cipsov4_list</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#ans_skb\">ans_skb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#nlsze_mult\">nlsze_mult</a> = 1;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi\">doi</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla_a\">nla_a</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla_b\">nla_b</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_DOI\">NLBL_CIPSOV4_A_DOI</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure\">list_failure</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#list_start\">list_start</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ans_skb\">ans_skb</a> = <a class=\"id\" href=\"#nlmsg_new\">nlmsg_new</a>(<a class=\"id\" href=\"#NLMSG_DEFAULT_SIZE\">NLMSG_DEFAULT_SIZE</a> * <a class=\"id\" href=\"#nlsze_mult\">nlsze_mult</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ans_skb\">ans_skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure\">list_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#genlmsg_put_reply\">genlmsg_put_reply</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#netlbl_cipsov4_gnl_family\">netlbl_cipsov4_gnl_family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> 0, <a class=\"id\" href=\"#NLBL_CIPSOV4_C_LIST\">NLBL_CIPSOV4_C_LIST</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#data\">data</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure\">list_failure</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi\">doi</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_CIPSOV4_A_DOI\">NLBL_CIPSOV4_A_DOI</a>]);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#cipso_v4_doi_getdef\">cipso_v4_doi_getdef</a>(<a class=\"id\" href=\"#doi\">doi</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure_lock\">list_failure_lock</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u32\">nla_put_u32</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MTYPE\">NLBL_CIPSOV4_A_MTYPE</a>, <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure_lock\">list_failure_lock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla_a\">nla_a</a> = <a class=\"id\" href=\"#nla_nest_start\">nla_nest_start</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAGLST\">NLBL_CIPSOV4_A_TAGLST</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_a\">nla_a</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure_lock\">list_failure_lock</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#CIPSO_V4_TAG_MAXCNT\">CIPSO_V4_TAG_MAXCNT</a> &&", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#tags\">tags</a>[<a class=\"id\" href=\"#iter\">iter</a>] != <a class=\"id\" href=\"#CIPSO_V4_TAG_INVALID\">CIPSO_V4_TAG_INVALID</a>;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#iter\">iter</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u8\">nla_put_u8</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NLBL_CIPSOV4_A_TAG\">NLBL_CIPSOV4_A_TAG</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#tags\">tags</a>[<a class=\"id\" href=\"#iter\">iter</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure_lock\">list_failure_lock</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla_nest_end\">nla_nest_end</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#nla_a\">nla_a</a>);", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_TRANS\">CIPSO_V4_MAP_TRANS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_a\">nla_a</a> = <a class=\"id\" href=\"#nla_nest_start\">nla_nest_start</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLST\">NLBL_CIPSOV4_A_MLSLVLLST</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_a\">nla_a</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure_lock\">list_failure_lock</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local_size\">local_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#iter\">iter</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local\">local</a>[<a class=\"id\" href=\"#iter\">iter</a>] ==", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#CIPSO_V4_INV_LVL\">CIPSO_V4_INV_LVL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_b\">nla_b</a> = <a class=\"id\" href=\"#nla_nest_start\">nla_nest_start</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVL\">NLBL_CIPSOV4_A_MLSLVL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_b\">nla_b</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_retry\">list_retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u32\">nla_put_u32</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLLOC\">NLBL_CIPSOV4_A_MLSLVLLOC</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#iter\">iter</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_retry\">list_retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u32\">nla_put_u32</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSLVLREM\">NLBL_CIPSOV4_A_MLSLVLREM</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local\">local</a>[<a class=\"id\" href=\"#iter\">iter</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_retry\">list_retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_nest_end\">nla_nest_end</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#nla_b\">nla_b</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_nest_end\">nla_nest_end</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#nla_a\">nla_a</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_a\">nla_a</a> = <a class=\"id\" href=\"#nla_nest_start\">nla_nest_start</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLST\">NLBL_CIPSOV4_A_MLSCATLST</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_a\">nla_a</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_retry\">list_retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local_size\">local_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#iter\">iter</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local\">local</a>[<a class=\"id\" href=\"#iter\">iter</a>] ==", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#CIPSO_V4_INV_CAT\">CIPSO_V4_INV_CAT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_b\">nla_b</a> = <a class=\"id\" href=\"#nla_nest_start\">nla_nest_start</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCAT\">NLBL_CIPSOV4_A_MLSCAT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_b\">nla_b</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_retry\">list_retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u32\">nla_put_u32</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATLOC\">NLBL_CIPSOV4_A_MLSCATLOC</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#iter\">iter</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_retry\">list_retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u32\">nla_put_u32</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MLSCATREM\">NLBL_CIPSOV4_A_MLSCATREM</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local\">local</a>[<a class=\"id\" href=\"#iter\">iter</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_retry\">list_retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_nest_end\">nla_nest_end</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#nla_b\">nla_b</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_nest_end\">nla_nest_end</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#nla_a\">nla_a</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#genlmsg_end\">genlmsg_end</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#genlmsg_reply\">genlmsg_reply</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#info\">info</a>);", 
"", 
"<a class=\"id\" href=\"#list_retry\">list_retry</a>:", 
"<span class=\"ts\"/><span class=\"comment\">/* XXX - this limit is a guesstimate */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlsze_mult\">nlsze_mult</a> &lt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlsze_mult\">nlsze_mult</a> *= 2;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_start\">list_start</a>;", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#list_failure_lock\">list_failure_lock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<a class=\"id\" href=\"#list_failure\">list_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_listall_cb - cipso_v4_doi_walk() callback for LISTALL</span>", 
"<span class=\"comment\"> * @doi_def: the CIPSOv4 DOI definition</span>", 
"<span class=\"comment\"> * @arg: the netlbl_cipsov4_doiwalk_arg structure</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function is designed to be used as a callback to the</span>", 
"<span class=\"comment\"> * cipso_v4_doi_walk() function for use in generating a response for a LISTALL</span>", 
"<span class=\"comment\"> * message.  Returns the size of the message on success, negative values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_listall_cb\">netlbl_cipsov4_listall_cb</a>(struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>, void *<a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_cipsov4_doiwalk_arg\">netlbl_cipsov4_doiwalk_arg</a> *<a class=\"id\" href=\"#cb_arg\">cb_arg</a> = <a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#genlmsg_put\">genlmsg_put</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#nl_cb\">nl_cb</a>-><a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#seq\">seq</a>, &amp;<a class=\"id\" href=\"#netlbl_cipsov4_gnl_family\">netlbl_cipsov4_gnl_family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#NLM_F_MULTI\">NLM_F_MULTI</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_C_LISTALL\">NLBL_CIPSOV4_C_LISTALL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#data\">data</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#listall_cb_failure\">listall_cb_failure</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u32\">nla_put_u32</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#NLBL_CIPSOV4_A_DOI\">NLBL_CIPSOV4_A_DOI</a>, <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#doi\">doi</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#listall_cb_failure\">listall_cb_failure</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u32\">nla_put_u32</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NLBL_CIPSOV4_A_MTYPE\">NLBL_CIPSOV4_A_MTYPE</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#listall_cb_failure\">listall_cb_failure</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#genlmsg_end\">genlmsg_end</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"", 
"<a class=\"id\" href=\"#listall_cb_failure\">listall_cb_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#genlmsg_cancel\">genlmsg_cancel</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_listall - Handle a LISTALL message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @cb: the NETLINK callback</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated LISTALL message and respond accordingly.  Returns</span>", 
"<span class=\"comment\"> * zero on success and negative values on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_listall\">netlbl_cipsov4_listall</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_cipsov4_doiwalk_arg\">netlbl_cipsov4_doiwalk_arg</a> <a class=\"id\" href=\"#cb_arg\">cb_arg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi_skip\">doi_skip</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#nl_cb\">nl_cb</a> = <a class=\"id\" href=\"#cb\">cb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_seq\">nlmsg_seq</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_walk\">cipso_v4_doi_walk</a>(&amp;<a class=\"id\" href=\"#doi_skip\">doi_skip</a>, <a class=\"id\" href=\"#netlbl_cipsov4_listall_cb\">netlbl_cipsov4_listall_cb</a>, &amp;<a class=\"id\" href=\"#cb_arg\">cb_arg</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0] = <a class=\"id\" href=\"#doi_skip\">doi_skip</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_cipsov4_remove_cb - netlbl_cipsov4_remove() callback for REMOVE</span>", 
"<span class=\"comment\"> * @entry: LSM domain mapping entry</span>", 
"<span class=\"comment\"> * @arg: the netlbl_domhsh_walk_arg structure</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function is intended for use by netlbl_cipsov4_remove() as the callback</span>", 
"<span class=\"comment\"> * for the netlbl_domhsh_walk() function; it removes LSM domain map entries</span>", 
"<span class=\"comment\"> * which are associated with the CIPSO DOI specified in @arg.  Returns zero on</span>", 
"<span class=\"comment\"> * success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_cipsov4_remove_cb\">netlbl_cipsov4_remove_cb</a>(struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>, void *<a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domhsh_walk_arg\">netlbl_domhsh_walk_arg</a> *<a class=\"id\" href=\"#cb_arg\">cb_arg</a> = <a class=\"id\" href=\"#arg\">arg</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#NETLBL_NLTYPE_CIPSOV4\">NETLBL_NLTYPE_CIPSOV4</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a>-><a class=\"id\" href=\"#doi\">doi</a> == <a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#doi\">doi</a>)", 
];
xr_frag_insert('l/29/acb86ae00f366b5df4a15e525ddda2b7f0c590.xr', __xr_tmp);
