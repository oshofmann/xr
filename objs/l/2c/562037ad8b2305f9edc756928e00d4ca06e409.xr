var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * drivers/base/power/runtime.c - Helper functions for device run-time PM</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (c) 2009 Rafael J. Wysocki &lt;rjw@sisk.pl&gt;, Novell Inc.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This file is released under the GPLv2.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sched\">sched</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pm_runtime\">pm_runtime</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#jiffies\">jiffies</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"static int <a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#from_wq\">from_wq</a>);", 
"static int <a class=\"id\" href=\"#__pm_request_idle\">__pm_request_idle</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>);", 
"static int <a class=\"id\" href=\"#__pm_request_resume\">__pm_request_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_deactivate_timer - Deactivate given device's suspend timer.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#pm_runtime_deactivate_timer\">pm_runtime_deactivate_timer</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#del_timer\">del_timer</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#suspend_timer\">suspend_timer</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a> = 0;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_cancel_pending - Deactivate suspend timer and cancel requests.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#pm_runtime_cancel_pending\">pm_runtime_cancel_pending</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_deactivate_timer\">pm_runtime_deactivate_timer</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * In case there's a request pending, make sure its work function will</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * return without doing anything.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_idle - Notify device bus type if the device can be suspended.</span>", 
"<span class=\"comment\"> * @dev: Device to notify the bus type about.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function must be called under dev-&gt;power.lock with interrupts disabled.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#__pm_runtime_idle\">__pm_runtime_idle</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__releases\">__releases</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>) <a class=\"id\" href=\"#__acquires\">__acquires</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#idle_notification\">idle_notification</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINPROGRESS\">EINPROGRESS</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>) &gt; 0", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#pm_children_suspended\">pm_children_suspended</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * If an idle notification request is pending, cancel it.  Any</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * other pending request takes precedence over us.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> == <a class=\"id\" href=\"#RPM_REQ_IDLE\">RPM_REQ_IDLE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> != <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#idle_notification\">idle_notification</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_idle\">runtime_idle</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_idle\">runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_idle\">runtime_idle</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_idle\">runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_idle\">runtime_idle</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_idle\">runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#idle_notification\">idle_notification</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up_all\">wake_up_all</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>);", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_idle - Notify device bus type if the device can be suspended.</span>", 
"<span class=\"comment\"> * @dev: Device to notify the bus type about.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#pm_runtime_idle\">pm_runtime_idle</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#__pm_runtime_idle\">__pm_runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_runtime_idle\">pm_runtime_idle</a>);", 
"", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * update_pm_runtime_accounting - Update the time accounting of power states</span>", 
"<span class=\"comment\"> * @dev: Device to update the accounting for</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * In order to be able to have time accounting of the various power states</span>", 
"<span class=\"comment\"> * (as used by programs such as PowerTOP to show the effectiveness of runtime</span>", 
"<span class=\"comment\"> * PM), we need to track the time spent in each state.</span>", 
"<span class=\"comment\"> * update_pm_runtime_accounting must be called each time before the</span>", 
"<span class=\"comment\"> * runtime_status field is updated, to account the time in the old state</span>", 
"<span class=\"comment\"> * correctly.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#update_pm_runtime_accounting\">update_pm_runtime_accounting</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#now\">now</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#delta\">delta</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#delta\">delta</a> = <a class=\"id\" href=\"#now\">now</a> - <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#accounting_timestamp\">accounting_timestamp</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#delta\">delta</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#delta\">delta</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#accounting_timestamp\">accounting_timestamp</a> = <a class=\"id\" href=\"#now\">now</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#suspended_jiffies\">suspended_jiffies</a> += <a class=\"id\" href=\"#delta\">delta</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#active_jiffies\">active_jiffies</a> += <a class=\"id\" href=\"#delta\">delta</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, enum <a class=\"id\" href=\"#rpm_status\">rpm_status</a> <a class=\"id\" href=\"#status\">status</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#update_pm_runtime_accounting\">update_pm_runtime_accounting</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> = <a class=\"id\" href=\"#status\">status</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_suspend - Carry out run-time suspend of given device.</span>", 
"<span class=\"comment\"> * @dev: Device to suspend.</span>", 
"<span class=\"comment\"> * @from_wq: If set, the function has been called via pm_wq.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Check if the device can be suspended and run the -&gt;runtime_suspend() callback</span>", 
"<span class=\"comment\"> * provided by its bus type.  If another suspend has been started earlier, wait</span>", 
"<span class=\"comment\"> * for it to finish.  If an idle notification or suspend request is pending or</span>", 
"<span class=\"comment\"> * scheduled, cancel it.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function must be called under dev-&gt;power.lock with interrupts disabled.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__pm_runtime_suspend\">__pm_runtime_suspend</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#from_wq\">from_wq</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__releases\">__releases</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>) <a class=\"id\" href=\"#__acquires\">__acquires</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#notify\">notify</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_dbg\">dev_dbg</a>(<a class=\"id\" href=\"#dev\">dev</a>, \"__pm_runtime_suspend()%s!\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#from_wq\">from_wq</a> ? \" from workqueue\" : \"\");", 
"", 
" <a class=\"id\" href=\"#repeat\">repeat</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Pending resume requests take precedence over us. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> == <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Other scheduled or pending requests need to be canceled. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_cancel_pending\">pm_runtime_cancel_pending</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 1;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_RESUMING\">RPM_RESUMING</a>", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>) &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#pm_children_suspended\">pm_children_suspended</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DEFINE_WAIT\">DEFINE_WAIT</a>(<a class=\"id\" href=\"#wait\">wait</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#from_wq\">from_wq</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINPROGRESS\">EINPROGRESS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Wait for the other suspend running in parallel with us. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prepare_to_wait\">prepare_to_wait</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#TASK_UNINTERRUPTIBLE\">TASK_UNINTERRUPTIBLE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule\">schedule</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#finish_wait\">finish_wait</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#repeat\">repeat</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#deferred_resume\">deferred_resume</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_suspend\">runtime_suspend</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_suspend\">runtime_suspend</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_suspend\">runtime_suspend</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_suspend\">runtime_suspend</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_suspend\">runtime_suspend</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_suspend\">runtime_suspend</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#ENOSYS\">ENOSYS</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a> == -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a> || <a class=\"id\" href=\"#retval\">retval</a> == -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#notify\">notify</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_cancel_pending\">pm_runtime_cancel_pending</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_deactivate_timer\">pm_runtime_deactivate_timer</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_add_unless\">atomic_add_unless</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#child_count\">child_count</a>, -1, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up_all\">wake_up_all</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#deferred_resume\">deferred_resume</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#notify\">notify</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_idle\">__pm_runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#parent\">parent</a> && !<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#ignore_children\">ignore_children</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_request_idle\">pm_request_idle</a>(<a class=\"id\" href=\"#parent\">parent</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_dbg\">dev_dbg</a>(<a class=\"id\" href=\"#dev\">dev</a>, \"__pm_runtime_suspend() returns %d!\\n\", <a class=\"id\" href=\"#retval\">retval</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_suspend - Carry out run-time suspend of given device.</span>", 
"<span class=\"comment\"> * @dev: Device to suspend.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#pm_runtime_suspend\">pm_runtime_suspend</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#__pm_runtime_suspend\">__pm_runtime_suspend</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_runtime_suspend\">pm_runtime_suspend</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_resume - Carry out run-time resume of given device.</span>", 
"<span class=\"comment\"> * @dev: Device to resume.</span>", 
"<span class=\"comment\"> * @from_wq: If set, the function has been called via pm_wq.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Check if the device can be woken up and run the -&gt;runtime_resume() callback</span>", 
"<span class=\"comment\"> * provided by its bus type.  If another resume has been started earlier, wait</span>", 
"<span class=\"comment\"> * for it to finish.  If there's a suspend running in parallel with this</span>", 
"<span class=\"comment\"> * function, wait for it to finish and resume the device.  Cancel any scheduled</span>", 
"<span class=\"comment\"> * or pending requests.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function must be called under dev-&gt;power.lock with interrupts disabled.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#from_wq\">from_wq</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__releases\">__releases</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>) <a class=\"id\" href=\"#__acquires\">__acquires</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_dbg\">dev_dbg</a>(<a class=\"id\" href=\"#dev\">dev</a>, \"__pm_runtime_resume()%s!\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#from_wq\">from_wq</a> ? \" from workqueue\" : \"\");", 
"", 
" <a class=\"id\" href=\"#repeat\">repeat</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_cancel_pending\">pm_runtime_cancel_pending</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 1;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_RESUMING\">RPM_RESUMING</a>", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DEFINE_WAIT\">DEFINE_WAIT</a>(<a class=\"id\" href=\"#wait\">wait</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#from_wq\">from_wq</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#deferred_resume\">deferred_resume</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINPROGRESS\">EINPROGRESS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Wait for the operation carried out in parallel with us. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prepare_to_wait\">prepare_to_wait</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#TASK_UNINTERRUPTIBLE\">TASK_UNINTERRUPTIBLE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_RESUMING\">RPM_RESUMING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule\">schedule</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#finish_wait\">finish_wait</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#repeat\">repeat</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#parent\">parent</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Increment the parent's resume counter and resume it if</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * necessary.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_get_noresume\">pm_runtime_get_noresume</a>(<a class=\"id\" href=\"#parent\">parent</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * We can resume if the parent's run-time PM is disabled or it</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * is set to ignore children.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>    && !<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#ignore_children\">ignore_children</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(<a class=\"id\" href=\"#parent\">parent</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#repeat\">repeat</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#RPM_RESUMING\">RPM_RESUMING</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_resume\">runtime_resume</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_resume\">runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_resume\">runtime_resume</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_resume\">runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_resume\">runtime_resume</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#class\">class</a>-><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#runtime_resume\">runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#ENOSYS\">ENOSYS</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_cancel_pending\">pm_runtime_cancel_pending</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#parent\">parent</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#child_count\">child_count</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up_all\">wake_up_all</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_request_idle\">__pm_request_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_put\">pm_runtime_put</a>(<a class=\"id\" href=\"#parent\">parent</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_dbg\">dev_dbg</a>(<a class=\"id\" href=\"#dev\">dev</a>, \"__pm_runtime_resume() returns %d!\\n\", <a class=\"id\" href=\"#retval\">retval</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_resume - Carry out run-time resume of given device.</span>", 
"<span class=\"comment\"> * @dev: Device to suspend.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#pm_runtime_resume\">pm_runtime_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_runtime_resume\">pm_runtime_resume</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_work - Universal run-time PM work function.</span>", 
"<span class=\"comment\"> * @work: Work structure used for scheduling the execution of this function.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Use @work to get the device object the work is to be done for, determine what</span>", 
"<span class=\"comment\"> * is to be done and execute the appropriate run-time PM function.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#pm_runtime_work\">pm_runtime_work</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#work\">work</a>, struct <a class=\"id\" href=\"#device\">device</a>, <a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#work\">work</a>);", 
"<span class=\"ts\"/>enum <a class=\"id\" href=\"#rpm_request\">rpm_request</a> <a class=\"id\" href=\"#req\">req</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#req\">req</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#RPM_REQ_IDLE\">RPM_REQ_IDLE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_idle\">__pm_runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#RPM_REQ_SUSPEND\">RPM_REQ_SUSPEND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_suspend\">__pm_runtime_suspend</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#true\">true</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#true\">true</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_request_idle - Submit an idle notification request for given device.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Check if the device's run-time PM status is correct for suspending the device</span>", 
"<span class=\"comment\"> * and queue up a request to run __pm_runtime_idle() for it.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function must be called under dev-&gt;power.lock with interrupts disabled.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#__pm_request_idle\">__pm_request_idle</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>) &gt; 0", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#pm_children_suspended\">pm_children_suspended</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Any requests other then RPM_REQ_IDLE take precedence. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> == <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_IDLE\">RPM_REQ_IDLE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> != <a class=\"id\" href=\"#RPM_REQ_IDLE\">RPM_REQ_IDLE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_IDLE\">RPM_REQ_IDLE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_work\">queue_work</a>(<a class=\"id\" href=\"#pm_wq\">pm_wq</a>, &amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#work\">work</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_request_idle - Submit an idle notification request for given device.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#pm_request_idle\">pm_request_idle</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#__pm_request_idle\">__pm_request_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_request_idle\">pm_request_idle</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_request_suspend - Submit a suspend request for given device.</span>", 
"<span class=\"comment\"> * @dev: Device to suspend.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function must be called under dev-&gt;power.lock with interrupts disabled.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#__pm_request_suspend\">__pm_request_suspend</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 1;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>) &gt; 0", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINPROGRESS\">EINPROGRESS</a>;", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#pm_children_suspended\">pm_children_suspended</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_deactivate_timer\">pm_runtime_deactivate_timer</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Pending resume requests take precedence over us, but we can</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * overtake any other pending request.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> == <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> != <a class=\"id\" href=\"#RPM_REQ_SUSPEND\">RPM_REQ_SUSPEND</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#retval\">retval</a> ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a> : <a class=\"id\" href=\"#RPM_REQ_SUSPEND\">RPM_REQ_SUSPEND</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#retval\">retval</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_SUSPEND\">RPM_REQ_SUSPEND</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_work\">queue_work</a>(<a class=\"id\" href=\"#pm_wq\">pm_wq</a>, &amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#work\">work</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_suspend_timer_fn - Timer function for pm_schedule_suspend().</span>", 
"<span class=\"comment\"> * @data: Device pointer passed by pm_schedule_suspend().</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Check if the time is right and execute __pm_request_suspend() in that case.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#pm_suspend_timer_fn\">pm_suspend_timer_fn</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a> = (struct <a class=\"id\" href=\"#device\">device</a> *)<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#expires\">expires</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#expires\">expires</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* If 'expire' is after 'jiffies' we've been called too early. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#expires\">expires</a> &gt; 0 && !<a class=\"id\" href=\"#time_after\">time_after</a>(<a class=\"id\" href=\"#expires\">expires</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_request_suspend\">__pm_request_suspend</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_schedule_suspend - Set up a timer to submit a suspend request in future.</span>", 
"<span class=\"comment\"> * @dev: Device to suspend.</span>", 
"<span class=\"comment\"> * @delay: Time to wait before submitting a suspend request, in milliseconds.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#pm_schedule_suspend\">pm_schedule_suspend</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, unsigned int <a class=\"id\" href=\"#delay\">delay</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#delay\">delay</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#__pm_request_suspend\">__pm_request_suspend</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_deactivate_timer\">pm_runtime_deactivate_timer</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Pending resume requests take precedence over us, but any</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * other pending requests have to be canceled.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> == <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 1;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>) &gt; 0", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#pm_children_suspended\">pm_children_suspended</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a> + <a class=\"id\" href=\"#msecs_to_jiffies\">msecs_to_jiffies</a>(<a class=\"id\" href=\"#delay\">delay</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#suspend_timer\">suspend_timer</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a>);", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_schedule_suspend\">pm_schedule_suspend</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_request_resume - Submit a resume request for given device.</span>", 
"<span class=\"comment\"> * @dev: Device to resume.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function must be called under dev-&gt;power.lock with interrupts disabled.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#__pm_request_resume\">__pm_request_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 1;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_RESUMING\">RPM_RESUMING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EINPROGRESS\">EINPROGRESS</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_deactivate_timer\">pm_runtime_deactivate_timer</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#deferred_resume\">deferred_resume</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* If non-resume request is pending, we can overtake it. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#retval\">retval</a> ? <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a> : <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#retval\">retval</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#queue_work\">queue_work</a>(<a class=\"id\" href=\"#pm_wq\">pm_wq</a>, &amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#work\">work</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_request_resume - Submit a resume request for given device.</span>", 
"<span class=\"comment\"> * @dev: Device to resume.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#pm_request_resume\">pm_request_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#__pm_request_resume\">__pm_request_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_request_resume\">pm_request_resume</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_get - Reference count a device and wake it up, if necessary.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> * @sync: If set and the device is suspended, resume it synchronously.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Increment the usage count of the device and resume it or submit a resume</span>", 
"<span class=\"comment\"> * request for it, depending on the value of @sync.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__pm_runtime_get\">__pm_runtime_get</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#sync\">sync</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#sync\">sync</a> ? <a class=\"id\" href=\"#pm_runtime_resume\">pm_runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>) : <a class=\"id\" href=\"#pm_request_resume\">pm_request_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#__pm_runtime_get\">__pm_runtime_get</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_put - Decrement the device's usage counter and notify its bus.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> * @sync: If the device's bus type is to be notified, do that synchronously.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Decrement the usage count of the device and if it reaches zero, carry out a</span>", 
"<span class=\"comment\"> * synchronous idle notification or submit an idle notification request for it,</span>", 
"<span class=\"comment\"> * depending on the value of @sync.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__pm_runtime_put\">__pm_runtime_put</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#sync\">sync</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_dec_and_test\">atomic_dec_and_test</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#sync\">sync</a> ? <a class=\"id\" href=\"#pm_runtime_idle\">pm_runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>) : <a class=\"id\" href=\"#pm_request_idle\">pm_request_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#__pm_runtime_put\">__pm_runtime_put</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_set_status - Set run-time PM status of a device.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> * @status: New run-time PM status of the device.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * If run-time PM of the device is disabled or its power.runtime_error field is</span>", 
"<span class=\"comment\"> * different from zero, the status may be changed either to RPM_ACTIVE, or to</span>", 
"<span class=\"comment\"> * RPM_SUSPENDED, as long as that reflects the actual state of the device.</span>", 
"<span class=\"comment\"> * However, if the device has a parent and the parent is not active, and the</span>", 
"<span class=\"comment\"> * parent's power.ignore_children flag is unset, the device's status cannot be</span>", 
"<span class=\"comment\"> * set to RPM_ACTIVE, so -EBUSY is returned in that case.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * If successful, __pm_runtime_set_status() clears the power.runtime_error field</span>", 
"<span class=\"comment\"> * and the device parent's counter of unsuspended children is modified to</span>", 
"<span class=\"comment\"> * reflect the new status.  If the new status is RPM_SUSPENDED, an idle</span>", 
"<span class=\"comment\"> * notification request for the parent is submitted.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__pm_runtime_set_status\">__pm_runtime_set_status</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, unsigned int <a class=\"id\" href=\"#status\">status</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#notify_parent\">notify_parent</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#status\">status</a> != <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a> && <a class=\"id\" href=\"#status\">status</a> != <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> && !<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#status\">status</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_set\">out_set</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#status\">status</a> == <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* It always is possible to set the status to 'suspended'. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_add_unless\">atomic_add_unless</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#child_count\">child_count</a>, -1, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#notify_parent\">notify_parent</a> = !<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#ignore_children\">ignore_children</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_set\">out_set</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_nested\">spin_lock_nested</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#SINGLE_DEPTH_NESTING\">SINGLE_DEPTH_NESTING</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * It is invalid to put an active child under a parent that is</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * not active, has run-time PM enabled and the</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * 'power.ignore_children' flag unset.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>    && !<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#ignore_children\">ignore_children</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>    && <a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#child_count\">child_count</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
" <a class=\"id\" href=\"#out_set\">out_set</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__update_runtime_status\">__update_runtime_status</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#status\">status</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = 0;", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#notify_parent\">notify_parent</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_request_idle\">pm_request_idle</a>(<a class=\"id\" href=\"#parent\">parent</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#__pm_runtime_set_status\">__pm_runtime_set_status</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_barrier - Cancel pending requests and wait for completions.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Flush all pending requests for the device from pm_wq and wait for all</span>", 
"<span class=\"comment\"> * run-time PM operations involving the device in progress to complete.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Should be called under dev-&gt;power.lock with interrupts disabled.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#__pm_runtime_barrier\">__pm_runtime_barrier</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_deactivate_timer\">pm_runtime_deactivate_timer</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cancel_work_sync\">cancel_work_sync</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#work\">work</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_RESUMING\">RPM_RESUMING</a>", 
"<span class=\"ts\"/>    || <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#idle_notification\">idle_notification</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DEFINE_WAIT\">DEFINE_WAIT</a>(<a class=\"id\" href=\"#wait\">wait</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Suspend, wake-up or idle notification in progress. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prepare_to_wait\">prepare_to_wait</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#TASK_UNINTERRUPTIBLE\">TASK_UNINTERRUPTIBLE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_SUSPENDING\">RPM_SUSPENDING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> != <a class=\"id\" href=\"#RPM_RESUMING\">RPM_RESUMING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    && !<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#idle_notification\">idle_notification</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule\">schedule</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#finish_wait\">finish_wait</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_barrier - Flush pending requests and wait for completions.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Prevent the device from being suspended by incrementing its usage counter and</span>", 
"<span class=\"comment\"> * if there's a pending resume request for the device, wake the device up.</span>", 
"<span class=\"comment\"> * Next, make sure that all pending requests for the device have been flushed</span>", 
"<span class=\"comment\"> * from pm_wq and wait for all run-time PM operations involving the device in</span>", 
"<span class=\"comment\"> * progress to complete.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Return value:</span>", 
"<span class=\"comment\"> * 1, if there was a resume request pending and the device had to be woken up,</span>", 
"<span class=\"comment\"> * 0, otherwise</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#pm_runtime_barrier\">pm_runtime_barrier</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_get_noresume\">pm_runtime_get_noresume</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> == <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_barrier\">__pm_runtime_barrier</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_put_noidle\">pm_runtime_put_noidle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_runtime_barrier\">pm_runtime_barrier</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __pm_runtime_disable - Disable run-time PM of a device.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> * @check_resume: If set, check if there's a resume request for the device.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Increment power.disable_depth for the device and if was zero previously,</span>", 
"<span class=\"comment\"> * cancel all pending run-time PM requests for the device and wait for all</span>", 
"<span class=\"comment\"> * operations in progress to complete.  The device can be either active or</span>", 
"<span class=\"comment\"> * suspended after its run-time PM has been disabled.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * If @check_resume is set and there's a resume request pending when</span>", 
"<span class=\"comment\"> * __pm_runtime_disable() is called and power.disable_depth is zero, the</span>", 
"<span class=\"comment\"> * function will wake up the device before disabling its run-time PM.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#__pm_runtime_disable\">__pm_runtime_disable</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#check_resume\">check_resume</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Wake up the device if there's a resume request pending, because that</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * means there probably is some I/O to process and disabling run-time PM</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * shouldn't prevent the device from processing the I/O.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#check_resume\">check_resume</a> && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a>", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> == <a class=\"id\" href=\"#RPM_REQ_RESUME\">RPM_REQ_RESUME</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Prevent suspends and idle notifications from being carried</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * out after we have woken up the device.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_get_noresume\">pm_runtime_get_noresume</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_put_noidle\">pm_runtime_put_noidle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_barrier\">__pm_runtime_barrier</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#__pm_runtime_disable\">__pm_runtime_disable</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_enable - Enable run-time PM of a device.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#pm_runtime_enable\">pm_runtime_enable</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a>--;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_warn\">dev_warn</a>(<a class=\"id\" href=\"#dev\">dev</a>, \"Unbalanced %s!\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_runtime_enable\">pm_runtime_enable</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_forbid - Block run-time PM of a device.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Increase the device's usage count and clear its power.runtime_auto flag,</span>", 
"<span class=\"comment\"> * so that it cannot be suspended at run time until pm_runtime_allow() is called</span>", 
"<span class=\"comment\"> * for it.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#pm_runtime_forbid\">pm_runtime_forbid</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_auto\">runtime_auto</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_auto\">runtime_auto</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_resume\">__pm_runtime_resume</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_runtime_forbid\">pm_runtime_forbid</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_allow - Unblock run-time PM of a device.</span>", 
"<span class=\"comment\"> * @dev: Device to handle.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Decrease the device's usage count and set its power.runtime_auto flag.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#pm_runtime_allow\">pm_runtime_allow</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irq\">spin_lock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_auto\">runtime_auto</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_auto\">runtime_auto</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_dec_and_test\">atomic_dec_and_test</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_idle\">__pm_runtime_idle</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irq\">spin_unlock_irq</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#pm_runtime_allow\">pm_runtime_allow</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_init - Initialize run-time PM fields in given device object.</span>", 
"<span class=\"comment\"> * @dev: Device object to initialize.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#pm_runtime_init\">pm_runtime_init</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> = <a class=\"id\" href=\"#RPM_SUSPENDED\">RPM_SUSPENDED</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#idle_notification\">idle_notification</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#disable_depth\">disable_depth</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#usage_count\">usage_count</a>, 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_error\">runtime_error</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#child_count\">child_count</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm_suspend_ignore_children\">pm_suspend_ignore_children</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_auto\">runtime_auto</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request_pending\">request_pending</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#request\">request</a> = <a class=\"id\" href=\"#RPM_REQ_NONE\">RPM_REQ_NONE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#deferred_resume\">deferred_resume</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#accounting_timestamp\">accounting_timestamp</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_WORK\">INIT_WORK</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#work\">work</a>, <a class=\"id\" href=\"#pm_runtime_work\">pm_runtime_work</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#timer_expires\">timer_expires</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setup_timer\">setup_timer</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#suspend_timer\">suspend_timer</a>, <a class=\"id\" href=\"#pm_suspend_timer_fn\">pm_suspend_timer_fn</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned long)<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#init_waitqueue_head\">init_waitqueue_head</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#wait_queue\">wait_queue</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pm_runtime_remove - Prepare for removing a device from device hierarchy.</span>", 
"<span class=\"comment\"> * @dev: Device object being removed from device hierarchy.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#pm_runtime_remove\">pm_runtime_remove</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__pm_runtime_disable\">__pm_runtime_disable</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#false\">false</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Change the status back to 'suspended' to match the initial status. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#power\">power</a>.<a class=\"id\" href=\"#runtime_status\">runtime_status</a> == <a class=\"id\" href=\"#RPM_ACTIVE\">RPM_ACTIVE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_set_suspended\">pm_runtime_set_suspended</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"}", 
];
xr_frag_insert('l/2c/562037ad8b2305f9edc756928e00d4ca06e409.xr', __xr_tmp);
