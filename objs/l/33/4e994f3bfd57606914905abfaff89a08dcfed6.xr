var __xr_tmp = [
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Neighbour tables are full and nothing</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   can be released. Try to shrink route cache,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   it is most likely it holds some neighbour records.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#attempts\">attempts</a>-- &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#saved_elasticity\">saved_elasticity</a> = <a class=\"id\" href=\"#ip_rt_gc_elasticity\">ip_rt_gc_elasticity</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#saved_int\">saved_int</a> = <a class=\"id\" href=\"#ip_rt_gc_min_interval\">ip_rt_gc_min_interval</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_gc_elasticity\">ip_rt_gc_elasticity</a><span class=\"ts\"/>= 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_gc_min_interval\">ip_rt_gc_min_interval</a><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_garbage_collect\">rt_garbage_collect</a>(&amp;<a class=\"id\" href=\"#ipv4_dst_ops\">ipv4_dst_ops</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_gc_min_interval\">ip_rt_gc_min_interval</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saved_int\">saved_int</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_gc_elasticity\">ip_rt_gc_elasticity</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saved_elasticity\">saved_elasticity</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#restart\">restart</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"ipv4: Neighbour table overflow.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_drop\">rt_drop</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a> = <a class=\"id\" href=\"#rt_hash_table\">rt_hash_table</a>[<a class=\"id\" href=\"#hash\">hash</a>].<a class=\"id\" href=\"#chain\">chain</a>;", 
"", 
"#if <a class=\"id\" href=\"#RT_CACHE_DEBUG\">RT_CACHE_DEBUG</a> >= 2", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#trt\">trt</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"rt_cache @%02x: %pI4\",", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#hash\">hash</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#trt\">trt</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>; <a class=\"id\" href=\"#trt\">trt</a>; <a class=\"id\" href=\"#trt\">trt</a> = <a class=\"id\" href=\"#trt\">trt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\" . %pI4\", &amp;<a class=\"id\" href=\"#trt\">trt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"\\n\");", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Since lookup is lockfree, we must make sure</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * previous writes to rt are comitted to memory</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * before making rt visible to other CPUS.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#rt_hash_table\">rt_hash_table</a>[<a class=\"id\" href=\"#hash\">hash</a>].<a class=\"id\" href=\"#chain\">chain</a>, <a class=\"id\" href=\"#rt\">rt</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(<a class=\"id\" href=\"#rt_hash_lock_addr\">rt_hash_lock_addr</a>(<a class=\"id\" href=\"#hash\">hash</a>));", 
"", 
"<a class=\"id\" href=\"#skip_hashing\">skip_hashing</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rp\">rp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#rp\">rp</a> = <a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_set\">skb_dst_set</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"void <a class=\"id\" href=\"#rt_bind_peer\">rt_bind_peer</a>(struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>, int <a class=\"id\" href=\"#create\">create</a>)", 
"{", 
"<span class=\"ts\"/>static <a class=\"id\" href=\"#DEFINE_SPINLOCK\">DEFINE_SPINLOCK</a>(<a class=\"id\" href=\"#rt_peer_lock\">rt_peer_lock</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_peer\">inet_peer</a> *<a class=\"id\" href=\"#peer\">peer</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#peer\">peer</a> = <a class=\"id\" href=\"#inet_getpeer\">inet_getpeer</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>, <a class=\"id\" href=\"#create\">create</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#rt_peer_lock\">rt_peer_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a> = <a class=\"id\" href=\"#peer\">peer</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#peer\">peer</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#rt_peer_lock\">rt_peer_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#peer\">peer</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet_putpeer\">inet_putpeer</a>(<a class=\"id\" href=\"#peer\">peer</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Peer allocation may fail only in serious out-of-memory conditions.  However</span>", 
"<span class=\"comment\"> * we still can generate some output.</span>", 
"<span class=\"comment\"> * Random ID selection looks a bit dangerous because we have no chances to</span>", 
"<span class=\"comment\"> * select ID being unique in a reasonable period of time.</span>", 
"<span class=\"comment\"> * But broken packet identifier may be better than no packet at all.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#ip_select_fb_ident\">ip_select_fb_ident</a>(struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph\">iph</a>)", 
"{", 
"<span class=\"ts\"/>static <a class=\"id\" href=\"#DEFINE_SPINLOCK\">DEFINE_SPINLOCK</a>(<a class=\"id\" href=\"#ip_fb_id_lock\">ip_fb_id_lock</a>);", 
"<span class=\"ts\"/>static <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#ip_fallback_id\">ip_fallback_id</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#salt\">salt</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#ip_fb_id_lock\">ip_fb_id_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#salt\">salt</a> = <a class=\"id\" href=\"#secure_ip_id\">secure_ip_id</a>((<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#__be32\">__be32</a>)<a class=\"id\" href=\"#ip_fallback_id\">ip_fallback_id</a> ^ <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#daddr\">daddr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#salt\">salt</a> &amp; 0xFFFF);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_fallback_id\">ip_fallback_id</a> = <a class=\"id\" href=\"#salt\">salt</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#ip_fb_id_lock\">ip_fb_id_lock</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#__ip_select_ident\">__ip_select_ident</a>(struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph\">iph</a>, struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, int <a class=\"id\" href=\"#more\">more</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rtable\">rtable</a> *) <a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_bind_peer\">rt_bind_peer</a>(<a class=\"id\" href=\"#rt\">rt</a>, 1);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* If peer is attached to destination, it is never detached,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   so that we need not to grab a lock to dereference it.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#inet_getid\">inet_getid</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a>, <a class=\"id\" href=\"#more\">more</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"rt_bind_peer(0) @%p\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#__builtin_return_address\">__builtin_return_address</a>(0));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_select_fb_ident\">ip_select_fb_ident</a>(<a class=\"id\" href=\"#iph\">iph</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#__ip_select_ident\">__ip_select_ident</a>);", 
"", 
"static void <a class=\"id\" href=\"#rt_del\">rt_del</a>(unsigned <a class=\"id\" href=\"#hash\">hash</a>, struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#rthp\">rthp</a>, *<a class=\"id\" href=\"#aux\">aux</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rthp\">rthp</a> = &amp;<a class=\"id\" href=\"#rt_hash_table\">rt_hash_table</a>[<a class=\"id\" href=\"#hash\">hash</a>].<a class=\"id\" href=\"#chain\">chain</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(<a class=\"id\" href=\"#rt_hash_lock_addr\">rt_hash_lock_addr</a>(<a class=\"id\" href=\"#hash\">hash</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/>while ((<a class=\"id\" href=\"#aux\">aux</a> = *<a class=\"id\" href=\"#rthp\">rthp</a>) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#aux\">aux</a> == <a class=\"id\" href=\"#rt\">rt</a> || <a class=\"id\" href=\"#rt_is_expired\">rt_is_expired</a>(<a class=\"id\" href=\"#aux\">aux</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#rthp\">rthp</a> = <a class=\"id\" href=\"#aux\">aux</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_free\">rt_free</a>(<a class=\"id\" href=\"#aux\">aux</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rthp\">rthp</a> = &amp;<a class=\"id\" href=\"#aux\">aux</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(<a class=\"id\" href=\"#rt_hash_lock_addr\">rt_hash_lock_addr</a>(<a class=\"id\" href=\"#hash\">hash</a>));", 
"}", 
"", 
"<span class=\"comment\">/* called in rcu_read_lock() section */</span>", 
"void <a class=\"id\" href=\"#ip_rt_redirect\">ip_rt_redirect</a>(<a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#old_gw\">old_gw</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#new_gw\">new_gw</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rcu\">__in_dev_get_rcu</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rth\">rth</a>, **<a class=\"id\" href=\"#rthp\">rthp</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a>  <a class=\"id\" href=\"#skeys\">skeys</a>[2] = { <a class=\"id\" href=\"#saddr\">saddr</a>, 0 };", 
"<span class=\"ts\"/>int  <a class=\"id\" href=\"#ikeys\">ikeys</a>[2] = { <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>, 0 };", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netevent_redirect\">netevent_redirect</a> <a class=\"id\" href=\"#netevent\">netevent</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new_gw\">new_gw</a> == <a class=\"id\" href=\"#old_gw\">old_gw</a> || !<a class=\"id\" href=\"#IN_DEV_RX_REDIRECTS\">IN_DEV_RX_REDIRECTS</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#new_gw\">new_gw</a>) || <a class=\"id\" href=\"#ipv4_is_lbcast\">ipv4_is_lbcast</a>(<a class=\"id\" href=\"#new_gw\">new_gw</a>) ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#new_gw\">new_gw</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reject_redirect\">reject_redirect</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rt_caching\">rt_caching</a>(<a class=\"id\" href=\"#net\">net</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reject_redirect\">reject_redirect</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#IN_DEV_SHARED_MEDIA\">IN_DEV_SHARED_MEDIA</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#inet_addr_onlink\">inet_addr_onlink</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#new_gw\">new_gw</a>, <a class=\"id\" href=\"#old_gw\">old_gw</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reject_redirect\">reject_redirect</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_SEC_REDIRECTS\">IN_DEV_SEC_REDIRECTS</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) && <a class=\"id\" href=\"#ip_fib_check_default\">ip_fib_check_default</a>(<a class=\"id\" href=\"#new_gw\">new_gw</a>, <a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reject_redirect\">reject_redirect</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_addr_type\">inet_addr_type</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#new_gw\">new_gw</a>) != <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#reject_redirect\">reject_redirect</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; 2; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#k\">k</a> = 0; <a class=\"id\" href=\"#k\">k</a> &lt; 2; <a class=\"id\" href=\"#k\">k</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned <a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#skeys\">skeys</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#ikeys\">ikeys</a>[<a class=\"id\" href=\"#k\">k</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rthp\">rthp</a>=&amp;<a class=\"id\" href=\"#rt_hash_table\">rt_hash_table</a>[<a class=\"id\" href=\"#hash\">hash</a>].<a class=\"id\" href=\"#chain\">chain</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>while ((<a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(*<a class=\"id\" href=\"#rthp\">rthp</a>)) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> != <a class=\"id\" href=\"#daddr\">daddr</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> != <a class=\"id\" href=\"#skeys\">skeys</a>[<a class=\"id\" href=\"#i\">i</a>] ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> != <a class=\"id\" href=\"#ikeys\">ikeys</a>[<a class=\"id\" href=\"#k\">k</a>] ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a> != 0 ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rt_is_expired\">rt_is_expired</a>(<a class=\"id\" href=\"#rth\">rth</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#net_eq\">net_eq</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#net\">net</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rthp\">rthp</a> = &amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a> != <a class=\"id\" href=\"#daddr\">daddr</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a> != <a class=\"id\" href=\"#saddr\">saddr</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#error\">error</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a> != <a class=\"id\" href=\"#old_gw\">old_gw</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a> != <a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_hold\">dst_hold</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#dst_alloc\">dst_alloc</a>(&amp;<a class=\"id\" href=\"#ipv4_dst_ops\">ipv4_dst_ops</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rth\">rth</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Copy all the information. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#rt\">rt</a> = *<a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#__use\">__use</a><span class=\"ts\"/><span class=\"ts\"/>= 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#__refcnt\">__refcnt</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#child\">child</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_hold\">in_dev_hold</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#obsolete\">obsolete</a><span class=\"ts\"/>= -1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#lastuse\">lastuse</a><span class=\"ts\"/>= <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#path\">path</a><span class=\"ts\"/><span class=\"ts\"/>= &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#neighbour\">neighbour</a><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#hh\">hh</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_XFRM\">CONFIG_XFRM</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#xfrm\">xfrm</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_genid\">rt_genid</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a><span class=\"ts\"/><span class=\"ts\"/>|= <a class=\"id\" href=\"#RTCF_REDIRECTED\">RTCF_REDIRECTED</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Gateway is different ... */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#new_gw\">new_gw</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Redirect received -&gt; path was valid */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_confirm\">dst_confirm</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arp_bind_neighbour\">arp_bind_neighbour</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    !(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#neighbour\">neighbour</a>-><a class=\"id\" href=\"#nud_state\">nud_state</a> &amp;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#NUD_VALID\">NUD_VALID</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#neighbour\">neighbour</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#neigh_event_send\">neigh_event_send</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#neighbour\">neighbour</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rth\">rth</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_drop\">rt_drop</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#do_next\">do_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netevent\">netevent</a>.<a class=\"id\" href=\"#old\">old</a> = &amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netevent\">netevent</a>.<a class=\"id\" href=\"#new\">new</a> = &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_netevent_notifiers\">call_netevent_notifiers</a>(<a class=\"id\" href=\"#NETEVENT_REDIRECT\">NETEVENT_REDIRECT</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#netevent\">netevent</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_del\">rt_del</a>(<a class=\"id\" href=\"#hash\">hash</a>, <a class=\"id\" href=\"#rth\">rth</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#rt_intern_hash\">rt_intern_hash</a>(<a class=\"id\" href=\"#hash\">hash</a>, <a class=\"id\" href=\"#rt\">rt</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#do_next\">do_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_next\">do_next</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return;", 
"", 
"<a class=\"id\" href=\"#reject_redirect\">reject_redirect</a>:", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_VERBOSE\">CONFIG_IP_ROUTE_VERBOSE</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_LOG_MARTIANS\">IN_DEV_LOG_MARTIANS</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) && <a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"Redirect from %pI4 on %s about %pI4 ignored.\\n\"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"  Advised path = %pI4 -> %pI4\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#old_gw\">old_gw</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, &amp;<a class=\"id\" href=\"#new_gw\">new_gw</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#saddr\">saddr</a>, &amp;<a class=\"id\" href=\"#daddr\">daddr</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#ipv4_negative_advice\">ipv4_negative_advice</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rtable\">rtable</a> *)<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#obsolete\">obsolete</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if ((<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTCF_REDIRECTED\">RTCF_REDIRECTED</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#expires\">expires</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#time_after_eq\">time_after_eq</a>(<a class=\"id\" href=\"#jiffies\">jiffies</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#expires\">expires</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned <a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#dev\">dev</a>)));", 
"#if <a class=\"id\" href=\"#RT_CACHE_DEBUG\">RT_CACHE_DEBUG</a> >= 1", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"ipv4_negative_advice: redirect to %pI4/%02x dropped\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_tos\">fl4_tos</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_del\">rt_del</a>(<a class=\"id\" href=\"#hash\">hash</a>, <a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Algorithm:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>1. The first ip_rt_redirect_number redirects are sent</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>   with exponential backoff, then we stop sending them at all,</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>   assuming that the host ignores our redirects.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>2. If we did not see packets requiring redirects</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>   during ip_rt_redirect_silence, we assume that the host</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>   forgot redirected route and start to send redirects again.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This algorithm is much cheaper and more intelligent than dumb load limiting</span>", 
"<span class=\"comment\"> * in icmp.c.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * NOTE. Do not forget to inhibit load limiting for redirects (redundant)</span>", 
"<span class=\"comment\"> * and \"frag. need\" (breaks PMTU discovery) in icmp.c.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_rt_send_redirect\">ip_rt_send_redirect</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#log_martians\">log_martians</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rcu\">__in_dev_get_rcu</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a> || !<a class=\"id\" href=\"#IN_DEV_TX_REDIRECTS\">IN_DEV_TX_REDIRECTS</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#log_martians\">log_martians</a> = <a class=\"id\" href=\"#IN_DEV_LOG_MARTIANS\">IN_DEV_LOG_MARTIANS</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* No redirected packets during ip_rt_redirect_silence;</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * reset the algorithm.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#time_after\">time_after</a>(<a class=\"id\" href=\"#jiffies\">jiffies</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_last\">rate_last</a> + <a class=\"id\" href=\"#ip_rt_redirect_silence\">ip_rt_redirect_silence</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Too many ignored redirects; do not send anything</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * set dst.rate_last to the last seen redirected packet.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> >= <a class=\"id\" href=\"#ip_rt_redirect_number\">ip_rt_redirect_number</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_last\">rate_last</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check for load limit; set rate_last to the latest sent</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * redirect.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> == 0 ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#time_after\">time_after</a>(<a class=\"id\" href=\"#jiffies\">jiffies</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_last\">rate_last</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#ip_rt_redirect_load\">ip_rt_redirect_load</a> << <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a>)))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#icmp_send\">icmp_send</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ICMP_REDIRECT\">ICMP_REDIRECT</a>, <a class=\"id\" href=\"#ICMP_REDIR_HOST\">ICMP_REDIR_HOST</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_last\">rate_last</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_VERBOSE\">CONFIG_IP_ROUTE_VERBOSE</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#log_martians\">log_martians</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> == <a class=\"id\" href=\"#ip_rt_redirect_number\">ip_rt_redirect_number</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"host %pI4/if%d ignores redirects for %pI4 to %pI4.\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_iif\">rt_iif</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static int <a class=\"id\" href=\"#ip_error\">ip_error</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#code\">code</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#error\">error</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#EINVAL\">EINVAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#EHOSTUNREACH\">EHOSTUNREACH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#ICMP_HOST_UNREACH\">ICMP_HOST_UNREACH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#ENETUNREACH\">ENETUNREACH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#ICMP_NET_UNREACH\">ICMP_NET_UNREACH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IP_INC_STATS_BH\">IP_INC_STATS_BH</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IPSTATS_MIB_INNOROUTES\">IPSTATS_MIB_INNOROUTES</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#EACCES\">EACCES</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#ICMP_PKT_FILTERED\">ICMP_PKT_FILTERED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#now\">now</a> = <a class=\"id\" href=\"#jiffies\">jiffies</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> += <a class=\"id\" href=\"#now\">now</a> - <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_last\">rate_last</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> &gt; <a class=\"id\" href=\"#ip_rt_error_burst\">ip_rt_error_burst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> = <a class=\"id\" href=\"#ip_rt_error_burst\">ip_rt_error_burst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_last\">rate_last</a> = <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> >= <a class=\"id\" href=\"#ip_rt_error_cost\">ip_rt_error_cost</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rate_tokens\">rate_tokens</a> -= <a class=\"id\" href=\"#ip_rt_error_cost\">ip_rt_error_cost</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#icmp_send\">icmp_send</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ICMP_DEST_UNREACH\">ICMP_DEST_UNREACH</a>, <a class=\"id\" href=\"#code\">code</a>, 0);", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>The last two values are not from the RFC but</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>are needed for AMPRnet AX.25 paths.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static const unsigned short <a class=\"id\" href=\"#mtu_plateau\">mtu_plateau</a>[] =", 
"{32000, 17914, 8166, 4352, 2002, 1492, 576, 296, 216, 128 };", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned short <a class=\"id\" href=\"#guess_mtu\">guess_mtu</a>(unsigned short <a class=\"id\" href=\"#old_mtu\">old_mtu</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#mtu_plateau\">mtu_plateau</a>); <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#old_mtu\">old_mtu</a> &gt; <a class=\"id\" href=\"#mtu_plateau\">mtu_plateau</a>[<a class=\"id\" href=\"#i\">i</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#mtu_plateau\">mtu_plateau</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/>return 68;", 
"}", 
"", 
"unsigned short <a class=\"id\" href=\"#ip_rt_frag_needed\">ip_rt_frag_needed</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph\">iph</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> unsigned short <a class=\"id\" href=\"#new_mtu\">new_mtu</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#old_mtu\">old_mtu</a> = <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#tot_len\">tot_len</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/>int  <a class=\"id\" href=\"#ikeys\">ikeys</a>[2] = { <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>, 0 };", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a>  <a class=\"id\" href=\"#skeys\">skeys</a>[2] = { <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#saddr\">saddr</a>, 0, };", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a>  <a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#est_mtu\">est_mtu</a> = 0;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#k\">k</a> = 0; <a class=\"id\" href=\"#k\">k</a> &lt; 2; <a class=\"id\" href=\"#k\">k</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; 2; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned <a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#skeys\">skeys</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#ikeys\">ikeys</a>[<a class=\"id\" href=\"#k\">k</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#rt_hash_table\">rt_hash_table</a>[<a class=\"id\" href=\"#hash\">hash</a>].<a class=\"id\" href=\"#chain\">chain</a>); <a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#mtu\">mtu</a> = <a class=\"id\" href=\"#new_mtu\">new_mtu</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> != <a class=\"id\" href=\"#daddr\">daddr</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> != <a class=\"id\" href=\"#skeys\">skeys</a>[<a class=\"id\" href=\"#i\">i</a>] ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a> != <a class=\"id\" href=\"#daddr\">daddr</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a> != <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#saddr\">saddr</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> != <a class=\"id\" href=\"#ikeys\">ikeys</a>[<a class=\"id\" href=\"#k\">k</a>] ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a> != 0 ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#dst_metric_locked\">dst_metric_locked</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#net_eq\">net_eq</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#net\">net</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rt_is_expired\">rt_is_expired</a>(<a class=\"id\" href=\"#rth\">rth</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#new_mtu\">new_mtu</a> &lt; 68 || <a class=\"id\" href=\"#new_mtu\">new_mtu</a> >= <a class=\"id\" href=\"#old_mtu\">old_mtu</a>) {", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* BSD 4.2 compatibility hack :-( */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mtu\">mtu</a> == 0 &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#old_mtu\">old_mtu</a> >= <a class=\"id\" href=\"#dst_mtu\">dst_mtu</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#old_mtu\">old_mtu</a> >= 68 + (<a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#ihl\">ihl</a> << 2))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_mtu\">old_mtu</a> -= <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#ihl\">ihl</a> << 2;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mtu\">mtu</a> = <a class=\"id\" href=\"#guess_mtu\">guess_mtu</a>(<a class=\"id\" href=\"#old_mtu\">old_mtu</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mtu\">mtu</a> <= <a class=\"id\" href=\"#dst_mtu\">dst_mtu</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mtu\">mtu</a> &lt; <a class=\"id\" href=\"#dst_mtu\">dst_mtu</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_confirm\">dst_confirm</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mtu\">mtu</a> &lt; <a class=\"id\" href=\"#ip_rt_min_pmtu\">ip_rt_min_pmtu</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mtu\">mtu</a> = <a class=\"id\" href=\"#ip_rt_min_pmtu\">ip_rt_min_pmtu</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_LOCK\">RTAX_LOCK</a>-1] |=", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(1 << <a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>-1] = <a class=\"id\" href=\"#mtu\">mtu</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_set_expires\">dst_set_expires</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_mtu_expires\">ip_rt_mtu_expires</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#est_mtu\">est_mtu</a> = <a class=\"id\" href=\"#mtu\">mtu</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#est_mtu\">est_mtu</a> ? : <a class=\"id\" href=\"#new_mtu\">new_mtu</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ip_rt_update_pmtu\">ip_rt_update_pmtu</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mtu\">mtu</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_mtu\">dst_mtu</a>(<a class=\"id\" href=\"#dst\">dst</a>) &gt; <a class=\"id\" href=\"#mtu\">mtu</a> && <a class=\"id\" href=\"#mtu\">mtu</a> >= 68 &&", 
"<span class=\"ts\"/>    !(<a class=\"id\" href=\"#dst_metric_locked\">dst_metric_locked</a>(<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mtu\">mtu</a> &lt; <a class=\"id\" href=\"#ip_rt_min_pmtu\">ip_rt_min_pmtu</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mtu\">mtu</a> = <a class=\"id\" href=\"#ip_rt_min_pmtu\">ip_rt_min_pmtu</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_LOCK\">RTAX_LOCK</a>-1] |= (1 << <a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>-1] = <a class=\"id\" href=\"#mtu\">mtu</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_set_expires\">dst_set_expires</a>(<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#ip_rt_mtu_expires\">ip_rt_mtu_expires</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_netevent_notifiers\">call_netevent_notifiers</a>(<a class=\"id\" href=\"#NETEVENT_PMTU_UPDATE\">NETEVENT_PMTU_UPDATE</a>, <a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#ipv4_dst_check\">ipv4_dst_check</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cookie\">cookie</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt_is_expired\">rt_is_expired</a>((struct <a class=\"id\" href=\"#rtable\">rtable</a> *)<a class=\"id\" href=\"#dst\">dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#dst\">dst</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ipv4_dst_destroy\">ipv4_dst_destroy</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rtable\">rtable</a> *) <a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_peer\">inet_peer</a> *<a class=\"id\" href=\"#peer\">peer</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#peer\">peer</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet_putpeer\">inet_putpeer</a>(<a class=\"id\" href=\"#peer\">peer</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#idev\">idev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_put\">in_dev_put</a>(<a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ipv4_dst_ifdown\">ipv4_dst_ifdown</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    int <a class=\"id\" href=\"#how\">how</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rtable\">rtable</a> *) <a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a> != <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>)-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a> && <a class=\"id\" href=\"#idev\">idev</a> && <a class=\"id\" href=\"#idev\">idev</a>-><a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#loopback_idev\">loopback_idev</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_get\">in_dev_get</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>)-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#loopback_idev\">loopback_idev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#loopback_idev\">loopback_idev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_put\">in_dev_put</a>(<a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ipv4_link_failure\">ipv4_link_failure</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#icmp_send\">icmp_send</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ICMP_DEST_UNREACH\">ICMP_DEST_UNREACH</a>, <a class=\"id\" href=\"#ICMP_HOST_UNREACH\">ICMP_HOST_UNREACH</a>, 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_set_expires\">dst_set_expires</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, 0);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#ip_rt_bug\">ip_rt_bug</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"ip_rt_bug: %pI4 -> %pI4, %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>, &amp;<a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> ? <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a> : \"?\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\">   We do not cache source address of outgoing interface,</span>", 
"<span class=\"comment\">   because it is used only by IP RR, TS and SRR options,</span>", 
"<span class=\"comment\">   so that it out of fast path.</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\">   BTW remember: \"addr\" is allowed to be not aligned</span>", 
"<span class=\"comment\">   in IP options!</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_rt_get_source\">ip_rt_get_source</a>(<a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#addr\">addr</a>, struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#src\">src</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result\">fib_result</a> <a class=\"id\" href=\"#res\">res</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#src\">src</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#fib_lookup\">fib_lookup</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>), &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#src\">src</a> = <a class=\"id\" href=\"#FIB_RES_PREFSRC\">FIB_RES_PREFSRC</a>(<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#src\">src</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#RT_SCOPE_UNIVERSE\">RT_SCOPE_UNIVERSE</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#addr\">addr</a>, &amp;<a class=\"id\" href=\"#src\">src</a>, 4);", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"static void <a class=\"id\" href=\"#set_class_tag\">set_class_tag</a>(struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tag\">tag</a>)", 
"{", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#tclassid\">tclassid</a> &amp; 0xFFFF))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#tclassid\">tclassid</a> |= <a class=\"id\" href=\"#tag\">tag</a> &amp; 0xFFFF;", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#tclassid\">tclassid</a> &amp; 0xFFFF0000))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#tclassid\">tclassid</a> |= <a class=\"id\" href=\"#tag\">tag</a> &amp; 0xFFFF0000;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static void <a class=\"id\" href=\"#rt_set_nexthop\">rt_set_nexthop</a>(struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>, struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#itag\">itag</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_info\">fib_info</a> *<a class=\"id\" href=\"#fi\">fi</a> = <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fi\">fi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#FIB_RES_GW\">FIB_RES_GW</a>(*<a class=\"id\" href=\"#res\">res</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#FIB_RES_NH\">FIB_RES_NH</a>(*<a class=\"id\" href=\"#res\">res</a>).<a class=\"id\" href=\"#nh_scope\">nh_scope</a> == <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a> = <a class=\"id\" href=\"#FIB_RES_GW\">FIB_RES_GW</a>(*<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>, <a class=\"id\" href=\"#fi\">fi</a>-><a class=\"id\" href=\"#fib_metrics\">fib_metrics</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       sizeof(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fi\">fi</a>-><a class=\"id\" href=\"#fib_mtu\">fib_mtu</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>-1] = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_metric_locked\">dst_metric_locked</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a> != <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a> &gt; 576)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>-1] = 576;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#tclassid\">tclassid</a> = <a class=\"id\" href=\"#FIB_RES_NH\">FIB_RES_NH</a>(*<a class=\"id\" href=\"#res\">res</a>).<a class=\"id\" href=\"#nh_tclassid\">nh_tclassid</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>-1]= <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_metric\">dst_metric</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_HOPLIMIT\">RTAX_HOPLIMIT</a>) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_HOPLIMIT\">RTAX_HOPLIMIT</a>-1] = <a class=\"id\" href=\"#sysctl_ip_default_ttl\">sysctl_ip_default_ttl</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_mtu\">dst_mtu</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>) &gt; <a class=\"id\" href=\"#IP_MAX_MTU\">IP_MAX_MTU</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_MTU\">RTAX_MTU</a>-1] = <a class=\"id\" href=\"#IP_MAX_MTU\">IP_MAX_MTU</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_metric\">dst_metric</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_ADVMSS\">RTAX_ADVMSS</a>) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_ADVMSS\">RTAX_ADVMSS</a>-1] = <a class=\"id\" href=\"#max_t\">max_t</a>(unsigned int, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a> - 40,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#ip_rt_min_advmss\">ip_rt_min_advmss</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_metric\">dst_metric</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_ADVMSS\">RTAX_ADVMSS</a>) &gt; 65535 - 40)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>[<a class=\"id\" href=\"#RTAX_ADVMSS\">RTAX_ADVMSS</a>-1] = 65535 - 40;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_class_tag\">set_class_tag</a>(<a class=\"id\" href=\"#rt\">rt</a>, <a class=\"id\" href=\"#fib_rules_tclass\">fib_rules_tclass</a>(<a class=\"id\" href=\"#res\">res</a>));", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_class_tag\">set_class_tag</a>(<a class=\"id\" href=\"#rt\">rt</a>, <a class=\"id\" href=\"#itag\">itag</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a> = <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"}", 
"", 
"<span class=\"comment\">/* called in rcu_read_lock() section */</span>", 
"static int <a class=\"id\" href=\"#ip_route_input_mc\">ip_route_input_mc</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tos\">tos</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, int <a class=\"id\" href=\"#our\">our</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hash\">hash</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#spec_dst\">spec_dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rcu\">__in_dev_get_rcu</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#itag\">itag</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Primary sanity checks. */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in_dev\">in_dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#saddr\">saddr</a>) || <a class=\"id\" href=\"#ipv4_is_lbcast\">ipv4_is_lbcast</a>(<a class=\"id\" href=\"#saddr\">saddr</a>) ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#ipv4_is_loopback\">ipv4_is_loopback</a>(<a class=\"id\" href=\"#saddr\">saddr</a>) || <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> != <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#ETH_P_IP\">ETH_P_IP</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_inval\">e_inval</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#saddr\">saddr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv4_is_local_multicast\">ipv4_is_local_multicast</a>(<a class=\"id\" href=\"#daddr\">daddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_inval\">e_inval</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spec_dst\">spec_dst</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev\">dev</a>, 0, <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_validate_source\">fib_validate_source</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, 0, <a class=\"id\" href=\"#tos\">tos</a>, 0, <a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#spec_dst\">spec_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#itag\">itag</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_err\">e_err</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#dst_alloc\">dst_alloc</a>(&amp;<a class=\"id\" href=\"#ipv4_dst_ops\">ipv4_dst_ops</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rth\">rth</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_nobufs\">e_nobufs</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#output\">output</a> = <a class=\"id\" href=\"#ip_rt_bug\">ip_rt_bug</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#obsolete\">obsolete</a> = -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#__refcnt\">__refcnt</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a>= <a class=\"id\" href=\"#DST_HOST\">DST_HOST</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#NOPOLICY\">NOPOLICY</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_NOPOLICY\">DST_NOPOLICY</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_tos\">fl4_tos</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tos\">tos</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#mark\">mark</a>    = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#tclassid\">tclassid</a> = <a class=\"id\" href=\"#itag\">itag</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_iif\">rt_iif</a><span class=\"ts\"/>=", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a><span class=\"ts\"/>= <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a><span class=\"ts\"/>= <a class=\"id\" href=\"#init_net\">init_net</a>.<a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#idev\">idev</a><span class=\"ts\"/>= <a class=\"id\" href=\"#in_dev_get\">in_dev_get</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>= <a class=\"id\" href=\"#spec_dst\">spec_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_genid\">rt_genid</a><span class=\"ts\"/>= <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a><span class=\"ts\"/>= <a class=\"id\" href=\"#RTCF_MULTICAST\">RTCF_MULTICAST</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a><span class=\"ts\"/>= <a class=\"id\" href=\"#RTN_MULTICAST\">RTN_MULTICAST</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#our\">our</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#input\">input</a>= <a class=\"id\" href=\"#ip_local_deliver\">ip_local_deliver</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> |= <a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MROUTE\">CONFIG_IP_MROUTE</a>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv4_is_local_multicast\">ipv4_is_local_multicast</a>(<a class=\"id\" href=\"#daddr\">daddr</a>) && <a class=\"id\" href=\"#IN_DEV_MFORWARD\">IN_DEV_MFORWARD</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#input\">input</a> = <a class=\"id\" href=\"#ip_mr_input\">ip_mr_input</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_slow_mc\">in_slow_mc</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>, <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>)));", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rt_intern_hash\">rt_intern_hash</a>(<a class=\"id\" href=\"#hash\">hash</a>, <a class=\"id\" href=\"#rth\">rth</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"", 
"<a class=\"id\" href=\"#e_nobufs\">e_nobufs</a>:", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<a class=\"id\" href=\"#e_inval\">e_inval</a>:", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<a class=\"id\" href=\"#e_err\">e_err</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"", 
"static void <a class=\"id\" href=\"#ip_handle_martian_source\">ip_handle_martian_source</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_martian_src\">in_martian_src</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_VERBOSE\">CONFIG_IP_ROUTE_VERBOSE</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_LOG_MARTIANS\">IN_DEV_LOG_MARTIANS</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) && <a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>()) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *<span class=\"ts\"/>RFC1812 recommendation, if source is martian,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *<span class=\"ts\"/>the only hint is MAC header.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"martian source %pI4 from %pI4, on dev %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a> && <a class=\"id\" href=\"#skb_mac_header_was_set\">skb_mac_header_was_set</a>(<a class=\"id\" href=\"#skb\">skb</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const unsigned char *<a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#skb_mac_header\">skb_mac_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"ll header: \");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>; <a class=\"id\" href=\"#i\">i</a>++, <a class=\"id\" href=\"#p\">p</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"%02x\", *<a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> &lt; (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a> - 1))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\":\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"", 
"<span class=\"comment\">/* called in rcu_read_lock() section */</span>", 
"static int <a class=\"id\" href=\"#__mkroute_input\">__mkroute_input</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tos\">tos</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#result\">result</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#out_dev\">out_dev</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#flags\">flags</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#spec_dst\">spec_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#itag\">itag</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* get a working reference to the output device */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#out_dev\">out_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rcu\">__in_dev_get_rcu</a>(<a class=\"id\" href=\"#FIB_RES_DEV\">FIB_RES_DEV</a>(*<a class=\"id\" href=\"#res\">res</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#out_dev\">out_dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_CRIT\">KERN_CRIT</a> \"Bug in ip_route_input\" \\", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       \"_slow(). Please, report\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_validate_source\">fib_validate_source</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#tos\">tos</a>, <a class=\"id\" href=\"#FIB_RES_OIF\">FIB_RES_OIF</a>(*<a class=\"id\" href=\"#res\">res</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#spec_dst\">spec_dst</a>, &amp;<a class=\"id\" href=\"#itag\">itag</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_handle_martian_source\">ip_handle_martian_source</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#saddr\">saddr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#cleanup\">cleanup</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_DIRECTSRC\">RTCF_DIRECTSRC</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#out_dev\">out_dev</a> == <a class=\"id\" href=\"#in_dev\">in_dev</a> && <a class=\"id\" href=\"#err\">err</a> &&", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#IN_DEV_SHARED_MEDIA\">IN_DEV_SHARED_MEDIA</a>(<a class=\"id\" href=\"#out_dev\">out_dev</a>) ||", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#inet_addr_onlink\">inet_addr_onlink</a>(<a class=\"id\" href=\"#out_dev\">out_dev</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#FIB_RES_GW\">FIB_RES_GW</a>(*<a class=\"id\" href=\"#res\">res</a>))))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_DOREDIRECT\">RTCF_DOREDIRECT</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> != <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#ETH_P_IP\">ETH_P_IP</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Not IP (i.e. ARP). Do not create route, if it is</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * invalid for proxy arp. DNAT routes are always valid.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Proxy arp feature have been extended to allow, ARP</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * replies back to the same interface, to support</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Private VLAN switch technologies. See arp.c.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#out_dev\">out_dev</a> == <a class=\"id\" href=\"#in_dev\">in_dev</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#IN_DEV_PROXY_ARP_PVLAN\">IN_DEV_PROXY_ARP_PVLAN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#cleanup\">cleanup</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#dst_alloc\">dst_alloc</a>(&amp;<a class=\"id\" href=\"#ipv4_dst_ops\">ipv4_dst_ops</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rth\">rth</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#cleanup\">cleanup</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#__refcnt\">__refcnt</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a>= <a class=\"id\" href=\"#DST_HOST\">DST_HOST</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#NOPOLICY\">NOPOLICY</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_NOPOLICY\">DST_NOPOLICY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>(<a class=\"id\" href=\"#out_dev\">out_dev</a>, <a class=\"id\" href=\"#NOXFRM\">NOXFRM</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_NOXFRM\">DST_NOXFRM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_tos\">fl4_tos</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tos\">tos</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#mark\">mark</a>    = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_iif\">rt_iif</a> <span class=\"ts\"/>=", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a><span class=\"ts\"/>= <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a><span class=\"ts\"/>= (<a class=\"id\" href=\"#out_dev\">out_dev</a>)-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#idev\">idev</a><span class=\"ts\"/>= <a class=\"id\" href=\"#in_dev_get\">in_dev_get</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> <span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>= <a class=\"id\" href=\"#spec_dst\">spec_dst</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#obsolete\">obsolete</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#input\">input</a> = <a class=\"id\" href=\"#ip_forward\">ip_forward</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#output\">output</a> = <a class=\"id\" href=\"#ip_output\">ip_output</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_genid\">rt_genid</a> = <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt_set_nexthop\">rt_set_nexthop</a>(<a class=\"id\" href=\"#rth\">rth</a>, <a class=\"id\" href=\"#res\">res</a>, <a class=\"id\" href=\"#itag\">itag</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> = <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
" <a class=\"id\" href=\"#cleanup\">cleanup</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#ip_mkroute_input\">ip_mkroute_input</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tos\">tos</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a>* <a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#hash\">hash</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_MULTIPATH\">CONFIG_IP_ROUTE_MULTIPATH</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a> && <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a>-><a class=\"id\" href=\"#fib_nhs\">fib_nhs</a> &gt; 1 && <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#oif\">oif</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_select_multipath\">fib_select_multipath</a>(<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#res\">res</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* create a routing cache entry */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__mkroute_input\">__mkroute_input</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#res\">res</a>, <a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#tos\">tos</a>, &amp;<a class=\"id\" href=\"#rth\">rth</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* put it into the cache */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#iif\">iif</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>)));", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rt_intern_hash\">rt_intern_hash</a>(<a class=\"id\" href=\"#hash\">hash</a>, <a class=\"id\" href=\"#rth\">rth</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#iif\">iif</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>NOTE. We drop all the packets that has local source</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>addresses, because every properly looped back packet</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>must have correct destination already attached by output routine.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Such approach solves two big problems:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>1. Not simplex devices are handled properly.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>2. IP spoofing attempts are filtered with 100% of guarantee.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#ip_route_input_slow\">ip_route_input_slow</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tos\">tos</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result\">fib_result</a> <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rcu\">__in_dev_get_rcu</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#tos\">tos</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#scope\">scope</a> = <a class=\"id\" href=\"#RT_SCOPE_UNIVERSE\">RT_SCOPE_UNIVERSE</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      } },", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#iif\">iif</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> };", 
"<span class=\"ts\"/>unsigned<span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#itag\">itag</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> * <a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/>unsigned<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spec_dst\">spec_dst</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_res\">free_res</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a>    * <a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* IP on this device is disabled. */</span>", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Check for the most weird martians, which can be not detected</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   by fib_lookup.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#saddr\">saddr</a>) || <a class=\"id\" href=\"#ipv4_is_lbcast\">ipv4_is_lbcast</a>(<a class=\"id\" href=\"#saddr\">saddr</a>) ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#ipv4_is_loopback\">ipv4_is_loopback</a>(<a class=\"id\" href=\"#saddr\">saddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#martian_source\">martian_source</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#daddr\">daddr</a> == <a class=\"id\" href=\"#htonl\">htonl</a>(0xFFFFFFFF) || (<a class=\"id\" href=\"#saddr\">saddr</a> == 0 && <a class=\"id\" href=\"#daddr\">daddr</a> == 0))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#brd_input\">brd_input</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Accept zero addresses only to limited broadcast;</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * I even do not know to fix it or not. Waiting for complains :-)</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#saddr\">saddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#martian_source\">martian_source</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_lbcast\">ipv4_is_lbcast</a>(<a class=\"id\" href=\"#daddr\">daddr</a>) || <a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#daddr\">daddr</a>) ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#ipv4_is_loopback\">ipv4_is_loopback</a>(<a class=\"id\" href=\"#daddr\">daddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#martian_destination\">martian_destination</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Now we are ready to route packet.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_lookup\">fib_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>)) != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#IN_DEV_FORWARD\">IN_DEV_FORWARD</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_hostunreach\">e_hostunreach</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#no_route\">no_route</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_res\">free_res</a> = 1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_slow_tot\">in_slow_tot</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#brd_input\">brd_input</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_validate_source\">fib_validate_source</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#tos\">tos</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#spec_dst\">spec_dst</a>, &amp;<a class=\"id\" href=\"#itag\">itag</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#martian_source_keep_err\">martian_source_keep_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_DIRECTSRC\">RTCF_DIRECTSRC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spec_dst\">spec_dst</a> = <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#local_input\">local_input</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#IN_DEV_FORWARD\">IN_DEV_FORWARD</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_hostunreach\">e_hostunreach</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#martian_destination\">martian_destination</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ip_mkroute_input\">ip_mkroute_input</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#res\">res</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#tos\">tos</a>);", 
"<a class=\"id\" href=\"#done\">done</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#free_res\">free_res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<a class=\"id\" href=\"#brd_input\">brd_input</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> != <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#ETH_P_IP\">ETH_P_IP</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_inval\">e_inval</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#saddr\">saddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spec_dst\">spec_dst</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev\">dev</a>, 0, <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>);", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_validate_source\">fib_validate_source</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, 0, <a class=\"id\" href=\"#tos\">tos</a>, 0, <a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#spec_dst\">spec_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#itag\">itag</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#martian_source_keep_err\">martian_source_keep_err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_DIRECTSRC\">RTCF_DIRECTSRC</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_BROADCAST\">RTCF_BROADCAST</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_brd\">in_brd</a>);", 
"", 
"<a class=\"id\" href=\"#local_input\">local_input</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#dst_alloc\">dst_alloc</a>(&amp;<a class=\"id\" href=\"#ipv4_dst_ops\">ipv4_dst_ops</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rth\">rth</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_nobufs\">e_nobufs</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#output\">output</a>= <a class=\"id\" href=\"#ip_rt_bug\">ip_rt_bug</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#obsolete\">obsolete</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_genid\">rt_genid</a> = <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#__refcnt\">__refcnt</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a>= <a class=\"id\" href=\"#DST_HOST\">DST_HOST</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#NOPOLICY\">NOPOLICY</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_NOPOLICY\">DST_NOPOLICY</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_tos\">fl4_tos</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tos\">tos</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#mark\">mark</a>    = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#tclassid\">tclassid</a> = <a class=\"id\" href=\"#itag\">itag</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_iif\">rt_iif</a><span class=\"ts\"/>=", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a><span class=\"ts\"/>= <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a><span class=\"ts\"/>= <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#idev\">idev</a><span class=\"ts\"/>= <a class=\"id\" href=\"#in_dev_get\">in_dev_get</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a><span class=\"ts\"/>= <a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>= <a class=\"id\" href=\"#spec_dst\">spec_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#input\">input</a>= <a class=\"id\" href=\"#ip_local_deliver\">ip_local_deliver</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> <span class=\"ts\"/>= <a class=\"id\" href=\"#flags\">flags</a>|<a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_UNREACHABLE\">RTN_UNREACHABLE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#input\">input</a>= <a class=\"id\" href=\"#ip_error\">ip_error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#error\">error</a>= -<a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> <span class=\"ts\"/>&= ~<a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a><span class=\"ts\"/>= <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a>, <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rt_intern_hash\">rt_intern_hash</a>(<a class=\"id\" href=\"#hash\">hash</a>, <a class=\"id\" href=\"#rth\">rth</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<a class=\"id\" href=\"#no_route\">no_route</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_no_route\">in_no_route</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spec_dst\">spec_dst</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev\">dev</a>, 0, <a class=\"id\" href=\"#RT_SCOPE_UNIVERSE\">RT_SCOPE_UNIVERSE</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#RTN_UNREACHABLE\">RTN_UNREACHABLE</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> == -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENETUNREACH\">ENETUNREACH</a>;", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#local_input\">local_input</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Do not cache martian addresses: they should be logged (RFC1812)</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<a class=\"id\" href=\"#martian_destination\">martian_destination</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_martian_dst\">in_martian_dst</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_VERBOSE\">CONFIG_IP_ROUTE_VERBOSE</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_LOG_MARTIANS\">IN_DEV_LOG_MARTIANS</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) && <a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"martian destination %pI4 from %pI4, dev %s\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<a class=\"id\" href=\"#e_hostunreach\">e_hostunreach</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EHOSTUNREACH\">EHOSTUNREACH</a>;", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<a class=\"id\" href=\"#e_inval\">e_inval</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<a class=\"id\" href=\"#e_nobufs\">e_nobufs</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<a class=\"id\" href=\"#martian_source\">martian_source</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<a class=\"id\" href=\"#martian_source_keep_err\">martian_source_keep_err</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_handle_martian_source\">ip_handle_martian_source</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_route_input_common\">ip_route_input_common</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tos\">tos</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#noref\">noref</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> * <a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/>unsigned<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#iif\">iif</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#res\">res</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rt_caching\">rt_caching</a>(<a class=\"id\" href=\"#net\">net</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#skip_cache\">skip_cache</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tos\">tos</a> &= <a class=\"id\" href=\"#IPTOS_RT_MASK\">IPTOS_RT_MASK</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#iif\">iif</a>, <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>));", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#rt_hash_table\">rt_hash_table</a>[<a class=\"id\" href=\"#hash\">hash</a>].<a class=\"id\" href=\"#chain\">chain</a>); <a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((((<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> ^ (<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#daddr\">daddr</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/>     ((<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> ^ (<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#saddr\">saddr</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/>     (<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a> ^ <a class=\"id\" href=\"#iif\">iif</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/>     (<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_tos\">fl4_tos</a> ^ <a class=\"id\" href=\"#tos\">tos</a>)) == 0 &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#mark\">mark</a> == <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#net_eq\">net_eq</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#net\">net</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#rt_is_expired\">rt_is_expired</a>(<a class=\"id\" href=\"#rth\">rth</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#noref\">noref</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_use_noref\">dst_use_noref</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_set_noref\">skb_dst_set_noref</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_use\">dst_use</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_set\">skb_dst_set</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_hit\">in_hit</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#in_hlist_search\">in_hlist_search</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#skip_cache\">skip_cache</a>:", 
"<span class=\"ts\"/><span class=\"comment\">/* Multicast recognition logic is moved from route cache to here.</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   The problem was that too many Ethernet cards have broken/missing</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   hardware multicast filters :-( As result the host on multicasting</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   network acquires a lot of useless route cache entries, sort of</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   SDR messages from all the world. Now we try to get rid of them.</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   Really, provided software IP multicast filter is organized</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   reasonably (at least, hashed), it does not result in a slowdown</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   comparing with route cache reject entries.</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   Note, that multicast routers are not affected, because</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   route cache entry is created eventually.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#daddr\">daddr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rcu\">__in_dev_get_rcu</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#in_dev\">in_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#our\">our</a> = <a class=\"id\" href=\"#ip_check_mc\">ip_check_mc</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#protocol\">protocol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#our\">our</a>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MROUTE\">CONFIG_IP_MROUTE</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    (!<a class=\"id\" href=\"#ipv4_is_local_multicast\">ipv4_is_local_multicast</a>(<a class=\"id\" href=\"#daddr\">daddr</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#IN_DEV_MFORWARD\">IN_DEV_MFORWARD</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>))", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   ) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#ip_route_input_mc\">ip_route_input_mc</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tos\">tos</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#our\">our</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#ip_route_input_slow\">ip_route_input_slow</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#tos\">tos</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ip_route_input_common\">ip_route_input_common</a>);", 
"", 
"static int <a class=\"id\" href=\"#__mkroute_output\">__mkroute_output</a>(struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#result\">result</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#oldflp\">oldflp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev_out\">dev_out</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    unsigned <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#RT_FL_TOS\">RT_FL_TOS</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_loopback\">ipv4_is_loopback</a>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>) && !(<a class=\"id\" href=\"#dev_out\">dev_out</a>-><a class=\"id\" href=\"#flags\">flags</a>&amp;<a class=\"id\" href=\"#IFF_LOOPBACK\">IFF_LOOPBACK</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> == <a class=\"id\" href=\"#htonl\">htonl</a>(0xFFFFFFFF))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#RTN_MULTICAST\">RTN_MULTICAST</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#ipv4_is_lbcast\">ipv4_is_lbcast</a>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>) || <a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFF_LOOPBACK\">IFF_LOOPBACK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* get work reference to inet device */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#in_dev_get\">in_dev_get</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_BROADCAST\">RTCF_BROADCAST</a> | <a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_info_put\">fib_info_put</a>(<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_MULTICAST\">RTN_MULTICAST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_MULTICAST\">RTCF_MULTICAST</a>|<a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#ip_check_mc\">ip_check_mc</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#proto\">proto</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* If multicast route do not exist use</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   default one, but do not gateway in this case.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   Yes, it is hack.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a> && <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#prefixlen\">prefixlen</a> &lt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_info_put\">fib_info_put</a>(<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#fi\">fi</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#dst_alloc\">dst_alloc</a>(&amp;<a class=\"id\" href=\"#ipv4_dst_ops\">ipv4_dst_ops</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rth\">rth</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#cleanup\">cleanup</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#__refcnt\">__refcnt</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a>= <a class=\"id\" href=\"#DST_HOST\">DST_HOST</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#NOXFRM\">NOXFRM</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_NOXFRM\">DST_NOXFRM</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#NOPOLICY\">NOPOLICY</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#DST_NOPOLICY\">DST_NOPOLICY</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_tos\">fl4_tos</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tos\">tos</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a><span class=\"ts\"/>= <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#mark\">mark</a>    = <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#mark\">mark</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a><span class=\"ts\"/>= <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a><span class=\"ts\"/>= <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_iif\">rt_iif</a><span class=\"ts\"/>= <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a> ? : <a class=\"id\" href=\"#dev_out\">dev_out</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* get references to the devices that are to be hold by the routing</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   cache entry */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a><span class=\"ts\"/>= <a class=\"id\" href=\"#dev_out\">dev_out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#idev\">idev</a><span class=\"ts\"/>= <a class=\"id\" href=\"#in_dev_get\">in_dev_get</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a> = <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>= <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#output\">output</a>=<a class=\"id\" href=\"#ip_output\">ip_output</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#obsolete\">obsolete</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_genid\">rt_genid</a> = <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#out_slow_tot\">out_slow_tot</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#input\">input</a> = <a class=\"id\" href=\"#ip_local_deliver\">ip_local_deliver</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a> = <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; (<a class=\"id\" href=\"#RTCF_BROADCAST\">RTCF_BROADCAST</a> | <a class=\"id\" href=\"#RTCF_MULTICAST\">RTCF_MULTICAST</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a> = <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !(<a class=\"id\" href=\"#dev_out\">dev_out</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFF_LOOPBACK\">IFF_LOOPBACK</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#output\">output</a> = <a class=\"id\" href=\"#ip_mc_output\">ip_mc_output</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#out_slow_mc\">out_slow_mc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MROUTE\">CONFIG_IP_MROUTE</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_MULTICAST\">RTN_MULTICAST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IN_DEV_MFORWARD\">IN_DEV_MFORWARD</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#ipv4_is_local_multicast\">ipv4_is_local_multicast</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#input\">input</a> = <a class=\"id\" href=\"#ip_mr_input\">ip_mr_input</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#output\">output</a> = <a class=\"id\" href=\"#ip_mc_output\">ip_mc_output</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt_set_nexthop\">rt_set_nexthop</a>(<a class=\"id\" href=\"#rth\">rth</a>, <a class=\"id\" href=\"#res\">res</a>, 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> = <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#rth\">rth</a>;", 
" <a class=\"id\" href=\"#cleanup\">cleanup</a>:", 
"<span class=\"ts\"/><span class=\"comment\">/* release work reference to inet device */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev_put\">in_dev_put</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#ip_mkroute_output\">ip_mkroute_output</a>(struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#rp\">rp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#oldflp\">oldflp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev_out\">dev_out</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     unsigned <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__mkroute_output\">__mkroute_output</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>, <a class=\"id\" href=\"#res\">res</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>, <a class=\"id\" href=\"#dev_out\">dev_out</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#hash\">hash</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>)));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rt_intern_hash\">rt_intern_hash</a>(<a class=\"id\" href=\"#hash\">hash</a>, <a class=\"id\" href=\"#rth\">rth</a>, <a class=\"id\" href=\"#rp\">rp</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Major route resolver routine.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#ip_route_output_slow\">ip_route_output_slow</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#rp\">rp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#oldflp\">oldflp</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tos\">tos</a><span class=\"ts\"/>= <a class=\"id\" href=\"#RT_FL_TOS\">RT_FL_TOS</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#tos\">tos</a> &amp; <a class=\"id\" href=\"#IPTOS_RT_MASK\">IPTOS_RT_MASK</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#scope\">scope</a> = ((<a class=\"id\" href=\"#tos\">tos</a> &amp; <a class=\"id\" href=\"#RTO_ONLINK\">RTO_ONLINK</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#RT_SCOPE_UNIVERSE\">RT_SCOPE_UNIVERSE</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      } },", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#mark\">mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#iif\">iif</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a> };", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result\">fib_result</a> <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#flags\">flags</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#free_res\">free_res</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#r\">r</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ipv4_is_lbcast\">ipv4_is_lbcast</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* I removed check for oif == dev_out-&gt;oif here.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   It was wrong for two reasons:</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   1. ip_dev_find(net, saddr) can return wrong iface, if saddr</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>      is assigned to multiple interfaces.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   2. Moreover, we are allowed to send packets with saddr</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>      of another iface. --ANK</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a> == 0 &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> == <a class=\"id\" href=\"#htonl\">htonl</a>(0xFFFFFFFF))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* It is equivalent to inet_addr_type(saddr) == RTN_LOCAL */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#ip_dev_find\">ip_dev_find</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Special hack: user can direct multicasts</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   and limited broadcast via necessary interface</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   without fiddling with IP_MULTICAST_IF or IP_PKTINFO.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   This hack is not just for fun, it allows</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   vic,vat and friends to work.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   They bind socket to loopback, set ttl to zero</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   and expect that it will work.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   From the viewpoint of routing cache they are broken,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   because we are not allowed to build multicast path</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   with loopback source addr (look, routing cache</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   cannot know, that ttl is zero, so that packet</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   will not leave this host and route is valid).</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   Luckily, this hack is good workaround.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#dev_out\">dev_out</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#make_route\">make_route</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#FLOWI_FLAG_ANYSRC\">FLOWI_FLAG_ANYSRC</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* It is equivalent to inet_addr_type(saddr) == RTN_LOCAL */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#ip_dev_find\">ip_dev_find</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#dev_get_by_index\">dev_get_by_index</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* RACE: Check return value of inet_select_addr instead. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#__in_dev_get_rtnl\">__in_dev_get_rtnl</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>) == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;<span class=\"ts\"/><span class=\"comment\">/* Wrong error code */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_local_multicast\">ipv4_is_local_multicast</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> == <a class=\"id\" href=\"#htonl\">htonl</a>(0xFFFFFFFF)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#make_route\">make_route</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_scope\">fl4_scope</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else if (!<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#RT_SCOPE_HOST\">RT_SCOPE_HOST</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> = <a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> = <a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> = <a class=\"id\" href=\"#htonl\">htonl</a>(<a class=\"id\" href=\"#INADDR_LOOPBACK\">INADDR_LOOPBACK</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#make_route\">make_route</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fib_lookup\">fib_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#oldflp\">oldflp</a>-><a class=\"id\" href=\"#oif\">oif</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Apparently, routing tables are wrong. Assume,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   that the destination is on link.</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   WHY? DW.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   Because we are allowed to send to iface</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   even if it has NO routes and NO assigned</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   addresses. When oif is specified, routing</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   tables are looked up with only one purpose:</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   to catch if destination is gatewayed, rather than</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   direct. Moreover, if MSG_DONTROUTE is set,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   we send packet, ignoring both routing tables</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   and ifaddr state. --ANK</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   We could make it even if oif is unknown,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   likely IPv6, but we do not.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#make_route\">make_route</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENETUNREACH\">ENETUNREACH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_res\">free_res</a> = 1;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> = <a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#loopback_dev\">loopback_dev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#dev_out\">dev_out</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_info_put\">fib_info_put</a>(<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#RTCF_LOCAL\">RTCF_LOCAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#make_route\">make_route</a>;", 
"<span class=\"ts\"/>}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_MULTIPATH\">CONFIG_IP_ROUTE_MULTIPATH</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a>-><a class=\"id\" href=\"#fib_nhs\">fib_nhs</a> &gt; 1 && <a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_select_multipath\">fib_select_multipath</a>(&amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/>else", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#prefixlen\">prefixlen</a> && <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a> && !<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_select_default\">fib_select_default</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> = <a class=\"id\" href=\"#FIB_RES_PREFSRC\">FIB_RES_PREFSRC</a>(<a class=\"id\" href=\"#res\">res</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_out\">dev_out</a> = <a class=\"id\" href=\"#FIB_RES_DEV\">FIB_RES_DEV</a>(<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#dev_out\">dev_out</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"", 
"", 
"<a class=\"id\" href=\"#make_route\">make_route</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ip_mkroute_output\">ip_mkroute_output</a>(<a class=\"id\" href=\"#rp\">rp</a>, &amp;<a class=\"id\" href=\"#res\">res</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#oldflp\">oldflp</a>, <a class=\"id\" href=\"#dev_out\">dev_out</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#free_res\">free_res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_out\">dev_out</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev_out\">dev_out</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#__ip_route_output_key\">__ip_route_output_key</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#rp\">rp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#flp\">flp</a>)", 
"{", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#hash\">hash</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rth\">rth</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rt_caching\">rt_caching</a>(<a class=\"id\" href=\"#net\">net</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#slow_output\">slow_output</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#rt_hash\">rt_hash</a>(<a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>, <a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>, <a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#oif\">oif</a>, <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock_bh\">rcu_read_lock_bh</a>();", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#rcu_dereference_bh\">rcu_dereference_bh</a>(<a class=\"id\" href=\"#rt_hash_table\">rt_hash_table</a>[<a class=\"id\" href=\"#hash\">hash</a>].<a class=\"id\" href=\"#chain\">chain</a>); <a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rth\">rth</a> = <a class=\"id\" href=\"#rcu_dereference_bh\">rcu_dereference_bh</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#rt_next\">rt_next</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> == <a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_src\">fl4_src</a> == <a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#iif\">iif</a> == 0 &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> == <a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#oif\">oif</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#mark\">mark</a> == <a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#mark\">mark</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !((<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#fl4_tos\">fl4_tos</a> ^ <a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_tos\">fl4_tos</a>) &amp;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#IPTOS_RT_MASK\">IPTOS_RT_MASK</a> | <a class=\"id\" href=\"#RTO_ONLINK\">RTO_ONLINK</a>)) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#net_eq\">net_eq</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#net\">net</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#rt_is_expired\">rt_is_expired</a>(<a class=\"id\" href=\"#rth\">rth</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_use\">dst_use</a>(&amp;<a class=\"id\" href=\"#rth\">rth</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#out_hit\">out_hit</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock_bh\">rcu_read_unlock_bh</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#rp\">rp</a> = <a class=\"id\" href=\"#rth\">rth</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#RT_CACHE_STAT_INC\">RT_CACHE_STAT_INC</a>(<a class=\"id\" href=\"#out_hlist_search\">out_hlist_search</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock_bh\">rcu_read_unlock_bh</a>();", 
"", 
"<a class=\"id\" href=\"#slow_output\">slow_output</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ip_route_output_slow\">ip_route_output_slow</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#rp\">rp</a>, <a class=\"id\" href=\"#flp\">flp</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#__ip_route_output_key\">__ip_route_output_key</a>);", 
"", 
"static struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#ipv4_blackhole_dst_check\">ipv4_blackhole_dst_check</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cookie\">cookie</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ipv4_rt_blackhole_update_pmtu\">ipv4_rt_blackhole_update_pmtu</a>(struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mtu\">mtu</a>)", 
"{", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#dst_ops\">dst_ops</a> <a class=\"id\" href=\"#ipv4_dst_blackhole_ops\">ipv4_dst_blackhole_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#family\">family</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#AF_INET\">AF_INET</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#protocol\">protocol</a><span class=\"ts\"/><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#cpu_to_be16\">cpu_to_be16</a>(<a class=\"id\" href=\"#ETH_P_IP\">ETH_P_IP</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#destroy\">destroy</a><span class=\"ts\"/><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#ipv4_dst_destroy\">ipv4_dst_destroy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#check\">check</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#ipv4_blackhole_dst_check\">ipv4_blackhole_dst_check</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#update_pmtu\">update_pmtu</a><span class=\"ts\"/><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#ipv4_rt_blackhole_update_pmtu\">ipv4_rt_blackhole_update_pmtu</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#entries\">entries</a><span class=\"ts\"/><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#ATOMIC_INIT\">ATOMIC_INIT</a>(0),", 
"};", 
"", 
"", 
"static int <a class=\"id\" href=\"#ipv4_dst_blackhole\">ipv4_dst_blackhole</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#rp\">rp</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#flp\">flp</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#ort\">ort</a> = *<a class=\"id\" href=\"#rp\">rp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = (struct <a class=\"id\" href=\"#rtable\">rtable</a> *)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_alloc\">dst_alloc</a>(&amp;<a class=\"id\" href=\"#ipv4_dst_blackhole_ops\">ipv4_dst_blackhole_ops</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#new\">new</a> = &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#__refcnt\">__refcnt</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#__use\">__use</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#input\">input</a> = <a class=\"id\" href=\"#dst_discard\">dst_discard</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#output\">output</a> = <a class=\"id\" href=\"#dst_discard\">dst_discard</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#metrics\">metrics</a>, <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#metrics\">metrics</a>, <a class=\"id\" href=\"#RTAX_MAX\">RTAX_MAX</a>*sizeof(<a class=\"id\" href=\"#u32\">u32</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#fl\">fl</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#fl\">fl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#idev\">idev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_hold\">in_dev_hold</a>(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_genid\">rt_genid</a> = <a class=\"id\" href=\"#rt_genid\">rt_genid</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_iif\">rt_iif</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#rt_iif\">rt_iif</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a> = <a class=\"id\" href=\"#ort\">ort</a>-><a class=\"id\" href=\"#peer\">peer</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#peer\">peer</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_free\">dst_free</a>(<a class=\"id\" href=\"#new\">new</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst_release\">dst_release</a>(&amp;(*<a class=\"id\" href=\"#rp\">rp</a>)-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#rp\">rp</a> = <a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#rt\">rt</a> ? 0 : -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_route_output_flow\">ip_route_output_flow</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#rtable\">rtable</a> **<a class=\"id\" href=\"#rp\">rp</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#flp\">flp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, int <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__ip_route_output_key\">__ip_route_output_key</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#rp\">rp</a>, <a class=\"id\" href=\"#flp\">flp</a>)) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#proto\">proto</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a> = (*<a class=\"id\" href=\"#rp\">rp</a>)-><a class=\"id\" href=\"#rt_src\">rt_src</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flp\">flp</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a> = (*<a class=\"id\" href=\"#rp\">rp</a>)-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__xfrm_lookup\">__xfrm_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, (struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> **)<a class=\"id\" href=\"#rp\">rp</a>, <a class=\"id\" href=\"#flp\">flp</a>, <a class=\"id\" href=\"#sk\">sk</a>,", 
];
xr_frag_insert('l/33/4e994f3bfd57606914905abfaff89a08dcfed6.xr', __xr_tmp);
