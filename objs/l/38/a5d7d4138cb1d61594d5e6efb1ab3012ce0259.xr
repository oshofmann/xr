var __xr_tmp = [
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#__find_acq_core\">__find_acq_core</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#create\">create</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_find_acq\">xfrm_find_acq</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_XFRM_SUB_POLICY\">CONFIG_XFRM_SUB_POLICY</a>", 
"int", 
"<a class=\"id\" href=\"#xfrm_tmpl_sort\">xfrm_tmpl_sort</a>(struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a> **<a class=\"id\" href=\"#dst\">dst</a>, struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a> **<a class=\"id\" href=\"#src\">src</a>, int <a class=\"id\" href=\"#n\">n</a>,", 
"<span class=\"ts\"/>       unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#tmpl_sort\">tmpl_sort</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#tmpl_sort\">tmpl_sort</a>(<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#n\">n</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_tmpl_sort\">xfrm_tmpl_sort</a>);", 
"", 
"int", 
"<a class=\"id\" href=\"#xfrm_state_sort\">xfrm_state_sort</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> **<a class=\"id\" href=\"#dst\">dst</a>, struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> **<a class=\"id\" href=\"#src\">src</a>, int <a class=\"id\" href=\"#n\">n</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#state_sort\">state_sort</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#state_sort\">state_sort</a>(<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#n\">n</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_sort\">xfrm_state_sort</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"comment\">/* Silly enough, but I'm lazy to build resolution list */</span>", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#__xfrm_find_acq_byseq\">__xfrm_find_acq_byseq</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> <= <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#seq\">seq</a> == <a class=\"id\" href=\"#seq\">seq</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_ACQ\">XFRM_STATE_ACQ</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#xfrm_find_acq_byseq\">xfrm_find_acq_byseq</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#__xfrm_find_acq_byseq\">__xfrm_find_acq_byseq</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#seq\">seq</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_find_acq_byseq\">xfrm_find_acq_byseq</a>);", 
"", 
"<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#xfrm_get_acqseq\">xfrm_get_acqseq</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>static <a class=\"id\" href=\"#atomic_t\">atomic_t</a> <a class=\"id\" href=\"#acqseq\">acqseq</a>;", 
"", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#atomic_inc_return\">atomic_inc_return</a>(&amp;<a class=\"id\" href=\"#acqseq\">acqseq</a>);", 
"<span class=\"ts\"/>} while (!<a class=\"id\" href=\"#res\">res</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_get_acqseq\">xfrm_get_acqseq</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_alloc_spi\">xfrm_alloc_spi</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#low\">low</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#high\">high</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x0\">x0</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#minspi\">minspi</a> = <a class=\"id\" href=\"#htonl\">htonl</a>(<a class=\"id\" href=\"#low\">low</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#maxspi\">maxspi</a> = <a class=\"id\" href=\"#htonl\">htonl</a>(<a class=\"id\" href=\"#high\">high</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#minspi\">minspi</a> == <a class=\"id\" href=\"#maxspi\">maxspi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x0\">x0</a> = <a class=\"id\" href=\"#xfrm_state_lookup\">xfrm_state_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#minspi\">minspi</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x0\">x0</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x0\">x0</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#minspi\">minspi</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#spi\">spi</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#h\">h</a>=0; <a class=\"id\" href=\"#h\">h</a>&lt;<a class=\"id\" href=\"#high\">high</a>-<a class=\"id\" href=\"#low\">low</a>+1; <a class=\"id\" href=\"#h\">h</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#low\">low</a> + <a class=\"id\" href=\"#net_random\">net_random</a>()%(<a class=\"id\" href=\"#high\">high</a>-<a class=\"id\" href=\"#low\">low</a>+1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x0\">x0</a> = <a class=\"id\" href=\"#xfrm_state_lookup\">xfrm_state_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#htonl\">htonl</a>(<a class=\"id\" href=\"#spi\">spi</a>), <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x0\">x0</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#htonl\">htonl</a>(<a class=\"id\" href=\"#spi\">spi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x0\">x0</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_spi_hash\">xfrm_spi_hash</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#byspi\">byspi</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#unlock\">unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_alloc_spi\">xfrm_alloc_spi</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a> *<a class=\"id\" href=\"#walk\">walk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    int (*<a class=\"id\" href=\"#func\">func</a>)(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *, int, void*),", 
"<span class=\"ts\"/><span class=\"ts\"/>    void *<a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#state\">state</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a> != 0 && <a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#list_first_entry\">list_first_entry</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_all\">state_all</a>, struct <a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a>, <a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#list_entry\">list_entry</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>, struct <a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a>, <a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_from\">list_for_each_entry_from</a>(<a class=\"id\" href=\"#x\">x</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_all\">state_all</a>, <a class=\"id\" href=\"#all\">all</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#x\">x</a>, struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a>, <a class=\"id\" href=\"#km\">km</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#xfrm_id_proto_match\">xfrm_id_proto_match</a>(<a class=\"id\" href=\"#state\">state</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#proto\">proto</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#func\">func</a>(<a class=\"id\" href=\"#state\">state</a>, <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_move_tail\">list_move_tail</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del_init\">list_del_init</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_state_walk_init\">xfrm_state_walk_init</a>(struct <a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a> *<a class=\"id\" href=\"#walk\">walk</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#seq\">seq</a> = 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_walk_init\">xfrm_state_walk_init</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_state_walk_done\">xfrm_state_walk_done</a>(struct <a class=\"id\" href=\"#xfrm_state_walk\">xfrm_state_walk</a> *<a class=\"id\" href=\"#walk\">walk</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_walk_done\">xfrm_state_walk_done</a>);", 
"", 
"", 
"void <a class=\"id\" href=\"#xfrm_replay_notify\">xfrm_replay_notify</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#event\">event</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#km_event\">km_event</a> <a class=\"id\" href=\"#c\">c</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* we send notify messages in case</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *  1. we updated on of the sequence numbers, and the seqno difference</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *     is at least x-&gt;replay_maxdiff, in this case we also update the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *     timeout of our timer function</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *  2. if x-&gt;replay_maxage has elapsed since last update,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *     and there were changes</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *  The state structure must be locked!</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#event\">event</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#XFRM_REPLAY_UPDATE\">XFRM_REPLAY_UPDATE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxdiff\">replay_maxdiff</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a> - <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#preplay\">preplay</a>.<a class=\"id\" href=\"#seq\">seq</a> &lt; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxdiff\">replay_maxdiff</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#oseq\">oseq</a> - <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#preplay\">preplay</a>.<a class=\"id\" href=\"#oseq\">oseq</a> &lt; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxdiff\">replay_maxdiff</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#xflags\">xflags</a> &amp; <a class=\"id\" href=\"#XFRM_TIME_DEFER\">XFRM_TIME_DEFER</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#event\">event</a> = <a class=\"id\" href=\"#XFRM_REPLAY_TIMEOUT\">XFRM_REPLAY_TIMEOUT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#XFRM_REPLAY_TIMEOUT\">XFRM_REPLAY_TIMEOUT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#preplay\">preplay</a>.<a class=\"id\" href=\"#seq\">seq</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#preplay\">preplay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#oseq\">oseq</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#preplay\">preplay</a>.<a class=\"id\" href=\"#oseq\">oseq</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#xflags\">xflags</a> |= <a class=\"id\" href=\"#XFRM_TIME_DEFER\">XFRM_TIME_DEFER</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#preplay\">preplay</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>, sizeof(struct <a class=\"id\" href=\"#xfrm_replay_state\">xfrm_replay_state</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#event\">event</a> = <a class=\"id\" href=\"#XFRM_MSG_NEWAE\">XFRM_MSG_NEWAE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#data\">data</a>.<a class=\"id\" href=\"#aevent\">aevent</a> = <a class=\"id\" href=\"#event\">event</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#km_state_notify\">km_state_notify</a>(<a class=\"id\" href=\"#x\">x</a>, &amp;<a class=\"id\" href=\"#c\">c</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxage\">replay_maxage</a> &&", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#rtimer\">rtimer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a> + <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxage\">replay_maxage</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#xflags\">xflags</a> &= ~<a class=\"id\" href=\"#XFRM_TIME_DEFER\">XFRM_TIME_DEFER</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_replay_timer_handler\">xfrm_replay_timer_handler</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a> = (struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a>*)<a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_aevent_is_on\">xfrm_aevent_is_on</a>(<a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_replay_notify\">xfrm_replay_notify</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#XFRM_REPLAY_TIMEOUT\">XFRM_REPLAY_TIMEOUT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#xflags\">xflags</a> |= <a class=\"id\" href=\"#XFRM_TIME_DEFER\">XFRM_TIME_DEFER</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#xfrm_replay_check\">xfrm_replay_check</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_seq\">net_seq</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#diff\">diff</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#net_seq\">net_seq</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#seq\">seq</a> == 0))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#seq\">seq</a> &gt; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#diff\">diff</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a> - <a class=\"id\" href=\"#seq\">seq</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#diff\">diff</a> >= <a class=\"id\" href=\"#min_t\">min_t</a>(unsigned int, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#replay_window\">replay_window</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  sizeof(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a>) * 8)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#replay_window\">replay_window</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a> &amp; (1U << <a class=\"id\" href=\"#diff\">diff</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#replay\">replay</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#err\">err</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_state_replay\">xfrm_audit_state_replay</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#net_seq\">net_seq</a>);", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#xfrm_replay_advance\">xfrm_replay_advance</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_seq\">net_seq</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#diff\">diff</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#net_seq\">net_seq</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#seq\">seq</a> &gt; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#diff\">diff</a> = <a class=\"id\" href=\"#seq\">seq</a> - <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#diff\">diff</a> &lt; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#replay_window\">replay_window</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a> = ((<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a>) << <a class=\"id\" href=\"#diff\">diff</a>) | 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#seq\">seq</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#diff\">diff</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#seq\">seq</a> - <a class=\"id\" href=\"#seq\">seq</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay\">replay</a>.<a class=\"id\" href=\"#bitmap\">bitmap</a> |= (1U << <a class=\"id\" href=\"#diff\">diff</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_aevent_is_on\">xfrm_aevent_is_on</a>(<a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_replay_notify\">xfrm_replay_notify</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#XFRM_REPLAY_UPDATE\">XFRM_REPLAY_UPDATE</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#LIST_HEAD\">LIST_HEAD</a>(<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>);", 
"static <a class=\"id\" href=\"#DEFINE_RWLOCK\">DEFINE_RWLOCK</a>(<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"", 
"void <a class=\"id\" href=\"#km_policy_notify\">km_policy_notify</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#xp\">xp</a>, int <a class=\"id\" href=\"#dir\">dir</a>, struct <a class=\"id\" href=\"#km_event\">km_event</a> *<a class=\"id\" href=\"#c\">c</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#km\">km</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>, <a class=\"id\" href=\"#list\">list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#notify_policy\">notify_policy</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#notify_policy\">notify_policy</a>(<a class=\"id\" href=\"#xp\">xp</a>, <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#c\">c</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#km_state_notify\">km_state_notify</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, struct <a class=\"id\" href=\"#km_event\">km_event</a> *<a class=\"id\" href=\"#c\">c</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#km\">km</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>, <a class=\"id\" href=\"#list\">list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#notify\">notify</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#notify\">notify</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#c\">c</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"}", 
"", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_policy_notify\">km_policy_notify</a>);", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_state_notify\">km_state_notify</a>);", 
"", 
"void <a class=\"id\" href=\"#km_state_expired\">km_state_expired</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#hard\">hard</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#km_event\">km_event</a> <a class=\"id\" href=\"#c\">c</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#data\">data</a>.<a class=\"id\" href=\"#hard\">hard</a> = <a class=\"id\" href=\"#hard\">hard</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#event\">event</a> = <a class=\"id\" href=\"#XFRM_MSG_EXPIRE\">XFRM_MSG_EXPIRE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#km_state_notify\">km_state_notify</a>(<a class=\"id\" href=\"#x\">x</a>, &amp;<a class=\"id\" href=\"#c\">c</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hard\">hard</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#km_waitq\">km_waitq</a>);", 
"}", 
"", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_state_expired\">km_state_expired</a>);", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * We send to all registered managers regardless of failure</span>", 
"<span class=\"comment\"> * We are happy with one success</span>", 
"<span class=\"comment\">*/</span>", 
"int <a class=\"id\" href=\"#km_query\">km_query</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a> *<a class=\"id\" href=\"#t\">t</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>, <a class=\"id\" href=\"#acqret\">acqret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#km\">km</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acqret\">acqret</a> = <a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#acquire\">acquire</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#t\">t</a>, <a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#XFRM_POLICY_OUT\">XFRM_POLICY_OUT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#acqret\">acqret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#acqret\">acqret</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_query\">km_query</a>);", 
"", 
"int <a class=\"id\" href=\"#km_new_mapping\">km_new_mapping</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#ipaddr\">ipaddr</a>, <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#sport\">sport</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#km\">km</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#new_mapping\">new_mapping</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#new_mapping\">new_mapping</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#ipaddr\">ipaddr</a>, <a class=\"id\" href=\"#sport\">sport</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_new_mapping\">km_new_mapping</a>);", 
"", 
"void <a class=\"id\" href=\"#km_policy_expired\">km_policy_expired</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, int <a class=\"id\" href=\"#dir\">dir</a>, int <a class=\"id\" href=\"#hard\">hard</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#km_event\">km_event</a> <a class=\"id\" href=\"#c\">c</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#data\">data</a>.<a class=\"id\" href=\"#hard\">hard</a> = <a class=\"id\" href=\"#hard\">hard</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#c\">c</a>.<a class=\"id\" href=\"#event\">event</a> = <a class=\"id\" href=\"#XFRM_MSG_POLEXPIRE\">XFRM_MSG_POLEXPIRE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#km_policy_notify\">km_policy_notify</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#dir\">dir</a>, &amp;<a class=\"id\" href=\"#c\">c</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hard\">hard</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#km_waitq\">km_waitq</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_policy_expired\">km_policy_expired</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_XFRM_MIGRATE\">CONFIG_XFRM_MIGRATE</a>", 
"int <a class=\"id\" href=\"#km_migrate\">km_migrate</a>(struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/>       struct <a class=\"id\" href=\"#xfrm_migrate\">xfrm_migrate</a> *<a class=\"id\" href=\"#m\">m</a>, int <a class=\"id\" href=\"#num_migrate\">num_migrate</a>,", 
"<span class=\"ts\"/>       struct <a class=\"id\" href=\"#xfrm_kmaddress\">xfrm_kmaddress</a> *<a class=\"id\" href=\"#k\">k</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#km\">km</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#migrate\">migrate</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#migrate\">migrate</a>(<a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#m\">m</a>, <a class=\"id\" href=\"#num_migrate\">num_migrate</a>, <a class=\"id\" href=\"#k\">k</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_migrate\">km_migrate</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"int <a class=\"id\" href=\"#km_report\">km_report</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, struct <a class=\"id\" href=\"#xfrm_selector\">xfrm_selector</a> *<a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#km\">km</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#report\">report</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#report\">report</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#km_report\">km_report</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_user_policy\">xfrm_user_policy</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, int <a class=\"id\" href=\"#optname\">optname</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#optval\">optval</a>, int <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> <= 0 || <a class=\"id\" href=\"#optlen\">optlen</a> &gt; <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(<a class=\"id\" href=\"#optlen\">optlen</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#data\">data</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#optval\">optval</a>, <a class=\"id\" href=\"#optlen\">optlen</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#km\">km</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pol\">pol</a> = <a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#compile_policy\">compile_policy</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#optname\">optname</a>, <a class=\"id\" href=\"#data\">data</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#optlen\">optlen</a>, &amp;<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> >= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> >= 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_sk_policy_insert\">xfrm_sk_policy_insert</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#err\">err</a>, <a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_pol_put\">xfrm_pol_put</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_user_policy\">xfrm_user_policy</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_register_km\">xfrm_register_km</a>(struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail\">list_add_tail</a>(&amp;<a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#xfrm_km_list\">xfrm_km_list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_register_km\">xfrm_register_km</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_unregister_km\">xfrm_unregister_km</a>(struct <a class=\"id\" href=\"#xfrm_mgr\">xfrm_mgr</a> *<a class=\"id\" href=\"#km\">km</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#km\">km</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_km_lock\">xfrm_km_lock</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_unregister_km\">xfrm_unregister_km</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_register_afinfo\">xfrm_state_register_afinfo</a>(struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#family\">family</a> >= <a class=\"id\" href=\"#NPROTO\">NPROTO</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#family\">family</a>] != <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#family\">family</a>] = <a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_register_afinfo\">xfrm_state_register_afinfo</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_unregister_afinfo\">xfrm_state_unregister_afinfo</a>(struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#family\">family</a> >= <a class=\"id\" href=\"#NPROTO\">NPROTO</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#family\">family</a>] != <a class=\"id\" href=\"#NULL\">NULL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#family\">family</a>] != <a class=\"id\" href=\"#afinfo\">afinfo</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#family\">family</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_unregister_afinfo\">xfrm_state_unregister_afinfo</a>);", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(unsigned int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#family\">family</a> >= <a class=\"id\" href=\"#NPROTO\">NPROTO</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#family\">family</a>];", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#afinfo\">afinfo</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__releases\">__releases</a>(<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Temporarily located here until net/xfrm/xfrm_tunnel.c is created */</span>", 
"void <a class=\"id\" href=\"#xfrm_state_delete_tunnel\">xfrm_state_delete_tunnel</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#tunnel\">tunnel</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#t\">t</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#tunnel\">tunnel</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#t\">t</a>-><a class=\"id\" href=\"#tunnel_users\">tunnel_users</a>) == 2)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_delete\">xfrm_state_delete</a>(<a class=\"id\" href=\"#t\">t</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_dec\">atomic_dec</a>(&amp;<a class=\"id\" href=\"#t\">t</a>-><a class=\"id\" href=\"#tunnel_users\">tunnel_users</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#t\">t</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#tunnel\">tunnel</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_delete_tunnel\">xfrm_state_delete_tunnel</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_mtu\">xfrm_state_mtu</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#mtu\">mtu</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#res\">res</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a> && <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#get_mtu\">get_mtu</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#get_mtu\">get_mtu</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#mtu\">mtu</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#mtu\">mtu</a> - <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#header_len\">header_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#xfrm_init_state\">xfrm_init_state</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> *<a class=\"id\" href=\"#inner_mode\">inner_mode</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#init_flags\">init_flags</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#init_flags\">init_flags</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EPROTONOSUPPORT\">EPROTONOSUPPORT</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#AF_UNSPEC\">AF_UNSPEC</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inner_mode\">inner_mode</a> = <a class=\"id\" href=\"#xfrm_get_mode\">xfrm_get_mode</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inner_mode\">inner_mode</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#inner_mode\">inner_mode</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_MODE_FLAG_TUNNEL\">XFRM_MODE_FLAG_TUNNEL</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_put_mode\">xfrm_put_mode</a>(<a class=\"id\" href=\"#inner_mode\">inner_mode</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode\">inner_mode</a> = <a class=\"id\" href=\"#inner_mode\">inner_mode</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> *<a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#iafamily\">iafamily</a> = <a class=\"id\" href=\"#AF_INET\">AF_INET</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inner_mode\">inner_mode</a> = <a class=\"id\" href=\"#xfrm_get_mode\">xfrm_get_mode</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inner_mode\">inner_mode</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#inner_mode\">inner_mode</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_MODE_FLAG_TUNNEL\">XFRM_MODE_FLAG_TUNNEL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_put_mode\">xfrm_put_mode</a>(<a class=\"id\" href=\"#inner_mode\">inner_mode</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode\">inner_mode</a> = <a class=\"id\" href=\"#inner_mode\">inner_mode</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#AF_INET\">AF_INET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iafamily\">iafamily</a> = <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a> = <a class=\"id\" href=\"#xfrm_get_mode\">xfrm_get_mode</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#iafamily\">iafamily</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_MODE_FLAG_TUNNEL\">XFRM_MODE_FLAG_TUNNEL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a> = <a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_put_mode\">xfrm_put_mode</a>(<a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#xfrm_get_type\">xfrm_get_type</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#init_state\">init_state</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#outer_mode\">outer_mode</a> = <a class=\"id\" href=\"#xfrm_get_mode\">xfrm_get_mode</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#outer_mode\">outer_mode</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a>;", 
"", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_init_state\">xfrm_init_state</a>);", 
"", 
"int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#xfrm_state_init\">xfrm_state_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#sz\">sz</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_all\">state_all</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sz\">sz</a> = sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>) * 8;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#sz\">sz</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_bydst\">out_bydst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#sz\">sz</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_bysrc\">out_bysrc</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#sz\">sz</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_byspi\">out_byspi</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a> = ((<a class=\"id\" href=\"#sz\">sz</a> / sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>)) - 1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_num\">state_num</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_WORK\">INIT_WORK</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hash_work\">state_hash_work</a>, <a class=\"id\" href=\"#xfrm_hash_resize\">xfrm_hash_resize</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_HEAD\">INIT_HLIST_HEAD</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_gc_list\">state_gc_list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_WORK\">INIT_WORK</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_gc_work\">state_gc_work</a>, <a class=\"id\" href=\"#xfrm_state_gc_task\">xfrm_state_gc_task</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#init_waitqueue_head\">init_waitqueue_head</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#km_waitq\">km_waitq</a>);", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#out_byspi\">out_byspi</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>, <a class=\"id\" href=\"#sz\">sz</a>);", 
"<a class=\"id\" href=\"#out_bysrc\">out_bysrc</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>, <a class=\"id\" href=\"#sz\">sz</a>);", 
"<a class=\"id\" href=\"#out_bydst\">out_bydst</a>:", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#xfrm_state_fini\">xfrm_state_fini</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_audit\">xfrm_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#sz\">sz</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#flush_work\">flush_work</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hash_work\">state_hash_work</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>.<a class=\"id\" href=\"#loginuid\">loginuid</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>.<a class=\"id\" href=\"#sessionid\">sessionid</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>.<a class=\"id\" href=\"#secid\">secid</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_flush\">xfrm_state_flush</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#IPSEC_PROTO_ANY\">IPSEC_PROTO_ANY</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#flush_work\">flush_work</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_gc_work\">state_gc_work</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(!<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_all\">state_all</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sz\">sz</a> = (<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a> + 1) * sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(!<a class=\"id\" href=\"#hlist_empty\">hlist_empty</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>, <a class=\"id\" href=\"#sz\">sz</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(!<a class=\"id\" href=\"#hlist_empty\">hlist_empty</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>, <a class=\"id\" href=\"#sz\">sz</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(!<a class=\"id\" href=\"#hlist_empty\">hlist_empty</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>, <a class=\"id\" href=\"#sz\">sz</a>);", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_AUDITSYSCALL\">CONFIG_AUDITSYSCALL</a>", 
"static void <a class=\"id\" href=\"#xfrm_audit_helper_sainfo\">xfrm_audit_helper_sainfo</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_sec_ctx\">xfrm_sec_ctx</a> *<a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#security\">security</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ctx\">ctx</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" sec_alg=%u sec_doi=%u sec_obj=%s\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#ctx_alg\">ctx_alg</a>, <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#ctx_doi\">ctx_doi</a>, <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#ctx_str\">ctx_str</a>);", 
"", 
"<span class=\"ts\"/>switch(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET\">AF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" src=%pI4 dst=%pI4\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>.<a class=\"id\" href=\"#a4\">a4</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>.<a class=\"id\" href=\"#a4\">a4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" src=%pI6 dst=%pI6\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>.<a class=\"id\" href=\"#a6\">a6</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>.<a class=\"id\" href=\"#a6\">a6</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" spi=%u(0x%x)\", <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#spi\">spi</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_audit_helper_pktinfo\">xfrm_audit_helper_pktinfo</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph4\">iph4</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipv6hdr\">ipv6hdr</a> *<a class=\"id\" href=\"#iph6\">iph6</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET\">AF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iph4\">iph4</a> = <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" src=%pI4 dst=%pI4\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#iph4\">iph4</a>-><a class=\"id\" href=\"#saddr\">saddr</a>, &amp;<a class=\"id\" href=\"#iph4\">iph4</a>-><a class=\"id\" href=\"#daddr\">daddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iph6\">iph6</a> = <a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \" src=%pI6 dst=%pI6 flowlbl=0x%x%02x%02x\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#iph6\">iph6</a>-><a class=\"id\" href=\"#saddr\">saddr</a>,&amp;<a class=\"id\" href=\"#iph6\">iph6</a>-><a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#iph6\">iph6</a>-><a class=\"id\" href=\"#flow_lbl\">flow_lbl</a>[0] &amp; 0x0f,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#iph6\">iph6</a>-><a class=\"id\" href=\"#flow_lbl\">flow_lbl</a>[1],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#iph6\">iph6</a>-><a class=\"id\" href=\"#flow_lbl\">flow_lbl</a>[2]);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"void <a class=\"id\" href=\"#xfrm_audit_state_add\">xfrm_audit_state_add</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#result\">result</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#uid_t\">uid_t</a> <a class=\"id\" href=\"#auid\">auid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secid\">secid</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#xfrm_audit_start\">xfrm_audit_start</a>(\"SAD-add\");", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_usrinfo\">xfrm_audit_helper_usrinfo</a>(<a class=\"id\" href=\"#auid\">auid</a>, <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#secid\">secid</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_sainfo\">xfrm_audit_helper_sainfo</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" res=%u\", <a class=\"id\" href=\"#result\">result</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#xfrm_audit_state_add\">xfrm_audit_state_add</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_audit_state_delete\">xfrm_audit_state_delete</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#result\">result</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#uid_t\">uid_t</a> <a class=\"id\" href=\"#auid\">auid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secid\">secid</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#xfrm_audit_start\">xfrm_audit_start</a>(\"SAD-delete\");", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_usrinfo\">xfrm_audit_helper_usrinfo</a>(<a class=\"id\" href=\"#auid\">auid</a>, <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#secid\">secid</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_sainfo\">xfrm_audit_helper_sainfo</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" res=%u\", <a class=\"id\" href=\"#result\">result</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#xfrm_audit_state_delete\">xfrm_audit_state_delete</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_audit_state_replay_overflow\">xfrm_audit_state_replay_overflow</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#spi\">spi</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#xfrm_audit_start\">xfrm_audit_start</a>(\"SA-replay-overflow\");", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_pktinfo\">xfrm_audit_helper_pktinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* don't record the sequence number because it's inherent in this kind</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * of audit message */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" spi=%u(0x%x)\", <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#spi\">spi</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#xfrm_audit_state_replay_overflow\">xfrm_audit_state_replay_overflow</a>);", 
"", 
"static void <a class=\"id\" href=\"#xfrm_audit_state_replay\">xfrm_audit_state_replay</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_seq\">net_seq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#spi\">spi</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#xfrm_audit_start\">xfrm_audit_start</a>(\"SA-replayed-pkt\");", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_pktinfo\">xfrm_audit_helper_pktinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" spi=%u(0x%x) seqno=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#net_seq\">net_seq</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#xfrm_audit_state_notfound_simple\">xfrm_audit_state_notfound_simple</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#xfrm_audit_start\">xfrm_audit_start</a>(\"SA-notfound\");", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_pktinfo\">xfrm_audit_helper_pktinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#xfrm_audit_state_notfound_simple\">xfrm_audit_state_notfound_simple</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_audit_state_notfound\">xfrm_audit_state_notfound</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_spi\">net_spi</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_seq\">net_seq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#spi\">spi</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#xfrm_audit_start\">xfrm_audit_start</a>(\"SA-notfound\");", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_pktinfo\">xfrm_audit_helper_pktinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#net_spi\">net_spi</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" spi=%u(0x%x) seqno=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#net_seq\">net_seq</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#xfrm_audit_state_notfound\">xfrm_audit_state_notfound</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_audit_state_icvfail\">xfrm_audit_state_icvfail</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_spi\">net_spi</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_seq\">net_seq</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#xfrm_audit_start\">xfrm_audit_start</a>(\"SA-icv-failure\");", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_helper_pktinfo\">xfrm_audit_helper_pktinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_parse_spi\">xfrm_parse_spi</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#proto\">proto</a>, &amp;<a class=\"id\" href=\"#net_spi\">net_spi</a>, &amp;<a class=\"id\" href=\"#net_seq\">net_seq</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#spi\">spi</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#net_spi\">net_spi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" spi=%u(0x%x) seqno=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#net_seq\">net_seq</a>));", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#xfrm_audit_state_icvfail\">xfrm_audit_state_icvfail</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_AUDITSYSCALL */</span>", 
];
xr_frag_insert('l/38/a5d7d4138cb1d61594d5e6efb1ab3012ce0259.xr', __xr_tmp);
