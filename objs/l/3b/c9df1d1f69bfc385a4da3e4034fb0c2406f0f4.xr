var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * CIPSO - Commercial IP Security Option</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This is an implementation of the CIPSO 2.2 protocol as specified in</span>", 
"<span class=\"comment\"> * draft-ietf-cipso-ipsecurity-01.txt with additional tag types as found in</span>", 
"<span class=\"comment\"> * FIPS-188.  While CIPSO never became a full IETF RFC standard many vendors</span>", 
"<span class=\"comment\"> * have chosen to adopt the protocol and over the years it has become a</span>", 
"<span class=\"comment\"> * de-facto standard for labeled networking.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * The CIPSO draft specification can be found in the kernel's Documentation</span>", 
"<span class=\"comment\"> * directory as well as the following URL:</span>", 
"<span class=\"comment\"> *   http://netlabel.sourceforge.net/files/draft-ietf-cipso-ipsecurity-01.txt</span>", 
"<span class=\"comment\"> * The FIPS-188 specification can be found at the following URL:</span>", 
"<span class=\"comment\"> *   http://www.itl.nist.gov/fipspubs/fip188.htm</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author: Paul Moore &lt;paul.moore@hp.com&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * (c) Copyright Hewlett-Packard Development Company, L.P., 2006, 2008</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software;  you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of the GNU General Public License as published by</span>", 
"<span class=\"comment\"> * the Free Software Foundation; either version 2 of the License, or</span>", 
"<span class=\"comment\"> * (at your option) any later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is distributed in the hope that it will be useful,</span>", 
"<span class=\"comment\"> * but WITHOUT ANY WARRANTY;  without even the implied warranty of</span>", 
"<span class=\"comment\"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See</span>", 
"<span class=\"comment\"> * the GNU General Public License for more details.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * You should have received a copy of the GNU General Public License</span>", 
"<span class=\"comment\"> * along with this program;  if not, write to the Free Software</span>", 
"<span class=\"comment\"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#rcupdate\">rcupdate</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#spinlock\">spinlock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#jhash\">jhash</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#audit\">audit</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#icmp\">icmp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#tcp\">tcp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#netlabel\">netlabel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#cipso_ipv4\">cipso_ipv4</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#atomic\">atomic</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#bug\">bug</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#unaligned\">unaligned</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"<span class=\"comment\">/* List of available DOI definitions */</span>", 
"<span class=\"comment\">/* XXX - This currently assumes a minimal number of different DOIs in use,</span>", 
"<span class=\"comment\"> * if in practice there are a lot of different DOIs this list should</span>", 
"<span class=\"comment\"> * probably be turned into a hash table or something similar so we</span>", 
"<span class=\"comment\"> * can do quick lookups. */</span>", 
"static <a class=\"id\" href=\"#DEFINE_SPINLOCK\">DEFINE_SPINLOCK</a>(<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"static <a class=\"id\" href=\"#LIST_HEAD\">LIST_HEAD</a>(<a class=\"id\" href=\"#cipso_v4_doi_list\">cipso_v4_doi_list</a>);", 
"", 
"<span class=\"comment\">/* Label mapping cache */</span>", 
"int <a class=\"id\" href=\"#cipso_v4_cache_enabled\">cipso_v4_cache_enabled</a> = 1;", 
"int <a class=\"id\" href=\"#cipso_v4_cache_bucketsize\">cipso_v4_cache_bucketsize</a> = 10;", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETBITS\">CIPSO_V4_CACHE_BUCKETBITS</a>     7", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETS\">CIPSO_V4_CACHE_BUCKETS</a>        (1 << <a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETBITS\">CIPSO_V4_CACHE_BUCKETBITS</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_CACHE_REORDERLIMIT\">CIPSO_V4_CACHE_REORDERLIMIT</a>   10", 
"struct <a class=\"id\" href=\"#cipso_v4_map_cache_bkt\">cipso_v4_map_cache_bkt</a> {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spinlock_t\">spinlock_t</a> <a class=\"id\" href=\"#lock\">lock</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> <a class=\"id\" href=\"#list\">list</a>;", 
"};", 
"struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a> {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#hash\">hash</a>;", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#key\">key</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#key_len\">key_len</a>;", 
"", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_lsm_cache\">netlbl_lsm_cache</a> *<a class=\"id\" href=\"#lsm_data\">lsm_data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#activity\">activity</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> <a class=\"id\" href=\"#list\">list</a>;", 
"};", 
"static struct <a class=\"id\" href=\"#cipso_v4_map_cache_bkt\">cipso_v4_map_cache_bkt</a> *<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"comment\">/* Restricted bitmap (tag #1) flags */</span>", 
"int <a class=\"id\" href=\"#cipso_v4_rbm_optfmt\">cipso_v4_rbm_optfmt</a> = 0;", 
"int <a class=\"id\" href=\"#cipso_v4_rbm_strictvalid\">cipso_v4_rbm_strictvalid</a> = 1;", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Protocol Constants</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/* Maximum size of the CIPSO IP option, derived from the fact that the maximum</span>", 
"<span class=\"comment\"> * IPv4 header size is 60 bytes and the base IPv4 header is 20 bytes long. */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_OPT_LEN_MAX\">CIPSO_V4_OPT_LEN_MAX</a>          40", 
"", 
"<span class=\"comment\">/* Length of the base CIPSO option, this includes the option type (1 byte), the</span>", 
"<span class=\"comment\"> * option length (1 byte), and the DOI (4 bytes). */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_HDR_LEN\">CIPSO_V4_HDR_LEN</a>              6", 
"", 
"<span class=\"comment\">/* Base length of the restrictive category bitmap tag (tag #1). */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_TAG_RBM_BLEN\">CIPSO_V4_TAG_RBM_BLEN</a>         4", 
"", 
"<span class=\"comment\">/* Base length of the enumerated category tag (tag #2). */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_TAG_ENUM_BLEN\">CIPSO_V4_TAG_ENUM_BLEN</a>        4", 
"", 
"<span class=\"comment\">/* Base length of the ranged categories bitmap tag (tag #5). */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_TAG_RNG_BLEN\">CIPSO_V4_TAG_RNG_BLEN</a>         4", 
"<span class=\"comment\">/* The maximum number of category ranges permitted in the ranged category tag</span>", 
"<span class=\"comment\"> * (tag #5).  You may note that the IETF draft states that the maximum number</span>", 
"<span class=\"comment\"> * of category ranges is 7, but if the low end of the last category range is</span>", 
"<span class=\"comment\"> * zero then it is possibile to fit 8 category ranges because the zero should</span>", 
"<span class=\"comment\"> * be omitted. */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_TAG_RNG_CAT_MAX\">CIPSO_V4_TAG_RNG_CAT_MAX</a>      8", 
"", 
"<span class=\"comment\">/* Base length of the local tag (non-standard tag).</span>", 
"<span class=\"comment\"> *  Tag definition (may change between kernel versions)</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * 0          8          16         24         32</span>", 
"<span class=\"comment\"> * +----------+----------+----------+----------+</span>", 
"<span class=\"comment\"> * | 10000000 | 00000110 | 32-bit secid value  |</span>", 
"<span class=\"comment\"> * +----------+----------+----------+----------+</span>", 
"<span class=\"comment\"> * | in (host byte order)|</span>", 
"<span class=\"comment\"> * +----------+----------+</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CIPSO_V4_TAG_LOC_BLEN\">CIPSO_V4_TAG_LOC_BLEN</a>         6", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Helper Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_bitmap_walk - Walk a bitmap looking for a bit</span>", 
"<span class=\"comment\"> * @bitmap: the bitmap</span>", 
"<span class=\"comment\"> * @bitmap_len: length in bits</span>", 
"<span class=\"comment\"> * @offset: starting offset</span>", 
"<span class=\"comment\"> * @state: if non-zero, look for a set (1) bit else look for a cleared (0) bit</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Starting at @offset, walk the bitmap from left to right until either the</span>", 
"<span class=\"comment\"> * desired bit is found or we reach the end.  Return the bit offset, -1 if</span>", 
"<span class=\"comment\"> * not found, or -2 if error.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_bitmap_walk\">cipso_v4_bitmap_walk</a>(const unsigned char *<a class=\"id\" href=\"#bitmap\">bitmap</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#bitmap_len\">bitmap_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#offset\">offset</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#state\">state</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#bit_spot\">bit_spot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#byte_offset\">byte_offset</a>;", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#bitmask\">bitmask</a>;", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#byte\">byte</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* gcc always rounds to zero when doing integer division */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#byte_offset\">byte_offset</a> = <a class=\"id\" href=\"#offset\">offset</a> / 8;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#byte\">byte</a> = <a class=\"id\" href=\"#bitmap\">bitmap</a>[<a class=\"id\" href=\"#byte_offset\">byte_offset</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bit_spot\">bit_spot</a> = <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bitmask\">bitmask</a> = 0x80 >> (<a class=\"id\" href=\"#offset\">offset</a> % 8);", 
"", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#bit_spot\">bit_spot</a> &lt; <a class=\"id\" href=\"#bitmap_len\">bitmap_len</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#state\">state</a> && (<a class=\"id\" href=\"#byte\">byte</a> &amp; <a class=\"id\" href=\"#bitmask\">bitmask</a>) == <a class=\"id\" href=\"#bitmask\">bitmask</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#state\">state</a> == 0 && (<a class=\"id\" href=\"#byte\">byte</a> &amp; <a class=\"id\" href=\"#bitmask\">bitmask</a>) == 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#bit_spot\">bit_spot</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bit_spot\">bit_spot</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bitmask\">bitmask</a> >>= 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bitmask\">bitmask</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#byte\">byte</a> = <a class=\"id\" href=\"#bitmap\">bitmap</a>[++<a class=\"id\" href=\"#byte_offset\">byte_offset</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bitmask\">bitmask</a> = 0x80;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return -1;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_bitmap_setbit - Sets a single bit in a bitmap</span>", 
"<span class=\"comment\"> * @bitmap: the bitmap</span>", 
"<span class=\"comment\"> * @bit: the bit</span>", 
"<span class=\"comment\"> * @state: if non-zero, set the bit (1) else clear the bit (0)</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Set a single bit in the bitmask.  Returns zero on success, negative values</span>", 
"<span class=\"comment\"> * on error.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#cipso_v4_bitmap_setbit\">cipso_v4_bitmap_setbit</a>(unsigned char *<a class=\"id\" href=\"#bitmap\">bitmap</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#bit\">bit</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#state\">state</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#byte_spot\">byte_spot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#bitmask\">bitmask</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* gcc always rounds to zero when doing integer division */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#byte_spot\">byte_spot</a> = <a class=\"id\" href=\"#bit\">bit</a> / 8;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bitmask\">bitmask</a> = 0x80 >> (<a class=\"id\" href=\"#bit\">bit</a> % 8);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#state\">state</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bitmap\">bitmap</a>[<a class=\"id\" href=\"#byte_spot\">byte_spot</a>] |= <a class=\"id\" href=\"#bitmask\">bitmask</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bitmap\">bitmap</a>[<a class=\"id\" href=\"#byte_spot\">byte_spot</a>] &= ~<a class=\"id\" href=\"#bitmask\">bitmask</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_cache_entry_free - Frees a cache entry</span>", 
"<span class=\"comment\"> * @entry: the entry to free</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function frees the memory associated with a cache entry including the</span>", 
"<span class=\"comment\"> * LSM cache data if there are no longer any users, i.e. reference count == 0.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#cipso_v4_cache_entry_free\">cipso_v4_cache_entry_free</a>(struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a> *<a class=\"id\" href=\"#entry\">entry</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#lsm_data\">lsm_data</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_secattr_cache_free\">netlbl_secattr_cache_free</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#lsm_data\">lsm_data</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#key\">key</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_map_cache_hash - Hashing function for the CIPSO cache</span>", 
"<span class=\"comment\"> * @key: the hash key</span>", 
"<span class=\"comment\"> * @key_len: the length of the key in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * The CIPSO tag hashing function.  Returns a 32-bit hash value.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cipso_v4_map_cache_hash\">cipso_v4_map_cache_hash</a>(const unsigned char *<a class=\"id\" href=\"#key\">key</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#key_len\">key_len</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#jhash\">jhash</a>(<a class=\"id\" href=\"#key\">key</a>, <a class=\"id\" href=\"#key_len\">key_len</a>, 0);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Label Mapping Cache Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_cache_init - Initialize the CIPSO cache</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Initializes the CIPSO label mapping cache, this function should be called</span>", 
"<span class=\"comment\"> * before any of the other functions defined in this file.  Returns zero on</span>", 
"<span class=\"comment\"> * success, negative values on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_cache_init\">cipso_v4_cache_init</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(<a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETS\">CIPSO_V4_CACHE_BUCKETS</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> sizeof(struct <a class=\"id\" href=\"#cipso_v4_map_cache_bkt\">cipso_v4_map_cache_bkt</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETS\">CIPSO_V4_CACHE_BUCKETS</a>; <a class=\"id\" href=\"#iter\">iter</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#size\">size</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_cache_invalidate - Invalidates the current CIPSO cache</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Invalidates and frees any entries in the CIPSO cache.  Returns zero on</span>", 
"<span class=\"comment\"> * success and negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#cipso_v4_cache_invalidate\">cipso_v4_cache_invalidate</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a> *<a class=\"id\" href=\"#entry\">entry</a>, *<a class=\"id\" href=\"#tmp_entry\">tmp_entry</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETS\">CIPSO_V4_CACHE_BUCKETS</a>; <a class=\"id\" href=\"#iter\">iter</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_safe\">list_for_each_entry_safe</a>(<a class=\"id\" href=\"#entry\">entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tmp_entry\">tmp_entry</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache_entry_free\">cipso_v4_cache_entry_free</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#size\">size</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_cache_check - Check the CIPSO cache for a label mapping</span>", 
"<span class=\"comment\"> * @key: the buffer to check</span>", 
"<span class=\"comment\"> * @key_len: buffer length in bytes</span>", 
"<span class=\"comment\"> * @secattr: the security attribute struct to use</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function checks the cache to see if a label mapping already exists for</span>", 
"<span class=\"comment\"> * the given key.  If there is a match then the cache is adjusted and the</span>", 
"<span class=\"comment\"> * @secattr struct is populated with the correct LSM security attributes.  The</span>", 
"<span class=\"comment\"> * cache is adjusted in the following manner if the entry is not already the</span>", 
"<span class=\"comment\"> * first in the cache bucket:</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  1. The cache entry's activity counter is incremented</span>", 
"<span class=\"comment\"> *  2. The previous (higher ranking) entry's activity counter is decremented</span>", 
"<span class=\"comment\"> *  3. If the difference between the two activity counters is geater than</span>", 
"<span class=\"comment\"> *     CIPSO_V4_CACHE_REORDERLIMIT the two entries are swapped</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns zero on success, -ENOENT for a cache miss, and other negative values</span>", 
"<span class=\"comment\"> * on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_cache_check\">cipso_v4_cache_check</a>(const unsigned char *<a class=\"id\" href=\"#key\">key</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#key_len\">key_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#bkt\">bkt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a> *<a class=\"id\" href=\"#prev_entry\">prev_entry</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#hash\">hash</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#cipso_v4_cache_enabled\">cipso_v4_cache_enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#cipso_v4_map_cache_hash\">cipso_v4_map_cache_hash</a>(<a class=\"id\" href=\"#key\">key</a>, <a class=\"id\" href=\"#key_len\">key_len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bkt\">bkt</a> = <a class=\"id\" href=\"#hash\">hash</a> &amp; (<a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETS\">CIPSO_V4_CACHE_BUCKETS</a> - 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#entry\">entry</a>, &amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#hash\">hash</a> == <a class=\"id\" href=\"#hash\">hash</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#key_len\">key_len</a> == <a class=\"id\" href=\"#key_len\">key_len</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#memcmp\">memcmp</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#key\">key</a>, <a class=\"id\" href=\"#key\">key</a>, <a class=\"id\" href=\"#key_len\">key_len</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#activity\">activity</a> += 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#lsm_data\">lsm_data</a>-><a class=\"id\" href=\"#refcount\">refcount</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#lsm_data\">lsm_data</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_CACHE\">NETLBL_SECATTR_CACHE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_CIPSOV4\">NETLBL_NLTYPE_CIPSOV4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev_entry\">prev_entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev_entry\">prev_entry</a>-><a class=\"id\" href=\"#activity\">activity</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prev_entry\">prev_entry</a>-><a class=\"id\" href=\"#activity\">activity</a> -= 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#activity\">activity</a> &gt; <a class=\"id\" href=\"#prev_entry\">prev_entry</a>-><a class=\"id\" href=\"#activity\">activity</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#activity\">activity</a> - <a class=\"id\" href=\"#prev_entry\">prev_entry</a>-><a class=\"id\" href=\"#activity\">activity</a> &gt;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#CIPSO_V4_CACHE_REORDERLIMIT\">CIPSO_V4_CACHE_REORDERLIMIT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__list_del\">__list_del</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#prev\">prev</a>, <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#next\">next</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__list_add\">__list_add</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#prev_entry\">prev_entry</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#prev\">prev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#prev_entry\">prev_entry</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prev_entry\">prev_entry</a> = <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_cache_add - Add an entry to the CIPSO cache</span>", 
"<span class=\"comment\"> * @skb: the packet</span>", 
"<span class=\"comment\"> * @secattr: the packet's security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Add a new entry into the CIPSO label mapping cache.  Add the new entry to</span>", 
"<span class=\"comment\"> * head of the cache bucket's list, if the cache bucket is out of room remove</span>", 
"<span class=\"comment\"> * the last entry in the list first.  It is important to note that there is</span>", 
"<span class=\"comment\"> * currently no checking for duplicate keys.  Returns zero on success,</span>", 
"<span class=\"comment\"> * negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#cipso_v4_cache_add\">cipso_v4_cache_add</a>(const struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#bkt\">bkt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a> *<a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a> *<a class=\"id\" href=\"#old_entry\">old_entry</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#cipso_ptr\">cipso_ptr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cipso_ptr_len\">cipso_ptr_len</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#cipso_v4_cache_enabled\">cipso_v4_cache_enabled</a> || <a class=\"id\" href=\"#cipso_v4_cache_bucketsize\">cipso_v4_cache_bucketsize</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_ptr\">cipso_ptr</a> = <a class=\"id\" href=\"#CIPSO_V4_OPTPTR\">CIPSO_V4_OPTPTR</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_ptr_len\">cipso_ptr_len</a> = <a class=\"id\" href=\"#cipso_ptr\">cipso_ptr</a>[1];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#entry\">entry</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#key\">key</a> = <a class=\"id\" href=\"#kmemdup\">kmemdup</a>(<a class=\"id\" href=\"#cipso_ptr\">cipso_ptr</a>, <a class=\"id\" href=\"#cipso_ptr_len\">cipso_ptr_len</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#key\">key</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#cache_add_failure\">cache_add_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#key_len\">key_len</a> = <a class=\"id\" href=\"#cipso_ptr_len\">cipso_ptr_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#hash\">hash</a> = <a class=\"id\" href=\"#cipso_v4_map_cache_hash\">cipso_v4_map_cache_hash</a>(<a class=\"id\" href=\"#cipso_ptr\">cipso_ptr</a>, <a class=\"id\" href=\"#cipso_ptr_len\">cipso_ptr_len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a>-><a class=\"id\" href=\"#refcount\">refcount</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#lsm_data\">lsm_data</a> = <a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bkt\">bkt</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#hash\">hash</a> &amp; (<a class=\"id\" href=\"#CIPSO_V4_CACHE_BUCKETS\">CIPSO_V4_CACHE_BUCKETS</a> - 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#size\">size</a> &lt; <a class=\"id\" href=\"#cipso_v4_cache_bucketsize\">cipso_v4_cache_bucketsize</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#size\">size</a> += 1;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_entry\">old_entry</a> = <a class=\"id\" href=\"#list_entry\">list_entry</a>(<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#prev\">prev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#cipso_v4_map_cache_entry\">cipso_v4_map_cache_entry</a>, <a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#old_entry\">old_entry</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache_entry_free\">cipso_v4_cache_entry_free</a>(<a class=\"id\" href=\"#old_entry\">old_entry</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#cipso_v4_cache\">cipso_v4_cache</a>[<a class=\"id\" href=\"#bkt\">bkt</a>].<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#cache_add_failure\">cache_add_failure</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache_entry_free\">cipso_v4_cache_entry_free</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * DOI List Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_search - Searches for a DOI definition</span>", 
"<span class=\"comment\"> * @doi: the DOI to search for</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Search the DOI definition list for a DOI definition with a DOI value that</span>", 
"<span class=\"comment\"> * matches @doi.  The caller is responsibile for calling rcu_read_[un]lock().</span>", 
"<span class=\"comment\"> * Returns a pointer to the DOI definition on success and NULL on failure.</span>", 
"<span class=\"comment\"> */</span>", 
"static struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#cipso_v4_doi_search\">cipso_v4_doi_search</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi\">doi</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#iter\">iter</a>, &amp;<a class=\"id\" href=\"#cipso_v4_doi_list\">cipso_v4_doi_list</a>, <a class=\"id\" href=\"#list\">list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter\">iter</a>-><a class=\"id\" href=\"#doi\">doi</a> == <a class=\"id\" href=\"#doi\">doi</a> && <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#iter\">iter</a>-><a class=\"id\" href=\"#refcount\">refcount</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#iter\">iter</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_add - Add a new DOI to the CIPSO protocol engine</span>", 
"<span class=\"comment\"> * @doi_def: the DOI structure</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * The caller defines a new DOI for use by the CIPSO engine and calls this</span>", 
"<span class=\"comment\"> * function to add it to the list of acceptable domains.  The caller must</span>", 
"<span class=\"comment\"> * ensure that the mapping table specified in @doi_def-&gt;map meets all of the</span>", 
"<span class=\"comment\"> * requirements of the mapping type (see cipso_ipv4.h for details).  Returns</span>", 
"<span class=\"comment\"> * zero on success and non-zero on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#cipso_v4_doi_add\">cipso_v4_doi_add</a>(struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi\">doi</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi_type\">doi_type</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi\">doi</a> = <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#doi\">doi</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_type\">doi_type</a> = <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#doi\">doi</a> == <a class=\"id\" href=\"#CIPSO_V4_DOI_UNKNOWN\">CIPSO_V4_DOI_UNKNOWN</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_add_return\">doi_add_return</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#CIPSO_V4_TAG_MAXCNT\">CIPSO_V4_TAG_MAXCNT</a>; <a class=\"id\" href=\"#iter\">iter</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#tags\">tags</a>[<a class=\"id\" href=\"#iter\">iter</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_TAG_RBITMAP\">CIPSO_V4_TAG_RBITMAP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_TAG_RANGE\">CIPSO_V4_TAG_RANGE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_TAG_ENUM\">CIPSO_V4_TAG_ENUM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#CIPSO_V4_MAP_PASS\">CIPSO_V4_MAP_PASS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_add_return\">doi_add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_TAG_LOCAL\">CIPSO_V4_TAG_LOCAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#CIPSO_V4_MAP_LOCAL\">CIPSO_V4_MAP_LOCAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_add_return\">doi_add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_TAG_INVALID\">CIPSO_V4_TAG_INVALID</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter\">iter</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_add_return\">doi_add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_add_return\">doi_add_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#refcount\">refcount</a>, 1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cipso_v4_doi_search\">cipso_v4_doi_search</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#doi\">doi</a>) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_add_return\">doi_add_return</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail_rcu\">list_add_tail_rcu</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#cipso_v4_doi_list\">cipso_v4_doi_list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = 0;", 
"", 
"<a class=\"id\" href=\"#doi_add_return\">doi_add_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#netlbl_audit_start\">netlbl_audit_start</a>(<a class=\"id\" href=\"#AUDIT_MAC_CIPSOV4_ADD\">AUDIT_MAC_CIPSOV4_ADD</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const char *<a class=\"id\" href=\"#type_str\">type_str</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#doi_type\">doi_type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_TRANS\">CIPSO_V4_MAP_TRANS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type_str\">type_str</a> = \"trans\";", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_PASS\">CIPSO_V4_MAP_PASS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type_str\">type_str</a> = \"pass\";", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_LOCAL\">CIPSO_V4_MAP_LOCAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type_str\">type_str</a> = \"local\";", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type_str\">type_str</a> = \"(unknown)\";", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \" cipso_doi=%u cipso_type=%s res=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#doi\">doi</a>, <a class=\"id\" href=\"#type_str\">type_str</a>, <a class=\"id\" href=\"#ret_val\">ret_val</a> == 0 ? 1 : 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_free - Frees a DOI definition</span>", 
"<span class=\"comment\"> * @entry: the entry's RCU field</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function frees all of the memory associated with a DOI definition.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#cipso_v4_doi_free\">cipso_v4_doi_free</a>(struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_TRANS\">CIPSO_V4_MAP_TRANS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#cipso\">cipso</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#lvl\">lvl</a>.<a class=\"id\" href=\"#local\">local</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso\">cipso</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#local\">local</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_free_rcu - Frees a DOI definition via the RCU pointer</span>", 
"<span class=\"comment\"> * @entry: the entry's RCU field</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function is designed to be used as a callback to the call_rcu()</span>", 
"<span class=\"comment\"> * function so that the memory allocated to the DOI definition can be released</span>", 
"<span class=\"comment\"> * safely.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#cipso_v4_doi_free_rcu\">cipso_v4_doi_free_rcu</a>(struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> *<a class=\"id\" href=\"#entry\">entry</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#entry\">entry</a>, struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a>, <a class=\"id\" href=\"#rcu\">rcu</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_free\">cipso_v4_doi_free</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_remove - Remove an existing DOI from the CIPSO protocol engine</span>", 
"<span class=\"comment\"> * @doi: the DOI value</span>", 
"<span class=\"comment\"> * @audit_secid: the LSM secid to use in the audit message</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Removes a DOI definition from the CIPSO engine.  The NetLabel routines will</span>", 
"<span class=\"comment\"> * be called to release their own LSM domain mappings as well as our own</span>", 
"<span class=\"comment\"> * domain list.  Returns zero on success and negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#cipso_v4_doi_remove\">cipso_v4_doi_remove</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi\">doi</a>, struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#cipso_v4_doi_search\">cipso_v4_doi_search</a>(<a class=\"id\" href=\"#doi\">doi</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_remove_return\">doi_remove_return</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#atomic_dec_and_test\">atomic_dec_and_test</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#refcount\">refcount</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_remove_return\">doi_remove_return</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache_invalidate\">cipso_v4_cache_invalidate</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#cipso_v4_doi_free_rcu\">cipso_v4_doi_free_rcu</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = 0;", 
"", 
"<a class=\"id\" href=\"#doi_remove_return\">doi_remove_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#netlbl_audit_start\">netlbl_audit_start</a>(<a class=\"id\" href=\"#AUDIT_MAC_CIPSOV4_DEL\">AUDIT_MAC_CIPSOV4_DEL</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \" cipso_doi=%u res=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#doi\">doi</a>, <a class=\"id\" href=\"#ret_val\">ret_val</a> == 0 ? 1 : 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_getdef - Returns a reference to a valid DOI definition</span>", 
"<span class=\"comment\"> * @doi: the DOI value</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Searches for a valid DOI definition and if one is found it is returned to</span>", 
"<span class=\"comment\"> * the caller.  Otherwise NULL is returned.  The caller must ensure that</span>", 
"<span class=\"comment\"> * rcu_read_lock() is held while accessing the returned definition and the DOI</span>", 
"<span class=\"comment\"> * definition reference count is decremented when the caller is done.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#cipso_v4_doi_getdef\">cipso_v4_doi_getdef</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi\">doi</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#cipso_v4_doi_search\">cipso_v4_doi_search</a>(<a class=\"id\" href=\"#doi\">doi</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#doi_getdef_return\">doi_getdef_return</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#atomic_inc_not_zero\">atomic_inc_not_zero</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#refcount\">refcount</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doi_def\">doi_def</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<a class=\"id\" href=\"#doi_getdef_return\">doi_getdef_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#doi_def\">doi_def</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_putdef - Releases a reference for the given DOI definition</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Releases a DOI definition reference obtained from cipso_v4_doi_getdef().</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#cipso_v4_doi_putdef\">cipso_v4_doi_putdef</a>(struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#atomic_dec_and_test\">atomic_dec_and_test</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#refcount\">refcount</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#cipso_v4_doi_list_lock\">cipso_v4_doi_list_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_cache_invalidate\">cipso_v4_cache_invalidate</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#cipso_v4_doi_free_rcu\">cipso_v4_doi_free_rcu</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_doi_walk - Iterate through the DOI definitions</span>", 
"<span class=\"comment\"> * @skip_cnt: skip past this number of DOI definitions, updated</span>", 
"<span class=\"comment\"> * @callback: callback for each DOI definition</span>", 
"<span class=\"comment\"> * @cb_arg: argument for the callback function</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Iterate over the DOI definition list, skipping the first @skip_cnt entries.</span>", 
"<span class=\"comment\"> * For each entry call @callback, if @callback returns a negative value stop</span>", 
"<span class=\"comment\"> * 'walking' through the list and return.  Updates the value in @skip_cnt upon</span>", 
"<span class=\"comment\"> * return.  Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#cipso_v4_doi_walk\">cipso_v4_doi_walk</a>(<a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#skip_cnt\">skip_cnt</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>     int (*<a class=\"id\" href=\"#callback\">callback</a>) (struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>, void *<a class=\"id\" href=\"#arg\">arg</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/>     void *<a class=\"id\" href=\"#cb_arg\">cb_arg</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#doi_cnt\">doi_cnt</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#iter_doi\">iter_doi</a>;", 
"", 
];
xr_frag_insert('l/3b/c9df1d1f69bfc385a4da3e4034fb0c2406f0f4.xr', __xr_tmp);
