var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * INET<span class=\"ts\"/><span class=\"ts\"/>An implementation of the TCP/IP protocol suite for the LINUX</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>operating system.  INET is implemented using the  BSD Socket</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>interface as the means of communication with the user level.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>The options processing module for ip.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Authors:<span class=\"ts\"/>A.N.Kuznetsov</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#capability\">capability</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#skbuff\">skbuff</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#icmp\">icmp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#rtnetlink\">rtnetlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#sock\">sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#icmp\">icmp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#route\">route</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#cipso_ipv4\">cipso_ipv4</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Write options to IP header, record destination address to</span>", 
"<span class=\"comment\"> * source route option, address of outgoing interface</span>", 
"<span class=\"comment\"> * (we should already know it, so that this  function is allowed be</span>", 
"<span class=\"comment\"> * called only after routing decision) and timestamp,</span>", 
"<span class=\"comment\"> * if we originate this datagram.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * daddr is real destination address, next hop is recorded in IP header.</span>", 
"<span class=\"comment\"> * saddr is address of outgoing interface.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_options_build\">ip_options_build</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> * <a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#ip_options\">ip_options</a> * <a class=\"id\" href=\"#opt\">opt</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>, int <a class=\"id\" href=\"#is_frag\">is_frag</a>)", 
"{", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#iph\">iph</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;(<a class=\"id\" href=\"#IPCB\">IPCB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#opt\">opt</a>), <a class=\"id\" href=\"#opt\">opt</a>, sizeof(struct <a class=\"id\" href=\"#ip_options\">ip_options</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#iph\">iph</a>+sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>), <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>, <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#optlen\">optlen</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a> = &amp;(<a class=\"id\" href=\"#IPCB\">IPCB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#opt\">opt</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#iph\">iph</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>+<a class=\"id\" href=\"#iph\">iph</a>[<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>+1]-4, &amp;<a class=\"id\" href=\"#daddr\">daddr</a>, 4);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#is_frag\">is_frag</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_get_source\">ip_rt_get_source</a>(<a class=\"id\" href=\"#iph\">iph</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>+<a class=\"id\" href=\"#iph\">iph</a>[<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>+2]-5, <a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_get_source\">ip_rt_get_source</a>(<a class=\"id\" href=\"#iph\">iph</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>+<a class=\"id\" href=\"#iph\">iph</a>[<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>+2]-9, <a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#tv\">tv</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#midtime\">midtime</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#getnstimeofday\">getnstimeofday</a>(&amp;<a class=\"id\" href=\"#tv\">tv</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#midtime\">midtime</a> = <a class=\"id\" href=\"#htonl\">htonl</a>((<a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_sec\">tv_sec</a> % 86400) * <a class=\"id\" href=\"#MSEC_PER_SEC\">MSEC_PER_SEC</a> + <a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_nsec\">tv_nsec</a> / <a class=\"id\" href=\"#NSEC_PER_MSEC\">NSEC_PER_MSEC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#iph\">iph</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>+<a class=\"id\" href=\"#iph\">iph</a>[<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>+2]-5, &amp;<a class=\"id\" href=\"#midtime\">midtime</a>, 4);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#iph\">iph</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>, <a class=\"id\" href=\"#IPOPT_NOP\">IPOPT_NOP</a>, <a class=\"id\" href=\"#iph\">iph</a>[<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>+1]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#iph\">iph</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>, <a class=\"id\" href=\"#IPOPT_NOP\">IPOPT_NOP</a>, <a class=\"id\" href=\"#iph\">iph</a>[<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>+1]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 0;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Provided (sopt, skb) points to received options,</span>", 
"<span class=\"comment\"> * build in dopt compiled option set appropriate for answering.</span>", 
"<span class=\"comment\"> * i.e. invert SRR option, copy anothers,</span>", 
"<span class=\"comment\"> * and grab room in RR/TS options.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * NOTE: dopt cannot point to skb.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ip_options_echo\">ip_options_echo</a>(struct <a class=\"id\" href=\"#ip_options\">ip_options</a> * <a class=\"id\" href=\"#dopt\">dopt</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> * <a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_options\">ip_options</a> *<a class=\"id\" href=\"#sopt\">sopt</a>;", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#sptr\">sptr</a>, *<a class=\"id\" href=\"#dptr\">dptr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#soffset\">soffset</a>, <a class=\"id\" href=\"#doffset\">doffset</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><a class=\"id\" href=\"#daddr\">daddr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#dopt\">dopt</a>, 0, sizeof(struct <a class=\"id\" href=\"#ip_options\">ip_options</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sopt\">sopt</a> = &amp;(<a class=\"id\" href=\"#IPCB\">IPCB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#opt\">opt</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sptr\">sptr</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a> = <a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#__data\">__data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#rr\">rr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a>  = <a class=\"id\" href=\"#sptr\">sptr</a>[<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#rr\">rr</a>+1];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> = <a class=\"id\" href=\"#sptr\">sptr</a>[<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#rr\">rr</a>+2];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#rr\">rr</a> = <a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> + sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#dptr\">dptr</a>, <a class=\"id\" href=\"#sptr\">sptr</a>+<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#rr\">rr</a>, <a class=\"id\" href=\"#optlen\">optlen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a> && <a class=\"id\" href=\"#soffset\">soffset</a> <= <a class=\"id\" href=\"#optlen\">optlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#soffset\">soffset</a> + 3 &gt; <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a>[2] = <a class=\"id\" href=\"#soffset\">soffset</a> + 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#ts\">ts</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a> = <a class=\"id\" href=\"#sptr\">sptr</a>[<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#ts\">ts</a>+1];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> = <a class=\"id\" href=\"#sptr\">sptr</a>[<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#ts\">ts</a>+2];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> + sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#dptr\">dptr</a>, <a class=\"id\" href=\"#sptr\">sptr</a>+<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#ts\">ts</a>, <a class=\"id\" href=\"#optlen\">optlen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#soffset\">soffset</a> <= <a class=\"id\" href=\"#optlen\">optlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#soffset\">soffset</a> + 3 &gt; <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> += 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#soffset\">soffset</a> + 3 &gt; <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#dptr\">dptr</a>[3]&amp;0xF) != <a class=\"id\" href=\"#IPOPT_TS_PRESPEC\">IPOPT_TS_PRESPEC</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> += 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#soffset\">soffset</a> + 8 <= <a class=\"id\" href=\"#optlen\">optlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#sptr\">sptr</a>+<a class=\"id\" href=\"#soffset\">soffset</a>-1, 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_addr_type\">inet_addr_type</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#skb_dst\">skb_dst</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#addr\">addr</a>) != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> += 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a>[2] = <a class=\"id\" href=\"#soffset\">soffset</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#srr\">srr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned char * <a class=\"id\" href=\"#start\">start</a> = <a class=\"id\" href=\"#sptr\">sptr</a>+<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#srr\">srr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#faddr\">faddr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a>  = <a class=\"id\" href=\"#start\">start</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> = <a class=\"id\" href=\"#start\">start</a>[2];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doffset\">doffset</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#soffset\">soffset</a> &gt; <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> = <a class=\"id\" href=\"#optlen\">optlen</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#soffset\">soffset</a> -= 4;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#soffset\">soffset</a> &gt; 3) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#faddr\">faddr</a>, &amp;<a class=\"id\" href=\"#start\">start</a>[<a class=\"id\" href=\"#soffset\">soffset</a>-1], 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#soffset\">soffset</a>-=4, <a class=\"id\" href=\"#doffset\">doffset</a>=4; <a class=\"id\" href=\"#soffset\">soffset</a> &gt; 3; <a class=\"id\" href=\"#soffset\">soffset</a>-=4, <a class=\"id\" href=\"#doffset\">doffset</a>+=4)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#dptr\">dptr</a>[<a class=\"id\" href=\"#doffset\">doffset</a>-1], &amp;<a class=\"id\" href=\"#start\">start</a>[<a class=\"id\" href=\"#soffset\">soffset</a>-1], 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * RFC1812 requires to fix illegal source routes.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#memcmp\">memcmp</a>(&amp;<a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#start\">start</a>[<a class=\"id\" href=\"#soffset\">soffset</a> + 3], 4) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#doffset\">doffset</a> -= 4;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#doffset\">doffset</a> &gt; 3) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#start\">start</a>[<a class=\"id\" href=\"#doffset\">doffset</a>-1], &amp;<a class=\"id\" href=\"#daddr\">daddr</a>, 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#faddr\">faddr</a> = <a class=\"id\" href=\"#faddr\">faddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a>[0] = <a class=\"id\" href=\"#start\">start</a>[0];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a>[1] = <a class=\"id\" href=\"#doffset\">doffset</a>+3;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a>[2] = 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a> += <a class=\"id\" href=\"#doffset\">doffset</a>+3;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#srr\">srr</a> = <a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> + sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> += <a class=\"id\" href=\"#doffset\">doffset</a>+3;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#is_strictroute\">is_strictroute</a> = <a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#is_strictroute\">is_strictroute</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#cipso\">cipso</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a>  = <a class=\"id\" href=\"#sptr\">sptr</a>[<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#cipso\">cipso</a>+1];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#cipso\">cipso</a> = <a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a>+sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#dptr\">dptr</a>, <a class=\"id\" href=\"#sptr\">sptr</a>+<a class=\"id\" href=\"#sopt\">sopt</a>-><a class=\"id\" href=\"#cipso\">cipso</a>, <a class=\"id\" href=\"#optlen\">optlen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dptr\">dptr</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> &amp; 3) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#dptr\">dptr</a>++ = <a class=\"id\" href=\"#IPOPT_END\">IPOPT_END</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dopt\">dopt</a>-><a class=\"id\" href=\"#optlen\">optlen</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Options \"fragmenting\", just fill options not</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>allowed in fragments with NOOPs.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Simple and stupid 8), but the most efficient way.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_options_fragment\">ip_options_fragment</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> * <a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>) + sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_options\">ip_options</a> * <a class=\"id\" href=\"#opt\">opt</a> = &amp;(<a class=\"id\" href=\"#IPCB\">IPCB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#opt\">opt</a>);", 
"<span class=\"ts\"/>int  <a class=\"id\" href=\"#l\">l</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>int  <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#l\">l</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (*<a class=\"id\" href=\"#optptr\">optptr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPOPT_END\">IPOPT_END</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#IPOPT_NOOP\">IPOPT_NOOP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#l\">l</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a> = <a class=\"id\" href=\"#optptr\">optptr</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a>&lt;2 || <a class=\"id\" href=\"#optlen\">optlen</a>&gt;<a class=\"id\" href=\"#l\">l</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>  return;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#IPOPT_COPIED\">IPOPT_COPIED</a>(*<a class=\"id\" href=\"#optptr\">optptr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#optptr\">optptr</a>, <a class=\"id\" href=\"#IPOPT_NOOP\">IPOPT_NOOP</a>, <a class=\"id\" href=\"#optlen\">optlen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#l\">l</a> -= <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Verify options and fill pointers in struct options.</span>", 
"<span class=\"comment\"> * Caller should clear *opt, and set opt-&gt;data.</span>", 
"<span class=\"comment\"> * If opt == NULL, then skb-&gt;data should point to IP header.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ip_options_compile\">ip_options_compile</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#ip_options\">ip_options</a> * <a class=\"id\" href=\"#opt\">opt</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> * <a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#l\">l</a>;", 
"<span class=\"ts\"/>unsigned char * <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/>unsigned char * <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>unsigned char * <a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a> = (unsigned char *)&amp;(<a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)[1]);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#l\">l</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#optlen\">optlen</a>; <a class=\"id\" href=\"#l\">l</a> &gt; 0; ) {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (*<a class=\"id\" href=\"#optptr\">optptr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_END\">IPOPT_END</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#optptr\">optptr</a>++, <a class=\"id\" href=\"#l\">l</a>--; <a class=\"id\" href=\"#l\">l</a>&gt;0; <a class=\"id\" href=\"#optptr\">optptr</a>++, <a class=\"id\" href=\"#l\">l</a>--) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#optptr\">optptr</a> != <a class=\"id\" href=\"#IPOPT_END\">IPOPT_END</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#IPOPT_END\">IPOPT_END</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#eol\">eol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_NOOP\">IPOPT_NOOP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#l\">l</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optlen\">optlen</a> = <a class=\"id\" href=\"#optptr\">optptr</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a>&lt;2 || <a class=\"id\" href=\"#optlen\">optlen</a>&gt;<a class=\"id\" href=\"#l\">l</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (*<a class=\"id\" href=\"#optptr\">optptr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_SSRR\">IPOPT_SSRR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_LSRR\">IPOPT_LSRR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &lt; 3) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2] &lt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* NB: cf RFC-1812 5.2.4.1 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2] != 4 || <a class=\"id\" href=\"#optlen\">optlen</a> &lt; 7 || ((<a class=\"id\" href=\"#optlen\">optlen</a>-3) &amp; 3)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#faddr\">faddr</a>, &amp;<a class=\"id\" href=\"#optptr\">optptr</a>[3], 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &gt; 7)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memmove\">memmove</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[3], &amp;<a class=\"id\" href=\"#optptr\">optptr</a>[7], <a class=\"id\" href=\"#optlen\">optlen</a>-7);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_strictroute\">is_strictroute</a> = (<a class=\"id\" href=\"#optptr\">optptr</a>[0] == <a class=\"id\" href=\"#IPOPT_SSRR\">IPOPT_SSRR</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_RR\">IPOPT_RR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &lt; 3) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2] &lt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2] <= <a class=\"id\" href=\"#optlen\">optlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2]+3 &gt; <a class=\"id\" href=\"#optlen\">optlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-1], &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>, 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] += 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_TIMESTAMP\">IPOPT_TIMESTAMP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &lt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2] &lt; 5) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2] <= <a class=\"id\" href=\"#optlen\">optlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#timeptr\">timeptr</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2]+3 &gt; <a class=\"id\" href=\"#optptr\">optptr</a>[1]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#optptr\">optptr</a>[3]&amp;0xF) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_TS_TSONLY\">IPOPT_TS_TSONLY</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeptr\">timeptr</a> = (<a class=\"id\" href=\"#__be32\">__be32</a>*)&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-1];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] += 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_TS_TSANDADDR\">IPOPT_TS_TSANDADDR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2]+7 &gt; <a class=\"id\" href=\"#optptr\">optptr</a>[1]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-1], &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_spec_dst\">rt_spec_dst</a>, 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeptr\">timeptr</a> = (<a class=\"id\" href=\"#__be32\">__be32</a>*)&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]+3];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] += 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_TS_PRESPEC\">IPOPT_TS_PRESPEC</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2]+7 &gt; <a class=\"id\" href=\"#optptr\">optptr</a>[1]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#addr\">addr</a>, &amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-1], 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_addr_type\">inet_addr_type</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#addr\">addr</a>) == <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeptr\">timeptr</a> = (<a class=\"id\" href=\"#__be32\">__be32</a>*)&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]+3];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] += 8;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a> && !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_NET_RAW\">CAP_NET_RAW</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 3;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#timeptr\">timeptr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#tv\">tv</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a>  <a class=\"id\" href=\"#midtime\">midtime</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#getnstimeofday\">getnstimeofday</a>(&amp;<a class=\"id\" href=\"#tv\">tv</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#midtime\">midtime</a> = <a class=\"id\" href=\"#htonl\">htonl</a>((<a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_sec\">tv_sec</a> % 86400) * <a class=\"id\" href=\"#MSEC_PER_SEC\">MSEC_PER_SEC</a> + <a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_nsec\">tv_nsec</a> / <a class=\"id\" href=\"#NSEC_PER_MSEC\">NSEC_PER_MSEC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#timeptr\">timeptr</a>, &amp;<a class=\"id\" href=\"#midtime\">midtime</a>, sizeof(<a class=\"id\" href=\"#__be32\">__be32</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned <a class=\"id\" href=\"#overflow\">overflow</a> = <a class=\"id\" href=\"#optptr\">optptr</a>[3]>>4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#overflow\">overflow</a> == 15) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 3;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[3] = (<a class=\"id\" href=\"#optptr\">optptr</a>[3]&amp;0xF)|((<a class=\"id\" href=\"#overflow\">overflow</a>+1)<<4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_RA\">IPOPT_RA</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &lt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a> + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optptr\">optptr</a>[2] == 0 && <a class=\"id\" href=\"#optptr\">optptr</a>[3] == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#router_alert\">router_alert</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_CIPSO\">IPOPT_CIPSO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if ((!<a class=\"id\" href=\"#skb\">skb</a> && !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_NET_RAW\">CAP_NET_RAW</a>)) || <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#cipso\">cipso</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#cipso\">cipso</a> = <a class=\"id\" href=\"#optptr\">optptr</a> - <a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cipso_v4_validate\">cipso_v4_validate</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#optptr\">optptr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_SEC\">IPOPT_SEC</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>      case <a class=\"id\" href=\"#IPOPT_SID\">IPOPT_SID</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>      default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a> && !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_NET_RAW\">CAP_NET_RAW</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pp_ptr\">pp_ptr</a> = <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#l\">l</a> -= <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a> += <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#eol\">eol</a>:", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pp_ptr\">pp_ptr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#icmp_send\">icmp_send</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ICMP_PARAMETERPROB\">ICMP_PARAMETERPROB</a>, 0, <a class=\"id\" href=\"#htonl\">htonl</a>((<a class=\"id\" href=\"#pp_ptr\">pp_ptr</a>-<a class=\"id\" href=\"#iph\">iph</a>)<<24));", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Undo all the changes done by ip_options_compile().</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_options_undo\">ip_options_undo</a>(struct <a class=\"id\" href=\"#ip_options\">ip_options</a> * <a class=\"id\" href=\"#opt\">opt</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned  char * <a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>-sizeof(struct  <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memmove\">memmove</a>(<a class=\"id\" href=\"#optptr\">optptr</a>+7, <a class=\"id\" href=\"#optptr\">optptr</a>+3, <a class=\"id\" href=\"#optptr\">optptr</a>[1]-7);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#optptr\">optptr</a>+3, &amp;<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#faddr\">faddr</a>, 4);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned  char * <a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>-sizeof(struct  <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] -= 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-1], 0, 4);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned  char * <a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>+<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>-sizeof(struct  <a class=\"id\" href=\"#iphdr\">iphdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needtime\">ts_needtime</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] -= 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-1], 0, 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#optptr\">optptr</a>[3]&amp;0xF) == <a class=\"id\" href=\"#IPOPT_TS_PRESPEC\">IPOPT_TS_PRESPEC</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] -= 4;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] -= 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-1], 0, 4);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#ip_options\">ip_options</a> *<a class=\"id\" href=\"#ip_options_get_alloc\">ip_options_get_alloc</a>(const int <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#ip_options\">ip_options</a>) + ((<a class=\"id\" href=\"#optlen\">optlen</a> + 3) &amp; ~3),", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#ip_options_get_finish\">ip_options_get_finish</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#ip_options\">ip_options</a> **<a class=\"id\" href=\"#optp\">optp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#ip_options\">ip_options</a> *<a class=\"id\" href=\"#opt\">opt</a>, int <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#optlen\">optlen</a> &amp; 3)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>[<a class=\"id\" href=\"#optlen\">optlen</a>++] = <a class=\"id\" href=\"#IPOPT_END\">IPOPT_END</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#optlen\">optlen</a> = <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> && <a class=\"id\" href=\"#ip_options_compile\">ip_options_compile</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#NULL\">NULL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#opt\">opt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(*<a class=\"id\" href=\"#optp\">optp</a>);", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#optp\">optp</a> = <a class=\"id\" href=\"#opt\">opt</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_options_get_from_user\">ip_options_get_from_user</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#ip_options\">ip_options</a> **<a class=\"id\" href=\"#optp\">optp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     unsigned char <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#data\">data</a>, int <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_options\">ip_options</a> *<a class=\"id\" href=\"#opt\">opt</a> = <a class=\"id\" href=\"#ip_options_get_alloc\">ip_options_get_alloc</a>(<a class=\"id\" href=\"#optlen\">optlen</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#opt\">opt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> && <a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>, <a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#optlen\">optlen</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#opt\">opt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ip_options_get_finish\">ip_options_get_finish</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#optp\">optp</a>, <a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#optlen\">optlen</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_options_get\">ip_options_get</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#ip_options\">ip_options</a> **<a class=\"id\" href=\"#optp\">optp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>   unsigned char *<a class=\"id\" href=\"#data\">data</a>, int <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_options\">ip_options</a> *<a class=\"id\" href=\"#opt\">opt</a> = <a class=\"id\" href=\"#ip_options_get_alloc\">ip_options_get_alloc</a>(<a class=\"id\" href=\"#optlen\">optlen</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#opt\">opt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#__data\">__data</a>, <a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#optlen\">optlen</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ip_options_get_finish\">ip_options_get_finish</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#optp\">optp</a>, <a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#optlen\">optlen</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#ip_forward_options\">ip_forward_options</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct   <a class=\"id\" href=\"#ip_options\">ip_options</a> * <a class=\"id\" href=\"#opt\">opt</a><span class=\"ts\"/>= &amp;(<a class=\"id\" href=\"#IPCB\">IPCB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#opt\">opt</a>);", 
"<span class=\"ts\"/>unsigned char * <a class=\"id\" href=\"#optptr\">optptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#raw\">raw</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr_needaddr\">rr_needaddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a> = (unsigned char *)<a class=\"id\" href=\"#raw\">raw</a> + <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#rr\">rr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_get_source\">ip_rt_get_source</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-5], <a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr_is_hit\">srr_is_hit</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#srrptr\">srrptr</a>, <a class=\"id\" href=\"#srrspace\">srrspace</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#raw\">raw</a> + <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>for ( <a class=\"id\" href=\"#srrptr\">srrptr</a>=<a class=\"id\" href=\"#optptr\">optptr</a>[2], <a class=\"id\" href=\"#srrspace\">srrspace</a> = <a class=\"id\" href=\"#optptr\">optptr</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#srrptr\">srrptr</a> <= <a class=\"id\" href=\"#srrspace\">srrspace</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#srrptr\">srrptr</a> += 4", 
"<span class=\"ts\"/><span class=\"ts\"/>     ) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#srrptr\">srrptr</a> + 3 &gt; <a class=\"id\" href=\"#srrspace\">srrspace</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#memcmp\">memcmp</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>, &amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#srrptr\">srrptr</a>-1], 4) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#srrptr\">srrptr</a> + 3 <= <a class=\"id\" href=\"#srrspace\">srrspace</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_get_source\">ip_rt_get_source</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#srrptr\">srrptr</a>-1], <a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a>[2] = <a class=\"id\" href=\"#srrptr\">srrptr</a>+4;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#net_ratelimit\">net_ratelimit</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_CRIT\">KERN_CRIT</a> \"ip_forward(): Argh! Destination lost!\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts_needaddr\">ts_needaddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#raw\">raw</a> + <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#ts\">ts</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_get_source\">ip_rt_get_source</a>(&amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#optptr\">optptr</a>[2]-9], <a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_send_check\">ip_send_check</a>(<a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_options_rcv_srr\">ip_options_rcv_srr</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_options\">ip_options</a> *<a class=\"id\" href=\"#opt\">opt</a> = &amp;(<a class=\"id\" href=\"#IPCB\">IPCB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#opt\">opt</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#srrspace\">srrspace</a>, <a class=\"id\" href=\"#srrptr\">srrptr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#nexthop\">nexthop</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph\">iph</a> = <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#optptr\">optptr</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>) + <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt2\">rt2</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#orefdst\">orefdst</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a> != <a class=\"id\" href=\"#PACKET_HOST\">PACKET_HOST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a> == <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_strictroute\">is_strictroute</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#icmp_send\">icmp_send</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ICMP_PARAMETERPROB\">ICMP_PARAMETERPROB</a>, 0, <a class=\"id\" href=\"#htonl\">htonl</a>(16<<24));", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a> != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#srrptr\">srrptr</a>=<a class=\"id\" href=\"#optptr\">optptr</a>[2], <a class=\"id\" href=\"#srrspace\">srrspace</a> = <a class=\"id\" href=\"#optptr\">optptr</a>[1]; <a class=\"id\" href=\"#srrptr\">srrptr</a> <= <a class=\"id\" href=\"#srrspace\">srrspace</a>; <a class=\"id\" href=\"#srrptr\">srrptr</a> += 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#srrptr\">srrptr</a> + 3 &gt; <a class=\"id\" href=\"#srrspace\">srrspace</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#icmp_send\">icmp_send</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ICMP_PARAMETERPROB\">ICMP_PARAMETERPROB</a>, 0, <a class=\"id\" href=\"#htonl\">htonl</a>((<a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>+2)<<24));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#nexthop\">nexthop</a>, &amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#srrptr\">srrptr</a>-1], 4);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#orefdst\">orefdst</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#_skb_refdst\">_skb_refdst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_set\">skb_dst_set</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ip_route_input\">ip_route_input</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nexthop\">nexthop</a>, <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#tos\">tos</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt2\">rt2</a> = <a class=\"id\" href=\"#skb_rtable\">skb_rtable</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> || (<a class=\"id\" href=\"#rt2\">rt2</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a> != <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a> && <a class=\"id\" href=\"#rt2\">rt2</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a> != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_drop\">skb_dst_drop</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#_skb_refdst\">_skb_refdst</a> = <a class=\"id\" href=\"#orefdst\">orefdst</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#refdst_drop\">refdst_drop</a>(<a class=\"id\" href=\"#orefdst\">orefdst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt2\">rt2</a>-><a class=\"id\" href=\"#rt_type\">rt_type</a> != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Superfast 8) loopback forward */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#optptr\">optptr</a>[<a class=\"id\" href=\"#srrptr\">srrptr</a>-1], 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#srrptr\">srrptr</a> <= <a class=\"id\" href=\"#srrspace\">srrspace</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr_is_hit\">srr_is_hit</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#is_changed\">is_changed</a> = 1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
];
xr_frag_insert('l/3d/65bb21bc16ec6096bdc44dc6ce36eb2650aa53.xr', __xr_tmp);
