var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *  (c) 2005, 2006 Advanced Micro Devices, Inc.</span>", 
"<span class=\"comment\"> *  Your use of this code is subject to the terms and conditions of the</span>", 
"<span class=\"comment\"> *  GNU general public license version 2. See \"COPYING\" or</span>", 
"<span class=\"comment\"> *  http://www.gnu.org/licenses/gpl.html</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  Written by Jacob Shin - AMD, Inc.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  Support : jacob.shin@amd.com</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  April 2006</span>", 
"<span class=\"comment\"> *     - added support for AMD Family 0x10 processors</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  All MC4_MISCi registers are shared between multi-cores</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#interrupt\">interrupt</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#notifier\">notifier</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kobject\">kobject</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#percpu\">percpu</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sysdev\">sysdev</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sched\">sched</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sysfs\">sysfs</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#cpu\">cpu</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#smp\">smp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#apic\">apic</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#idle\">idle</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#mce\">mce</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#msr\">msr</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PFX\">PFX</a>               \"mce_threshold: \"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#VERSION\">VERSION</a>           \"version 1.1.1\"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>          6", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#NR_BLOCKS\">NR_BLOCKS</a>         9", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>     0xFFF", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#INT_TYPE_APIC\">INT_TYPE_APIC</a>     0x00020000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_VALID_HI\">MASK_VALID_HI</a>     0x80000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_CNTP_HI\">MASK_CNTP_HI</a>      0x40000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_LOCKED_HI\">MASK_LOCKED_HI</a>    0x20000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_LVTOFF_HI\">MASK_LVTOFF_HI</a>    0x00F00000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_COUNT_EN_HI\">MASK_COUNT_EN_HI</a>  0x00080000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_INT_TYPE_HI\">MASK_INT_TYPE_HI</a>  0x00060000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_OVERFLOW_HI\">MASK_OVERFLOW_HI</a>  0x00010000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_ERR_COUNT_HI\">MASK_ERR_COUNT_HI</a> 0x00000FFF", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MASK_BLKPTR_LO\">MASK_BLKPTR_LO</a>    0xFF000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MCG_XBLK_ADDR\">MCG_XBLK_ADDR</a>     0xC0000400", 
"", 
"struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> {", 
"<span class=\"ts\"/>unsigned int<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#block\">block</a>;", 
"<span class=\"ts\"/>unsigned int<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bank\">bank</a>;", 
"<span class=\"ts\"/>unsigned int<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cpu\">cpu</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#kobject\">kobject</a><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kobj\">kobj</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a><span class=\"ts\"/><a class=\"id\" href=\"#miscj\">miscj</a>;", 
"};", 
"", 
"<span class=\"comment\">/* defaults used early on boot */</span>", 
"static struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> <a class=\"id\" href=\"#threshold_defaults\">threshold_defaults</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a><span class=\"ts\"/>= 0,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#threshold_limit\">threshold_limit</a><span class=\"ts\"/>= <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>,", 
"};", 
"", 
"struct <a class=\"id\" href=\"#threshold_bank\">threshold_bank</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#kobject\">kobject</a><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#kobj\">kobj</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a><span class=\"ts\"/>*<a class=\"id\" href=\"#blocks\">blocks</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cpumask_var_t\">cpumask_var_t</a><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cpus\">cpus</a>;", 
"};", 
"static <a class=\"id\" href=\"#DEFINE_PER_CPU\">DEFINE_PER_CPU</a>(struct <a class=\"id\" href=\"#threshold_bank\">threshold_bank</a> * [<a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>], <a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"static unsigned char <a class=\"id\" href=\"#shared_bank\">shared_bank</a>[<a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>] = {", 
"<span class=\"ts\"/>0, 0, 0, 0, 1", 
"};", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static <a class=\"id\" href=\"#DEFINE_PER_CPU\">DEFINE_PER_CPU</a>(unsigned char, <a class=\"id\" href=\"#bank_map\">bank_map</a>);<span class=\"ts\"/><span class=\"comment\">/* see which banks are on */</span>", 
"", 
"static void <a class=\"id\" href=\"#amd_threshold_interrupt\">amd_threshold_interrupt</a>(void);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * CPU Initialization</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"struct <a class=\"id\" href=\"#thresh_restart\">thresh_restart</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a><span class=\"ts\"/>*<a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reset\">reset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_limit\">old_limit</a>;", 
"};", 
"", 
"<span class=\"comment\">/* must be called with correct cpu affinity */</span>", 
"<span class=\"comment\">/* Called via smp_call_function_single() */</span>", 
"static void <a class=\"id\" href=\"#threshold_restart_bank\">threshold_restart_bank</a>(void *<a class=\"id\" href=\"#_tr\">_tr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#thresh_restart\">thresh_restart</a> *<a class=\"id\" href=\"#tr\">tr</a> = <a class=\"id\" href=\"#_tr\">_tr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a>, <a class=\"id\" href=\"#mci_misc_lo\">mci_misc_lo</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdmsr\">rdmsr</a>(<a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#mci_misc_lo\">mci_misc_lo</a>, <a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a> &lt; (<a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> &amp; <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#reset\">reset</a> = 1;<span class=\"ts\"/><span class=\"comment\">/* limit cannot be lower than err count */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#reset\">reset</a>) {<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* reset err count and overflow bit */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> &amp; ~(<a class=\"id\" href=\"#MASK_ERR_COUNT_HI\">MASK_ERR_COUNT_HI</a> | <a class=\"id\" href=\"#MASK_OVERFLOW_HI\">MASK_OVERFLOW_HI</a>)) |", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a> - <a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#old_limit\">old_limit</a>) {<span class=\"ts\"/><span class=\"comment\">/* change limit w/o reset */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#new_count\">new_count</a> = (<a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> &amp; <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>) +", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#old_limit\">old_limit</a> - <a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> = (<a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> &amp; ~<a class=\"id\" href=\"#MASK_ERR_COUNT_HI\">MASK_ERR_COUNT_HI</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#new_count\">new_count</a> &amp; <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a> ?", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> = (<a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> &amp; ~<a class=\"id\" href=\"#MASK_INT_TYPE_HI\">MASK_INT_TYPE_HI</a>) | <a class=\"id\" href=\"#INT_TYPE_APIC\">INT_TYPE_APIC</a>) :", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> &= ~<a class=\"id\" href=\"#MASK_INT_TYPE_HI\">MASK_INT_TYPE_HI</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a> |= <a class=\"id\" href=\"#MASK_COUNT_EN_HI\">MASK_COUNT_EN_HI</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wrmsr\">wrmsr</a>(<a class=\"id\" href=\"#tr\">tr</a>-><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#mci_misc_lo\">mci_misc_lo</a>, <a class=\"id\" href=\"#mci_misc_hi\">mci_misc_hi</a>);", 
"}", 
"", 
"<span class=\"comment\">/* cpu init entry point, called from mce.c with preempt off */</span>", 
"void <a class=\"id\" href=\"#mce_amd_feature_init\">mce_amd_feature_init</a>(struct <a class=\"id\" href=\"#cpuinfo_x86\">cpuinfo_x86</a> *<a class=\"id\" href=\"#c\">c</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#cpu\">cpu</a> = <a class=\"id\" href=\"#smp_processor_id\">smp_processor_id</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#low\">low</a> = 0, <a class=\"id\" href=\"#high\">high</a> = 0, <a class=\"id\" href=\"#address\">address</a> = 0;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#bank\">bank</a>, <a class=\"id\" href=\"#block\">block</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#thresh_restart\">thresh_restart</a> <a class=\"id\" href=\"#tr\">tr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#lvt_off\">lvt_off</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#bank\">bank</a> = 0; <a class=\"id\" href=\"#bank\">bank</a> &lt; <a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>; ++<a class=\"id\" href=\"#bank\">bank</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#block\">block</a> = 0; <a class=\"id\" href=\"#block\">block</a> &lt; <a class=\"id\" href=\"#NR_BLOCKS\">NR_BLOCKS</a>; ++<a class=\"id\" href=\"#block\">block</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#block\">block</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = <a class=\"id\" href=\"#MSR_IA32_MC0_MISC\">MSR_IA32_MC0_MISC</a> + <a class=\"id\" href=\"#bank\">bank</a> * 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#block\">block</a> == 1) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = (<a class=\"id\" href=\"#low\">low</a> &amp; <a class=\"id\" href=\"#MASK_BLKPTR_LO\">MASK_BLKPTR_LO</a>) >> 21;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#address\">address</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> += <a class=\"id\" href=\"#MCG_XBLK_ADDR\">MCG_XBLK_ADDR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#address\">address</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rdmsr_safe\">rdmsr_safe</a>(<a class=\"id\" href=\"#address\">address</a>, &amp;<a class=\"id\" href=\"#low\">low</a>, &amp;<a class=\"id\" href=\"#high\">high</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_VALID_HI\">MASK_VALID_HI</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_CNTP_HI\">MASK_CNTP_HI</a>)  ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     (<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_LOCKED_HI\">MASK_LOCKED_HI</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#block\">block</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#bank_map\">bank_map</a>, <a class=\"id\" href=\"#cpu\">cpu</a>) |= (1 << <a class=\"id\" href=\"#bank\">bank</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#shared_bank\">shared_bank</a>[<a class=\"id\" href=\"#bank\">bank</a>] && <a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#cpu_core_id\">cpu_core_id</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#lvt_off\">lvt_off</a> = <a class=\"id\" href=\"#setup_APIC_eilvt_mce\">setup_APIC_eilvt_mce</a>(<a class=\"id\" href=\"#THRESHOLD_APIC_VECTOR\">THRESHOLD_APIC_VECTOR</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#APIC_EILVT_MSG_FIX\">APIC_EILVT_MSG_FIX</a>, 0);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#high\">high</a> &= ~<a class=\"id\" href=\"#MASK_LVTOFF_HI\">MASK_LVTOFF_HI</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#high\">high</a> |= <a class=\"id\" href=\"#lvt_off\">lvt_off</a> << 20;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wrmsr\">wrmsr</a>(<a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#low\">low</a>, <a class=\"id\" href=\"#high\">high</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#threshold_defaults\">threshold_defaults</a>.<a class=\"id\" href=\"#address\">address</a> = <a class=\"id\" href=\"#address\">address</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#b\">b</a> = &amp;<a class=\"id\" href=\"#threshold_defaults\">threshold_defaults</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#reset\">reset</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#old_limit\">old_limit</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#threshold_restart_bank\">threshold_restart_bank</a>(&amp;<a class=\"id\" href=\"#tr\">tr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mce_threshold_vector\">mce_threshold_vector</a> = <a class=\"id\" href=\"#amd_threshold_interrupt\">amd_threshold_interrupt</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * APIC Interrupt Handler</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * threshold interrupt handler will service THRESHOLD_APIC_VECTOR.</span>", 
"<span class=\"comment\"> * the interrupt goes off when error_count reaches threshold_limit.</span>", 
"<span class=\"comment\"> * the handler will simply log mcelog w/ software defined bank number.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#amd_threshold_interrupt\">amd_threshold_interrupt</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#low\">low</a> = 0, <a class=\"id\" href=\"#high\">high</a> = 0, <a class=\"id\" href=\"#address\">address</a> = 0;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#bank\">bank</a>, <a class=\"id\" href=\"#block\">block</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mce\">mce</a> <a class=\"id\" href=\"#m\">m</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mce_setup\">mce_setup</a>(&amp;<a class=\"id\" href=\"#m\">m</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* assume first bank caused it */</span>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#bank\">bank</a> = 0; <a class=\"id\" href=\"#bank\">bank</a> &lt; <a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>; ++<a class=\"id\" href=\"#bank\">bank</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#bank_map\">bank_map</a>, <a class=\"id\" href=\"#m\">m</a>.<a class=\"id\" href=\"#cpu\">cpu</a>) &amp; (1 << <a class=\"id\" href=\"#bank\">bank</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#block\">block</a> = 0; <a class=\"id\" href=\"#block\">block</a> &lt; <a class=\"id\" href=\"#NR_BLOCKS\">NR_BLOCKS</a>; ++<a class=\"id\" href=\"#block\">block</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#block\">block</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = <a class=\"id\" href=\"#MSR_IA32_MC0_MISC\">MSR_IA32_MC0_MISC</a> + <a class=\"id\" href=\"#bank\">bank</a> * 4;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#block\">block</a> == 1) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = (<a class=\"id\" href=\"#low\">low</a> &amp; <a class=\"id\" href=\"#MASK_BLKPTR_LO\">MASK_BLKPTR_LO</a>) >> 21;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#address\">address</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> += <a class=\"id\" href=\"#MCG_XBLK_ADDR\">MCG_XBLK_ADDR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#address\">address</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rdmsr_safe\">rdmsr_safe</a>(<a class=\"id\" href=\"#address\">address</a>, &amp;<a class=\"id\" href=\"#low\">low</a>, &amp;<a class=\"id\" href=\"#high\">high</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_VALID_HI\">MASK_VALID_HI</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#block\">block</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_CNTP_HI\">MASK_CNTP_HI</a>)  ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     (<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_LOCKED_HI\">MASK_LOCKED_HI</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Log the machine check that caused the threshold</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * event.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#machine_check_poll\">machine_check_poll</a>(<a class=\"id\" href=\"#MCP_TIMESTAMP\">MCP_TIMESTAMP</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#__get_cpu_var\">__get_cpu_var</a>(<a class=\"id\" href=\"#mce_poll_banks\">mce_poll_banks</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_OVERFLOW_HI\">MASK_OVERFLOW_HI</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rdmsrl\">rdmsrl</a>(<a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#m\">m</a>.<a class=\"id\" href=\"#misc\">misc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rdmsrl\">rdmsrl</a>(<a class=\"id\" href=\"#MSR_IA32_MC0_STATUS\">MSR_IA32_MC0_STATUS</a> + <a class=\"id\" href=\"#bank\">bank</a> * 4,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#m\">m</a>.<a class=\"id\" href=\"#status\">status</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#m\">m</a>.<a class=\"id\" href=\"#bank\">bank</a> = <a class=\"id\" href=\"#K8_MCE_THRESHOLD_BASE\">K8_MCE_THRESHOLD_BASE</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       + <a class=\"id\" href=\"#bank\">bank</a> * <a class=\"id\" href=\"#NR_BLOCKS\">NR_BLOCKS</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       + <a class=\"id\" href=\"#block\">block</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mce_log\">mce_log</a>(&amp;<a class=\"id\" href=\"#m\">m</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Sysfs Interface</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"struct <a class=\"id\" href=\"#threshold_attr\">threshold_attr</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#attribute\">attribute</a> <a class=\"id\" href=\"#attr\">attr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ssize_t\">ssize_t</a> (*<a class=\"id\" href=\"#show\">show</a>) (struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *, char *);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ssize_t\">ssize_t</a> (*<a class=\"id\" href=\"#store\">store</a>) (struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *, const char *, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#count\">count</a>);", 
"};", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#SHOW_FIELDS\">SHOW_FIELDS</a>(<a class=\"id\" href=\"#name\">name</a>)<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\\", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#show_\">show_</a> ## <a class=\"id\" href=\"#name\">name</a>(struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a>, char *<a class=\"id\" href=\"#buf\">buf</a>)<span class=\"ts\"/>\\", 
"{<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\\", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#buf\">buf</a>, \"%lx\\n\", (unsigned long) <a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#name\">name</a>);<span class=\"ts\"/><span class=\"ts\"/>\\", 
"}", 
"<a class=\"id\" href=\"#SHOW_FIELDS\">SHOW_FIELDS</a>(<a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a>)", 
"<a class=\"id\" href=\"#SHOW_FIELDS\">SHOW_FIELDS</a>(<a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>)", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a>", 
"<a class=\"id\" href=\"#store_interrupt_enable\">store_interrupt_enable</a>(struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a>, const char *<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#thresh_restart\">thresh_restart</a> <a class=\"id\" href=\"#tr\">tr</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#new\">new</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strict_strtoul\">strict_strtoul</a>(<a class=\"id\" href=\"#buf\">buf</a>, 0, &amp;<a class=\"id\" href=\"#new\">new</a>) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a> = !!<a class=\"id\" href=\"#new\">new</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#b\">b</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#reset\">reset</a><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#old_limit\">old_limit</a><span class=\"ts\"/>= 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#smp_call_function_single\">smp_call_function_single</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#threshold_restart_bank\">threshold_restart_bank</a>, &amp;<a class=\"id\" href=\"#tr\">tr</a>, 1);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#size\">size</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a>", 
"<a class=\"id\" href=\"#store_threshold_limit\">store_threshold_limit</a>(struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a>, const char *<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#thresh_restart\">thresh_restart</a> <a class=\"id\" href=\"#tr\">tr</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#new\">new</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strict_strtoul\">strict_strtoul</a>(<a class=\"id\" href=\"#buf\">buf</a>, 0, &amp;<a class=\"id\" href=\"#new\">new</a>) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new\">new</a> &gt; <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a> = <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new\">new</a> &lt; 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a> = 1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#old_limit\">old_limit</a> = <a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a> = <a class=\"id\" href=\"#new\">new</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tr\">tr</a>.<a class=\"id\" href=\"#reset\">reset</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#smp_call_function_single\">smp_call_function_single</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#threshold_restart_bank\">threshold_restart_bank</a>, &amp;<a class=\"id\" href=\"#tr\">tr</a>, 1);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#size\">size</a>;", 
"}", 
"", 
"struct <a class=\"id\" href=\"#threshold_block_cross_cpu\">threshold_block_cross_cpu</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a><span class=\"ts\"/>*<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>long<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a>;", 
"};", 
"", 
"static void <a class=\"id\" href=\"#local_error_count_handler\">local_error_count_handler</a>(void *<a class=\"id\" href=\"#_tbcc\">_tbcc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block_cross_cpu\">threshold_block_cross_cpu</a> *<a class=\"id\" href=\"#tbcc\">tbcc</a> = <a class=\"id\" href=\"#_tbcc\">_tbcc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#tbcc\">tbcc</a>-><a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#low\">low</a>, <a class=\"id\" href=\"#high\">high</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdmsr\">rdmsr</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#low\">low</a>, <a class=\"id\" href=\"#high\">high</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbcc\">tbcc</a>-><a class=\"id\" href=\"#retval\">retval</a> = (<a class=\"id\" href=\"#high\">high</a> &amp; 0xFFF) - (<a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a> - <a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#show_error_count\">show_error_count</a>(struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a>, char *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block_cross_cpu\">threshold_block_cross_cpu</a> <a class=\"id\" href=\"#tbcc\">tbcc</a> = { .<a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#b\">b</a>, };", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#smp_call_function_single\">smp_call_function_single</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#local_error_count_handler\">local_error_count_handler</a>, &amp;<a class=\"id\" href=\"#tbcc\">tbcc</a>, 1);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#buf\">buf</a>, \"%lx\\n\", <a class=\"id\" href=\"#tbcc\">tbcc</a>.<a class=\"id\" href=\"#retval\">retval</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#store_error_count\">store_error_count</a>(struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const char *<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#count\">count</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#thresh_restart\">thresh_restart</a> <a class=\"id\" href=\"#tr\">tr</a> = { .<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#b\">b</a>, .<a class=\"id\" href=\"#reset\">reset</a> = 1, .<a class=\"id\" href=\"#old_limit\">old_limit</a> = 0 };", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#smp_call_function_single\">smp_call_function_single</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#threshold_restart_bank\">threshold_restart_bank</a>, &amp;<a class=\"id\" href=\"#tr\">tr</a>, 1);", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#RW_ATTR\">RW_ATTR</a>(<a class=\"id\" href=\"#val\">val</a>)<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\\", 
"static struct <a class=\"id\" href=\"#threshold_attr\">threshold_attr</a> <a class=\"id\" href=\"#val\">val</a> = {<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\\", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#attr\">attr</a><span class=\"ts\"/>= {.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#__stringify\">__stringify</a>(<a class=\"id\" href=\"#val\">val</a>), .<a class=\"id\" href=\"#mode\">mode</a> = 0644 },<span class=\"ts\"/><span class=\"ts\"/>\\", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#show\">show</a><span class=\"ts\"/>= <a class=\"id\" href=\"#show_\">show_</a>## <a class=\"id\" href=\"#val\">val</a>,<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\\", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#store\">store</a><span class=\"ts\"/>= <a class=\"id\" href=\"#store_\">store_</a>## <a class=\"id\" href=\"#val\">val</a>,<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\\", 
"};", 
"", 
"<a class=\"id\" href=\"#RW_ATTR\">RW_ATTR</a>(<a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a>);", 
"<a class=\"id\" href=\"#RW_ATTR\">RW_ATTR</a>(<a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>);", 
"<a class=\"id\" href=\"#RW_ATTR\">RW_ATTR</a>(<a class=\"id\" href=\"#error_count\">error_count</a>);", 
"", 
"static struct <a class=\"id\" href=\"#attribute\">attribute</a> *<a class=\"id\" href=\"#default_attrs\">default_attrs</a>[] = {", 
"<span class=\"ts\"/>&amp;<a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a>.<a class=\"id\" href=\"#attr\">attr</a>,", 
"<span class=\"ts\"/>&amp;<a class=\"id\" href=\"#threshold_limit\">threshold_limit</a>.<a class=\"id\" href=\"#attr\">attr</a>,", 
"<span class=\"ts\"/>&amp;<a class=\"id\" href=\"#error_count\">error_count</a>.<a class=\"id\" href=\"#attr\">attr</a>,", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NULL\">NULL</a>", 
"};", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#to_block\">to_block</a>(<a class=\"id\" href=\"#k\">k</a>)<span class=\"ts\"/><a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#k\">k</a>, struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a>, <a class=\"id\" href=\"#kobj\">kobj</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#to_attr\">to_attr</a>(<a class=\"id\" href=\"#a\">a</a>)<span class=\"ts\"/><a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#a\">a</a>, struct <a class=\"id\" href=\"#threshold_attr\">threshold_attr</a>, <a class=\"id\" href=\"#attr\">attr</a>)", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#show\">show</a>(struct <a class=\"id\" href=\"#kobject\">kobject</a> *<a class=\"id\" href=\"#kobj\">kobj</a>, struct <a class=\"id\" href=\"#attribute\">attribute</a> *<a class=\"id\" href=\"#attr\">attr</a>, char *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#to_block\">to_block</a>(<a class=\"id\" href=\"#kobj\">kobj</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_attr\">threshold_attr</a> *<a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#to_attr\">to_attr</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#show\">show</a> ? <a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#show\">show</a>(<a class=\"id\" href=\"#b\">b</a>, <a class=\"id\" href=\"#buf\">buf</a>) : -<a class=\"id\" href=\"#EIO\">EIO</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#store\">store</a>(struct <a class=\"id\" href=\"#kobject\">kobject</a> *<a class=\"id\" href=\"#kobj\">kobj</a>, struct <a class=\"id\" href=\"#attribute\">attribute</a> *<a class=\"id\" href=\"#attr\">attr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>     const char *<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#count\">count</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#to_block\">to_block</a>(<a class=\"id\" href=\"#kobj\">kobj</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_attr\">threshold_attr</a> *<a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#to_attr\">to_attr</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#store\">store</a> ? <a class=\"id\" href=\"#a\">a</a>-><a class=\"id\" href=\"#store\">store</a>(<a class=\"id\" href=\"#b\">b</a>, <a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#count\">count</a>) : -<a class=\"id\" href=\"#EIO\">EIO</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#sysfs_ops\">sysfs_ops</a> <a class=\"id\" href=\"#threshold_ops\">threshold_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#show\">show</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#show\">show</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#store\">store</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#store\">store</a>,", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#kobj_type\">kobj_type</a> <a class=\"id\" href=\"#threshold_ktype\">threshold_ktype</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#sysfs_ops\">sysfs_ops</a><span class=\"ts\"/><span class=\"ts\"/>= &amp;<a class=\"id\" href=\"#threshold_ops\">threshold_ops</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#default_attrs\">default_attrs</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#default_attrs\">default_attrs</a>,", 
"};", 
"", 
"static <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> int <a class=\"id\" href=\"#allocate_threshold_blocks\">allocate_threshold_blocks</a>(unsigned int <a class=\"id\" href=\"#cpu\">cpu</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       unsigned int <a class=\"id\" href=\"#bank\">bank</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       unsigned int <a class=\"id\" href=\"#block\">block</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#address\">address</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#low\">low</a>, <a class=\"id\" href=\"#high\">high</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#bank\">bank</a> >= <a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>) || (<a class=\"id\" href=\"#block\">block</a> >= <a class=\"id\" href=\"#NR_BLOCKS\">NR_BLOCKS</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rdmsr_safe_on_cpu\">rdmsr_safe_on_cpu</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#address\">address</a>, &amp;<a class=\"id\" href=\"#low\">low</a>, &amp;<a class=\"id\" href=\"#high\">high</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_VALID_HI\">MASK_VALID_HI</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#block\">block</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#recurse\">recurse</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_CNTP_HI\">MASK_CNTP_HI</a>)  ||", 
"<span class=\"ts\"/>     (<a class=\"id\" href=\"#high\">high</a> &amp; <a class=\"id\" href=\"#MASK_LOCKED_HI\">MASK_LOCKED_HI</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#recurse\">recurse</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#b\">b</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#block\">block</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#block\">block</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#bank\">bank</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#bank\">bank</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpu\">cpu</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#cpu\">cpu</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#address\">address</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#address\">address</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#interrupt_enable\">interrupt_enable</a><span class=\"ts\"/>= 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#threshold_limit\">threshold_limit</a><span class=\"ts\"/>= <a class=\"id\" href=\"#THRESHOLD_MAX\">THRESHOLD_MAX</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#miscj\">miscj</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>]-><a class=\"id\" href=\"#blocks\">blocks</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#miscj\">miscj</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>]-><a class=\"id\" href=\"#blocks\">blocks</a>-><a class=\"id\" href=\"#miscj\">miscj</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>]-><a class=\"id\" href=\"#blocks\">blocks</a> = <a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#kobject_init_and_add\">kobject_init_and_add</a>(&amp;<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>, &amp;<a class=\"id\" href=\"#threshold_ktype\">threshold_ktype</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>]-><a class=\"id\" href=\"#kobj\">kobj</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"misc%i\", <a class=\"id\" href=\"#block\">block</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"<a class=\"id\" href=\"#recurse\">recurse</a>:", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#block\">block</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = (<a class=\"id\" href=\"#low\">low</a> &amp; <a class=\"id\" href=\"#MASK_BLKPTR_LO\">MASK_BLKPTR_LO</a>) >> 21;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#address\">address</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> += <a class=\"id\" href=\"#MCG_XBLK_ADDR\">MCG_XBLK_ADDR</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>++<a class=\"id\" href=\"#address\">address</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#allocate_threshold_blocks\">allocate_threshold_blocks</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#bank\">bank</a>, ++<a class=\"id\" href=\"#block\">block</a>, <a class=\"id\" href=\"#address\">address</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#b\">b</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kobject_uevent\">kobject_uevent</a>(&amp;<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>, <a class=\"id\" href=\"#KOBJ_ADD\">KOBJ_ADD</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<a class=\"id\" href=\"#out_free\">out_free</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#b\">b</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kobject_put\">kobject_put</a>(&amp;<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#b\">b</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> long", 
"<a class=\"id\" href=\"#local_allocate_threshold_blocks\">local_allocate_threshold_blocks</a>(int <a class=\"id\" href=\"#cpu\">cpu</a>, unsigned int <a class=\"id\" href=\"#bank\">bank</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#allocate_threshold_blocks\">allocate_threshold_blocks</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#bank\">bank</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#MSR_IA32_MC0_MISC\">MSR_IA32_MC0_MISC</a> + <a class=\"id\" href=\"#bank\">bank</a> * 4);", 
"}", 
"", 
"<span class=\"comment\">/* symlinks sibling shared banks to first core.  first core owns dir/files. */</span>", 
"static <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> int <a class=\"id\" href=\"#threshold_create_bank\">threshold_create_bank</a>(unsigned int <a class=\"id\" href=\"#cpu\">cpu</a>, unsigned int <a class=\"id\" href=\"#bank\">bank</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_bank\">threshold_bank</a> *<a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#name\">name</a>[32];", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cpuinfo_x86\">cpuinfo_x86</a> *<a class=\"id\" href=\"#c\">c</a> = &amp;<a class=\"id\" href=\"#cpu_data\">cpu_data</a>(<a class=\"id\" href=\"#cpu\">cpu</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#name\">name</a>, \"threshold_bank%i\", <a class=\"id\" href=\"#bank\">bank</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cpu_data\">cpu_data</a>(<a class=\"id\" href=\"#cpu\">cpu</a>).<a class=\"id\" href=\"#cpu_core_id\">cpu_core_id</a> && <a class=\"id\" href=\"#shared_bank\">shared_bank</a>[<a class=\"id\" href=\"#bank\">bank</a>]) {<span class=\"ts\"/><span class=\"comment\">/* symlink */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#cpumask_first\">cpumask_first</a>(<a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#llc_shared_map\">llc_shared_map</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* first core not up yet */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cpu_data\">cpu_data</a>(<a class=\"id\" href=\"#i\">i</a>).<a class=\"id\" href=\"#cpu_core_id\">cpu_core_id</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* already linked */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#i\">i</a>)[<a class=\"id\" href=\"#bank\">bank</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#b\">b</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#sysfs_create_link\">sysfs_create_link</a>(&amp;<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#mce_dev\">mce_dev</a>, <a class=\"id\" href=\"#cpu\">cpu</a>).<a class=\"id\" href=\"#kobj\">kobj</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>, <a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cpumask_copy\">cpumask_copy</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>, <a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#llc_shared_map\">llc_shared_map</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>] = <a class=\"id\" href=\"#b\">b</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#threshold_bank\">threshold_bank</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#b\">b</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#zalloc_cpumask_var\">zalloc_cpumask_var</a>(&amp;<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#b\">b</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a> = <a class=\"id\" href=\"#kobject_create_and_add\">kobject_create_and_add</a>(<a class=\"id\" href=\"#name\">name</a>, &amp;<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#mce_dev\">mce_dev</a>, <a class=\"id\" href=\"#cpu\">cpu</a>).<a class=\"id\" href=\"#kobj\">kobj</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cpumask_setall\">cpumask_setall</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>);", 
"#else", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cpumask_set_cpu\">cpumask_set_cpu</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>] = <a class=\"id\" href=\"#b\">b</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#local_allocate_threshold_blocks\">local_allocate_threshold_blocks</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#bank\">bank</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#for_each_cpu\">for_each_cpu</a>(<a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> == <a class=\"id\" href=\"#cpu\">cpu</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#sysfs_create_link\">sysfs_create_link</a>(&amp;<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#mce_dev\">mce_dev</a>, <a class=\"id\" href=\"#i\">i</a>).<a class=\"id\" href=\"#kobj\">kobj</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>, <a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#i\">i</a>)[<a class=\"id\" href=\"#bank\">bank</a>] = <a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<a class=\"id\" href=\"#out_free\">out_free</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_cpumask_var\">free_cpumask_var</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#b\">b</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/* create dir/files for all valid threshold banks */</span>", 
"static <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> int <a class=\"id\" href=\"#threshold_create_device\">threshold_create_device</a>(unsigned int <a class=\"id\" href=\"#cpu\">cpu</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#bank\">bank</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#bank\">bank</a> = 0; <a class=\"id\" href=\"#bank\">bank</a> &lt; <a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>; ++<a class=\"id\" href=\"#bank\">bank</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#bank_map\">bank_map</a>, <a class=\"id\" href=\"#cpu\">cpu</a>) &amp; (1 << <a class=\"id\" href=\"#bank\">bank</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#threshold_create_bank\">threshold_create_bank</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#bank\">bank</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * let's be hotplug friendly.</span>", 
"<span class=\"comment\"> * in case of multiple core processors, the first core always takes ownership</span>", 
"<span class=\"comment\"> *   of shared sysfs dir/files, and rest of the cores will be symlinked to it.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#deallocate_threshold_block\">deallocate_threshold_block</a>(unsigned int <a class=\"id\" href=\"#cpu\">cpu</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> unsigned int <a class=\"id\" href=\"#bank\">bank</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#pos\">pos</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_block\">threshold_block</a> *<a class=\"id\" href=\"#tmp\">tmp</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_bank\">threshold_bank</a> *<a class=\"id\" href=\"#head\">head</a> = <a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>];", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#head\">head</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_safe\">list_for_each_entry_safe</a>(<a class=\"id\" href=\"#pos\">pos</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, &amp;<a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#blocks\">blocks</a>-><a class=\"id\" href=\"#miscj\">miscj</a>, <a class=\"id\" href=\"#miscj\">miscj</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kobject_put\">kobject_put</a>(&amp;<a class=\"id\" href=\"#pos\">pos</a>-><a class=\"id\" href=\"#kobj\">kobj</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#pos\">pos</a>-><a class=\"id\" href=\"#miscj\">miscj</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#pos\">pos</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>]-><a class=\"id\" href=\"#blocks\">blocks</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>]-><a class=\"id\" href=\"#blocks\">blocks</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#threshold_remove_bank\">threshold_remove_bank</a>(unsigned int <a class=\"id\" href=\"#cpu\">cpu</a>, int <a class=\"id\" href=\"#bank\">bank</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#threshold_bank\">threshold_bank</a> *<a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#name\">name</a>[32];", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>];", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#b\">b</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#blocks\">blocks</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#free_out\">free_out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#name\">name</a>, \"threshold_bank%i\", <a class=\"id\" href=\"#bank\">bank</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"<span class=\"ts\"/><span class=\"comment\">/* sibling symlink */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#shared_bank\">shared_bank</a>[<a class=\"id\" href=\"#bank\">bank</a>] && <a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#blocks\">blocks</a>-><a class=\"id\" href=\"#cpu\">cpu</a> != <a class=\"id\" href=\"#cpu\">cpu</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sysfs_remove_link\">sysfs_remove_link</a>(&amp;<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#mce_dev\">mce_dev</a>, <a class=\"id\" href=\"#cpu\">cpu</a>).<a class=\"id\" href=\"#kobj\">kobj</a>, <a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* remove all sibling symlinks before unregistering */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#for_each_cpu\">for_each_cpu</a>(<a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> == <a class=\"id\" href=\"#cpu\">cpu</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sysfs_remove_link\">sysfs_remove_link</a>(&amp;<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#mce_dev\">mce_dev</a>, <a class=\"id\" href=\"#i\">i</a>).<a class=\"id\" href=\"#kobj\">kobj</a>, <a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#i\">i</a>)[<a class=\"id\" href=\"#bank\">bank</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#deallocate_threshold_block\">deallocate_threshold_block</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#bank\">bank</a>);", 
"", 
"<a class=\"id\" href=\"#free_out\">free_out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kobject_del\">kobject_del</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kobject_put\">kobject_put</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#kobj\">kobj</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_cpumask_var\">free_cpumask_var</a>(<a class=\"id\" href=\"#b\">b</a>-><a class=\"id\" href=\"#cpus\">cpus</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#b\">b</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#threshold_banks\">threshold_banks</a>, <a class=\"id\" href=\"#cpu\">cpu</a>)[<a class=\"id\" href=\"#bank\">bank</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#threshold_remove_device\">threshold_remove_device</a>(unsigned int <a class=\"id\" href=\"#cpu\">cpu</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#bank\">bank</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#bank\">bank</a> = 0; <a class=\"id\" href=\"#bank\">bank</a> &lt; <a class=\"id\" href=\"#NR_BANKS\">NR_BANKS</a>; ++<a class=\"id\" href=\"#bank\">bank</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#per_cpu\">per_cpu</a>(<a class=\"id\" href=\"#bank_map\">bank_map</a>, <a class=\"id\" href=\"#cpu\">cpu</a>) &amp; (1 << <a class=\"id\" href=\"#bank\">bank</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#threshold_remove_bank\">threshold_remove_bank</a>(<a class=\"id\" href=\"#cpu\">cpu</a>, <a class=\"id\" href=\"#bank\">bank</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/* get notified when a cpu comes on/off */</span>", 
"static void <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a>", 
"<a class=\"id\" href=\"#amd_64_threshold_cpu_callback\">amd_64_threshold_cpu_callback</a>(unsigned long <a class=\"id\" href=\"#action\">action</a>, unsigned int <a class=\"id\" href=\"#cpu\">cpu</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#action\">action</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CPU_ONLINE\">CPU_ONLINE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CPU_ONLINE_FROZEN\">CPU_ONLINE_FROZEN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#threshold_create_device\">threshold_create_device</a>(<a class=\"id\" href=\"#cpu\">cpu</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CPU_DEAD\">CPU_DEAD</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#CPU_DEAD_FROZEN\">CPU_DEAD_FROZEN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#threshold_remove_device\">threshold_remove_device</a>(<a class=\"id\" href=\"#cpu\">cpu</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static <a class=\"id\" href=\"#__init\">__init</a> int <a class=\"id\" href=\"#threshold_init_device\">threshold_init_device</a>(void)", 
"{", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#lcpu\">lcpu</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* to hit CPUs online before the notifier is up */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#for_each_online_cpu\">for_each_online_cpu</a>(<a class=\"id\" href=\"#lcpu\">lcpu</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#threshold_create_device\">threshold_create_device</a>(<a class=\"id\" href=\"#lcpu\">lcpu</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#threshold_cpu_callback\">threshold_cpu_callback</a> = <a class=\"id\" href=\"#amd_64_threshold_cpu_callback\">amd_64_threshold_cpu_callback</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#device_initcall\">device_initcall</a>(<a class=\"id\" href=\"#threshold_init_device\">threshold_init_device</a>);", 
];
xr_frag_insert('l/4c/684985050c6e5a9c496a80f785e37f607de2e0.xr', __xr_tmp);
