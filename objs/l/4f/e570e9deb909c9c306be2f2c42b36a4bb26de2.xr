var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * INET<span class=\"ts\"/><span class=\"ts\"/>An implementation of the TCP/IP protocol suite for the LINUX</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>operating system.  INET is implemented using the  BSD Socket</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>interface as the means of communication with the user level.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>IPv4 Forwarding Information Base: FIB frontend.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Authors:<span class=\"ts\"/>Alexey Kuznetsov, &lt;kuznet@ms2.inr.ac.ru&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>This program is free software; you can redistribute it and/or</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>modify it under the terms of the GNU General Public License</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>as published by the Free Software Foundation; either version</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>2 of the License, or (at your option) any later version.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#system\">system</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#bitops\">bitops</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#capability\">capability</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sockios\">sockios</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#in\">in</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inet\">inet</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inetdevice\">inetdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#if_addr\">if_addr</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#if_arp\">if_arp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#skbuff\">skbuff</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#protocol\">protocol</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#route\">route</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#tcp\">tcp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#sock\">sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#arp\">arp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip_fib\">ip_fib</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#rtnetlink\">rtnetlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"", 
"static int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#fib4_rules_init\">fib4_rules_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#local_table\">local_table</a>, *<a class=\"id\" href=\"#main_table\">main_table</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#local_table\">local_table</a> = <a class=\"id\" href=\"#fib_hash_table\">fib_hash_table</a>(<a class=\"id\" href=\"#RT_TABLE_LOCAL\">RT_TABLE_LOCAL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#local_table\">local_table</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#main_table\">main_table</a>  = <a class=\"id\" href=\"#fib_hash_table\">fib_hash_table</a>(<a class=\"id\" href=\"#RT_TABLE_MAIN\">RT_TABLE_MAIN</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#main_table\">main_table</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head_rcu\">hlist_add_head_rcu</a>(&amp;<a class=\"id\" href=\"#local_table\">local_table</a>-><a class=\"id\" href=\"#tb_hlist\">tb_hlist</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#TABLE_LOCAL_INDEX\">TABLE_LOCAL_INDEX</a>]);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head_rcu\">hlist_add_head_rcu</a>(&amp;<a class=\"id\" href=\"#main_table\">main_table</a>-><a class=\"id\" href=\"#tb_hlist\">tb_hlist</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#TABLE_MAIN_INDEX\">TABLE_MAIN_INDEX</a>]);", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#fail\">fail</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#local_table\">local_table</a>);", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"}", 
"#else", 
"", 
"struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#fib_new_table\">fib_new_table</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#id\">id</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#id\">id</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#RT_TABLE_MAIN\">RT_TABLE_MAIN</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#tb\">tb</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_hash_table\">fib_hash_table</a>(<a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tb\">tb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#id\">id</a> &amp; (<a class=\"id\" href=\"#FIB_TABLE_HASHSZ\">FIB_TABLE_HASHSZ</a> - 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head_rcu\">hlist_add_head_rcu</a>(&amp;<a class=\"id\" href=\"#tb\">tb</a>-><a class=\"id\" href=\"#tb_hlist\">tb_hlist</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#h\">h</a>]);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tb\">tb</a>;", 
"}", 
"", 
"struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#id\">id</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#head\">head</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#id\">id</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#RT_TABLE_MAIN\">RT_TABLE_MAIN</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#id\">id</a> &amp; (<a class=\"id\" href=\"#FIB_TABLE_HASHSZ\">FIB_TABLE_HASHSZ</a> - 1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a> = &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#h\">h</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry_rcu\">hlist_for_each_entry_rcu</a>(<a class=\"id\" href=\"#tb\">tb</a>, <a class=\"id\" href=\"#node\">node</a>, <a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#tb_hlist\">tb_hlist</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a>-><a class=\"id\" href=\"#tb_id\">tb_id</a> == <a class=\"id\" href=\"#id\">id</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_IP_MULTIPLE_TABLES */</span>", 
"", 
"void <a class=\"id\" href=\"#fib_select_default\">fib_select_default</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#flp\">flp</a>, struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#table\">table</a> = <a class=\"id\" href=\"#RT_TABLE_MAIN\">RT_TABLE_MAIN</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#r\">r</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#action\">action</a> != <a class=\"id\" href=\"#FR_ACT_TO_TBL\">FR_ACT_TO_TBL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#table\">table</a> = <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#table\">table</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#table\">table</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#FIB_RES_GW\">FIB_RES_GW</a>(*<a class=\"id\" href=\"#res\">res</a>) && <a class=\"id\" href=\"#FIB_RES_NH\">FIB_RES_NH</a>(*<a class=\"id\" href=\"#res\">res</a>).<a class=\"id\" href=\"#nh_scope\">nh_scope</a> == <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_table_select_default\">fib_table_select_default</a>(<a class=\"id\" href=\"#tb\">tb</a>, <a class=\"id\" href=\"#flp\">flp</a>, <a class=\"id\" href=\"#res\">res</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#fib_flush\">fib_flush</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#flushed\">flushed</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#head\">head</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#h\">h</a> = 0; <a class=\"id\" href=\"#h\">h</a> &lt; <a class=\"id\" href=\"#FIB_TABLE_HASHSZ\">FIB_TABLE_HASHSZ</a>; <a class=\"id\" href=\"#h\">h</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a> = &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#h\">h</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#tb\">tb</a>, <a class=\"id\" href=\"#node\">node</a>, <a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#tb_hlist\">tb_hlist</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flushed\">flushed</a> += <a class=\"id\" href=\"#fib_table_flush\">fib_table_flush</a>(<a class=\"id\" href=\"#tb\">tb</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flushed\">flushed</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush\">rt_cache_flush</a>(<a class=\"id\" href=\"#net\">net</a>, -1);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Find the first device with a given source address.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"struct <a class=\"id\" href=\"#net_device\">net_device</a> * <a class=\"id\" href=\"#ip_dev_find\">ip_dev_find</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> = { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#addr\">addr</a> } } };", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result\">fib_result</a> <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#local_table\">local_table</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#local_table\">local_table</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#RT_TABLE_LOCAL\">RT_TABLE_LOCAL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#local_table\">local_table</a> || <a class=\"id\" href=\"#fib_table_lookup\">fib_table_lookup</a>(<a class=\"id\" href=\"#local_table\">local_table</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#FIB_RES_DEV\">FIB_RES_DEV</a>(<a class=\"id\" href=\"#res\">res</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_hold\">dev_hold</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#dev\">dev</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ip_dev_find\">ip_dev_find</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Find address type as if only \"dev\" was present in the system. If</span>", 
"<span class=\"comment\"> * on_dev is NULL then all interfaces are taken into consideration.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned <a class=\"id\" href=\"#__inet_dev_addr_type\">__inet_dev_addr_type</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> = { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#addr\">addr</a> } } };", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result\">fib_result</a><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#local_table\">local_table</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#addr\">addr</a>) || <a class=\"id\" href=\"#ipv4_is_lbcast\">ipv4_is_lbcast</a>(<a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#RTN_MULTICAST\">RTN_MULTICAST</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#local_table\">local_table</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#RT_TABLE_LOCAL\">RT_TABLE_LOCAL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#local_table\">local_table</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fib_table_lookup\">fib_table_lookup</a>(<a class=\"id\" href=\"#local_table\">local_table</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a> || <a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a>-><a class=\"id\" href=\"#fib_dev\">fib_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"unsigned int <a class=\"id\" href=\"#inet_addr_type\">inet_addr_type</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__inet_dev_addr_type\">__inet_dev_addr_type</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#addr\">addr</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#inet_addr_type\">inet_addr_type</a>);", 
"", 
"unsigned int <a class=\"id\" href=\"#inet_dev_addr_type\">inet_dev_addr_type</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, const struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"       return <a class=\"id\" href=\"#__inet_dev_addr_type\">__inet_dev_addr_type</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#addr\">addr</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#inet_dev_addr_type\">inet_dev_addr_type</a>);", 
"", 
"<span class=\"comment\">/* Given (packet source, input interface) and optional (dst, oif, tos):</span>", 
"<span class=\"comment\">   - (main) check, that source is valid i.e. not broadcast or our local</span>", 
"<span class=\"comment\">     address.</span>", 
"<span class=\"comment\">   - figure out what \"logical\" interface this packet arrived</span>", 
"<span class=\"comment\">     and calculate \"specific destination\" address.</span>", 
"<span class=\"comment\">   - check, that packet arrived from expected physical interface.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#fib_validate_source\">fib_validate_source</a>(<a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tos\">tos</a>, int <a class=\"id\" href=\"#oif\">oif</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#spec_dst\">spec_dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#itag\">itag</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#src\">src</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#dst\">dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#tos\">tos</a> } },", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#mark\">mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#iif\">iif</a> = <a class=\"id\" href=\"#oif\">oif</a> };", 
"", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result\">fib_result</a> <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#no_addr\">no_addr</a>, <a class=\"id\" href=\"#rpf\">rpf</a>, <a class=\"id\" href=\"#accept_local\">accept_local</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#dev_match\">dev_match</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#no_addr\">no_addr</a> = <a class=\"id\" href=\"#rpf\">rpf</a> = <a class=\"id\" href=\"#accept_local\">accept_local</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rcu\">__in_dev_get_rcu</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in_dev\">in_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#no_addr\">no_addr</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#ifa_list\">ifa_list</a> == <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rpf\">rpf</a> = <a class=\"id\" href=\"#IN_DEV_RPFILTER\">IN_DEV_RPFILTER</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#accept_local\">accept_local</a> = <a class=\"id\" href=\"#IN_DEV_ACCEPT_LOCAL\">IN_DEV_ACCEPT_LOCAL</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mark\">mark</a> && !<a class=\"id\" href=\"#IN_DEV_SRC_VMARK\">IN_DEV_SRC_VMARK</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#mark\">mark</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in_dev\">in_dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_inval\">e_inval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fib_lookup\">fib_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#last_resort\">last_resort</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a> || !<a class=\"id\" href=\"#accept_local\">accept_local</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_inval_res\">e_inval_res</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#spec_dst\">spec_dst</a> = <a class=\"id\" href=\"#FIB_RES_PREFSRC\">FIB_RES_PREFSRC</a>(<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_combine_itag\">fib_combine_itag</a>(<a class=\"id\" href=\"#itag\">itag</a>, &amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_match\">dev_match</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_MULTIPATH\">CONFIG_IP_ROUTE_MULTIPATH</a>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#ret\">ret</a> = 0; <a class=\"id\" href=\"#ret\">ret</a> &lt; <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a>-><a class=\"id\" href=\"#fib_nhs\">fib_nhs</a>; <a class=\"id\" href=\"#ret\">ret</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_nh\">fib_nh</a> *<a class=\"id\" href=\"#nh\">nh</a> = &amp;<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#fi\">fi</a>-><a class=\"id\" href=\"#fib_nh\">fib_nh</a>[<a class=\"id\" href=\"#ret\">ret</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nh\">nh</a>-><a class=\"id\" href=\"#nh_dev\">nh_dev</a> == <a class=\"id\" href=\"#dev\">dev</a>) {", 
];
xr_frag_insert('l/4f/e570e9deb909c9c306be2f2c42b36a4bb26de2.xr', __xr_tmp);
