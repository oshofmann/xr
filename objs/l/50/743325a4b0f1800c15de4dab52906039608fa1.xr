var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *  linux/drivers/char/vt.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  Copyright (C) 1991, 1992  Linus Torvalds</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Hopefully this will be a rather complete VT102 implementation.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Beeping thanks to John T Kohl.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Virtual Consoles, Screen Blanking, Screen Dumping, Color, Graphics</span>", 
"<span class=\"comment\"> *   Chars, and VT100 enhancements by Peter MacDonald.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copy and paste function by Andrew Haylett,</span>", 
"<span class=\"comment\"> *   some enhancements by Alessandro Rubini.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Code to check for different video-cards mostly by Galen Hunt,</span>", 
"<span class=\"comment\"> * &lt;g-hunt@ee.utah.edu&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Rudimentary ISO 10646/Unicode/UTF-8 character set support by</span>", 
"<span class=\"comment\"> * Markus Kuhn, &lt;mskuhn@immd4.informatik.uni-erlangen.de&gt;.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Dynamic allocation of consoles, aeb@cwi.nl, May 1994</span>", 
"<span class=\"comment\"> * Resizing of consoles, aeb, 940926</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Code for xterm like mouse click reporting by Peter Orbaek 20-Jul-94</span>", 
"<span class=\"comment\"> * &lt;poe@daimi.aau.dk&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * User-defined bell sound, new setterm control sequences and printk</span>", 
"<span class=\"comment\"> * redirection by Martin Mares &lt;mj@k332.feld.cvut.cz&gt; 19-Nov-95</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * APM screenblank bug fixed Takashi Manabe &lt;manabe@roy.dsl.tutics.tut.jp&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Merge with the abstract console driver by Geert Uytterhoeven</span>", 
"<span class=\"comment\"> * &lt;geert@linux-m68k.org&gt;, Jan 1997.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *   Original m68k console driver modifications by</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *     - Arno Griffioen &lt;arno@usn.nl&gt;</span>", 
"<span class=\"comment\"> *     - David Carter &lt;carter@cs.bris.ac.uk&gt;</span>", 
"<span class=\"comment\"> * </span>", 
"<span class=\"comment\"> *   The abstract console driver provides a generic interface for a text</span>", 
"<span class=\"comment\"> *   console. It supports VGA text mode, frame buffer based graphical consoles</span>", 
"<span class=\"comment\"> *   and special graphics processors that are only accessible through some</span>", 
"<span class=\"comment\"> *   registers (e.g. a TMS340x0 GSP).</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *   The interface to the hardware is specified using a special structure</span>", 
"<span class=\"comment\"> *   (struct consw) which contains function pointers to console operations</span>", 
"<span class=\"comment\"> *   (see &lt;linux/console.h&gt; for more information).</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Support for changeable cursor shape</span>", 
"<span class=\"comment\"> * by Pavel Machek &lt;pavel@atrey.karlin.mff.cuni.cz&gt;, August 1997</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Ported to i386 and con_scrolldelta fixed</span>", 
"<span class=\"comment\"> * by Emmanuel Marty &lt;core@ggi-project.org&gt;, April 1998</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Resurrected character buffers in videoram plus lots of other trickery</span>", 
"<span class=\"comment\"> * by Martin Mares &lt;mj@atrey.karlin.mff.cuni.cz&gt;, July 1998</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Removed old-style timers, introduced console_timer, made timer</span>", 
"<span class=\"comment\"> * deletion SMP-safe.  17Jun00, Andrew Morton</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Removed console_lock, enabled interrupts across all console operations</span>", 
"<span class=\"comment\"> * 13 March 2001, Andrew Morton</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Fixed UTF-8 mode so alternate charset modes always work according</span>", 
"<span class=\"comment\"> * to control sequences interpreted in do_con_trol function</span>", 
"<span class=\"comment\"> * preserving backward VT100 semigraphics compatibility,</span>", 
"<span class=\"comment\"> * malformed UTF sequences represented as sequences of replacement glyphs,</span>", 
"<span class=\"comment\"> * original codes or '?' as a last resort if replacement glyph is undefined</span>", 
"<span class=\"comment\"> * by Adam Tla/lka &lt;atlka@pg.gda.pl&gt;, Aug 2006</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sched\">sched</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#tty\">tty</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#tty_flip\">tty_flip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kd\">kd</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#major\">major</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#console\">console</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mutex\">mutex</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#vt_kern\">vt_kern</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#selection\">selection</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#smp_lock\">smp_lock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#tiocl\">tiocl</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kbd_kern\">kbd_kern</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#consolemap\">consolemap</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#timer\">timer</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#interrupt\">interrupt</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#workqueue\">workqueue</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pm\">pm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#font\">font</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#bitops\">bitops</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#notifier\">notifier</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#device\">device</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#io\">io</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#system\">system</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kdb\">kdb</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ctype\">ctype</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MAX_NR_CON_DRIVER\">MAX_NR_CON_DRIVER</a> 16", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CON_DRIVER_FLAG_MODULE\">CON_DRIVER_FLAG_MODULE</a> 1", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CON_DRIVER_FLAG_INIT\">CON_DRIVER_FLAG_INIT</a>   2", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CON_DRIVER_FLAG_ATTR\">CON_DRIVER_FLAG_ATTR</a>   4", 
"", 
"struct <a class=\"id\" href=\"#con_driver\">con_driver</a> {", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#consw\">consw</a> *<a class=\"id\" href=\"#con\">con</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#desc\">desc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#first\">first</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#last\">last</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#flag\">flag</a>;", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#con_driver\">con_driver</a> <a class=\"id\" href=\"#registered_con_driver\">registered_con_driver</a>[<a class=\"id\" href=\"#MAX_NR_CON_DRIVER\">MAX_NR_CON_DRIVER</a>];", 
"const struct <a class=\"id\" href=\"#consw\">consw</a> *<a class=\"id\" href=\"#conswitchp\">conswitchp</a>;", 
"", 
"<span class=\"comment\">/* A bitmap for codes &lt;32. A bit of 1 indicates that the code</span>", 
"<span class=\"comment\"> * corresponding to that bit number invokes some special action</span>", 
"<span class=\"comment\"> * (such as cursor movement) and should not be displayed as a</span>", 
"<span class=\"comment\"> * glyph unless the disp_ctrl mode is explicitly enabled.</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CTRL_ACTION\">CTRL_ACTION</a> 0x0d00ff81", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CTRL_ALWAYS\">CTRL_ALWAYS</a> 0x0800f501<span class=\"ts\"/><span class=\"comment\">/* Cannot be overridden by disp_ctrl */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Here is the default bell parameters: 750HZ, 1/8th of a second</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEFAULT_BELL_PITCH\">DEFAULT_BELL_PITCH</a><span class=\"ts\"/>750", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEFAULT_BELL_DURATION\">DEFAULT_BELL_DURATION</a><span class=\"ts\"/>(<a class=\"id\" href=\"#HZ\">HZ</a>/8)", 
"", 
"struct <a class=\"id\" href=\"#vc\">vc</a> <a class=\"id\" href=\"#vc_cons\">vc_cons</a> [<a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>];", 
"", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#VT_SINGLE_DRIVER\">VT_SINGLE_DRIVER</a>", 
"static const struct <a class=\"id\" href=\"#consw\">consw</a> *<a class=\"id\" href=\"#con_driver_map\">con_driver_map</a>[<a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>];", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static int <a class=\"id\" href=\"#con_open\">con_open</a>(struct <a class=\"id\" href=\"#tty_struct\">tty_struct</a> *, struct <a class=\"id\" href=\"#file\">file</a> *);", 
"static void <a class=\"id\" href=\"#vc_init\">vc_init</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned int <a class=\"id\" href=\"#rows\">rows</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    unsigned int <a class=\"id\" href=\"#cols\">cols</a>, int <a class=\"id\" href=\"#do_clear\">do_clear</a>);", 
"static void <a class=\"id\" href=\"#gotoxy\">gotoxy</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#new_x\">new_x</a>, int <a class=\"id\" href=\"#new_y\">new_y</a>);", 
"static void <a class=\"id\" href=\"#save_cur\">save_cur</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>);", 
"static void <a class=\"id\" href=\"#reset_terminal\">reset_terminal</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#do_clear\">do_clear</a>);", 
"static void <a class=\"id\" href=\"#con_flush_chars\">con_flush_chars</a>(struct <a class=\"id\" href=\"#tty_struct\">tty_struct</a> *<a class=\"id\" href=\"#tty\">tty</a>);", 
"static int <a class=\"id\" href=\"#set_vesa_blanking\">set_vesa_blanking</a>(char <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#p\">p</a>);", 
"static void <a class=\"id\" href=\"#set_cursor\">set_cursor</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>);", 
"static void <a class=\"id\" href=\"#hide_cursor\">hide_cursor</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>);", 
"static void <a class=\"id\" href=\"#console_callback\">console_callback</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#ignored\">ignored</a>);", 
"static void <a class=\"id\" href=\"#blank_screen_t\">blank_screen_t</a>(unsigned long <a class=\"id\" href=\"#dummy\">dummy</a>);", 
"static void <a class=\"id\" href=\"#set_palette\">set_palette</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>);", 
"", 
"static int <a class=\"id\" href=\"#printable\">printable</a>;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Is console ready for printing? */</span>", 
"int <a class=\"id\" href=\"#default_utf8\">default_utf8</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<a class=\"id\" href=\"#module_param\">module_param</a>(<a class=\"id\" href=\"#default_utf8\">default_utf8</a>, int, <a class=\"id\" href=\"#S_IRUGO\">S_IRUGO</a> | <a class=\"id\" href=\"#S_IWUSR\">S_IWUSR</a>);", 
"int <a class=\"id\" href=\"#global_cursor_default\">global_cursor_default</a> = -1;", 
"<a class=\"id\" href=\"#module_param\">module_param</a>(<a class=\"id\" href=\"#global_cursor_default\">global_cursor_default</a>, int, <a class=\"id\" href=\"#S_IRUGO\">S_IRUGO</a> | <a class=\"id\" href=\"#S_IWUSR\">S_IWUSR</a>);", 
"", 
"static int <a class=\"id\" href=\"#cur_default\">cur_default</a> = <a class=\"id\" href=\"#CUR_DEFAULT\">CUR_DEFAULT</a>;", 
"<a class=\"id\" href=\"#module_param\">module_param</a>(<a class=\"id\" href=\"#cur_default\">cur_default</a>, int, <a class=\"id\" href=\"#S_IRUGO\">S_IRUGO</a> | <a class=\"id\" href=\"#S_IWUSR\">S_IWUSR</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ignore_poke: don't unblank the screen when things are typed.  This is</span>", 
"<span class=\"comment\"> * mainly for the privacy of braille terminal users.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#ignore_poke\">ignore_poke</a>;", 
"", 
"int <a class=\"id\" href=\"#do_poke_blanked_console\">do_poke_blanked_console</a>;", 
"int <a class=\"id\" href=\"#console_blanked\">console_blanked</a>;", 
"", 
"static int <a class=\"id\" href=\"#vesa_blank_mode\">vesa_blank_mode</a>; <span class=\"comment\">/* 0:none 1:suspendV 2:suspendH 3:powerdown */</span>", 
"static int <a class=\"id\" href=\"#vesa_off_interval\">vesa_off_interval</a>;", 
"static int <a class=\"id\" href=\"#blankinterval\">blankinterval</a> = 10*60;", 
"<a class=\"id\" href=\"#core_param\">core_param</a>(<a class=\"id\" href=\"#consoleblank\">consoleblank</a>, <a class=\"id\" href=\"#blankinterval\">blankinterval</a>, int, 0444);", 
"", 
"static <a class=\"id\" href=\"#DECLARE_WORK\">DECLARE_WORK</a>(<a class=\"id\" href=\"#console_work\">console_work</a>, <a class=\"id\" href=\"#console_callback\">console_callback</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * fg_console is the current virtual console,</span>", 
"<span class=\"comment\"> * last_console is the last used one,</span>", 
"<span class=\"comment\"> * want_console is the console we want to switch to,</span>", 
"<span class=\"comment\"> * saved_* variants are for save/restore around kernel debugger enter/leave</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#fg_console\">fg_console</a>;", 
"int <a class=\"id\" href=\"#last_console\">last_console</a>;", 
"int <a class=\"id\" href=\"#want_console\">want_console</a> = -1;", 
"static int <a class=\"id\" href=\"#saved_fg_console\">saved_fg_console</a>;", 
"static int <a class=\"id\" href=\"#saved_last_console\">saved_last_console</a>;", 
"static int <a class=\"id\" href=\"#saved_want_console\">saved_want_console</a>;", 
"static int <a class=\"id\" href=\"#saved_vc_mode\">saved_vc_mode</a>;", 
"static int <a class=\"id\" href=\"#saved_console_blanked\">saved_console_blanked</a>;", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * For each existing display, we have a pointer to console currently visible</span>", 
"<span class=\"comment\"> * on that display, allowing consoles other than fg_console to be refreshed</span>", 
"<span class=\"comment\"> * appropriately. Unless the low-level driver supplies its own display_fg</span>", 
"<span class=\"comment\"> * variable, we use this one for the \"master display\".</span>", 
"<span class=\"comment\"> */</span>", 
"static struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#master_display_fg\">master_display_fg</a>;", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Unfortunately, we need to delay tty echo when we're currently writing to the</span>", 
"<span class=\"comment\"> * console since the code is (and always was) not re-entrant, so we schedule</span>", 
"<span class=\"comment\"> * all flip requests to process context with schedule-task() and run it from</span>", 
"<span class=\"comment\"> * console_callback().</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * For the same reason, we defer scrollback to the console callback.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#scrollback_delta\">scrollback_delta</a>;", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Hook so that the power management routines can (un)blank</span>", 
"<span class=\"comment\"> * the console on our behalf.</span>", 
"<span class=\"comment\"> */</span>", 
"int (*<a class=\"id\" href=\"#console_blank_hook\">console_blank_hook</a>)(int);", 
"", 
"static <a class=\"id\" href=\"#DEFINE_TIMER\">DEFINE_TIMER</a>(<a class=\"id\" href=\"#console_timer\">console_timer</a>, <a class=\"id\" href=\"#blank_screen_t\">blank_screen_t</a>, 0, 0);", 
"static int <a class=\"id\" href=\"#blank_state\">blank_state</a>;", 
"static int <a class=\"id\" href=\"#blank_timer_expired\">blank_timer_expired</a>;", 
"enum {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#blank_off\">blank_off</a> = 0,", 
"<span class=\"ts\"/><a class=\"id\" href=\"#blank_normal_wait\">blank_normal_wait</a>,", 
"<span class=\"ts\"/><a class=\"id\" href=\"#blank_vesa_wait\">blank_vesa_wait</a>,", 
"};", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Notifier list for console events.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#ATOMIC_NOTIFIER_HEAD\">ATOMIC_NOTIFIER_HEAD</a>(<a class=\"id\" href=\"#vt_notifier_list\">vt_notifier_list</a>);", 
"", 
"int <a class=\"id\" href=\"#register_vt_notifier\">register_vt_notifier</a>(struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> *<a class=\"id\" href=\"#nb\">nb</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#atomic_notifier_chain_register\">atomic_notifier_chain_register</a>(&amp;<a class=\"id\" href=\"#vt_notifier_list\">vt_notifier_list</a>, <a class=\"id\" href=\"#nb\">nb</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#register_vt_notifier\">register_vt_notifier</a>);", 
"", 
"int <a class=\"id\" href=\"#unregister_vt_notifier\">unregister_vt_notifier</a>(struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> *<a class=\"id\" href=\"#nb\">nb</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#atomic_notifier_chain_unregister\">atomic_notifier_chain_unregister</a>(&amp;<a class=\"id\" href=\"#vt_notifier_list\">vt_notifier_list</a>, <a class=\"id\" href=\"#nb\">nb</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#unregister_vt_notifier\">unregister_vt_notifier</a>);", 
"", 
"static void <a class=\"id\" href=\"#notify_write\">notify_write</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned int <a class=\"id\" href=\"#unicode\">unicode</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_notifier_param\">vt_notifier_param</a> <a class=\"id\" href=\"#param\">param</a> = { .<a class=\"id\" href=\"#vc\">vc</a> = <a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#unicode\">unicode</a> = <a class=\"id\" href=\"#unicode\">unicode</a> };", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_notifier_call_chain\">atomic_notifier_call_chain</a>(&amp;<a class=\"id\" href=\"#vt_notifier_list\">vt_notifier_list</a>, <a class=\"id\" href=\"#VT_WRITE\">VT_WRITE</a>, &amp;<a class=\"id\" href=\"#param\">param</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#notify_update\">notify_update</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#vt_notifier_param\">vt_notifier_param</a> <a class=\"id\" href=\"#param\">param</a> = { .<a class=\"id\" href=\"#vc\">vc</a> = <a class=\"id\" href=\"#vc\">vc</a> };", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_notifier_call_chain\">atomic_notifier_call_chain</a>(&amp;<a class=\"id\" href=\"#vt_notifier_list\">vt_notifier_list</a>, <a class=\"id\" href=\"#VT_UPDATE\">VT_UPDATE</a>, &amp;<a class=\"id\" href=\"#param\">param</a>);", 
"}", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Low-Level Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IS_FG\">IS_FG</a>(<a class=\"id\" href=\"#vc\">vc</a>)<span class=\"ts\"/>((<a class=\"id\" href=\"#vc\">vc</a>)-><a class=\"id\" href=\"#vc_num\">vc_num</a> == <a class=\"id\" href=\"#fg_console\">fg_console</a>)", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#VT_BUF_VRAM_ONLY\">VT_BUF_VRAM_ONLY</a>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>)<span class=\"ts\"/>0", 
"#else", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>)<span class=\"ts\"/>(<a class=\"id\" href=\"#CON_IS_VISIBLE\">CON_IS_VISIBLE</a>(<a class=\"id\" href=\"#vc\">vc</a>) && !<a class=\"id\" href=\"#console_blanked\">console_blanked</a>)", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned short *<a class=\"id\" href=\"#screenpos\">screenpos</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#offset\">offset</a>, int <a class=\"id\" href=\"#viewed\">viewed</a>)", 
"{", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#viewed\">viewed</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = (unsigned short *)(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a> + <a class=\"id\" href=\"#offset\">offset</a>);", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_screen_pos\">con_screen_pos</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = (unsigned short *)(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_visible_origin\">vc_visible_origin</a> + <a class=\"id\" href=\"#offset\">offset</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_screen_pos\">con_screen_pos</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#offset\">offset</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#p\">p</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Called  from the keyboard irq path.. */</span>", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#scrolldelta\">scrolldelta</a>(int <a class=\"id\" href=\"#lines\">lines</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* FIXME */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* scrolldelta needs some kind of consistency lock, but the BKL was</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   and still is not protecting versus the scheduled back end */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scrollback_delta\">scrollback_delta</a> += <a class=\"id\" href=\"#lines\">lines</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#schedule_console_callback\">schedule_console_callback</a>();", 
"}", 
"", 
"void <a class=\"id\" href=\"#schedule_console_callback\">schedule_console_callback</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#schedule_work\">schedule_work</a>(&amp;<a class=\"id\" href=\"#console_work\">console_work</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#scrup\">scrup</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned int <a class=\"id\" href=\"#t\">t</a>, unsigned int <a class=\"id\" href=\"#b\">b</a>, int <a class=\"id\" href=\"#nr\">nr</a>)", 
"{", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#d\">d</a>, *<a class=\"id\" href=\"#s\">s</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#t\">t</a>+<a class=\"id\" href=\"#nr\">nr</a> >= <a class=\"id\" href=\"#b\">b</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr\">nr</a> = <a class=\"id\" href=\"#b\">b</a> - <a class=\"id\" href=\"#t\">t</a> - 1;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#b\">b</a> &gt; <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a> || <a class=\"id\" href=\"#t\">t</a> >= <a class=\"id\" href=\"#b\">b</a> || <a class=\"id\" href=\"#nr\">nr</a> &lt; 1)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#CON_IS_VISIBLE\">CON_IS_VISIBLE</a>(<a class=\"id\" href=\"#vc\">vc</a>) && <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_scroll\">con_scroll</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#t\">t</a>, <a class=\"id\" href=\"#b\">b</a>, <a class=\"id\" href=\"#SM_UP\">SM_UP</a>, <a class=\"id\" href=\"#nr\">nr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#d\">d</a> = (unsigned short *)(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a> + <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a> * <a class=\"id\" href=\"#t\">t</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a> = (unsigned short *)(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a> + <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a> * (<a class=\"id\" href=\"#t\">t</a> + <a class=\"id\" href=\"#nr\">nr</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scr_memmovew\">scr_memmovew</a>(<a class=\"id\" href=\"#d\">d</a>, <a class=\"id\" href=\"#s\">s</a>, (<a class=\"id\" href=\"#b\">b</a> - <a class=\"id\" href=\"#t\">t</a> - <a class=\"id\" href=\"#nr\">nr</a>) * <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scr_memsetw\">scr_memsetw</a>(<a class=\"id\" href=\"#d\">d</a> + (<a class=\"id\" href=\"#b\">b</a> - <a class=\"id\" href=\"#t\">t</a> - <a class=\"id\" href=\"#nr\">nr</a>) * <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a> * <a class=\"id\" href=\"#nr\">nr</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#scrdown\">scrdown</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned int <a class=\"id\" href=\"#t\">t</a>, unsigned int <a class=\"id\" href=\"#b\">b</a>, int <a class=\"id\" href=\"#nr\">nr</a>)", 
"{", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#s\">s</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#step\">step</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#t\">t</a>+<a class=\"id\" href=\"#nr\">nr</a> >= <a class=\"id\" href=\"#b\">b</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr\">nr</a> = <a class=\"id\" href=\"#b\">b</a> - <a class=\"id\" href=\"#t\">t</a> - 1;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#b\">b</a> &gt; <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a> || <a class=\"id\" href=\"#t\">t</a> >= <a class=\"id\" href=\"#b\">b</a> || <a class=\"id\" href=\"#nr\">nr</a> &lt; 1)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#CON_IS_VISIBLE\">CON_IS_VISIBLE</a>(<a class=\"id\" href=\"#vc\">vc</a>) && <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_scroll\">con_scroll</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#t\">t</a>, <a class=\"id\" href=\"#b\">b</a>, <a class=\"id\" href=\"#SM_DOWN\">SM_DOWN</a>, <a class=\"id\" href=\"#nr\">nr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a> = (unsigned short *)(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a> + <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a> * <a class=\"id\" href=\"#t\">t</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#step\">step</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> * <a class=\"id\" href=\"#nr\">nr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scr_memmovew\">scr_memmovew</a>(<a class=\"id\" href=\"#s\">s</a> + <a class=\"id\" href=\"#step\">step</a>, <a class=\"id\" href=\"#s\">s</a>, (<a class=\"id\" href=\"#b\">b</a> - <a class=\"id\" href=\"#t\">t</a> - <a class=\"id\" href=\"#nr\">nr</a>) * <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scr_memsetw\">scr_memsetw</a>(<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>, 2 * <a class=\"id\" href=\"#step\">step</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#do_update_region\">do_update_region</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned long <a class=\"id\" href=\"#start\">start</a>, int <a class=\"id\" href=\"#count\">count</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#VT_BUF_VRAM_ONLY\">VT_BUF_VRAM_ONLY</a>", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#xx\">xx</a>, <a class=\"id\" href=\"#yy\">yy</a>, <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> *<a class=\"id\" href=\"#p\">p</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = (<a class=\"id\" href=\"#u16\">u16</a> *) <a class=\"id\" href=\"#start\">start</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_getxy\">con_getxy</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = (<a class=\"id\" href=\"#start\">start</a> - <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a>) / 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xx\">xx</a> = <a class=\"id\" href=\"#offset\">offset</a> % <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yy\">yy</a> = <a class=\"id\" href=\"#offset\">offset</a> / <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#nxx\">nxx</a>, <a class=\"id\" href=\"#nyy\">nyy</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_getxy\">con_getxy</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#start\">start</a>, &amp;<a class=\"id\" href=\"#nxx\">nxx</a>, &amp;<a class=\"id\" href=\"#nyy\">nyy</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xx\">xx</a> = <a class=\"id\" href=\"#nxx\">nxx</a>; <a class=\"id\" href=\"#yy\">yy</a> = <a class=\"id\" href=\"#nyy\">nyy</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>for(;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#attrib\">attrib</a> = <a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#p\">p</a>) &amp; 0xff00;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#startx\">startx</a> = <a class=\"id\" href=\"#xx\">xx</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> *<a class=\"id\" href=\"#q\">q</a> = <a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#xx\">xx</a> &lt; <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> && <a class=\"id\" href=\"#count\">count</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#attrib\">attrib</a> != (<a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#p\">p</a>) &amp; 0xff00)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#p\">p</a> &gt; <a class=\"id\" href=\"#q\">q</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putcs\">con_putcs</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#q\">q</a>, <a class=\"id\" href=\"#p\">p</a>-<a class=\"id\" href=\"#q\">q</a>, <a class=\"id\" href=\"#yy\">yy</a>, <a class=\"id\" href=\"#startx\">startx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#startx\">startx</a> = <a class=\"id\" href=\"#xx\">xx</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#q\">q</a> = <a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#attrib\">attrib</a> = <a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#p\">p</a>) &amp; 0xff00;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xx\">xx</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#p\">p</a> &gt; <a class=\"id\" href=\"#q\">q</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putcs\">con_putcs</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#q\">q</a>, <a class=\"id\" href=\"#p\">p</a>-<a class=\"id\" href=\"#q\">q</a>, <a class=\"id\" href=\"#yy\">yy</a>, <a class=\"id\" href=\"#startx\">startx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#count\">count</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xx\">xx</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#yy\">yy</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_getxy\">con_getxy</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = (<a class=\"id\" href=\"#u16\">u16</a> *)<a class=\"id\" href=\"#start\">start</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_getxy\">con_getxy</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"", 
"void <a class=\"id\" href=\"#update_region\">update_region</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned long <a class=\"id\" href=\"#start\">start</a>, int <a class=\"id\" href=\"#count\">count</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hide_cursor\">hide_cursor</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_update_region\">do_update_region</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#count\">count</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_cursor\">set_cursor</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/* Structure of attributes is hardware-dependent */</span>", 
"", 
"static <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#build_attr\">build_attr</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#_color\">_color</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#_intensity\">_intensity</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#_blink\">_blink</a>,", 
"    <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#_underline\">_underline</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#_reverse\">_reverse</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#_italic\">_italic</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_build_attr\">con_build_attr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_build_attr\">con_build_attr</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#_color\">_color</a>, <a class=\"id\" href=\"#_intensity\">_intensity</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#_blink\">_blink</a>, <a class=\"id\" href=\"#_underline\">_underline</a>, <a class=\"id\" href=\"#_reverse\">_reverse</a>, <a class=\"id\" href=\"#_italic\">_italic</a>);", 
"", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#VT_BUF_VRAM_ONLY\">VT_BUF_VRAM_ONLY</a>", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ++roman: I completely changed the attribute format for monochrome</span>", 
"<span class=\"comment\"> * mode (!can_do_color). The formerly used MDA (monochrome display</span>", 
"<span class=\"comment\"> * adapter) format didn't allow the combination of certain effects.</span>", 
"<span class=\"comment\"> * Now the attribute is just a bit vector:</span>", 
"<span class=\"comment\"> *  Bit 0..1: intensity (0..2)</span>", 
"<span class=\"comment\"> *  Bit 2   : underline</span>", 
"<span class=\"comment\"> *  Bit 3   : reverse</span>", 
"<span class=\"comment\"> *  Bit 7   : blink</span>", 
"<span class=\"comment\"> */</span>", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#_color\">_color</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_can_do_color\">vc_can_do_color</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#_intensity\">_intensity</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/>       (<a class=\"id\" href=\"#_italic\">_italic</a> ? 2 : 0) |", 
"<span class=\"ts\"/><span class=\"ts\"/>       (<a class=\"id\" href=\"#_underline\">_underline</a> ? 4 : 0) |", 
"<span class=\"ts\"/><span class=\"ts\"/>       (<a class=\"id\" href=\"#_reverse\">_reverse</a> ? 8 : 0) |", 
"<span class=\"ts\"/><span class=\"ts\"/>       (<a class=\"id\" href=\"#_blink\">_blink</a> ? 0x80 : 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#_italic\">_italic</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = (<a class=\"id\" href=\"#a\">a</a> &amp; 0xF0) | <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_itcolor\">vc_itcolor</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#_underline\">_underline</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = (<a class=\"id\" href=\"#a\">a</a> &amp; 0xf0) | <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_ulcolor\">vc_ulcolor</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#_intensity\">_intensity</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = (<a class=\"id\" href=\"#a\">a</a> &amp; 0xf0) | <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_ulcolor\">vc_ulcolor</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#_reverse\">_reverse</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = ((<a class=\"id\" href=\"#a\">a</a>) &amp; 0x88) | ((((<a class=\"id\" href=\"#a\">a</a>) >> 4) | ((<a class=\"id\" href=\"#a\">a</a>) << 4)) &amp; 0x77);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#_blink\">_blink</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> ^= 0x80;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#_intensity\">_intensity</a> == 2)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> ^= 0x08;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_hi_font_mask\">vc_hi_font_mask</a> == 0x100)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> <<= 1;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#a\">a</a>;", 
"<span class=\"ts\"/>}", 
"#else", 
"<span class=\"ts\"/>return 0;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#update_attr\">update_attr</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_attr\">vc_attr</a> = <a class=\"id\" href=\"#build_attr\">build_attr</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_color\">vc_color</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_intensity\">vc_intensity</a>,", 
"<span class=\"ts\"/>              <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_blink\">vc_blink</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_underline\">vc_underline</a>,", 
"<span class=\"ts\"/>              <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_reverse\">vc_reverse</a> ^ <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_decscnm\">vc_decscnm</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_italic\">vc_italic</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a> = (<a class=\"id\" href=\"#build_attr\">build_attr</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_color\">vc_color</a>, 1, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_blink\">vc_blink</a>, 0, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_decscnm\">vc_decscnm</a>, 0) << 8) | ' ';", 
"}", 
"", 
"<span class=\"comment\">/* Note: inverting the screen twice should revert to the original state */</span>", 
"void <a class=\"id\" href=\"#invert_screen\">invert_screen</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#offset\">offset</a>, int <a class=\"id\" href=\"#count\">count</a>, int <a class=\"id\" href=\"#viewed\">viewed</a>)", 
"{", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#p\">p</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a> /= 2;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#screenpos\">screenpos</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#offset\">offset</a>, <a class=\"id\" href=\"#viewed\">viewed</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_invert_region\">con_invert_region</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_invert_region\">con_invert_region</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#count\">count</a>);", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#VT_BUF_VRAM_ONLY\">VT_BUF_VRAM_ONLY</a>", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> *<a class=\"id\" href=\"#q\">q</a> = <a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#cnt\">cnt</a> = <a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#a\">a</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_can_do_color\">vc_can_do_color</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cnt\">cnt</a>--) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#a\">a</a> ^= 0x0800;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#a\">a</a>, <a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#q\">q</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_hi_font_mask\">vc_hi_font_mask</a> == 0x100) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cnt\">cnt</a>--) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = ((<a class=\"id\" href=\"#a\">a</a>) &amp; 0x11ff) | (((<a class=\"id\" href=\"#a\">a</a>) &amp; 0xe000) >> 4) | (((<a class=\"id\" href=\"#a\">a</a>) &amp; 0x0e00) << 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#a\">a</a>, <a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#q\">q</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cnt\">cnt</a>--) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = <a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#a\">a</a> = ((<a class=\"id\" href=\"#a\">a</a>) &amp; 0x88ff) | (((<a class=\"id\" href=\"#a\">a</a>) &amp; 0x7000) >> 4) | (((<a class=\"id\" href=\"#a\">a</a>) &amp; 0x0700) << 4);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#a\">a</a>, <a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#q\">q</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_update_region\">do_update_region</a>(<a class=\"id\" href=\"#vc\">vc</a>, (unsigned long) <a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#count\">count</a>);", 
"}", 
"", 
"<span class=\"comment\">/* used by selection: complement pointer position */</span>", 
"void <a class=\"id\" href=\"#complement_pos\">complement_pos</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#offset\">offset</a>)", 
"{", 
"<span class=\"ts\"/>static int <a class=\"id\" href=\"#old_offset\">old_offset</a> = -1;", 
"<span class=\"ts\"/>static unsigned short <a class=\"id\" href=\"#old\">old</a>;", 
"<span class=\"ts\"/>static unsigned short <a class=\"id\" href=\"#oldx\">oldx</a>, <a class=\"id\" href=\"#oldy\">oldy</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#old_offset\">old_offset</a> != -1 && <a class=\"id\" href=\"#old_offset\">old_offset</a> >= 0 &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#old_offset\">old_offset</a> &lt; <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#old\">old</a>, <a class=\"id\" href=\"#screenpos\">screenpos</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#old_offset\">old_offset</a>, 1));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putc\">con_putc</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#old\">old</a>, <a class=\"id\" href=\"#oldy\">oldy</a>, <a class=\"id\" href=\"#oldx\">oldx</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_offset\">old_offset</a> = <a class=\"id\" href=\"#offset\">offset</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#offset\">offset</a> != -1 && <a class=\"id\" href=\"#offset\">offset</a> >= 0 &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#offset\">offset</a> &lt; <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#new\">new</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#screenpos\">screenpos</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#offset\">offset</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old\">old</a> = <a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a> = <a class=\"id\" href=\"#old\">old</a> ^ <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_complement_mask\">vc_complement_mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#new\">new</a>, <a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#oldx\">oldx</a> = (<a class=\"id\" href=\"#offset\">offset</a> >> 1) % <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#oldy\">oldy</a> = (<a class=\"id\" href=\"#offset\">offset</a> >> 1) / <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putc\">con_putc</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#new\">new</a>, <a class=\"id\" href=\"#oldy\">oldy</a>, <a class=\"id\" href=\"#oldx\">oldx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"}", 
"", 
"static void <a class=\"id\" href=\"#insert_char\">insert_char</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned int <a class=\"id\" href=\"#nr\">nr</a>)", 
"{", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#p\">p</a>, *<a class=\"id\" href=\"#q\">q</a> = (unsigned short *)<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_pos\">vc_pos</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#q\">q</a> + <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> - <a class=\"id\" href=\"#nr\">nr</a> - <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>;", 
"<span class=\"ts\"/>while (--<a class=\"id\" href=\"#p\">p</a> >= <a class=\"id\" href=\"#q\">q</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#p\">p</a>), <a class=\"id\" href=\"#p\">p</a> + <a class=\"id\" href=\"#nr\">nr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scr_memsetw\">scr_memsetw</a>(<a class=\"id\" href=\"#q\">q</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>, <a class=\"id\" href=\"#nr\">nr</a> * 2);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_need_wrap\">vc_need_wrap</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#oldattr\">oldattr</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_attr\">vc_attr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_bmove\">con_bmove</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a> + <a class=\"id\" href=\"#nr\">nr</a>, 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> - <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a> - <a class=\"id\" href=\"#nr\">nr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_attr\">vc_attr</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a> >> 8;", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#nr\">nr</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putc\">con_putc</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a> + <a class=\"id\" href=\"#nr\">nr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_attr\">vc_attr</a> = <a class=\"id\" href=\"#oldattr\">oldattr</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#delete_char\">delete_char</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned int <a class=\"id\" href=\"#nr\">nr</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>;", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#p\">p</a> = (unsigned short *)<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_pos\">vc_pos</a>;", 
"", 
"<span class=\"ts\"/>while (++<a class=\"id\" href=\"#i\">i</a> <= <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> - <a class=\"id\" href=\"#nr\">nr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#p\">p</a>+<a class=\"id\" href=\"#nr\">nr</a>), <a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scr_memsetw\">scr_memsetw</a>(<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>, <a class=\"id\" href=\"#nr\">nr</a> * 2);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_need_wrap\">vc_need_wrap</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#oldattr\">oldattr</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_attr\">vc_attr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_bmove\">con_bmove</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a> + <a class=\"id\" href=\"#nr\">nr</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>, 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> - <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a> - <a class=\"id\" href=\"#nr\">nr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_attr\">vc_attr</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a> >> 8;", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#nr\">nr</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putc\">con_putc</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> - 1 - <a class=\"id\" href=\"#nr\">nr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_attr\">vc_attr</a> = <a class=\"id\" href=\"#oldattr\">oldattr</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static int <a class=\"id\" href=\"#softcursor_original\">softcursor_original</a>;", 
"", 
"static void <a class=\"id\" href=\"#add_softcursor\">add_softcursor</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#scr_readw\">scr_readw</a>((<a class=\"id\" href=\"#u16\">u16</a> *) <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_pos\">vc_pos</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cursor_type\">vc_cursor_type</a>;", 
"", 
"<span class=\"ts\"/>if (! (<a class=\"id\" href=\"#type\">type</a> &amp; 0x10)) return;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#softcursor_original\">softcursor_original</a> != -1) return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#softcursor_original\">softcursor_original</a> = <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> |= ((<a class=\"id\" href=\"#type\">type</a> >> 8) &amp; 0xff00 );", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> ^= ((<a class=\"id\" href=\"#type\">type</a>) &amp; 0xff00 );", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#type\">type</a> &amp; 0x20) && ((<a class=\"id\" href=\"#softcursor_original\">softcursor_original</a> &amp; 0x7000) == (<a class=\"id\" href=\"#i\">i</a> &amp; 0x7000))) <a class=\"id\" href=\"#i\">i</a> ^= 0x7000;", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#type\">type</a> &amp; 0x40) && ((<a class=\"id\" href=\"#i\">i</a> &amp; 0x700) == ((<a class=\"id\" href=\"#i\">i</a> &amp; 0x7000) >> 4))) <a class=\"id\" href=\"#i\">i</a> ^= 0x0700;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#i\">i</a>, (<a class=\"id\" href=\"#u16\">u16</a> *) <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_pos\">vc_pos</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putc\">con_putc</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#hide_softcursor\">hide_softcursor</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#softcursor_original\">softcursor_original</a> != -1) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>(<a class=\"id\" href=\"#softcursor_original\">softcursor_original</a>, (<a class=\"id\" href=\"#u16\">u16</a> *)<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_pos\">vc_pos</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#DO_UPDATE\">DO_UPDATE</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_putc\">con_putc</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#softcursor_original\">softcursor_original</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#softcursor_original\">softcursor_original</a> = -1;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#hide_cursor\">hide_cursor</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a> == <a class=\"id\" href=\"#sel_cons\">sel_cons</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_selection\">clear_selection</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_cursor\">con_cursor</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#CM_ERASE\">CM_ERASE</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hide_softcursor\">hide_softcursor</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#set_cursor\">set_cursor</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#IS_FG\">IS_FG</a>(<a class=\"id\" href=\"#vc\">vc</a>) || <a class=\"id\" href=\"#console_blanked\">console_blanked</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_mode\">vc_mode</a> == <a class=\"id\" href=\"#KD_GRAPHICS\">KD_GRAPHICS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_deccm\">vc_deccm</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a> == <a class=\"id\" href=\"#sel_cons\">sel_cons</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_selection\">clear_selection</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#add_softcursor\">add_softcursor</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cursor_type\">vc_cursor_type</a> &amp; 0x0f) != 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_cursor\">con_cursor</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#CM_DRAW\">CM_DRAW</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hide_cursor\">hide_cursor</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#set_origin\">set_origin</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#CON_IS_VISIBLE\">CON_IS_VISIBLE</a>(<a class=\"id\" href=\"#vc\">vc</a>) ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_set_origin\">con_set_origin</a> ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_set_origin\">con_set_origin</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a> = (unsigned long)<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf\">vc_screenbuf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_visible_origin\">vc_visible_origin</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_scr_end\">vc_scr_end</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a> + <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_pos\">vc_pos</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a> + <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a> * <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a> + 2 * <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#save_screen\">save_screen</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_save_screen\">con_save_screen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_save_screen\">con_save_screen</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Redrawing of screen</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#clear_buffer_attributes\">clear_buffer_attributes</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>)", 
"{", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#p\">p</a> = (unsigned short *)<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a> / 2;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_hi_font_mask\">vc_hi_font_mask</a> | 0xff;", 
"", 
"<span class=\"ts\"/>for (; <a class=\"id\" href=\"#count\">count</a> &gt; 0; <a class=\"id\" href=\"#count\">count</a>--, <a class=\"id\" href=\"#p\">p</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_writew\">scr_writew</a>((<a class=\"id\" href=\"#scr_readw\">scr_readw</a>(<a class=\"id\" href=\"#p\">p</a>)&amp;<a class=\"id\" href=\"#mask\">mask</a>) | (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a> &amp; ~<a class=\"id\" href=\"#mask\">mask</a>), <a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"void <a class=\"id\" href=\"#redraw_screen\">redraw_screen</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#is_switch\">is_switch</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#redraw\">redraw</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc\">vc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* strange ... */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* printk(\"redraw_screen: tty %d not allocated ??\\n\", new_console+1); */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_switch\">is_switch</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#old_vc\">old_vc</a> = <a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#fg_console\">fg_console</a>].<a class=\"id\" href=\"#d\">d</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#old_vc\">old_vc</a> == <a class=\"id\" href=\"#vc\">vc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#CON_IS_VISIBLE\">CON_IS_VISIBLE</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#redraw\">redraw</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_display_fg\">vc_display_fg</a> = <a class=\"id\" href=\"#vc\">vc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fg_console\">fg_console</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_num\">vc_num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hide_cursor\">hide_cursor</a>(<a class=\"id\" href=\"#old_vc\">old_vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#CON_IS_VISIBLE\">CON_IS_VISIBLE</a>(<a class=\"id\" href=\"#old_vc\">old_vc</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#save_screen\">save_screen</a>(<a class=\"id\" href=\"#old_vc\">old_vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_origin\">set_origin</a>(<a class=\"id\" href=\"#old_vc\">old_vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hide_cursor\">hide_cursor</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#redraw\">redraw</a> = 1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#redraw\">redraw</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#update\">update</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#old_was_color\">old_was_color</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_can_do_color\">vc_can_do_color</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_origin\">set_origin</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#update\">update</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_switch\">con_switch</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_palette\">set_palette</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * If console changed from mono&lt;-&gt;color, the best we can do</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * is to clear the buffer attributes. As it currently stands,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * rebuilding new attributes from the old buffer is not doable</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * without overly complex code.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#old_was_color\">old_was_color</a> != <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_can_do_color\">vc_can_do_color</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#update_attr\">update_attr</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_buffer_attributes\">clear_buffer_attributes</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Forcibly update if we're panicing */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#update\">update</a> && <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_mode\">vc_mode</a> != <a class=\"id\" href=\"#KD_GRAPHICS\">KD_GRAPHICS</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#vt_force_oops_output\">vt_force_oops_output</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_update_region\">do_update_region</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a> / 2);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_cursor\">set_cursor</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_switch\">is_switch</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_leds\">set_leds</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#compute_shiftstate\">compute_shiftstate</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#notify_update\">notify_update</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Allocation, freeing and resizing of VTs.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#vc_cons_allocated\">vc_cons_allocated</a>(unsigned int <a class=\"id\" href=\"#i\">i</a>)", 
"{", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a> && <a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#d\">d</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#visual_init\">visual_init</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#num\">num</a>, int <a class=\"id\" href=\"#init\">init</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* ++Geert: vc-&gt;vc_sw-&gt;con_init determines console size */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#module_put\">module_put</a>(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#owner\">owner</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a> = <a class=\"id\" href=\"#conswitchp\">conswitchp</a>;", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#VT_SINGLE_DRIVER\">VT_SINGLE_DRIVER</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#con_driver_map\">con_driver_map</a>[<a class=\"id\" href=\"#num\">num</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a> = <a class=\"id\" href=\"#con_driver_map\">con_driver_map</a>[<a class=\"id\" href=\"#num\">num</a>];", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__module_get\">__module_get</a>(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#owner\">owner</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_num\">vc_num</a> = <a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_display_fg\">vc_display_fg</a> = &amp;<a class=\"id\" href=\"#master_display_fg\">master_display_fg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_uni_pagedir_loc\">vc_uni_pagedir_loc</a> = &amp;<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_uni_pagedir\">vc_uni_pagedir</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_uni_pagedir\">vc_uni_pagedir</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_hi_font_mask\">vc_hi_font_mask</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_complement_mask\">vc_complement_mask</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_can_do_color\">vc_can_do_color</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_panic_force_write\">vc_panic_force_write</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_init\">con_init</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#init\">init</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_complement_mask\">vc_complement_mask</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_complement_mask\">vc_complement_mask</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_can_do_color\">vc_can_do_color</a> ? 0x7700 : 0x0800;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_s_complement_mask\">vc_s_complement_mask</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_complement_mask\">vc_complement_mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> << 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a> * <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#vc_allocate\">vc_allocate</a>(unsigned int <a class=\"id\" href=\"#currcons\">currcons</a>)<span class=\"ts\"/><span class=\"comment\">/* return 0 on success */</span>", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#currcons\">currcons</a> >= <a class=\"id\" href=\"#MAX_NR_CONSOLES\">MAX_NR_CONSOLES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#currcons\">currcons</a>].<a class=\"id\" href=\"#d\">d</a>) {", 
"<span class=\"ts\"/>    struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>;", 
"<span class=\"ts\"/>    struct <a class=\"id\" href=\"#vt_notifier_param\">vt_notifier_param</a> <a class=\"id\" href=\"#param\">param</a>;", 
"", 
"<span class=\"ts\"/>    <span class=\"comment\">/* prevent users from taking too much memory */</span>", 
"<span class=\"ts\"/>    if (<a class=\"id\" href=\"#currcons\">currcons</a> >= <a class=\"id\" href=\"#MAX_NR_USER_CONSOLES\">MAX_NR_USER_CONSOLES</a> && !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_RESOURCE\">CAP_SYS_RESOURCE</a>))", 
"<span class=\"ts\"/>      return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/>    <span class=\"comment\">/* due to the granularity of kmalloc, we waste some memory here */</span>", 
"<span class=\"ts\"/>    <span class=\"comment\">/* the alloc is done in two steps, to optimize the common situation</span>", 
"<span class=\"comment\"><span class=\"ts\"/>       of a 25x80 console (structsize=216, screenbuf_size=4000) */</span>", 
"<span class=\"ts\"/>    <span class=\"comment\">/* although the numbers above are not valid since long ago, the</span>", 
"<span class=\"comment\"><span class=\"ts\"/>       point is still up-to-date and the comment still has its value</span>", 
"<span class=\"comment\"><span class=\"ts\"/>       even if only as a historical artifact.  --mj, July 1998 */</span>", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#vc\">vc</a> = <a class=\"id\" href=\"#vc\">vc</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#vc_data\">vc_data</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>    if (!<a class=\"id\" href=\"#vc\">vc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#currcons\">currcons</a>].<a class=\"id\" href=\"#d\">d</a> = <a class=\"id\" href=\"#vc\">vc</a>;", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#tty_port_init\">tty_port_init</a>(&amp;<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#port\">port</a>);", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#INIT_WORK\">INIT_WORK</a>(&amp;<a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#currcons\">currcons</a>].<a class=\"id\" href=\"#SAK_work\">SAK_work</a>, <a class=\"id\" href=\"#vc_SAK\">vc_SAK</a>);", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#visual_init\">visual_init</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#currcons\">currcons</a>, 1);", 
"<span class=\"ts\"/>    if (!*<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_uni_pagedir_loc\">vc_uni_pagedir_loc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#con_set_default_unimap\">con_set_default_unimap</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf\">vc_screenbuf</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>    if (!<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf\">vc_screenbuf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vc_cons\">vc_cons</a>[<a class=\"id\" href=\"#currcons\">currcons</a>].<a class=\"id\" href=\"#d\">d</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>    }", 
"", 
"<span class=\"ts\"/>    <span class=\"comment\">/* If no drivers have overridden us and the user didn't pass a</span>", 
"<span class=\"comment\"><span class=\"ts\"/>       boot option, default to displaying the cursor */</span>", 
"<span class=\"ts\"/>    if (<a class=\"id\" href=\"#global_cursor_default\">global_cursor_default</a> == -1)", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#global_cursor_default\">global_cursor_default</a> = 1;", 
"", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#vc_init\">vc_init</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>, 1);", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#vcs_make_sysfs\">vcs_make_sysfs</a>(<a class=\"id\" href=\"#currcons\">currcons</a>);", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#atomic_notifier_call_chain\">atomic_notifier_call_chain</a>(&amp;<a class=\"id\" href=\"#vt_notifier_list\">vt_notifier_list</a>, <a class=\"id\" href=\"#VT_ALLOCATE\">VT_ALLOCATE</a>, &amp;<a class=\"id\" href=\"#param\">param</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#resize_screen\">resize_screen</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, int <a class=\"id\" href=\"#width\">width</a>, int <a class=\"id\" href=\"#height\">height</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#user\">user</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* Resizes the resolution of the display adapater */</span>", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_mode\">vc_mode</a> != <a class=\"id\" href=\"#KD_GRAPHICS\">KD_GRAPHICS</a> && <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_resize\">con_resize</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_sw\">vc_sw</a>-><a class=\"id\" href=\"#con_resize\">con_resize</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#width\">width</a>, <a class=\"id\" href=\"#height\">height</a>, <a class=\"id\" href=\"#user\">user</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Change # of rows and columns (0 means unchanged/the size of fg_console)</span>", 
"<span class=\"comment\"> * [this is to be used together with some user program</span>", 
"<span class=\"comment\"> * like resize that changes the hardware videomode]</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#VC_RESIZE_MAXCOL\">VC_RESIZE_MAXCOL</a> (32767)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#VC_RESIZE_MAXROW\">VC_RESIZE_MAXROW</a> (32767)", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>vc_do_resize<span class=\"ts\"/>-<span class=\"ts\"/>resizing method for the tty</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@tty: tty being resized</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@real_tty: real tty (different to tty if a pty/tty pair)</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@vc: virtual console private data</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@cols: columns</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@lines: lines</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Resize a virtual console, clipping according to the actual constraints.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>If the caller passes a tty structure then update the termios winsize</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>information and perform any necessary signal handling.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Caller must hold the console semaphore. Takes the termios mutex and</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>ctrl_lock of the tty IFF a tty is passed.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#vc_do_resize\">vc_do_resize</a>(struct <a class=\"id\" href=\"#tty_struct\">tty_struct</a> *<a class=\"id\" href=\"#tty\">tty</a>, struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#cols\">cols</a>, unsigned int <a class=\"id\" href=\"#lines\">lines</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#old_origin\">old_origin</a>, <a class=\"id\" href=\"#new_origin\">new_origin</a>, <a class=\"id\" href=\"#new_scr_end\">new_scr_end</a>, <a class=\"id\" href=\"#rlth\">rlth</a>, <a class=\"id\" href=\"#rrem\">rrem</a>, <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#end\">end</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#old_cols\">old_cols</a>, <a class=\"id\" href=\"#old_rows\">old_rows</a>, <a class=\"id\" href=\"#old_row_size\">old_row_size</a>, <a class=\"id\" href=\"#old_screen_size\">old_screen_size</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#new_cols\">new_cols</a>, <a class=\"id\" href=\"#new_rows\">new_rows</a>, <a class=\"id\" href=\"#new_row_size\">new_row_size</a>, <a class=\"id\" href=\"#new_screen_size\">new_screen_size</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#user\">user</a>;", 
"<span class=\"ts\"/>unsigned short *<a class=\"id\" href=\"#newscreen\">newscreen</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_CONSOLE_UNLOCKED\">WARN_CONSOLE_UNLOCKED</a>();", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#vc\">vc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#user\">user</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_resize_user\">vc_resize_user</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_resize_user\">vc_resize_user</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cols\">cols</a> &gt; <a class=\"id\" href=\"#VC_RESIZE_MAXCOL\">VC_RESIZE_MAXCOL</a> || <a class=\"id\" href=\"#lines\">lines</a> &gt; <a class=\"id\" href=\"#VC_RESIZE_MAXROW\">VC_RESIZE_MAXROW</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new_cols\">new_cols</a> = (<a class=\"id\" href=\"#cols\">cols</a> ? <a class=\"id\" href=\"#cols\">cols</a> : <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new_rows\">new_rows</a> = (<a class=\"id\" href=\"#lines\">lines</a> ? <a class=\"id\" href=\"#lines\">lines</a> : <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new_row_size\">new_row_size</a> = <a class=\"id\" href=\"#new_cols\">new_cols</a> << 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new_screen_size\">new_screen_size</a> = <a class=\"id\" href=\"#new_row_size\">new_row_size</a> * <a class=\"id\" href=\"#new_rows\">new_rows</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new_cols\">new_cols</a> == <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> && <a class=\"id\" href=\"#new_rows\">new_rows</a> == <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newscreen\">newscreen</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(<a class=\"id\" href=\"#new_screen_size\">new_screen_size</a>, <a class=\"id\" href=\"#GFP_USER\">GFP_USER</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#newscreen\">newscreen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_rows\">old_rows</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_cols\">old_cols</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_row_size\">old_row_size</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_screen_size\">old_screen_size</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#resize_screen\">resize_screen</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#new_cols\">new_cols</a>, <a class=\"id\" href=\"#new_rows\">new_rows</a>, <a class=\"id\" href=\"#user\">user</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#newscreen\">newscreen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a> = <a class=\"id\" href=\"#new_rows\">new_rows</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a> = <a class=\"id\" href=\"#new_cols\">new_cols</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_size_row\">vc_size_row</a> = <a class=\"id\" href=\"#new_row_size\">new_row_size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a> = <a class=\"id\" href=\"#new_screen_size\">new_screen_size</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rlth\">rlth</a> = <a class=\"id\" href=\"#min\">min</a>(<a class=\"id\" href=\"#old_row_size\">old_row_size</a>, <a class=\"id\" href=\"#new_row_size\">new_row_size</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rrem\">rrem</a> = <a class=\"id\" href=\"#new_row_size\">new_row_size</a> - <a class=\"id\" href=\"#rlth\">rlth</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_origin\">old_origin</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_origin\">vc_origin</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new_origin\">new_origin</a> = (long) <a class=\"id\" href=\"#newscreen\">newscreen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new_scr_end\">new_scr_end</a> = <a class=\"id\" href=\"#new_origin\">new_origin</a> + <a class=\"id\" href=\"#new_screen_size\">new_screen_size</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a> &gt; <a class=\"id\" href=\"#new_rows\">new_rows</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#old_rows\">old_rows</a> - <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a> &lt; <a class=\"id\" href=\"#new_rows\">new_rows</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Cursor near the bottom, copy contents from the</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * bottom of buffer</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_origin\">old_origin</a> += (<a class=\"id\" href=\"#old_rows\">old_rows</a> - <a class=\"id\" href=\"#new_rows\">new_rows</a>) * <a class=\"id\" href=\"#old_row_size\">old_row_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Cursor is in no man's land, copy 1/2 screenful</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * from the top and bottom of cursor position</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_origin\">old_origin</a> += (<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a> - <a class=\"id\" href=\"#new_rows\">new_rows</a>/2) * <a class=\"id\" href=\"#old_row_size\">old_row_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#end\">end</a> = <a class=\"id\" href=\"#old_origin\">old_origin</a> + <a class=\"id\" href=\"#old_row_size\">old_row_size</a> * <a class=\"id\" href=\"#min\">min</a>(<a class=\"id\" href=\"#old_rows\">old_rows</a>, <a class=\"id\" href=\"#new_rows\">new_rows</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#update_attr\">update_attr</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#old_origin\">old_origin</a> &lt; <a class=\"id\" href=\"#end\">end</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_memcpyw\">scr_memcpyw</a>((unsigned short *) <a class=\"id\" href=\"#new_origin\">new_origin</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    (unsigned short *) <a class=\"id\" href=\"#old_origin\">old_origin</a>, <a class=\"id\" href=\"#rlth\">rlth</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rrem\">rrem</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_memsetw\">scr_memsetw</a>((void *)(<a class=\"id\" href=\"#new_origin\">new_origin</a> + <a class=\"id\" href=\"#rlth\">rlth</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>, <a class=\"id\" href=\"#rrem\">rrem</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_origin\">old_origin</a> += <a class=\"id\" href=\"#old_row_size\">old_row_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new_origin\">new_origin</a> += <a class=\"id\" href=\"#new_row_size\">new_row_size</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new_scr_end\">new_scr_end</a> &gt; <a class=\"id\" href=\"#new_origin\">new_origin</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scr_memsetw\">scr_memsetw</a>((void *)<a class=\"id\" href=\"#new_origin\">new_origin</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_video_erase_char\">vc_video_erase_char</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#new_scr_end\">new_scr_end</a> - <a class=\"id\" href=\"#new_origin\">new_origin</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf\">vc_screenbuf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf\">vc_screenbuf</a> = <a class=\"id\" href=\"#newscreen\">newscreen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_screenbuf_size\">vc_screenbuf_size</a> = <a class=\"id\" href=\"#new_screen_size\">new_screen_size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_origin\">set_origin</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* do part of a reset_terminal() */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_top\">vc_top</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_bottom\">vc_bottom</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#gotoxy\">gotoxy</a>(<a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_x\">vc_x</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_y\">vc_y</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#save_cur\">save_cur</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tty\">tty</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Rewrite the requested winsize data with the actual</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   resulting sizes */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#winsize\">winsize</a> <a class=\"id\" href=\"#ws\">ws</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#ws\">ws</a>, 0, sizeof(<a class=\"id\" href=\"#ws\">ws</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ws\">ws</a>.<a class=\"id\" href=\"#ws_row\">ws_row</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_rows\">vc_rows</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ws\">ws</a>.<a class=\"id\" href=\"#ws_col\">ws_col</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_cols\">vc_cols</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ws\">ws</a>.<a class=\"id\" href=\"#ws_ypixel\">ws_ypixel</a> = <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_scan_lines\">vc_scan_lines</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tty_do_resize\">tty_do_resize</a>(<a class=\"id\" href=\"#tty\">tty</a>, &amp;<a class=\"id\" href=\"#ws\">ws</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#CON_IS_VISIBLE\">CON_IS_VISIBLE</a>(<a class=\"id\" href=\"#vc\">vc</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#update_screen\">update_screen</a>(<a class=\"id\" href=\"#vc\">vc</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vt_event_post\">vt_event_post</a>(<a class=\"id\" href=\"#VT_EVENT_RESIZE\">VT_EVENT_RESIZE</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_num\">vc_num</a>, <a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#vc_num\">vc_num</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>vc_resize<span class=\"ts\"/><span class=\"ts\"/>-<span class=\"ts\"/>resize a VT</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@vc: virtual console</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@cols: columns</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@rows: rows</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Resize a virtual console as seen from the console end of things. We</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>use the common vc_do_resize methods to update the structures. The</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>caller must hold the console sem to protect console internals and</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>vc-&gt;port.tty</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#vc_resize\">vc_resize</a>(struct <a class=\"id\" href=\"#vc_data\">vc_data</a> *<a class=\"id\" href=\"#vc\">vc</a>, unsigned int <a class=\"id\" href=\"#cols\">cols</a>, unsigned int <a class=\"id\" href=\"#rows\">rows</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#vc_do_resize\">vc_do_resize</a>(<a class=\"id\" href=\"#vc\">vc</a>-><a class=\"id\" href=\"#port\">port</a>.<a class=\"id\" href=\"#tty\">tty</a>, <a class=\"id\" href=\"#vc\">vc</a>, <a class=\"id\" href=\"#cols\">cols</a>, <a class=\"id\" href=\"#rows\">rows</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>vt_resize<span class=\"ts\"/><span class=\"ts\"/>-<span class=\"ts\"/>resize a VT</span>", 
];
xr_frag_insert('l/50/743325a4b0f1800c15de4dab52906039608fa1.xr', __xr_tmp);
