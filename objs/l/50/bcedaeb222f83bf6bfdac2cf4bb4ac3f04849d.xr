var __xr_tmp = [
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#gfp\">gfp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ide\">ide</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"int <a class=\"id\" href=\"#generic_ide_suspend\">generic_ide_suspend</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pm_message_t\">pm_message_t</a> <a class=\"id\" href=\"#mesg\">mesg</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a> = <a class=\"id\" href=\"#dev_get_drvdata\">dev_get_drvdata</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#pair\">pair</a> = <a class=\"id\" href=\"#ide_get_pair_dev\">ide_get_pair_dev</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_hwif_t\">ide_hwif_t</a> *<a class=\"id\" href=\"#hwif\">hwif</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_pm_state\">request_pm_state</a> <a class=\"id\" href=\"#rqpm\">rqpm</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ide_port_acpi\">ide_port_acpi</a>(<a class=\"id\" href=\"#hwif\">hwif</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* call ACPI _GTM only once */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dn\">dn</a> &amp; 1) == 0 || <a class=\"id\" href=\"#pair\">pair</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_acpi_get_timing\">ide_acpi_get_timing</a>(<a class=\"id\" href=\"#hwif\">hwif</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#rqpm\">rqpm</a>, 0, sizeof(<a class=\"id\" href=\"#rqpm\">rqpm</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a> = <a class=\"id\" href=\"#blk_get_request\">blk_get_request</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#queue\">queue</a>, <a class=\"id\" href=\"#READ\">READ</a>, <a class=\"id\" href=\"#__GFP_WAIT\">__GFP_WAIT</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> = <a class=\"id\" href=\"#REQ_TYPE_PM_SUSPEND\">REQ_TYPE_PM_SUSPEND</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a> = &amp;<a class=\"id\" href=\"#rqpm\">rqpm</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rqpm\">rqpm</a>.<a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_START_SUSPEND\">IDE_PM_START_SUSPEND</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#mesg\">mesg</a>.<a class=\"id\" href=\"#event\">event</a> == <a class=\"id\" href=\"#PM_EVENT_PRETHAW\">PM_EVENT_PRETHAW</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mesg\">mesg</a>.<a class=\"id\" href=\"#event\">event</a> = <a class=\"id\" href=\"#PM_EVENT_FREEZE\">PM_EVENT_FREEZE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rqpm\">rqpm</a>.<a class=\"id\" href=\"#pm_state\">pm_state</a> = <a class=\"id\" href=\"#mesg\">mesg</a>.<a class=\"id\" href=\"#event\">event</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#blk_execute_rq\">blk_execute_rq</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#queue\">queue</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#rq\">rq</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#blk_put_request\">blk_put_request</a>(<a class=\"id\" href=\"#rq\">rq</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> == 0 && <a class=\"id\" href=\"#ide_port_acpi\">ide_port_acpi</a>(<a class=\"id\" href=\"#hwif\">hwif</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* call ACPI _PS3 only after both devices are suspended */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dn\">dn</a> &amp; 1) || <a class=\"id\" href=\"#pair\">pair</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_acpi_set_state\">ide_acpi_set_state</a>(<a class=\"id\" href=\"#hwif\">hwif</a>, 0);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#generic_ide_resume\">generic_ide_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a> = <a class=\"id\" href=\"#dev_get_drvdata\">dev_get_drvdata</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#pair\">pair</a> = <a class=\"id\" href=\"#ide_get_pair_dev\">ide_get_pair_dev</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_hwif_t\">ide_hwif_t</a> *<a class=\"id\" href=\"#hwif\">hwif</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_pm_state\">request_pm_state</a> <a class=\"id\" href=\"#rqpm\">rqpm</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ide_port_acpi\">ide_port_acpi</a>(<a class=\"id\" href=\"#hwif\">hwif</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* call ACPI _PS0 / _STM only once */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dn\">dn</a> &amp; 1) == 0 || <a class=\"id\" href=\"#pair\">pair</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_acpi_set_state\">ide_acpi_set_state</a>(<a class=\"id\" href=\"#hwif\">hwif</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_acpi_push_timing\">ide_acpi_push_timing</a>(<a class=\"id\" href=\"#hwif\">hwif</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_acpi_exec_tfs\">ide_acpi_exec_tfs</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#rqpm\">rqpm</a>, 0, sizeof(<a class=\"id\" href=\"#rqpm\">rqpm</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a> = <a class=\"id\" href=\"#blk_get_request\">blk_get_request</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#queue\">queue</a>, <a class=\"id\" href=\"#READ\">READ</a>, <a class=\"id\" href=\"#__GFP_WAIT\">__GFP_WAIT</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> = <a class=\"id\" href=\"#REQ_TYPE_PM_RESUME\">REQ_TYPE_PM_RESUME</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_flags\">cmd_flags</a> |= <a class=\"id\" href=\"#REQ_PREEMPT\">REQ_PREEMPT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a> = &amp;<a class=\"id\" href=\"#rqpm\">rqpm</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rqpm\">rqpm</a>.<a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_START_RESUME\">IDE_PM_START_RESUME</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rqpm\">rqpm</a>.<a class=\"id\" href=\"#pm_state\">pm_state</a> = <a class=\"id\" href=\"#PM_EVENT_ON\">PM_EVENT_ON</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#blk_execute_rq\">blk_execute_rq</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#queue\">queue</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#rq\">rq</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#blk_put_request\">blk_put_request</a>(<a class=\"id\" href=\"#rq\">rq</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> == 0 && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#driver\">driver</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ide_driver\">ide_driver</a> *<a class=\"id\" href=\"#drv\">drv</a> = <a class=\"id\" href=\"#to_ide_driver\">to_ide_driver</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#driver\">driver</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#resume\">resume</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#resume\">resume</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#ide_complete_power_step\">ide_complete_power_step</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_pm_state\">request_pm_state</a> *<a class=\"id\" href=\"#pm\">pm</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#DEBUG_PM\">DEBUG_PM</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: complete_power_step(step: %d)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#media\">media</a> != <a class=\"id\" href=\"#ide_disk\">ide_disk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_FLUSH_CACHE\">IDE_PM_FLUSH_CACHE</a>:<span class=\"ts\"/><span class=\"comment\">/* Suspend step 1 (flush cache) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_state\">pm_state</a> == <a class=\"id\" href=\"#PM_EVENT_FREEZE\">PM_EVENT_FREEZE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_COMPLETED\">IDE_PM_COMPLETED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_STANDBY\">IDE_PM_STANDBY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_STANDBY\">IDE_PM_STANDBY</a>:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Suspend step 2 (standby) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_COMPLETED\">IDE_PM_COMPLETED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_RESTORE_PIO\">IDE_PM_RESTORE_PIO</a>:<span class=\"ts\"/><span class=\"comment\">/* Resume step 1 (restore PIO) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_IDLE\">IDE_PM_IDLE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_IDLE\">IDE_PM_IDLE</a>:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Resume step 2 (idle)*/</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_RESTORE_DMA\">IDE_PM_RESTORE_DMA</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<a class=\"id\" href=\"#ide_startstop_t\">ide_startstop_t</a> <a class=\"id\" href=\"#ide_start_power_step\">ide_start_power_step</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_pm_state\">request_pm_state</a> *<a class=\"id\" href=\"#pm\">pm</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ide_cmd\">ide_cmd</a> <a class=\"id\" href=\"#cmd\">cmd</a> = { };", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_FLUSH_CACHE\">IDE_PM_FLUSH_CACHE</a>:<span class=\"ts\"/><span class=\"comment\">/* Suspend step 1 (flush cache) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#media\">media</a> != <a class=\"id\" href=\"#ide_disk\">ide_disk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Not supported? Switch to next step now. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ata_id_flush_enabled\">ata_id_flush_enabled</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#id\">id</a>) == 0 ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dev_flags\">dev_flags</a> &amp; <a class=\"id\" href=\"#IDE_DFLAG_WCACHE\">IDE_DFLAG_WCACHE</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_complete_power_step\">ide_complete_power_step</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ide_stopped\">ide_stopped</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ata_id_flush_ext_enabled\">ata_id_flush_ext_enabled</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#id\">id</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf\">tf</a>.<a class=\"id\" href=\"#command\">command</a> = <a class=\"id\" href=\"#ATA_CMD_FLUSH_EXT\">ATA_CMD_FLUSH_EXT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf\">tf</a>.<a class=\"id\" href=\"#command\">command</a> = <a class=\"id\" href=\"#ATA_CMD_FLUSH\">ATA_CMD_FLUSH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_do_tf\">out_do_tf</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_STANDBY\">IDE_PM_STANDBY</a>:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Suspend step 2 (standby) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf\">tf</a>.<a class=\"id\" href=\"#command\">command</a> = <a class=\"id\" href=\"#ATA_CMD_STANDBYNOW1\">ATA_CMD_STANDBYNOW1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_do_tf\">out_do_tf</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_RESTORE_PIO\">IDE_PM_RESTORE_PIO</a>:<span class=\"ts\"/><span class=\"comment\">/* Resume step 1 (restore PIO) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_set_max_pio\">ide_set_max_pio</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * skip IDE_PM_IDLE for ATAPI devices</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#media\">media</a> != <a class=\"id\" href=\"#ide_disk\">ide_disk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_RESTORE_DMA\">IDE_PM_RESTORE_DMA</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_complete_power_step\">ide_complete_power_step</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ide_stopped\">ide_stopped</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_IDLE\">IDE_PM_IDLE</a>:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Resume step 2 (idle) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf\">tf</a>.<a class=\"id\" href=\"#command\">command</a> = <a class=\"id\" href=\"#ATA_CMD_IDLEIMMEDIATE\">ATA_CMD_IDLEIMMEDIATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_do_tf\">out_do_tf</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IDE_PM_RESTORE_DMA\">IDE_PM_RESTORE_DMA</a>:<span class=\"ts\"/><span class=\"comment\">/* Resume step 3 (restore DMA) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Right now, all we do is call ide_set_dma(drive),</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * we could be smarter and check for current xfer_speed</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * in struct drive etc...</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#dma_ops\">dma_ops</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * TODO: respect IDE_DFLAG_USING_DMA</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_set_dma\">ide_set_dma</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> = <a class=\"id\" href=\"#IDE_PM_COMPLETED\">IDE_PM_COMPLETED</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ide_stopped\">ide_stopped</a>;", 
"", 
"<a class=\"id\" href=\"#out_do_tf\">out_do_tf</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#valid\">valid</a>.<a class=\"id\" href=\"#out\">out</a>.<a class=\"id\" href=\"#tf\">tf</a> = <a class=\"id\" href=\"#IDE_VALID_OUT_TF\">IDE_VALID_OUT_TF</a> | <a class=\"id\" href=\"#IDE_VALID_DEVICE\">IDE_VALID_DEVICE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#valid\">valid</a>.<a class=\"id\" href=\"#in\">in</a>.<a class=\"id\" href=\"#tf\">tf</a>  = <a class=\"id\" href=\"#IDE_VALID_IN_TF\">IDE_VALID_IN_TF</a>  | <a class=\"id\" href=\"#IDE_VALID_DEVICE\">IDE_VALID_DEVICE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#ATA_PROT_NODATA\">ATA_PROT_NODATA</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#do_rw_taskfile\">do_rw_taskfile</a>(<a class=\"id\" href=\"#drive\">drive</a>, &amp;<a class=\"id\" href=\"#cmd\">cmd</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>ide_complete_pm_rq - end the current Power Management request</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@drive: target drive</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@rq: request</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>This function cleans up the current PM request and stops the queue</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>if necessary.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#ide_complete_pm_rq\">ide_complete_pm_rq</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_queue\">request_queue</a> *<a class=\"id\" href=\"#q\">q</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#queue\">queue</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_pm_state\">request_pm_state</a> *<a class=\"id\" href=\"#pm\">pm</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_complete_power_step\">ide_complete_power_step</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> != <a class=\"id\" href=\"#IDE_PM_COMPLETED\">IDE_PM_COMPLETED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#DEBUG_PM\">DEBUG_PM</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"%s: completing PM request, %s\\n\", <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>,", 
"<span class=\"ts\"/>       (<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_PM_SUSPEND\">REQ_TYPE_PM_SUSPEND</a>) ? \"suspend\" : \"resume\");", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(<a class=\"id\" href=\"#q\">q</a>-><a class=\"id\" href=\"#queue_lock\">queue_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_PM_SUSPEND\">REQ_TYPE_PM_SUSPEND</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#blk_stop_queue\">blk_stop_queue</a>(<a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dev_flags\">dev_flags</a> &= ~<a class=\"id\" href=\"#IDE_DFLAG_BLOCKED\">IDE_DFLAG_BLOCKED</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(<a class=\"id\" href=\"#q\">q</a>-><a class=\"id\" href=\"#queue_lock\">queue_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#rq\">rq</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#blk_end_request\">blk_end_request</a>(<a class=\"id\" href=\"#rq\">rq</a>, 0, 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"}", 
"", 
"void <a class=\"id\" href=\"#ide_check_pm_state\">ide_check_pm_state</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_pm_state\">request_pm_state</a> *<a class=\"id\" href=\"#pm\">pm</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_PM_SUSPEND\">REQ_TYPE_PM_SUSPEND</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> == <a class=\"id\" href=\"#IDE_PM_START_SUSPEND\">IDE_PM_START_SUSPEND</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Mark drive blocked when starting the suspend sequence. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dev_flags\">dev_flags</a> |= <a class=\"id\" href=\"#IDE_DFLAG_BLOCKED\">IDE_DFLAG_BLOCKED</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_PM_RESUME\">REQ_TYPE_PM_RESUME</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> == <a class=\"id\" href=\"#IDE_PM_START_RESUME\">IDE_PM_START_RESUME</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * The first thing we do on wakeup is to wait for BSY bit to</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * go away (with a looong timeout) as a drive on this hwif may</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * just be POSTing itself.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * We do that before even selecting as the \"other\" device on</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * the bus may be broken enough to walk on our toes at this</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * point.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_hwif_t\">ide_hwif_t</a> *<a class=\"id\" href=\"#hwif\">hwif</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#ide_tp_ops\">ide_tp_ops</a> *<a class=\"id\" href=\"#tp_ops\">tp_ops</a> = <a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#tp_ops\">tp_ops</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#request_queue\">request_queue</a> *<a class=\"id\" href=\"#q\">q</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#queue\">queue</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#DEBUG_PM\">DEBUG_PM</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"%s: Wakeup request inited, waiting for !BSY...\\n\", <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#ide_wait_not_busy\">ide_wait_not_busy</a>(<a class=\"id\" href=\"#hwif\">hwif</a>, 35000);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"%s: bus not ready on wakeup\\n\", <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tp_ops\">tp_ops</a>-><a class=\"id\" href=\"#dev_select\">dev_select</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tp_ops\">tp_ops</a>-><a class=\"id\" href=\"#write_devctl\">write_devctl</a>(<a class=\"id\" href=\"#hwif\">hwif</a>, <a class=\"id\" href=\"#ATA_DEVCTL_OBS\">ATA_DEVCTL_OBS</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#ide_wait_not_busy\">ide_wait_not_busy</a>(<a class=\"id\" href=\"#hwif\">hwif</a>, 100000);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"%s: drive not ready on wakeup\\n\", <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(<a class=\"id\" href=\"#q\">q</a>-><a class=\"id\" href=\"#queue_lock\">queue_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#blk_start_queue\">blk_start_queue</a>(<a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(<a class=\"id\" href=\"#q\">q</a>-><a class=\"id\" href=\"#queue_lock\">queue_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>}", 
"}", 
];
xr_frag_insert('l/50/bcedaeb222f83bf6bfdac2cf4bb4ac3f04849d.xr', __xr_tmp);
