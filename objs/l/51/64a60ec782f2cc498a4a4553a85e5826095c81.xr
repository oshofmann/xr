var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * fs/sysfs/inode.c - basic sysfs inode and dentry operations</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (c) 2001-3 Patrick Mochel</span>", 
"<span class=\"comment\"> * Copyright (c) 2007 SUSE Linux Products GmbH</span>", 
"<span class=\"comment\"> * Copyright (c) 2007 Tejun Heo &lt;teheo@suse.de&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This file is released under the GPLv2.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Please see Documentation/filesystems/sysfs.txt for more information.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#DEBUG\">DEBUG</a> ", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pagemap\">pagemap</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#namei\">namei</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#backing\">backing</a>-<a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#capability\">capability</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sched\">sched</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#xattr\">xattr</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#security\">security</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"sysfs.h\"", 
"", 
"extern struct <a class=\"id\" href=\"#super_block\">super_block</a> * <a class=\"id\" href=\"#sysfs_sb\">sysfs_sb</a>;", 
"", 
"static const struct <a class=\"id\" href=\"#address_space_operations\">address_space_operations</a> <a class=\"id\" href=\"#sysfs_aops\">sysfs_aops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#readpage\">readpage</a><span class=\"ts\"/>= <a class=\"id\" href=\"#simple_readpage\">simple_readpage</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#write_begin\">write_begin</a><span class=\"ts\"/>= <a class=\"id\" href=\"#simple_write_begin\">simple_write_begin</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#write_end\">write_end</a><span class=\"ts\"/>= <a class=\"id\" href=\"#simple_write_end\">simple_write_end</a>,", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#backing_dev_info\">backing_dev_info</a> <a class=\"id\" href=\"#sysfs_backing_dev_info\">sysfs_backing_dev_info</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a><span class=\"ts\"/><span class=\"ts\"/>= \"sysfs\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#ra_pages\">ra_pages</a><span class=\"ts\"/>= 0,<span class=\"ts\"/><span class=\"comment\">/* No readahead */</span>", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#capabilities\">capabilities</a><span class=\"ts\"/>= <a class=\"id\" href=\"#BDI_CAP_NO_ACCT_AND_WRITEBACK\">BDI_CAP_NO_ACCT_AND_WRITEBACK</a>,", 
"};", 
"", 
"static const struct <a class=\"id\" href=\"#inode_operations\">inode_operations</a> <a class=\"id\" href=\"#sysfs_inode_operations\">sysfs_inode_operations</a> ={", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#permission\">permission</a><span class=\"ts\"/>= <a class=\"id\" href=\"#sysfs_permission\">sysfs_permission</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#setattr\">setattr</a><span class=\"ts\"/>= <a class=\"id\" href=\"#sysfs_setattr\">sysfs_setattr</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#getattr\">getattr</a><span class=\"ts\"/>= <a class=\"id\" href=\"#sysfs_getattr\">sysfs_getattr</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#setxattr\">setxattr</a><span class=\"ts\"/>= <a class=\"id\" href=\"#sysfs_setxattr\">sysfs_setxattr</a>,", 
"};", 
"", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#sysfs_inode_init\">sysfs_inode_init</a>(void)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#bdi_init\">bdi_init</a>(&amp;<a class=\"id\" href=\"#sysfs_backing_dev_info\">sysfs_backing_dev_info</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#sysfs_inode_attrs\">sysfs_inode_attrs</a> *<a class=\"id\" href=\"#sysfs_init_inode_attrs\">sysfs_init_inode_attrs</a>(struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_inode_attrs\">sysfs_inode_attrs</a> *<a class=\"id\" href=\"#attrs\">attrs</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iattr\">iattr</a> *<a class=\"id\" href=\"#iattrs\">iattrs</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#attrs\">attrs</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#sysfs_inode_attrs\">sysfs_inode_attrs</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#attrs\">attrs</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a> = &amp;<a class=\"id\" href=\"#attrs\">attrs</a>-><a class=\"id\" href=\"#ia_iattr\">ia_iattr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* assign default attributes */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_mode\">ia_mode</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_mode\">s_mode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_uid\">ia_uid</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_gid\">ia_gid</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_atime\">ia_atime</a> = <a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_mtime\">ia_mtime</a> = <a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_ctime\">ia_ctime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#attrs\">attrs</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#sysfs_sd_setattr\">sysfs_sd_setattr</a>(struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>, struct <a class=\"id\" href=\"#iattr\">iattr</a> * <a class=\"id\" href=\"#iattr\">iattr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_inode_attrs\">sysfs_inode_attrs</a> *<a class=\"id\" href=\"#sd_attrs\">sd_attrs</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iattr\">iattr</a> *<a class=\"id\" href=\"#iattrs\">iattrs</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#ia_valid\">ia_valid</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_valid\">ia_valid</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sd_attrs\">sd_attrs</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_iattr\">s_iattr</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sd_attrs\">sd_attrs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* setting attributes for the first time, allocate now */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sd_attrs\">sd_attrs</a> = <a class=\"id\" href=\"#sysfs_init_inode_attrs\">sysfs_init_inode_attrs</a>(<a class=\"id\" href=\"#sd\">sd</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#sd_attrs\">sd_attrs</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_iattr\">s_iattr</a> = <a class=\"id\" href=\"#sd_attrs\">sd_attrs</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"comment\">/* attributes were changed at least once in past */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a> = &amp;<a class=\"id\" href=\"#sd_attrs\">sd_attrs</a>-><a class=\"id\" href=\"#ia_iattr\">ia_iattr</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ia_valid\">ia_valid</a> &amp; <a class=\"id\" href=\"#ATTR_UID\">ATTR_UID</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_uid\">ia_uid</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_uid\">ia_uid</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ia_valid\">ia_valid</a> &amp; <a class=\"id\" href=\"#ATTR_GID\">ATTR_GID</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_gid\">ia_gid</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_gid\">ia_gid</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ia_valid\">ia_valid</a> &amp; <a class=\"id\" href=\"#ATTR_ATIME\">ATTR_ATIME</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_atime\">ia_atime</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_atime\">ia_atime</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ia_valid\">ia_valid</a> &amp; <a class=\"id\" href=\"#ATTR_MTIME\">ATTR_MTIME</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_mtime\">ia_mtime</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_mtime\">ia_mtime</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ia_valid\">ia_valid</a> &amp; <a class=\"id\" href=\"#ATTR_CTIME\">ATTR_CTIME</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_ctime\">ia_ctime</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_ctime\">ia_ctime</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ia_valid\">ia_valid</a> &amp; <a class=\"id\" href=\"#ATTR_MODE\">ATTR_MODE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#umode_t\">umode_t</a> <a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_mode\">ia_mode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_mode\">ia_mode</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_mode\">s_mode</a> = <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#sysfs_setattr\">sysfs_setattr</a>(struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, struct <a class=\"id\" href=\"#iattr\">iattr</a> *<a class=\"id\" href=\"#iattr\">iattr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a> = <a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_fsdata\">d_fsdata</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sd\">sd</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#inode_change_ok\">inode_change_ok</a>(<a class=\"id\" href=\"#inode\">inode</a>, <a class=\"id\" href=\"#iattr\">iattr</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#sysfs_sd_setattr\">sysfs_sd_setattr</a>(<a class=\"id\" href=\"#sd\">sd</a>, <a class=\"id\" href=\"#iattr\">iattr</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* this ignores size changes */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setattr_copy\">setattr_copy</a>(<a class=\"id\" href=\"#inode\">inode</a>, <a class=\"id\" href=\"#iattr\">iattr</a>);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#sysfs_sd_setsecdata\">sysfs_sd_setsecdata</a>(struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>, void **<a class=\"id\" href=\"#secdata\">secdata</a>, <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#secdata_len\">secdata_len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_inode_attrs\">sysfs_inode_attrs</a> *<a class=\"id\" href=\"#iattrs\">iattrs</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#old_secdata\">old_secdata</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#old_secdata_len\">old_secdata_len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_iattr\">s_iattr</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#iattrs\">iattrs</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a> = <a class=\"id\" href=\"#sysfs_init_inode_attrs\">sysfs_init_inode_attrs</a>(<a class=\"id\" href=\"#sd\">sd</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#iattrs\">iattrs</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_secdata\">old_secdata</a> = <a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_secdata\">ia_secdata</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_secdata_len\">old_secdata_len</a> = <a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_secdata_len\">ia_secdata_len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_secdata\">ia_secdata</a> = *<a class=\"id\" href=\"#secdata\">secdata</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_secdata_len\">ia_secdata_len</a> = *<a class=\"id\" href=\"#secdata_len\">secdata_len</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#secdata\">secdata</a> = <a class=\"id\" href=\"#old_secdata\">old_secdata</a>;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#secdata_len\">secdata_len</a> = <a class=\"id\" href=\"#old_secdata_len\">old_secdata_len</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#sysfs_setxattr\">sysfs_setxattr</a>(struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, const char *<a class=\"id\" href=\"#name\">name</a>, const void *<a class=\"id\" href=\"#value\">value</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>, int <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a> = <a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_fsdata\">d_fsdata</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#secdata\">secdata</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secdata_len\">secdata_len</a> = 0;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sd\">sd</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strncmp\">strncmp</a>(<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#XATTR_SECURITY_PREFIX\">XATTR_SECURITY_PREFIX</a>, <a class=\"id\" href=\"#XATTR_SECURITY_PREFIX_LEN\">XATTR_SECURITY_PREFIX_LEN</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const char *<a class=\"id\" href=\"#suffix\">suffix</a> = <a class=\"id\" href=\"#name\">name</a> + <a class=\"id\" href=\"#XATTR_SECURITY_PREFIX_LEN\">XATTR_SECURITY_PREFIX_LEN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#security_inode_setsecurity\">security_inode_setsecurity</a>(<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>, <a class=\"id\" href=\"#suffix\">suffix</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#value\">value</a>, <a class=\"id\" href=\"#size\">size</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#security_inode_getsecctx\">security_inode_getsecctx</a>(<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#secdata\">secdata</a>, &amp;<a class=\"id\" href=\"#secdata_len\">secdata_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#sysfs_sd_setsecdata\">sysfs_sd_setsecdata</a>(<a class=\"id\" href=\"#sd\">sd</a>, &amp;<a class=\"id\" href=\"#secdata\">secdata</a>, &amp;<a class=\"id\" href=\"#secdata_len\">secdata_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#secdata\">secdata</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_release_secctx\">security_release_secctx</a>(<a class=\"id\" href=\"#secdata\">secdata</a>, <a class=\"id\" href=\"#secdata_len\">secdata_len</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#set_default_inode_attr\">set_default_inode_attr</a>(struct <a class=\"id\" href=\"#inode\">inode</a> * <a class=\"id\" href=\"#inode\">inode</a>, <a class=\"id\" href=\"#mode_t\">mode_t</a> <a class=\"id\" href=\"#mode\">mode</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a> = <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mtime\">i_mtime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#set_inode_attr\">set_inode_attr</a>(struct <a class=\"id\" href=\"#inode\">inode</a> * <a class=\"id\" href=\"#inode\">inode</a>, struct <a class=\"id\" href=\"#iattr\">iattr</a> * <a class=\"id\" href=\"#iattr\">iattr</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_uid\">i_uid</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_uid\">ia_uid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_gid\">i_gid</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_gid\">ia_gid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_atime\">ia_atime</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mtime\">i_mtime</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_mtime\">ia_mtime</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#iattr\">iattr</a>-><a class=\"id\" href=\"#ia_ctime\">ia_ctime</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#sysfs_count_nlink\">sysfs_count_nlink</a>(struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#child\">child</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nr\">nr</a> = 0;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#child\">child</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_dir\">s_dir</a>.<a class=\"id\" href=\"#children\">children</a>; <a class=\"id\" href=\"#child\">child</a>; <a class=\"id\" href=\"#child\">child</a> = <a class=\"id\" href=\"#child\">child</a>-><a class=\"id\" href=\"#s_sibling\">s_sibling</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sysfs_type\">sysfs_type</a>(<a class=\"id\" href=\"#child\">child</a>) == <a class=\"id\" href=\"#SYSFS_DIR\">SYSFS_DIR</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr\">nr</a>++;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#nr\">nr</a> + 2;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#sysfs_refresh_inode\">sysfs_refresh_inode</a>(struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>, struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_inode_attrs\">sysfs_inode_attrs</a> *<a class=\"id\" href=\"#iattrs\">iattrs</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_iattr\">s_iattr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_mode\">s_mode</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iattrs\">iattrs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* sysfs_dirent has non-default attributes</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * get them from persistent copy in sysfs_dirent</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_inode_attr\">set_inode_attr</a>(<a class=\"id\" href=\"#inode\">inode</a>, &amp;<a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_iattr\">ia_iattr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_inode_notifysecctx\">security_inode_notifysecctx</a>(<a class=\"id\" href=\"#inode\">inode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_secdata\">ia_secdata</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#iattrs\">iattrs</a>-><a class=\"id\" href=\"#ia_secdata_len\">ia_secdata_len</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sysfs_type\">sysfs_type</a>(<a class=\"id\" href=\"#sd\">sd</a>) == <a class=\"id\" href=\"#SYSFS_DIR\">SYSFS_DIR</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_nlink\">i_nlink</a> = <a class=\"id\" href=\"#sysfs_count_nlink\">sysfs_count_nlink</a>(<a class=\"id\" href=\"#sd\">sd</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#sysfs_getattr\">sysfs_getattr</a>(struct <a class=\"id\" href=\"#vfsmount\">vfsmount</a> *<a class=\"id\" href=\"#mnt\">mnt</a>, struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, struct <a class=\"id\" href=\"#kstat\">kstat</a> *<a class=\"id\" href=\"#stat\">stat</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a> = <a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_fsdata\">d_fsdata</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sysfs_refresh_inode\">sysfs_refresh_inode</a>(<a class=\"id\" href=\"#sd\">sd</a>, <a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#generic_fillattr\">generic_fillattr</a>(<a class=\"id\" href=\"#inode\">inode</a>, <a class=\"id\" href=\"#stat\">stat</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#sysfs_init_inode\">sysfs_init_inode</a>(struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>, struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#bin_attribute\">bin_attribute</a> *<a class=\"id\" href=\"#bin_attr\">bin_attr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_private\">i_private</a> = <a class=\"id\" href=\"#sysfs_get\">sysfs_get</a>(<a class=\"id\" href=\"#sd\">sd</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mapping\">i_mapping</a>-><a class=\"id\" href=\"#a_ops\">a_ops</a> = &amp;<a class=\"id\" href=\"#sysfs_aops\">sysfs_aops</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mapping\">i_mapping</a>-><a class=\"id\" href=\"#backing_dev_info\">backing_dev_info</a> = &amp;<a class=\"id\" href=\"#sysfs_backing_dev_info\">sysfs_backing_dev_info</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_op\">i_op</a> = &amp;<a class=\"id\" href=\"#sysfs_inode_operations\">sysfs_inode_operations</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_default_inode_attr\">set_default_inode_attr</a>(<a class=\"id\" href=\"#inode\">inode</a>, <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_mode\">s_mode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sysfs_refresh_inode\">sysfs_refresh_inode</a>(<a class=\"id\" href=\"#sd\">sd</a>, <a class=\"id\" href=\"#inode\">inode</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* initialize inode according to type */</span>", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#sysfs_type\">sysfs_type</a>(<a class=\"id\" href=\"#sd\">sd</a>)) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SYSFS_DIR\">SYSFS_DIR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_op\">i_op</a> = &amp;<a class=\"id\" href=\"#sysfs_dir_inode_operations\">sysfs_dir_inode_operations</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_fop\">i_fop</a> = &amp;<a class=\"id\" href=\"#sysfs_dir_operations\">sysfs_dir_operations</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SYSFS_KOBJ_ATTR\">SYSFS_KOBJ_ATTR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_size\">i_size</a> = <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_fop\">i_fop</a> = &amp;<a class=\"id\" href=\"#sysfs_file_operations\">sysfs_file_operations</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SYSFS_KOBJ_BIN_ATTR\">SYSFS_KOBJ_BIN_ATTR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bin_attr\">bin_attr</a> = <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_bin_attr\">s_bin_attr</a>.<a class=\"id\" href=\"#bin_attr\">bin_attr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_size\">i_size</a> = <a class=\"id\" href=\"#bin_attr\">bin_attr</a>-><a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_fop\">i_fop</a> = &amp;<a class=\"id\" href=\"#bin_fops\">bin_fops</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SYSFS_KOBJ_LINK\">SYSFS_KOBJ_LINK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_op\">i_op</a> = &amp;<a class=\"id\" href=\"#sysfs_symlink_inode_operations\">sysfs_symlink_inode_operations</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unlock_new_inode\">unlock_new_inode</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>sysfs_get_inode - get inode for sysfs_dirent</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@sb: super block</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@sd: sysfs_dirent to allocate inode for</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Get inode for @sd.  If such inode doesn't exist, a new inode</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>is allocated and basics are initialized.  New inode is</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>returned locked.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>LOCKING:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Kernel thread context (may sleep).</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>RETURNS:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Pointer to allocated inode on success, NULL on failure.</span>", 
"<span class=\"comment\"> */</span>", 
"struct <a class=\"id\" href=\"#inode\">inode</a> * <a class=\"id\" href=\"#sysfs_get_inode\">sysfs_get_inode</a>(struct <a class=\"id\" href=\"#super_block\">super_block</a> *<a class=\"id\" href=\"#sb\">sb</a>, struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#iget_locked\">iget_locked</a>(<a class=\"id\" href=\"#sb\">sb</a>, <a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_ino\">s_ino</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#inode\">inode</a> && (<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_state\">i_state</a> &amp; <a class=\"id\" href=\"#I_NEW\">I_NEW</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sysfs_init_inode\">sysfs_init_inode</a>(<a class=\"id\" href=\"#sd\">sd</a>, <a class=\"id\" href=\"#inode\">inode</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#inode\">inode</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * The sysfs_dirent serves as both an inode and a directory entry for sysfs.</span>", 
"<span class=\"comment\"> * To prevent the sysfs inode numbers from being freed prematurely we take a</span>", 
"<span class=\"comment\"> * reference to sysfs_dirent from the sysfs inode.  A</span>", 
"<span class=\"comment\"> * super_operations.evict_inode() implementation is needed to drop that</span>", 
"<span class=\"comment\"> * reference upon inode destruction.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#sysfs_evict_inode\">sysfs_evict_inode</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>  = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_private\">i_private</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#truncate_inode_pages\">truncate_inode_pages</a>(&amp;<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_data\">i_data</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#end_writeback\">end_writeback</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sysfs_put\">sysfs_put</a>(<a class=\"id\" href=\"#sd\">sd</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#sysfs_hash_and_remove\">sysfs_hash_and_remove</a>(struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#dir_sd\">dir_sd</a>, const void *<a class=\"id\" href=\"#ns\">ns</a>, const char *<a class=\"id\" href=\"#name\">name</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_addrm_cxt\">sysfs_addrm_cxt</a> <a class=\"id\" href=\"#acxt\">acxt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dir_sd\">dir_sd</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sysfs_addrm_start\">sysfs_addrm_start</a>(&amp;<a class=\"id\" href=\"#acxt\">acxt</a>, <a class=\"id\" href=\"#dir_sd\">dir_sd</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sd\">sd</a> = <a class=\"id\" href=\"#sysfs_find_dirent\">sysfs_find_dirent</a>(<a class=\"id\" href=\"#dir_sd\">dir_sd</a>, <a class=\"id\" href=\"#ns\">ns</a>, <a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sd\">sd</a> && (<a class=\"id\" href=\"#sd\">sd</a>-><a class=\"id\" href=\"#s_ns\">s_ns</a> != <a class=\"id\" href=\"#ns\">ns</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sd\">sd</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sd\">sd</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sysfs_remove_one\">sysfs_remove_one</a>(&amp;<a class=\"id\" href=\"#acxt\">acxt</a>, <a class=\"id\" href=\"#sd\">sd</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sysfs_addrm_finish\">sysfs_addrm_finish</a>(&amp;<a class=\"id\" href=\"#acxt\">acxt</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sd\">sd</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#sysfs_permission\">sysfs_permission</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>, int <a class=\"id\" href=\"#mask\">mask</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sysfs_dirent\">sysfs_dirent</a> *<a class=\"id\" href=\"#sd\">sd</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_private\">i_private</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sysfs_refresh_inode\">sysfs_refresh_inode</a>(<a class=\"id\" href=\"#sd\">sd</a>, <a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#sysfs_mutex\">sysfs_mutex</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#generic_permission\">generic_permission</a>(<a class=\"id\" href=\"#inode\">inode</a>, <a class=\"id\" href=\"#mask\">mask</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"}", 
];
xr_frag_insert('l/51/64a60ec782f2cc498a4a4553a85e5826095c81.xr', __xr_tmp);
