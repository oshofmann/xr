var __xr_tmp = [
"<span class=\"comment\"> * Perform a label mapping to translate a CIPSO bitmap to the correct local</span>", 
"<span class=\"comment\"> * MLS category bitmap using the given DOI definition.  Returns zero on</span>", 
"<span class=\"comment\"> * success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_map_cat_rbm_ntoh\">cipso_v4_map_cat_rbm_ntoh</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const unsigned char *<a class=\"id\" href=\"#net_cat\">net_cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#net_spot\">net_spot</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#host_spot\">host_spot</a> = <a class=\"id\" href=\"#CIPSO_V4_INV_CAT\">CIPSO_V4_INV_CAT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_clen_bits\">net_clen_bits</a> = <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a> * 8;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_cat_size\">net_cat_size</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#net_cat_array\">net_cat_array</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#CIPSO_V4_MAP_TRANS\">CIPSO_V4_MAP_TRANS</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net_cat_size\">net_cat_size</a> = <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso_size\">cipso_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net_cat_array\">net_cat_array</a> = <a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#map\">map</a>.<a class=\"id\" href=\"#std\">std</a>-><a class=\"id\" href=\"#cat\">cat</a>.<a class=\"id\" href=\"#cipso\">cipso</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net_spot\">net_spot</a> = <a class=\"id\" href=\"#cipso_v4_bitmap_walk\">cipso_v4_bitmap_walk</a>(<a class=\"id\" href=\"#net_cat\">net_cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net_clen_bits\">net_clen_bits</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net_spot\">net_spot</a> + 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>1);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#net_spot\">net_spot</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#net_spot\">net_spot</a> == -2)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_PASS\">CIPSO_V4_MAP_PASS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#host_spot\">host_spot</a> = <a class=\"id\" href=\"#net_spot\">net_spot</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#CIPSO_V4_MAP_TRANS\">CIPSO_V4_MAP_TRANS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#net_spot\">net_spot</a> >= <a class=\"id\" href=\"#net_cat_size\">net_cat_size</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#host_spot\">host_spot</a> = <a class=\"id\" href=\"#net_cat_array\">net_cat_array</a>[<a class=\"id\" href=\"#net_spot\">net_spot</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#host_spot\">host_spot</a> >= <a class=\"id\" href=\"#CIPSO_V4_INV_CAT\">CIPSO_V4_INV_CAT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_secattr_catmap_setbit\">netlbl_secattr_catmap_setbit</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#host_spot\">host_spot</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_map_cat_enum_valid - Checks to see if the categories are valid</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @enumcat: category list</span>", 
"<span class=\"comment\"> * @enumcat_len: length of the category list in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Checks the given categories against the given DOI definition and returns a</span>", 
"<span class=\"comment\"> * negative value if any of the categories do not have a valid mapping and a</span>", 
"<span class=\"comment\"> * zero value if all of the categories are valid.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_map_cat_enum_valid\">cipso_v4_map_cat_enum_valid</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const unsigned char *<a class=\"id\" href=\"#enumcat\">enumcat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#enumcat_len\">enumcat_len</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cat\">cat</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#cat_prev\">cat_prev</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#CIPSO_V4_MAP_PASS\">CIPSO_V4_MAP_PASS</a> || <a class=\"id\" href=\"#enumcat_len\">enumcat_len</a> &amp; 0x01)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#enumcat_len\">enumcat_len</a>; <a class=\"id\" href=\"#iter\">iter</a> += 2) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat\">cat</a> = <a class=\"id\" href=\"#get_unaligned_be16\">get_unaligned_be16</a>(&amp;<a class=\"id\" href=\"#enumcat\">enumcat</a>[<a class=\"id\" href=\"#iter\">iter</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cat\">cat</a> <= <a class=\"id\" href=\"#cat_prev\">cat_prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_prev\">cat_prev</a> = <a class=\"id\" href=\"#cat\">cat</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_map_cat_enum_hton - Perform a category mapping from host to network</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> * @net_cat: the zero'd out category list in network/CIPSO format</span>", 
"<span class=\"comment\"> * @net_cat_len: the length of the CIPSO category list in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Perform a label mapping to translate a local MLS category bitmap to the</span>", 
"<span class=\"comment\"> * correct CIPSO category list using the given DOI definition.   Returns the</span>", 
"<span class=\"comment\"> * size in bytes of the network category bitmap on success, negative values</span>", 
"<span class=\"comment\"> * otherwise.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_map_cat_enum_hton\">cipso_v4_map_cat_enum_hton</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      unsigned char *<a class=\"id\" href=\"#net_cat\">net_cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#cat\">cat</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cat_iter\">cat_iter</a> = 0;", 
"", 
"<span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat\">cat</a> = <a class=\"id\" href=\"#netlbl_secattr_catmap_walk\">netlbl_secattr_catmap_walk</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#cat\">cat</a> + 1);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cat\">cat</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#cat_iter\">cat_iter</a> + 2) &gt; <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOSPC\">ENOSPC</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>*((<a class=\"id\" href=\"#__be16\">__be16</a> *)&amp;<a class=\"id\" href=\"#net_cat\">net_cat</a>[<a class=\"id\" href=\"#cat_iter\">cat_iter</a>]) = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#cat\">cat</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_iter\">cat_iter</a> += 2;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#cat_iter\">cat_iter</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_map_cat_enum_ntoh - Perform a category mapping from network to host</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @net_cat: the category list in network/CIPSO format</span>", 
"<span class=\"comment\"> * @net_cat_len: the length of the CIPSO bitmap in bytes</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Perform a label mapping to translate a CIPSO category list to the correct</span>", 
"<span class=\"comment\"> * local MLS category bitmap using the given DOI definition.  Returns zero on</span>", 
"<span class=\"comment\"> * success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_map_cat_enum_ntoh\">cipso_v4_map_cat_enum_ntoh</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const unsigned char *<a class=\"id\" href=\"#net_cat\">net_cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>; <a class=\"id\" href=\"#iter\">iter</a> += 2) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_secattr_catmap_setbit\">netlbl_secattr_catmap_setbit</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#get_unaligned_be16\">get_unaligned_be16</a>(&amp;<a class=\"id\" href=\"#net_cat\">net_cat</a>[<a class=\"id\" href=\"#iter\">iter</a>]),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_map_cat_rng_valid - Checks to see if the categories are valid</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @rngcat: category list</span>", 
"<span class=\"comment\"> * @rngcat_len: length of the category list in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Checks the given categories against the given DOI definition and returns a</span>", 
"<span class=\"comment\"> * negative value if any of the categories do not have a valid mapping and a</span>", 
"<span class=\"comment\"> * zero value if all of the categories are valid.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_map_cat_rng_valid\">cipso_v4_map_cat_rng_valid</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const unsigned char *<a class=\"id\" href=\"#rngcat\">rngcat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#rngcat_len\">rngcat_len</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cat_high\">cat_high</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cat_low\">cat_low</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cat_prev\">cat_prev</a> = <a class=\"id\" href=\"#CIPSO_V4_MAX_REM_CATS\">CIPSO_V4_MAX_REM_CATS</a> + 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#CIPSO_V4_MAP_PASS\">CIPSO_V4_MAP_PASS</a> || <a class=\"id\" href=\"#rngcat_len\">rngcat_len</a> &amp; 0x01)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#rngcat_len\">rngcat_len</a>; <a class=\"id\" href=\"#iter\">iter</a> += 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_high\">cat_high</a> = <a class=\"id\" href=\"#get_unaligned_be16\">get_unaligned_be16</a>(&amp;<a class=\"id\" href=\"#rngcat\">rngcat</a>[<a class=\"id\" href=\"#iter\">iter</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#iter\">iter</a> + 4) <= <a class=\"id\" href=\"#rngcat_len\">rngcat_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_low\">cat_low</a> = <a class=\"id\" href=\"#get_unaligned_be16\">get_unaligned_be16</a>(&amp;<a class=\"id\" href=\"#rngcat\">rngcat</a>[<a class=\"id\" href=\"#iter\">iter</a> + 2]);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_low\">cat_low</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cat_high\">cat_high</a> &gt; <a class=\"id\" href=\"#cat_prev\">cat_prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_prev\">cat_prev</a> = <a class=\"id\" href=\"#cat_low\">cat_low</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_map_cat_rng_hton - Perform a category mapping from host to network</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> * @net_cat: the zero'd out category list in network/CIPSO format</span>", 
"<span class=\"comment\"> * @net_cat_len: the length of the CIPSO category list in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Perform a label mapping to translate a local MLS category bitmap to the</span>", 
"<span class=\"comment\"> * correct CIPSO category list using the given DOI definition.   Returns the</span>", 
"<span class=\"comment\"> * size in bytes of the network category bitmap on success, negative values</span>", 
"<span class=\"comment\"> * otherwise.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_map_cat_rng_hton\">cipso_v4_map_cat_rng_hton</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     unsigned char *<a class=\"id\" href=\"#net_cat\">net_cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#iter\">iter</a> = -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#array\">array</a>[<a class=\"id\" href=\"#CIPSO_V4_TAG_RNG_CAT_MAX\">CIPSO_V4_TAG_RNG_CAT_MAX</a> * 2];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#array_cnt\">array_cnt</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cat_size\">cat_size</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* make sure we don't overflow the 'array[]' variable */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#net_cat_len\">net_cat_len</a> &gt;", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#CIPSO_V4_OPT_LEN_MAX\">CIPSO_V4_OPT_LEN_MAX</a> - <a class=\"id\" href=\"#CIPSO_V4_HDR_LEN\">CIPSO_V4_HDR_LEN</a> - <a class=\"id\" href=\"#CIPSO_V4_TAG_RNG_BLEN\">CIPSO_V4_TAG_RNG_BLEN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOSPC\">ENOSPC</a>;", 
"", 
"<span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter\">iter</a> = <a class=\"id\" href=\"#netlbl_secattr_catmap_walk\">netlbl_secattr_catmap_walk</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#iter\">iter</a> + 1);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter\">iter</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_size\">cat_size</a> += (<a class=\"id\" href=\"#iter\">iter</a> == 0 ? 0 : sizeof(<a class=\"id\" href=\"#u16\">u16</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cat_size\">cat_size</a> &gt; <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOSPC\">ENOSPC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#array\">array</a>[<a class=\"id\" href=\"#array_cnt\">array_cnt</a>++] = <a class=\"id\" href=\"#iter\">iter</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter\">iter</a> = <a class=\"id\" href=\"#netlbl_secattr_catmap_walk_rng\">netlbl_secattr_catmap_walk_rng</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#iter\">iter</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter\">iter</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_size\">cat_size</a> += sizeof(<a class=\"id\" href=\"#u16\">u16</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cat_size\">cat_size</a> &gt; <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOSPC\">ENOSPC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#array\">array</a>[<a class=\"id\" href=\"#array_cnt\">array_cnt</a>++] = <a class=\"id\" href=\"#iter\">iter</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#array_cnt\">array_cnt</a> &gt; 0;) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*((<a class=\"id\" href=\"#__be16\">__be16</a> *)&amp;<a class=\"id\" href=\"#net_cat\">net_cat</a>[<a class=\"id\" href=\"#iter\">iter</a>]) = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#array\">array</a>[--<a class=\"id\" href=\"#array_cnt\">array_cnt</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter\">iter</a> += 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#array_cnt\">array_cnt</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#array\">array</a>[<a class=\"id\" href=\"#array_cnt\">array_cnt</a>] != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*((<a class=\"id\" href=\"#__be16\">__be16</a> *)&amp;<a class=\"id\" href=\"#net_cat\">net_cat</a>[<a class=\"id\" href=\"#iter\">iter</a>]) = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#array\">array</a>[<a class=\"id\" href=\"#array_cnt\">array_cnt</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter\">iter</a> += 2;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#cat_size\">cat_size</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_map_cat_rng_ntoh - Perform a category mapping from network to host</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @net_cat: the category list in network/CIPSO format</span>", 
"<span class=\"comment\"> * @net_cat_len: the length of the CIPSO bitmap in bytes</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Perform a label mapping to translate a CIPSO category list to the correct</span>", 
"<span class=\"comment\"> * local MLS category bitmap using the given DOI definition.  Returns zero on</span>", 
"<span class=\"comment\"> * success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_map_cat_rng_ntoh\">cipso_v4_map_cat_rng_ntoh</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const unsigned char *<a class=\"id\" href=\"#net_cat\">net_cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#net_iter\">net_iter</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cat_low\">cat_low</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#cat_high\">cat_high</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#net_iter\">net_iter</a> = 0; <a class=\"id\" href=\"#net_iter\">net_iter</a> &lt; <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>; <a class=\"id\" href=\"#net_iter\">net_iter</a> += 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_high\">cat_high</a> = <a class=\"id\" href=\"#get_unaligned_be16\">get_unaligned_be16</a>(&amp;<a class=\"id\" href=\"#net_cat\">net_cat</a>[<a class=\"id\" href=\"#net_iter\">net_iter</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#net_iter\">net_iter</a> + 4) <= <a class=\"id\" href=\"#net_cat_len\">net_cat_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_low\">cat_low</a> = <a class=\"id\" href=\"#get_unaligned_be16\">get_unaligned_be16</a>(&amp;<a class=\"id\" href=\"#net_cat\">net_cat</a>[<a class=\"id\" href=\"#net_iter\">net_iter</a> + 2]);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cat_low\">cat_low</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_secattr_catmap_setrng\">netlbl_secattr_catmap_setrng</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#cat_low\">cat_low</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#cat_high\">cat_high</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Protocol Handling Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_gentag_hdr - Generate a CIPSO option header</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @len: the total tag length in bytes, not including this header</span>", 
"<span class=\"comment\"> * @buf: the CIPSO option buffer</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Write a CIPSO header into the beginning of @buffer.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#cipso_v4_gentag_hdr\">cipso_v4_gentag_hdr</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#buf\">buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buf\">buf</a>[0] = <a class=\"id\" href=\"#IPOPT_CIPSO\">IPOPT_CIPSO</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buf\">buf</a>[1] = <a class=\"id\" href=\"#CIPSO_V4_HDR_LEN\">CIPSO_V4_HDR_LEN</a> + <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>*(<a class=\"id\" href=\"#__be32\">__be32</a> *)&amp;<a class=\"id\" href=\"#buf\">buf</a>[2] = <a class=\"id\" href=\"#htonl\">htonl</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>-><a class=\"id\" href=\"#doi\">doi</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_gentag_rbm - Generate a CIPSO restricted bitmap tag (type #1)</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> * @buffer: the option buffer</span>", 
"<span class=\"comment\"> * @buffer_len: length of buffer in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Generate a CIPSO option using the restricted bitmap tag, tag type #1.  The</span>", 
"<span class=\"comment\"> * actual buffer length may be larger than the indicated size due to</span>", 
"<span class=\"comment\"> * translation between host and network category bitmaps.  Returns the size of</span>", 
"<span class=\"comment\"> * the tag on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_gentag_rbm\">cipso_v4_gentag_rbm</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       unsigned char *<a class=\"id\" href=\"#buffer\">buffer</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#buffer_len\">buffer_len</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_LVL\">NETLBL_SECATTR_MLS_LVL</a>) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_lvl_hton\">cipso_v4_map_lvl_hton</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#lvl\">lvl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_CAT\">NETLBL_SECATTR_MLS_CAT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_cat_rbm_hton\">cipso_v4_map_cat_rbm_hton</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#buffer\">buffer</a>[4],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#buffer_len\">buffer_len</a> - 4);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* This will send packets using the \"optimized\" format when</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * possibile as specified in  section 3.4.2.6 of the</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * CIPSO draft. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cipso_v4_rbm_optfmt\">cipso_v4_rbm_optfmt</a> && <a class=\"id\" href=\"#ret_val\">ret_val</a> &gt; 0 && <a class=\"id\" href=\"#ret_val\">ret_val</a> <= 10)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tag_len\">tag_len</a> = 14;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tag_len\">tag_len</a> = 4 + <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tag_len\">tag_len</a> = 4;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[0] = <a class=\"id\" href=\"#CIPSO_V4_TAG_RBITMAP\">CIPSO_V4_TAG_RBITMAP</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[1] = <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[3] = <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_parsetag_rbm - Parse a CIPSO restricted bitmap tag</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @tag: the CIPSO tag</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Parse a CIPSO restricted bitmap tag (tag type #1) and return the security</span>", 
"<span class=\"comment\"> * attributes in @secattr.  Return zero on success, negatives values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_parsetag_rbm\">cipso_v4_parsetag_rbm</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const unsigned char *<a class=\"id\" href=\"#tag\">tag</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tag_len\">tag_len</a> = <a class=\"id\" href=\"#tag\">tag</a>[1];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_lvl_ntoh\">cipso_v4_map_lvl_ntoh</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>, <a class=\"id\" href=\"#tag\">tag</a>[3], &amp;<a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#lvl\">lvl</a> = <a class=\"id\" href=\"#level\">level</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_LVL\">NETLBL_SECATTR_MLS_LVL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tag_len\">tag_len</a> &gt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/>                       <a class=\"id\" href=\"#netlbl_secattr_catmap_alloc\">netlbl_secattr_catmap_alloc</a>(<a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_cat_rbm_ntoh\">cipso_v4_map_cat_rbm_ntoh</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#tag\">tag</a>[4],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tag_len\">tag_len</a> - 4,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#secattr\">secattr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_secattr_catmap_free\">netlbl_secattr_catmap_free</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_CAT\">NETLBL_SECATTR_MLS_CAT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_gentag_enum - Generate a CIPSO enumerated tag (type #2)</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> * @buffer: the option buffer</span>", 
"<span class=\"comment\"> * @buffer_len: length of buffer in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Generate a CIPSO option using the enumerated tag, tag type #2.  Returns the</span>", 
"<span class=\"comment\"> * size of the tag on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_gentag_enum\">cipso_v4_gentag_enum</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#buffer\">buffer</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#buffer_len\">buffer_len</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_LVL\">NETLBL_SECATTR_MLS_LVL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_lvl_hton\">cipso_v4_map_lvl_hton</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#lvl\">lvl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_CAT\">NETLBL_SECATTR_MLS_CAT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_cat_enum_hton\">cipso_v4_map_cat_enum_hton</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#buffer\">buffer</a>[4],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#buffer_len\">buffer_len</a> - 4);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tag_len\">tag_len</a> = 4 + <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tag_len\">tag_len</a> = 4;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[0] = <a class=\"id\" href=\"#CIPSO_V4_TAG_ENUM\">CIPSO_V4_TAG_ENUM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[1] = <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[3] = <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_parsetag_enum - Parse a CIPSO enumerated tag</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @tag: the CIPSO tag</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Parse a CIPSO enumerated tag (tag type #2) and return the security</span>", 
"<span class=\"comment\"> * attributes in @secattr.  Return zero on success, negatives values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_parsetag_enum\">cipso_v4_parsetag_enum</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  const unsigned char *<a class=\"id\" href=\"#tag\">tag</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tag_len\">tag_len</a> = <a class=\"id\" href=\"#tag\">tag</a>[1];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_lvl_ntoh\">cipso_v4_map_lvl_ntoh</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>, <a class=\"id\" href=\"#tag\">tag</a>[3], &amp;<a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#lvl\">lvl</a> = <a class=\"id\" href=\"#level\">level</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_LVL\">NETLBL_SECATTR_MLS_LVL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tag_len\">tag_len</a> &gt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>               <a class=\"id\" href=\"#netlbl_secattr_catmap_alloc\">netlbl_secattr_catmap_alloc</a>(<a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_cat_enum_ntoh\">cipso_v4_map_cat_enum_ntoh</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#tag\">tag</a>[4],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#tag_len\">tag_len</a> - 4,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#secattr\">secattr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_secattr_catmap_free\">netlbl_secattr_catmap_free</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_CAT\">NETLBL_SECATTR_MLS_CAT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_gentag_rng - Generate a CIPSO ranged tag (type #5)</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> * @buffer: the option buffer</span>", 
"<span class=\"comment\"> * @buffer_len: length of buffer in bytes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Generate a CIPSO option using the ranged tag, tag type #5.  Returns the</span>", 
"<span class=\"comment\"> * size of the tag on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_gentag_rng\">cipso_v4_gentag_rng</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       unsigned char *<a class=\"id\" href=\"#buffer\">buffer</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#buffer_len\">buffer_len</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_LVL\">NETLBL_SECATTR_MLS_LVL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_lvl_hton\">cipso_v4_map_lvl_hton</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#lvl\">lvl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_CAT\">NETLBL_SECATTR_MLS_CAT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_cat_rng_hton\">cipso_v4_map_cat_rng_hton</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#buffer\">buffer</a>[4],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#buffer_len\">buffer_len</a> - 4);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tag_len\">tag_len</a> = 4 + <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tag_len\">tag_len</a> = 4;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[0] = <a class=\"id\" href=\"#CIPSO_V4_TAG_RANGE\">CIPSO_V4_TAG_RANGE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[1] = <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[3] = <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tag_len\">tag_len</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_parsetag_rng - Parse a CIPSO ranged tag</span>", 
"<span class=\"comment\"> * @doi_def: the DOI definition</span>", 
"<span class=\"comment\"> * @tag: the CIPSO tag</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Parse a CIPSO ranged tag (tag type #5) and return the security attributes</span>", 
"<span class=\"comment\"> * in @secattr.  Return zero on success, negatives values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#cipso_v4_parsetag_rng\">cipso_v4_parsetag_rng</a>(const struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const unsigned char *<a class=\"id\" href=\"#tag\">tag</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tag_len\">tag_len</a> = <a class=\"id\" href=\"#tag\">tag</a>[1];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#level\">level</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_lvl_ntoh\">cipso_v4_map_lvl_ntoh</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>, <a class=\"id\" href=\"#tag\">tag</a>[3], &amp;<a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#lvl\">lvl</a> = <a class=\"id\" href=\"#level\">level</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_LVL\">NETLBL_SECATTR_MLS_LVL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tag_len\">tag_len</a> &gt; 4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>               <a class=\"id\" href=\"#netlbl_secattr_catmap_alloc\">netlbl_secattr_catmap_alloc</a>(<a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#cipso_v4_map_cat_rng_ntoh\">cipso_v4_map_cat_rng_ntoh</a>(<a class=\"id\" href=\"#doi_def\">doi_def</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#tag\">tag</a>[4],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tag_len\">tag_len</a> - 4,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#secattr\">secattr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_secattr_catmap_free\">netlbl_secattr_catmap_free</a>(<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_CAT\">NETLBL_SECATTR_MLS_CAT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * cipso_v4_gentag_loc - Generate a CIPSO local tag (non-standard)</span>", 
];
xr_frag_insert('l/52/f625cfce0199764e675645ce0a69ae40089cca.xr', __xr_tmp);
