var __xr_tmp = [
"#<a class=\"id\" href=\"#include\">include</a> \"wakeup.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"boot.h\"", 
"", 
"static void <a class=\"id\" href=\"#udelay\">udelay</a>(int <a class=\"id\" href=\"#loops\">loops</a>)", 
"{", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#loops\">loops</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#io_delay\">io_delay</a>();<span class=\"ts\"/><span class=\"comment\">/* Approximately 1 us */</span>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#beep\">beep</a>(unsigned int <a class=\"id\" href=\"#hz\">hz</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#enable\">enable</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#hz\">hz</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#enable\">enable</a> = 0x00;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Turn off speaker */</span>", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#div\">div</a> = 1193181/<a class=\"id\" href=\"#hz\">hz</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#outb\">outb</a>(0xb6, 0x43);<span class=\"ts\"/><span class=\"comment\">/* Ctr 2, squarewave, load, binary */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#io_delay\">io_delay</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#outb\">outb</a>(<a class=\"id\" href=\"#div\">div</a>, 0x42);<span class=\"ts\"/><span class=\"comment\">/* LSB of counter */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#io_delay\">io_delay</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#outb\">outb</a>(<a class=\"id\" href=\"#div\">div</a> >> 8, 0x42);<span class=\"ts\"/><span class=\"comment\">/* MSB of counter */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#io_delay\">io_delay</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#enable\">enable</a> = 0x03;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Turn on speaker */</span>", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inb\">inb</a>(0x61);<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Dummy read of System Control Port B */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#io_delay\">io_delay</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#outb\">outb</a>(<a class=\"id\" href=\"#enable\">enable</a>, 0x61);<span class=\"ts\"/><span class=\"comment\">/* Enable timer 2 output to speaker */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#io_delay\">io_delay</a>();", 
"}", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DOT_HZ\">DOT_HZ</a><span class=\"ts\"/><span class=\"ts\"/>880", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DASH_HZ\">DASH_HZ</a><span class=\"ts\"/><span class=\"ts\"/>587", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#US_PER_DOT\">US_PER_DOT</a><span class=\"ts\"/>125000", 
"", 
"<span class=\"comment\">/* Okay, this is totally silly, but it's kind of fun. */</span>", 
"static void <a class=\"id\" href=\"#send_morse\">send_morse</a>(const char *<a class=\"id\" href=\"#pattern\">pattern</a>)", 
"{", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#s\">s</a>;", 
"", 
"<span class=\"ts\"/>while ((<a class=\"id\" href=\"#s\">s</a> = *<a class=\"id\" href=\"#pattern\">pattern</a>++)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#s\">s</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case '.':", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#beep\">beep</a>(<a class=\"id\" href=\"#DOT_HZ\">DOT_HZ</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#udelay\">udelay</a>(<a class=\"id\" href=\"#US_PER_DOT\">US_PER_DOT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#beep\">beep</a>(0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#udelay\">udelay</a>(<a class=\"id\" href=\"#US_PER_DOT\">US_PER_DOT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case '-':", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#beep\">beep</a>(<a class=\"id\" href=\"#DASH_HZ\">DASH_HZ</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#udelay\">udelay</a>(<a class=\"id\" href=\"#US_PER_DOT\">US_PER_DOT</a> * 3);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#beep\">beep</a>(0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#udelay\">udelay</a>(<a class=\"id\" href=\"#US_PER_DOT\">US_PER_DOT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:<span class=\"ts\"/><span class=\"comment\">/* Assume it's a space */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#udelay\">udelay</a>(<a class=\"id\" href=\"#US_PER_DOT\">US_PER_DOT</a> * 3);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"void <a class=\"id\" href=\"#main\">main</a>(void)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* Kill machine if structures are wrong */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#wakeup_header\">wakeup_header</a>.<a class=\"id\" href=\"#real_magic\">real_magic</a> != 0x12345678)", 
"<span class=\"ts\"/><span class=\"ts\"/>while (1);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#wakeup_header\">wakeup_header</a>.<a class=\"id\" href=\"#realmode_flags\">realmode_flags</a> &amp; 4)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#send_morse\">send_morse</a>(\"...-\");", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#wakeup_header\">wakeup_header</a>.<a class=\"id\" href=\"#realmode_flags\">realmode_flags</a> &amp; 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#asm\">asm</a> volatile(\"lcallw   $0xc000,$3\");", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#wakeup_header\">wakeup_header</a>.<a class=\"id\" href=\"#realmode_flags\">realmode_flags</a> &amp; 2) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Need to call BIOS */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#probe_cards\">probe_cards</a>(0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_mode\">set_mode</a>(<a class=\"id\" href=\"#wakeup_header\">wakeup_header</a>.<a class=\"id\" href=\"#video_mode\">video_mode</a>);", 
"<span class=\"ts\"/>}", 
"}", 
];
xr_frag_insert('l/55/67c47375d6d80d4a7e98a24cfeacf12fa0e236.xr', __xr_tmp);
