var __xr_tmp = [
"<span class=\"ts\"/><a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_queues_count\">mq_queues_count</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#mq_lock\">mq_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#mqueue_get_inode\">mqueue_get_inode</a>(<a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_sb\">i_sb</a>, <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>, <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#inode\">inode</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#mq_lock\">mq_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_queues_count\">mq_queues_count</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_ipc_ns\">put_ipc_ns</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_size\">i_size</a> += <a class=\"id\" href=\"#DIRENT_SIZE\">DIRENT_SIZE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_mtime\">i_mtime</a> = <a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#d_instantiate\">d_instantiate</a>(<a class=\"id\" href=\"#dentry\">dentry</a>, <a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dget\">dget</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/>return 0;", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#mq_lock\">mq_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_ipc_ns\">put_ipc_ns</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#mqueue_unlink\">mqueue_unlink</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#dir\">dir</a>, struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>)", 
"{", 
"  <span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_mtime\">i_mtime</a> = <a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#i_size\">i_size</a> -= <a class=\"id\" href=\"#DIRENT_SIZE\">DIRENT_SIZE</a>;", 
"  <span class=\"ts\"/><a class=\"id\" href=\"#drop_nlink\">drop_nlink</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"  <span class=\"ts\"/><a class=\"id\" href=\"#dput\">dput</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"  <span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\">*<span class=\"ts\"/>This is routine for system read from queue file.</span>", 
"<span class=\"comment\">*<span class=\"ts\"/>To avoid mess with doing here some sort of mq_receive we allow</span>", 
"<span class=\"comment\">*<span class=\"ts\"/>to read only queue size &amp; notification info (the only values</span>", 
"<span class=\"comment\">*<span class=\"ts\"/>that are interesting from user point of view and aren't accessible</span>", 
"<span class=\"comment\">*<span class=\"ts\"/>through std routines)</span>", 
"<span class=\"comment\">*/</span>", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#mqueue_read_file\">mqueue_read_file</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>, char <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#u_data\">u_data</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#count\">count</a>, <a class=\"id\" href=\"#loff_t\">loff_t</a> *<a class=\"id\" href=\"#off\">off</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#MQUEUE_I\">MQUEUE_I</a>(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>);", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#buffer\">buffer</a>[<a class=\"id\" href=\"#FILENT_SIZE\">FILENT_SIZE</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#snprintf\">snprintf</a>(<a class=\"id\" href=\"#buffer\">buffer</a>, sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"QSIZE:%-10lu NOTIFY:%-5d SIGNO:%-5d NOTIFY_PID:%-6d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#qsize\">qsize</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> ? <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> : 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> == <a class=\"id\" href=\"#SIGEV_SIGNAL\">SIGEV_SIGNAL</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_signo\">sigev_signo</a> : 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pid_vnr\">pid_vnr</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buffer\">buffer</a>[sizeof(<a class=\"id\" href=\"#buffer\">buffer</a>)-1] = '\\0';", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#simple_read_from_buffer\">simple_read_from_buffer</a>(<a class=\"id\" href=\"#u_data\">u_data</a>, <a class=\"id\" href=\"#count\">count</a>, <a class=\"id\" href=\"#off\">off</a>, <a class=\"id\" href=\"#buffer\">buffer</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#buffer\">buffer</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#mqueue_flush_file\">mqueue_flush_file</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>, <a class=\"id\" href=\"#fl_owner_t\">fl_owner_t</a> <a class=\"id\" href=\"#id\">id</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#MQUEUE_I\">MQUEUE_I</a>(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#task_tgid\">task_tgid</a>(<a class=\"id\" href=\"#current\">current</a>) == <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#remove_notification\">remove_notification</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static unsigned int <a class=\"id\" href=\"#mqueue_poll_file\">mqueue_poll_file</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>, struct <a class=\"id\" href=\"#poll_table_struct\">poll_table_struct</a> *<a class=\"id\" href=\"#poll_tab\">poll_tab</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#MQUEUE_I\">MQUEUE_I</a>(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#poll_wait\">poll_wait</a>(<a class=\"id\" href=\"#filp\">filp</a>, &amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#wait_q\">wait_q</a>, <a class=\"id\" href=\"#poll_tab\">poll_tab</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#POLLIN\">POLLIN</a> | <a class=\"id\" href=\"#POLLRDNORM\">POLLRDNORM</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a> &lt; <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> |= <a class=\"id\" href=\"#POLLOUT\">POLLOUT</a> | <a class=\"id\" href=\"#POLLWRNORM\">POLLWRNORM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Adds current to info-&gt;e_wait_q[sr] before element with smaller prio */</span>", 
"static void <a class=\"id\" href=\"#wq_add\">wq_add</a>(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>, int <a class=\"id\" href=\"#sr\">sr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> *<a class=\"id\" href=\"#ewp\">ewp</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> *<a class=\"id\" href=\"#walk\">walk</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ewp\">ewp</a>-><a class=\"id\" href=\"#task\">task</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#walk\">walk</a>, &amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#e_wait_q\">e_wait_q</a>[<a class=\"id\" href=\"#sr\">sr</a>].<a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#task\">task</a>-><a class=\"id\" href=\"#static_prio\">static_prio</a> <= <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#static_prio\">static_prio</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail\">list_add_tail</a>(&amp;<a class=\"id\" href=\"#ewp\">ewp</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail\">list_add_tail</a>(&amp;<a class=\"id\" href=\"#ewp\">ewp</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#e_wait_q\">e_wait_q</a>[<a class=\"id\" href=\"#sr\">sr</a>].<a class=\"id\" href=\"#list\">list</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Puts current task to sleep. Caller must hold queue lock. After return</span>", 
"<span class=\"comment\"> * lock isn't held.</span>", 
"<span class=\"comment\"> * sr: SEND or RECV</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#wq_sleep\">wq_sleep</a>(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>, int <a class=\"id\" href=\"#sr\">sr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ktime_t\">ktime_t</a> *<a class=\"id\" href=\"#timeout\">timeout</a>, struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> *<a class=\"id\" href=\"#ewp\">ewp</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"<span class=\"ts\"/>signed long <a class=\"id\" href=\"#time\">time</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wq_add\">wq_add</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#sr\">sr</a>, <a class=\"id\" href=\"#ewp\">ewp</a>);", 
"", 
"<span class=\"ts\"/>for (;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_current_state\">set_current_state</a>(<a class=\"id\" href=\"#TASK_INTERRUPTIBLE\">TASK_INTERRUPTIBLE</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#time\">time</a> = <a class=\"id\" href=\"#schedule_hrtimeout_range_clock\">schedule_hrtimeout_range_clock</a>(<a class=\"id\" href=\"#timeout\">timeout</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#HRTIMER_MODE_ABS\">HRTIMER_MODE_ABS</a>, 0, <a class=\"id\" href=\"#CLOCK_REALTIME\">CLOCK_REALTIME</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#ewp\">ewp</a>-><a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#STATE_PENDING\">STATE_PENDING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cpu_relax\">cpu_relax</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ewp\">ewp</a>-><a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#STATE_READY\">STATE_READY</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ewp\">ewp</a>-><a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#STATE_READY\">STATE_READY</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#signal_pending\">signal_pending</a>(<a class=\"id\" href=\"#current\">current</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#ERESTARTSYS\">ERESTARTSYS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#time\">time</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = -<a class=\"id\" href=\"#ETIMEDOUT\">ETIMEDOUT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#ewp\">ewp</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Returns waiting task that should be serviced first or NULL if none exists</span>", 
"<span class=\"comment\"> */</span>", 
"static struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> *<a class=\"id\" href=\"#wq_get_first_waiter\">wq_get_first_waiter</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>, int <a class=\"id\" href=\"#sr\">sr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#ptr\">ptr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#e_wait_q\">e_wait_q</a>[<a class=\"id\" href=\"#sr\">sr</a>].<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#prev\">prev</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a> == &amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#e_wait_q\">e_wait_q</a>[<a class=\"id\" href=\"#sr\">sr</a>].<a class=\"id\" href=\"#list\">list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#list_entry\">list_entry</a>(<a class=\"id\" href=\"#ptr\">ptr</a>, struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a>, <a class=\"id\" href=\"#list\">list</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Auxiliary functions to manipulate messages' list */</span>", 
"static void <a class=\"id\" href=\"#msg_insert\">msg_insert</a>(struct <a class=\"id\" href=\"#msg_msg\">msg_msg</a> *<a class=\"id\" href=\"#ptr\">ptr</a>, struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#k\">k</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a> - 1;", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#k\">k</a> >= 0 && <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#messages\">messages</a>[<a class=\"id\" href=\"#k\">k</a>]-><a class=\"id\" href=\"#m_type\">m_type</a> >= <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#m_type\">m_type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#messages\">messages</a>[<a class=\"id\" href=\"#k\">k</a> + 1] = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#messages\">messages</a>[<a class=\"id\" href=\"#k\">k</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a>--;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#qsize\">qsize</a> += <a class=\"id\" href=\"#ptr\">ptr</a>-><a class=\"id\" href=\"#m_ts\">m_ts</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#messages\">messages</a>[<a class=\"id\" href=\"#k\">k</a> + 1] = <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#msg_msg\">msg_msg</a> *<a class=\"id\" href=\"#msg_get\">msg_get</a>(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#qsize\">qsize</a> -= <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#messages\">messages</a>[--<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a>]-><a class=\"id\" href=\"#m_ts\">m_ts</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#messages\">messages</a>[<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a>];", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#set_cookie\">set_cookie</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, char <a class=\"id\" href=\"#code\">code</a>)", 
"{", 
"<span class=\"ts\"/>((char*)<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>)[<a class=\"id\" href=\"#NOTIFY_COOKIE_LEN\">NOTIFY_COOKIE_LEN</a>-1] = <a class=\"id\" href=\"#code\">code</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * The next function is only to split too long sys_mq_timedsend</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#__do_notify\">__do_notify</a>(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* notification</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * invoked when there is registered process and there isn't process</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * waiting synchronously for message AND state of queue changed from</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * empty to not empty. Here we are sure that no one is waiting</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * synchronously. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a> == 1) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#siginfo\">siginfo</a> <a class=\"id\" href=\"#sig_i\">sig_i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SIGEV_NONE\">SIGEV_NONE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SIGEV_SIGNAL\">SIGEV_SIGNAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* sends signal */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sig_i\">sig_i</a>.<a class=\"id\" href=\"#si_signo\">si_signo</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_signo\">sigev_signo</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sig_i\">sig_i</a>.<a class=\"id\" href=\"#si_errno\">si_errno</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sig_i\">sig_i</a>.<a class=\"id\" href=\"#si_code\">si_code</a> = <a class=\"id\" href=\"#SI_MESGQ\">SI_MESGQ</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sig_i\">sig_i</a>.<a class=\"id\" href=\"#si_value\">si_value</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_value\">sigev_value</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sig_i\">sig_i</a>.<a class=\"id\" href=\"#si_pid\">si_pid</a> = <a class=\"id\" href=\"#task_tgid_nr_ns\">task_tgid_nr_ns</a>(<a class=\"id\" href=\"#current\">current</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ns_of_pid\">ns_of_pid</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sig_i\">sig_i</a>.<a class=\"id\" href=\"#si_uid\">si_uid</a> = <a class=\"id\" href=\"#current_uid\">current_uid</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kill_pid_info\">kill_pid_info</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_signo\">sigev_signo</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#sig_i\">sig_i</a>, <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SIGEV_THREAD\">SIGEV_THREAD</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_cookie\">set_cookie</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_cookie\">notify_cookie</a>, <a class=\"id\" href=\"#NOTIFY_WOKENUP\">NOTIFY_WOKENUP</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_sendskb\">netlink_sendskb</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_sock\">notify_sock</a>, <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_cookie\">notify_cookie</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* after notification unregisters process */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_pid\">put_pid</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#wait_q\">wait_q</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#prepare_timeout\">prepare_timeout</a>(const struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#ktime_t\">ktime_t</a> *<a class=\"id\" href=\"#expires\">expires</a>, struct <a class=\"id\" href=\"#timespec\">timespec</a> *<a class=\"id\" href=\"#ts\">ts</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#ts\">ts</a>, <a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>, sizeof(struct <a class=\"id\" href=\"#timespec\">timespec</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#timespec_valid\">timespec_valid</a>(<a class=\"id\" href=\"#ts\">ts</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#expires\">expires</a> = <a class=\"id\" href=\"#timespec_to_ktime\">timespec_to_ktime</a>(*<a class=\"id\" href=\"#ts\">ts</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#remove_notification\">remove_notification</a>(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> != <a class=\"id\" href=\"#NULL\">NULL</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> == <a class=\"id\" href=\"#SIGEV_THREAD\">SIGEV_THREAD</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_cookie\">set_cookie</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_cookie\">notify_cookie</a>, <a class=\"id\" href=\"#NOTIFY_REMOVED\">NOTIFY_REMOVED</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_sendskb\">netlink_sendskb</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_sock\">notify_sock</a>, <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_cookie\">notify_cookie</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_pid\">put_pid</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#mq_attr_ok\">mq_attr_ok</a>(struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>, struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a> *<a class=\"id\" href=\"#attr\">attr</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a> <= 0 || <a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_msgsize\">mq_msgsize</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_RESOURCE\">CAP_SYS_RESOURCE</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a> &gt; <a class=\"id\" href=\"#HARD_MSGMAX\">HARD_MSGMAX</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a> &gt; <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_msg_max\">mq_msg_max</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_msgsize\">mq_msgsize</a> &gt; <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_msgsize_max\">mq_msgsize_max</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"comment\">/* check for overflow */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_msgsize\">mq_msgsize</a> &gt; <a class=\"id\" href=\"#ULONG_MAX\">ULONG_MAX</a>/<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>if ((unsigned long)(<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a> * (<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_msgsize\">mq_msgsize</a>", 
"<span class=\"ts\"/>    + sizeof (struct <a class=\"id\" href=\"#msg_msg\">msg_msg</a> *))) &lt;", 
"<span class=\"ts\"/>    (unsigned long)(<a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a> * <a class=\"id\" href=\"#attr\">attr</a>-><a class=\"id\" href=\"#mq_msgsize\">mq_msgsize</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Invoked when creating a new queue via sys_mq_open</span>", 
"<span class=\"comment\"> */</span>", 
"static struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#do_create\">do_create</a>(struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>, struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dir\">dir</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, int <a class=\"id\" href=\"#oflag\">oflag</a>, <a class=\"id\" href=\"#mode_t\">mode_t</a> <a class=\"id\" href=\"#mode\">mode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a> *<a class=\"id\" href=\"#attr\">attr</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#current_cred\">current_cred</a>();", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#result\">result</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#attr\">attr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#mq_attr_ok\">mq_attr_ok</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>, <a class=\"id\" href=\"#attr\">attr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* store for use during create */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_fsdata\">d_fsdata</a> = <a class=\"id\" href=\"#attr\">attr</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mode\">mode</a> &= ~<a class=\"id\" href=\"#current_umask\">current_umask</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#mnt_want_write\">mnt_want_write</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#vfs_create\">vfs_create</a>(<a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>, <a class=\"id\" href=\"#dentry\">dentry</a>, <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_fsdata\">d_fsdata</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_drop_write\">out_drop_write</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#dentry_open\">dentry_open</a>(<a class=\"id\" href=\"#dentry\">dentry</a>, <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>, <a class=\"id\" href=\"#oflag\">oflag</a>, <a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * dentry_open() took a persistent mnt_want_write(),</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * so we can now drop this one.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mnt_drop_write\">mnt_drop_write</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#result\">result</a>;", 
"", 
"<a class=\"id\" href=\"#out_drop_write\">out_drop_write</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mnt_drop_write\">mnt_drop_write</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dput\">dput</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mntput\">mntput</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#ret\">ret</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Opens existing queue */</span>", 
"static struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#do_open\">do_open</a>(struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, int <a class=\"id\" href=\"#oflag\">oflag</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#current_cred\">current_cred</a>();", 
"", 
"<span class=\"ts\"/>static const int <a class=\"id\" href=\"#oflag2acc\">oflag2acc</a>[<a class=\"id\" href=\"#O_ACCMODE\">O_ACCMODE</a>] = { <a class=\"id\" href=\"#MAY_READ\">MAY_READ</a>, <a class=\"id\" href=\"#MAY_WRITE\">MAY_WRITE</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#MAY_READ\">MAY_READ</a> | <a class=\"id\" href=\"#MAY_WRITE\">MAY_WRITE</a> };", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#oflag\">oflag</a> &amp; <a class=\"id\" href=\"#O_ACCMODE\">O_ACCMODE</a>) == (<a class=\"id\" href=\"#O_RDWR\">O_RDWR</a> | <a class=\"id\" href=\"#O_WRONLY\">O_WRONLY</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#inode_permission\">inode_permission</a>(<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>, <a class=\"id\" href=\"#oflag2acc\">oflag2acc</a>[<a class=\"id\" href=\"#oflag\">oflag</a> &amp; <a class=\"id\" href=\"#O_ACCMODE\">O_ACCMODE</a>])) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EACCES\">EACCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#dentry_open\">dentry_open</a>(<a class=\"id\" href=\"#dentry\">dentry</a>, <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>, <a class=\"id\" href=\"#oflag\">oflag</a>, <a class=\"id\" href=\"#cred\">cred</a>);", 
"", 
"<a class=\"id\" href=\"#err\">err</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dput\">dput</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mntput\">mntput</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#ret\">ret</a>);", 
"}", 
"", 
"<a class=\"id\" href=\"#SYSCALL_DEFINE4\">SYSCALL_DEFINE4</a>(<a class=\"id\" href=\"#mq_open\">mq_open</a>, const char <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_name\">u_name</a>, int, <a class=\"id\" href=\"#oflag\">oflag</a>, <a class=\"id\" href=\"#mode_t\">mode_t</a>, <a class=\"id\" href=\"#mode\">mode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a> <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_attr\">u_attr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#name\">name</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a> <a class=\"id\" href=\"#attr\">attr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#fd\">fd</a>, <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#nsproxy\">nsproxy</a>-><a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_attr\">u_attr</a> && <a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#attr\">attr</a>, <a class=\"id\" href=\"#u_attr\">u_attr</a>, sizeof(struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_mq_open\">audit_mq_open</a>(<a class=\"id\" href=\"#oflag\">oflag</a>, <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#u_attr\">u_attr</a> ? &amp;<a class=\"id\" href=\"#attr\">attr</a> : <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#getname\">getname</a>(<a class=\"id\" href=\"#u_name\">u_name</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fd\">fd</a> = <a class=\"id\" href=\"#get_unused_fd_flags\">get_unused_fd_flags</a>(<a class=\"id\" href=\"#O_CLOEXEC\">O_CLOEXEC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fd\">fd</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_putname\">out_putname</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_root\">mnt_root</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_mutex\">i_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dentry\">dentry</a> = <a class=\"id\" href=\"#lookup_one_len\">lookup_one_len</a>(<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_root\">mnt_root</a>, <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#name\">name</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#dentry\">dentry</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_putfd\">out_putfd</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mntget\">mntget</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oflag\">oflag</a> &amp; <a class=\"id\" href=\"#O_CREAT\">O_CREAT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>) {<span class=\"ts\"/><span class=\"comment\">/* entry already exists */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_inode\">audit_inode</a>(<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#oflag\">oflag</a> &amp; <a class=\"id\" href=\"#O_EXCL\">O_EXCL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#do_open\">do_open</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>, <a class=\"id\" href=\"#dentry\">dentry</a>, <a class=\"id\" href=\"#oflag\">oflag</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#do_create\">do_create</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>, <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_root\">mnt_root</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dentry\">dentry</a>, <a class=\"id\" href=\"#oflag\">oflag</a>, <a class=\"id\" href=\"#mode\">mode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u_attr\">u_attr</a> ? &amp;<a class=\"id\" href=\"#attr\">attr</a> : <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_inode\">audit_inode</a>(<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#do_open\">do_open</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>, <a class=\"id\" href=\"#dentry\">dentry</a>, <a class=\"id\" href=\"#oflag\">oflag</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#filp\">filp</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#filp\">filp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_putfd\">out_putfd</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fd_install\">fd_install</a>(<a class=\"id\" href=\"#fd\">fd</a>, <a class=\"id\" href=\"#filp\">filp</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out_upsem\">out_upsem</a>;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dput\">dput</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mntput\">mntput</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<a class=\"id\" href=\"#out_putfd\">out_putfd</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_unused_fd\">put_unused_fd</a>(<a class=\"id\" href=\"#fd\">fd</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fd\">fd</a> = <a class=\"id\" href=\"#error\">error</a>;", 
"<a class=\"id\" href=\"#out_upsem\">out_upsem</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_root\">mnt_root</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_mutex\">i_mutex</a>);", 
"<a class=\"id\" href=\"#out_putname\">out_putname</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#putname\">putname</a>(<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#fd\">fd</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#SYSCALL_DEFINE1\">SYSCALL_DEFINE1</a>(<a class=\"id\" href=\"#mq_unlink\">mq_unlink</a>, const char <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_name\">u_name</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#name\">name</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#nsproxy\">nsproxy</a>-><a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#getname\">getname</a>(<a class=\"id\" href=\"#u_name\">u_name</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#name\">name</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock_nested\">mutex_lock_nested</a>(&amp;<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_root\">mnt_root</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_mutex\">i_mutex</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#I_MUTEX_PARENT\">I_MUTEX_PARENT</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dentry\">dentry</a> = <a class=\"id\" href=\"#lookup_one_len\">lookup_one_len</a>(<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_root\">mnt_root</a>, <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#name\">name</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#dentry\">dentry</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#inode\">inode</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_count\">i_count</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#mnt_want_write\">mnt_want_write</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_err\">out_err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#vfs_unlink\">vfs_unlink</a>(<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_parent\">d_parent</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>, <a class=\"id\" href=\"#dentry\">dentry</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mnt_drop_write\">mnt_drop_write</a>(<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<a class=\"id\" href=\"#out_err\">out_err</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dput\">dput</a>(<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#ipc_ns\">ipc_ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_root\">mnt_root</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_mutex\">i_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#putname\">putname</a>(<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#inode\">inode</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iput\">iput</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Pipelined send and receive functions.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * If a receiver finds no waiting message, then it registers itself in the</span>", 
"<span class=\"comment\"> * list of waiting receivers. A sender checks that list before adding the new</span>", 
"<span class=\"comment\"> * message into the message array. If there is a waiting receiver, then it</span>", 
"<span class=\"comment\"> * bypasses the message array and directly hands the message over to the</span>", 
"<span class=\"comment\"> * receiver.</span>", 
"<span class=\"comment\"> * The receiver accepts the message and returns without grabbing the queue</span>", 
"<span class=\"comment\"> * spinlock. Therefore an intermediate STATE_PENDING state and memory barriers</span>", 
"<span class=\"comment\"> * are necessary. The same algorithm is used for sysv semaphores, see</span>", 
"<span class=\"comment\"> * ipc/sem.c for more details.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * The same algorithm is used for senders.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/* pipelined_send() - send a message directly to the task waiting in</span>", 
"<span class=\"comment\"> * sys_mq_timedreceive() (without inserting message into a queue).</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#pipelined_send\">pipelined_send</a>(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#msg_msg\">msg_msg</a> *<a class=\"id\" href=\"#message\">message</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> *<a class=\"id\" href=\"#receiver\">receiver</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#receiver\">receiver</a>-><a class=\"id\" href=\"#msg\">msg</a> = <a class=\"id\" href=\"#message\">message</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#receiver\">receiver</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#receiver\">receiver</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATE_PENDING\">STATE_PENDING</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up_process\">wake_up_process</a>(<a class=\"id\" href=\"#receiver\">receiver</a>-><a class=\"id\" href=\"#task\">task</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#smp_wmb\">smp_wmb</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#receiver\">receiver</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATE_READY\">STATE_READY</a>;", 
"}", 
"", 
"<span class=\"comment\">/* pipelined_receive() - if there is task waiting in sys_mq_timedsend()</span>", 
"<span class=\"comment\"> * gets its message and put to the queue (we have one free place for sure). */</span>", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#pipelined_receive\">pipelined_receive</a>(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> *<a class=\"id\" href=\"#sender\">sender</a> = <a class=\"id\" href=\"#wq_get_first_waiter\">wq_get_first_waiter</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#SEND\">SEND</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sender\">sender</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* for poll */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up_interruptible\">wake_up_interruptible</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#wait_q\">wait_q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg_insert\">msg_insert</a>(<a class=\"id\" href=\"#sender\">sender</a>-><a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#sender\">sender</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sender\">sender</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATE_PENDING\">STATE_PENDING</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up_process\">wake_up_process</a>(<a class=\"id\" href=\"#sender\">sender</a>-><a class=\"id\" href=\"#task\">task</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#smp_wmb\">smp_wmb</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sender\">sender</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATE_READY\">STATE_READY</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#SYSCALL_DEFINE5\">SYSCALL_DEFINE5</a>(<a class=\"id\" href=\"#mq_timedsend\">mq_timedsend</a>, <a class=\"id\" href=\"#mqd_t\">mqd_t</a>, <a class=\"id\" href=\"#mqdes\">mqdes</a>, const char <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_msg_ptr\">u_msg_ptr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a>, <a class=\"id\" href=\"#msg_len\">msg_len</a>, unsigned int, <a class=\"id\" href=\"#msg_prio\">msg_prio</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> <a class=\"id\" href=\"#wait\">wait</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> *<a class=\"id\" href=\"#receiver\">receiver</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#msg_msg\">msg_msg</a> *<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ktime_t\">ktime_t</a> <a class=\"id\" href=\"#expires\">expires</a>, *<a class=\"id\" href=\"#timeout\">timeout</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#ts\">ts</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#prepare_timeout\">prepare_timeout</a>(<a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>, &amp;<a class=\"id\" href=\"#expires\">expires</a>, &amp;<a class=\"id\" href=\"#ts\">ts</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = &amp;<a class=\"id\" href=\"#expires\">expires</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#msg_prio\">msg_prio</a> >= (unsigned long) <a class=\"id\" href=\"#MQ_PRIO_MAX\">MQ_PRIO_MAX</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_mq_sendrecv\">audit_mq_sendrecv</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>, <a class=\"id\" href=\"#msg_len\">msg_len</a>, <a class=\"id\" href=\"#msg_prio\">msg_prio</a>, <a class=\"id\" href=\"#timeout\">timeout</a> ? &amp;<a class=\"id\" href=\"#ts\">ts</a> : <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#fget\">fget</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#filp\">filp</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_op\">f_op</a> != &amp;<a class=\"id\" href=\"#mqueue_file_operations\">mqueue_file_operations</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#MQUEUE_I\">MQUEUE_I</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_inode\">audit_inode</a>(<a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_mode\">f_mode</a> &amp; <a class=\"id\" href=\"#FMODE_WRITE\">FMODE_WRITE</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#msg_len\">msg_len</a> &gt; <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_msgsize\">mq_msgsize</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* First try to allocate memory, before doing anything with</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * existing queues. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg_ptr\">msg_ptr</a> = <a class=\"id\" href=\"#load_msg\">load_msg</a>(<a class=\"id\" href=\"#u_msg_ptr\">u_msg_ptr</a>, <a class=\"id\" href=\"#msg_len\">msg_len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>-><a class=\"id\" href=\"#m_ts\">m_ts</a> = <a class=\"id\" href=\"#msg_len\">msg_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>-><a class=\"id\" href=\"#m_type\">m_type</a> = <a class=\"id\" href=\"#msg_prio\">msg_prio</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a> == <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_maxmsg\">mq_maxmsg</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_flags\">f_flags</a> &amp; <a class=\"id\" href=\"#O_NONBLOCK\">O_NONBLOCK</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wait\">wait</a>.<a class=\"id\" href=\"#task\">task</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wait\">wait</a>.<a class=\"id\" href=\"#msg\">msg</a> = (void *) <a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wait\">wait</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATE_NONE\">STATE_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#wq_sleep\">wq_sleep</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#SEND\">SEND</a>, <a class=\"id\" href=\"#timeout\">timeout</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_msg\">free_msg</a>(<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#receiver\">receiver</a> = <a class=\"id\" href=\"#wq_get_first_waiter\">wq_get_first_waiter</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#RECV\">RECV</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#receiver\">receiver</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pipelined_send\">pipelined_send</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>, <a class=\"id\" href=\"#receiver\">receiver</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* adds message to the queue */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg_insert\">msg_insert</a>(<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>, <a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__do_notify\">__do_notify</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mtime\">i_mtime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out_fput\">out_fput</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fput\">fput</a>(<a class=\"id\" href=\"#filp\">filp</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#SYSCALL_DEFINE5\">SYSCALL_DEFINE5</a>(<a class=\"id\" href=\"#mq_timedreceive\">mq_timedreceive</a>, <a class=\"id\" href=\"#mqd_t\">mqd_t</a>, <a class=\"id\" href=\"#mqdes\">mqdes</a>, char <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_msg_ptr\">u_msg_ptr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a>, <a class=\"id\" href=\"#msg_len\">msg_len</a>, unsigned int <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_msg_prio\">u_msg_prio</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#msg_msg\">msg_msg</a> *<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ext_wait_queue\">ext_wait_queue</a> <a class=\"id\" href=\"#wait\">wait</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ktime_t\">ktime_t</a> <a class=\"id\" href=\"#expires\">expires</a>, *<a class=\"id\" href=\"#timeout\">timeout</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#ts\">ts</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#prepare_timeout\">prepare_timeout</a>(<a class=\"id\" href=\"#u_abs_timeout\">u_abs_timeout</a>, &amp;<a class=\"id\" href=\"#expires\">expires</a>, &amp;<a class=\"id\" href=\"#ts\">ts</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = &amp;<a class=\"id\" href=\"#expires\">expires</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_mq_sendrecv\">audit_mq_sendrecv</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>, <a class=\"id\" href=\"#msg_len\">msg_len</a>, 0, <a class=\"id\" href=\"#timeout\">timeout</a> ? &amp;<a class=\"id\" href=\"#ts\">ts</a> : <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#fget\">fget</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#filp\">filp</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_op\">f_op</a> != &amp;<a class=\"id\" href=\"#mqueue_file_operations\">mqueue_file_operations</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#MQUEUE_I\">MQUEUE_I</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_inode\">audit_inode</a>(<a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_mode\">f_mode</a> &amp; <a class=\"id\" href=\"#FMODE_READ\">FMODE_READ</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* checks if buffer is big enough */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#msg_len\">msg_len</a> &lt; <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_msgsize\">mq_msgsize</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mq_curmsgs\">mq_curmsgs</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_flags\">f_flags</a> &amp; <a class=\"id\" href=\"#O_NONBLOCK\">O_NONBLOCK</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wait\">wait</a>.<a class=\"id\" href=\"#task\">task</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wait\">wait</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#STATE_NONE\">STATE_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#wq_sleep\">wq_sleep</a>(<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#RECV\">RECV</a>, <a class=\"id\" href=\"#timeout\">timeout</a>, &amp;<a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg_ptr\">msg_ptr</a> = <a class=\"id\" href=\"#wait\">wait</a>.<a class=\"id\" href=\"#msg\">msg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg_ptr\">msg_ptr</a> = <a class=\"id\" href=\"#msg_get\">msg_get</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mtime\">i_mtime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* There is now free space in queue. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pipelined_receive\">pipelined_receive</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>-><a class=\"id\" href=\"#m_ts\">m_ts</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#u_msg_prio\">u_msg_prio</a> && <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>-><a class=\"id\" href=\"#m_type\">m_type</a>, <a class=\"id\" href=\"#u_msg_prio\">u_msg_prio</a>)) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#store_msg\">store_msg</a>(<a class=\"id\" href=\"#u_msg_ptr\">u_msg_ptr</a>, <a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>, <a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>-><a class=\"id\" href=\"#m_ts\">m_ts</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_msg\">free_msg</a>(<a class=\"id\" href=\"#msg_ptr\">msg_ptr</a>);", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out_fput\">out_fput</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fput\">fput</a>(<a class=\"id\" href=\"#filp\">filp</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Notes: the case when user wants us to deregister (with NULL as pointer)</span>", 
"<span class=\"comment\"> * and he isn't currently owner of notification, will be silently discarded.</span>", 
"<span class=\"comment\"> * It isn't explicitly defined in the POSIX.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#SYSCALL_DEFINE2\">SYSCALL_DEFINE2</a>(<a class=\"id\" href=\"#mq_notify\">mq_notify</a>, <a class=\"id\" href=\"#mqd_t\">mqd_t</a>, <a class=\"id\" href=\"#mqdes\">mqdes</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#sigevent\">sigevent</a> <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_notification\">u_notification</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sock\">sock</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sigevent\">sigevent</a> <a class=\"id\" href=\"#notification\">notification</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#nc\">nc</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_notification\">u_notification</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#notification\">notification</a>, <a class=\"id\" href=\"#u_notification\">u_notification</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(struct <a class=\"id\" href=\"#sigevent\">sigevent</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_mq_notify\">audit_mq_notify</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>, <a class=\"id\" href=\"#u_notification\">u_notification</a> ? &amp;<a class=\"id\" href=\"#notification\">notification</a> : <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nc\">nc</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_notification\">u_notification</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> != <a class=\"id\" href=\"#SIGEV_NONE\">SIGEV_NONE</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> != <a class=\"id\" href=\"#SIGEV_SIGNAL\">SIGEV_SIGNAL</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> != <a class=\"id\" href=\"#SIGEV_THREAD\">SIGEV_THREAD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> == <a class=\"id\" href=\"#SIGEV_SIGNAL\">SIGEV_SIGNAL</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>!<a class=\"id\" href=\"#valid_signal\">valid_signal</a>(<a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_signo\">sigev_signo</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> == <a class=\"id\" href=\"#SIGEV_THREAD\">SIGEV_THREAD</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#timeo\">timeo</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* create the notify skb */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nc\">nc</a> = <a class=\"id\" href=\"#alloc_skb\">alloc_skb</a>(<a class=\"id\" href=\"#NOTIFY_COOKIE_LEN\">NOTIFY_COOKIE_LEN</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#nc\">nc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#nc\">nc</a>-><a class=\"id\" href=\"#data\">data</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_value\">sigev_value</a>.<a class=\"id\" href=\"#sival_ptr\">sival_ptr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NOTIFY_COOKIE_LEN\">NOTIFY_COOKIE_LEN</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* TODO: add a header? */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#nc\">nc</a>, <a class=\"id\" href=\"#NOTIFY_COOKIE_LEN\">NOTIFY_COOKIE_LEN</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* and attach it to the socket */</span>", 
"<a class=\"id\" href=\"#retry\">retry</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#fget\">fget</a>(<a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_signo\">sigev_signo</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#filp\">filp</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#netlink_getsockbyfilp\">netlink_getsockbyfilp</a>(<a class=\"id\" href=\"#filp\">filp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fput\">fput</a>(<a class=\"id\" href=\"#filp\">filp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#sock\">sock</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#sock\">sock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeo\">timeo</a> = <a class=\"id\" href=\"#MAX_SCHEDULE_TIMEOUT\">MAX_SCHEDULE_TIMEOUT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#netlink_attachskb\">netlink_attachskb</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#nc\">nc</a>, &amp;<a class=\"id\" href=\"#timeo\">timeo</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> == 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#retry\">retry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nc\">nc</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#fget\">fget</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#filp\">filp</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_op\">f_op</a> != &amp;<a class=\"id\" href=\"#mqueue_file_operations\">mqueue_file_operations</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#MQUEUE_I\">MQUEUE_I</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_notification\">u_notification</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> == <a class=\"id\" href=\"#task_tgid\">task_tgid</a>(<a class=\"id\" href=\"#current\">current</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#remove_notification\">remove_notification</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SIGEV_NONE\">SIGEV_NONE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> = <a class=\"id\" href=\"#SIGEV_NONE\">SIGEV_NONE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SIGEV_THREAD\">SIGEV_THREAD</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_sock\">notify_sock</a> = <a class=\"id\" href=\"#sock\">sock</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_cookie\">notify_cookie</a> = <a class=\"id\" href=\"#nc\">nc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nc\">nc</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> = <a class=\"id\" href=\"#SIGEV_THREAD\">SIGEV_THREAD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SIGEV_SIGNAL\">SIGEV_SIGNAL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_signo\">sigev_signo</a> = <a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_signo\">sigev_signo</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_value\">sigev_value</a> = <a class=\"id\" href=\"#notification\">notification</a>.<a class=\"id\" href=\"#sigev_value\">sigev_value</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify\">notify</a>.<a class=\"id\" href=\"#sigev_notify\">sigev_notify</a> = <a class=\"id\" href=\"#SIGEV_SIGNAL\">SIGEV_SIGNAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#notify_owner\">notify_owner</a> = <a class=\"id\" href=\"#get_pid\">get_pid</a>(<a class=\"id\" href=\"#task_tgid\">task_tgid</a>(<a class=\"id\" href=\"#current\">current</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<a class=\"id\" href=\"#out_fput\">out_fput</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fput\">fput</a>(<a class=\"id\" href=\"#filp\">filp</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_detachskb\">netlink_detachskb</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#nc\">nc</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#nc\">nc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_kfree_skb\">dev_kfree_skb</a>(<a class=\"id\" href=\"#nc\">nc</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#SYSCALL_DEFINE3\">SYSCALL_DEFINE3</a>(<a class=\"id\" href=\"#mq_getsetattr\">mq_getsetattr</a>, <a class=\"id\" href=\"#mqd_t\">mqd_t</a>, <a class=\"id\" href=\"#mqdes\">mqdes</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a> <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_mqstat\">u_mqstat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a> <a class=\"id\" href=\"#__user\">__user</a> *, <a class=\"id\" href=\"#u_omqstat\">u_omqstat</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a> <a class=\"id\" href=\"#mqstat\">mqstat</a>, <a class=\"id\" href=\"#omqstat\">omqstat</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#filp\">filp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_mqstat\">u_mqstat</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#mqstat\">mqstat</a>, <a class=\"id\" href=\"#u_mqstat\">u_mqstat</a>, sizeof(struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mqstat\">mqstat</a>.<a class=\"id\" href=\"#mq_flags\">mq_flags</a> &amp; (~<a class=\"id\" href=\"#O_NONBLOCK\">O_NONBLOCK</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a> = <a class=\"id\" href=\"#fget\">fget</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#filp\">filp</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_path\">f_path</a>.<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_op\">f_op</a> != &amp;<a class=\"id\" href=\"#mqueue_file_operations\">mqueue_file_operations</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fput\">out_fput</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = <a class=\"id\" href=\"#MQUEUE_I\">MQUEUE_I</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#omqstat\">omqstat</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attr\">attr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#omqstat\">omqstat</a>.<a class=\"id\" href=\"#mq_flags\">mq_flags</a> = <a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_flags\">f_flags</a> &amp; <a class=\"id\" href=\"#O_NONBLOCK\">O_NONBLOCK</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_mqstat\">u_mqstat</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_mq_getsetattr\">audit_mq_getsetattr</a>(<a class=\"id\" href=\"#mqdes\">mqdes</a>, &amp;<a class=\"id\" href=\"#mqstat\">mqstat</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_lock\">f_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mqstat\">mqstat</a>.<a class=\"id\" href=\"#mq_flags\">mq_flags</a> &amp; <a class=\"id\" href=\"#O_NONBLOCK\">O_NONBLOCK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_flags\">f_flags</a> |= <a class=\"id\" href=\"#O_NONBLOCK\">O_NONBLOCK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_flags\">f_flags</a> &= ~<a class=\"id\" href=\"#O_NONBLOCK\">O_NONBLOCK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#filp\">filp</a>-><a class=\"id\" href=\"#f_lock\">f_lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_atime\">i_atime</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_ctime\">i_ctime</a> = <a class=\"id\" href=\"#CURRENT_TIME\">CURRENT_TIME</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#u_omqstat\">u_omqstat</a> != <a class=\"id\" href=\"#NULL\">NULL</a> && <a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#u_omqstat\">u_omqstat</a>, &amp;<a class=\"id\" href=\"#omqstat\">omqstat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(struct <a class=\"id\" href=\"#mq_attr\">mq_attr</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<a class=\"id\" href=\"#out_fput\">out_fput</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fput\">fput</a>(<a class=\"id\" href=\"#filp\">filp</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#inode_operations\">inode_operations</a> <a class=\"id\" href=\"#mqueue_dir_inode_operations\">mqueue_dir_inode_operations</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#lookup\">lookup</a> = <a class=\"id\" href=\"#simple_lookup\">simple_lookup</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#create\">create</a> = <a class=\"id\" href=\"#mqueue_create\">mqueue_create</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#unlink\">unlink</a> = <a class=\"id\" href=\"#mqueue_unlink\">mqueue_unlink</a>,", 
"};", 
"", 
"static const struct <a class=\"id\" href=\"#file_operations\">file_operations</a> <a class=\"id\" href=\"#mqueue_file_operations\">mqueue_file_operations</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flush\">flush</a> = <a class=\"id\" href=\"#mqueue_flush_file\">mqueue_flush_file</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#poll\">poll</a> = <a class=\"id\" href=\"#mqueue_poll_file\">mqueue_poll_file</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#read\">read</a> = <a class=\"id\" href=\"#mqueue_read_file\">mqueue_read_file</a>,", 
"};", 
"", 
"static const struct <a class=\"id\" href=\"#super_operations\">super_operations</a> <a class=\"id\" href=\"#mqueue_super_ops\">mqueue_super_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#alloc_inode\">alloc_inode</a> = <a class=\"id\" href=\"#mqueue_alloc_inode\">mqueue_alloc_inode</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#destroy_inode\">destroy_inode</a> = <a class=\"id\" href=\"#mqueue_destroy_inode\">mqueue_destroy_inode</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#evict_inode\">evict_inode</a> = <a class=\"id\" href=\"#mqueue_evict_inode\">mqueue_evict_inode</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#statfs\">statfs</a> = <a class=\"id\" href=\"#simple_statfs\">simple_statfs</a>,", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#file_system_type\">file_system_type</a> <a class=\"id\" href=\"#mqueue_fs_type\">mqueue_fs_type</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = \"mqueue\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_sb\">get_sb</a> = <a class=\"id\" href=\"#mqueue_get_sb\">mqueue_get_sb</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#kill_sb\">kill_sb</a> = <a class=\"id\" href=\"#kill_litter_super\">kill_litter_super</a>,", 
"};", 
"", 
"int <a class=\"id\" href=\"#mq_init_ns\">mq_init_ns</a>(struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ns\">ns</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_queues_count\">mq_queues_count</a>  = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_queues_max\">mq_queues_max</a>    = <a class=\"id\" href=\"#DFLT_QUEUESMAX\">DFLT_QUEUESMAX</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_msg_max\">mq_msg_max</a>       = <a class=\"id\" href=\"#DFLT_MSGMAX\">DFLT_MSGMAX</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_msgsize_max\">mq_msgsize_max</a>   = <a class=\"id\" href=\"#DFLT_MSGSIZEMAX\">DFLT_MSGSIZEMAX</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a> = <a class=\"id\" href=\"#kern_mount_data\">kern_mount_data</a>(&amp;<a class=\"id\" href=\"#mqueue_fs_type\">mqueue_fs_type</a>, <a class=\"id\" href=\"#ns\">ns</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"void <a class=\"id\" href=\"#mq_clear_sbinfo\">mq_clear_sbinfo</a>(struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ns\">ns</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>-><a class=\"id\" href=\"#mnt_sb\">mnt_sb</a>-><a class=\"id\" href=\"#s_fs_info\">s_fs_info</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#mq_put_mnt\">mq_put_mnt</a>(struct <a class=\"id\" href=\"#ipc_namespace\">ipc_namespace</a> *<a class=\"id\" href=\"#ns\">ns</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mntput\">mntput</a>(<a class=\"id\" href=\"#ns\">ns</a>-><a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#init_mqueue_fs\">init_mqueue_fs</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mqueue_inode_cachep\">mqueue_inode_cachep</a> = <a class=\"id\" href=\"#kmem_cache_create\">kmem_cache_create</a>(\"mqueue_inode_cache\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(struct <a class=\"id\" href=\"#mqueue_inode_info\">mqueue_inode_info</a>), 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#SLAB_HWCACHE_ALIGN\">SLAB_HWCACHE_ALIGN</a>, <a class=\"id\" href=\"#init_once\">init_once</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#mqueue_inode_cachep\">mqueue_inode_cachep</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* ignore failures - they are not fatal */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mq_sysctl_table\">mq_sysctl_table</a> = <a class=\"id\" href=\"#mq_register_sysctl_table\">mq_register_sysctl_table</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#register_filesystem\">register_filesystem</a>(&amp;<a class=\"id\" href=\"#mqueue_fs_type\">mqueue_fs_type</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_sysctl\">out_sysctl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#mq_lock\">mq_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#init_ipc_ns\">init_ipc_ns</a>.<a class=\"id\" href=\"#mq_mnt\">mq_mnt</a> = <a class=\"id\" href=\"#kern_mount_data\">kern_mount_data</a>(&amp;<a class=\"id\" href=\"#mqueue_fs_type\">mqueue_fs_type</a>, &amp;<a class=\"id\" href=\"#init_ipc_ns\">init_ipc_ns</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#init_ipc_ns\">init_ipc_ns</a>.<a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#init_ipc_ns\">init_ipc_ns</a>.<a class=\"id\" href=\"#mq_mnt\">mq_mnt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_filesystem\">out_filesystem</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#out_filesystem\">out_filesystem</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unregister_filesystem\">unregister_filesystem</a>(&amp;<a class=\"id\" href=\"#mqueue_fs_type\">mqueue_fs_type</a>);", 
"<a class=\"id\" href=\"#out_sysctl\">out_sysctl</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#mq_sysctl_table\">mq_sysctl_table</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#unregister_sysctl_table\">unregister_sysctl_table</a>(<a class=\"id\" href=\"#mq_sysctl_table\">mq_sysctl_table</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kmem_cache_destroy\">kmem_cache_destroy</a>(<a class=\"id\" href=\"#mqueue_inode_cachep\">mqueue_inode_cachep</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#__initcall\">__initcall</a>(<a class=\"id\" href=\"#init_mqueue_fs\">init_mqueue_fs</a>);", 
];
xr_frag_insert('l/5b/9a49af0bcda7e3885cc88dd32f005b02580494.xr', __xr_tmp);
