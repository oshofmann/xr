var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Netlink event notifications for SELinux.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author: James Morris &lt;jmorris@redhat.com&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (C) 2004 Red Hat, Inc., James Morris &lt;jmorris@redhat.com&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of the GNU General Public License version 2,</span>", 
"<span class=\"comment\"> * as published by the Free Software Foundation.</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#stddef\">stddef</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#skbuff\">skbuff</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netlink\">netlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#selinux_netlink\">selinux_netlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#net_namespace\">net_namespace</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"static struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#selnl\">selnl</a>;", 
"", 
"static int <a class=\"id\" href=\"#selnl_msglen\">selnl_msglen</a>(int <a class=\"id\" href=\"#msgtype\">msgtype</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#msgtype\">msgtype</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SELNL_MSG_SETENFORCE\">SELNL_MSG_SETENFORCE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = sizeof(struct <a class=\"id\" href=\"#selnl_msg_setenforce\">selnl_msg_setenforce</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SELNL_MSG_POLICYLOAD\">SELNL_MSG_POLICYLOAD</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = sizeof(struct <a class=\"id\" href=\"#selnl_msg_policyload\">selnl_msg_policyload</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#selnl_add_payload\">selnl_add_payload</a>(struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>, int <a class=\"id\" href=\"#len\">len</a>, int <a class=\"id\" href=\"#msgtype\">msgtype</a>, void *<a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#msgtype\">msgtype</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SELNL_MSG_SETENFORCE\">SELNL_MSG_SETENFORCE</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#selnl_msg_setenforce\">selnl_msg_setenforce</a> *<a class=\"id\" href=\"#msg\">msg</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#msg\">msg</a>, 0, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#val\">val</a> = *((int *)<a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SELNL_MSG_POLICYLOAD\">SELNL_MSG_POLICYLOAD</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#selnl_msg_policyload\">selnl_msg_policyload</a> *<a class=\"id\" href=\"#msg\">msg</a> = <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#msg\">msg</a>, 0, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#seqno\">seqno</a> = *((<a class=\"id\" href=\"#u32\">u32</a> *)<a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#selnl_notify\">selnl_notify</a>(int <a class=\"id\" href=\"#msgtype\">msgtype</a>, void *<a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_buff_data_t\">sk_buff_data_t</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#selnl_msglen\">selnl_msglen</a>(<a class=\"id\" href=\"#msgtype\">msgtype</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#alloc_skb\">alloc_skb</a>(<a class=\"id\" href=\"#NLMSG_SPACE\">NLMSG_SPACE</a>(<a class=\"id\" href=\"#len\">len</a>), <a class=\"id\" href=\"#GFP_USER\">GFP_USER</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#oom\">oom</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tail\">tail</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#NLMSG_PUT\">NLMSG_PUT</a>(<a class=\"id\" href=\"#skb\">skb</a>, 0, 0, <a class=\"id\" href=\"#msgtype\">msgtype</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#selnl_add_payload\">selnl_add_payload</a>(<a class=\"id\" href=\"#nlh\">nlh</a>, <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#msgtype\">msgtype</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tail\">tail</a> - <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#dst_group\">dst_group</a> = <a class=\"id\" href=\"#SELNLGRP_AVC\">SELNLGRP_AVC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_broadcast\">netlink_broadcast</a>(<a class=\"id\" href=\"#selnl\">selnl</a>, <a class=\"id\" href=\"#skb\">skb</a>, 0, <a class=\"id\" href=\"#SELNLGRP_AVC\">SELNLGRP_AVC</a>, <a class=\"id\" href=\"#GFP_USER\">GFP_USER</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return;", 
"", 
"<a class=\"id\" href=\"#nlmsg_failure\">nlmsg_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#oom\">oom</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"SELinux:  OOM in %s\\n\", <a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#selnl_notify_setenforce\">selnl_notify_setenforce</a>(int <a class=\"id\" href=\"#val\">val</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#selnl_notify\">selnl_notify</a>(<a class=\"id\" href=\"#SELNL_MSG_SETENFORCE\">SELNL_MSG_SETENFORCE</a>, &amp;<a class=\"id\" href=\"#val\">val</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#selnl_notify_policyload\">selnl_notify_policyload</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seqno\">seqno</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#selnl_notify\">selnl_notify</a>(<a class=\"id\" href=\"#SELNL_MSG_POLICYLOAD\">SELNL_MSG_POLICYLOAD</a>, &amp;<a class=\"id\" href=\"#seqno\">seqno</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#selnl_init\">selnl_init</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#selnl\">selnl</a> = <a class=\"id\" href=\"#netlink_kernel_create\">netlink_kernel_create</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, <a class=\"id\" href=\"#NETLINK_SELINUX\">NETLINK_SELINUX</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#SELNLGRP_MAX\">SELNLGRP_MAX</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#selnl\">selnl</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#panic\">panic</a>(\"SELinux:  Cannot create netlink socket.\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_set_nonroot\">netlink_set_nonroot</a>(<a class=\"id\" href=\"#NETLINK_SELINUX\">NETLINK_SELINUX</a>, <a class=\"id\" href=\"#NL_NONROOT_RECV\">NL_NONROOT_RECV</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<a class=\"id\" href=\"#__initcall\">__initcall</a>(<a class=\"id\" href=\"#selnl_init\">selnl_init</a>);", 
];
xr_frag_insert('l/5e/dac8ec8ccfa5c87f409e80186b14779634138d.xr', __xr_tmp);
