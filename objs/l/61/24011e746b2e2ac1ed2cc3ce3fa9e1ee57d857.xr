var __xr_tmp = [
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#__LINUX_NET_SCM_H\">__LINUX_NET_SCM_H</a>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#__LINUX_NET_SCM_H\">__LINUX_NET_SCM_H</a>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#limits\">limits</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#net\">net</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#security\">security</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pid\">pid</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#nsproxy\">nsproxy</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"<span class=\"comment\">/* Well, we should have at least one descriptor open</span>", 
"<span class=\"comment\"> * to accept passed FDs 8)</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#SCM_MAX_FD\">SCM_MAX_FD</a><span class=\"ts\"/>255", 
"", 
"struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a><span class=\"ts\"/><a class=\"id\" href=\"#list\">list</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#fp\">fp</a>[<a class=\"id\" href=\"#SCM_MAX_FD\">SCM_MAX_FD</a>];", 
"};", 
"", 
"struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pid\">pid</a><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#pid\">pid</a>;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Skb credentials */</span>", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#cred\">cred</a><span class=\"ts\"/>*<a class=\"id\" href=\"#cred\">cred</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a><span class=\"ts\"/>*<a class=\"id\" href=\"#fp\">fp</a>;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Passed files<span class=\"ts\"/><span class=\"ts\"/>*/</span>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ucred\">ucred</a><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#creds\">creds</a>;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Skb credentials<span class=\"ts\"/>*/</span>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SECURITY_NETWORK\">CONFIG_SECURITY_NETWORK</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secid\">secid</a>;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Passed security ID <span class=\"ts\"/>*/</span>", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"};", 
"", 
"extern void <a class=\"id\" href=\"#scm_detach_fds\">scm_detach_fds</a>(struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>);", 
"extern void <a class=\"id\" href=\"#scm_detach_fds_compat\">scm_detach_fds_compat</a>(struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>);", 
"extern int <a class=\"id\" href=\"#__scm_send\">__scm_send</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>);", 
"extern void <a class=\"id\" href=\"#__scm_destroy\">__scm_destroy</a>(struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>);", 
"extern struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> * <a class=\"id\" href=\"#scm_fp_dup\">scm_fp_dup</a>(struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> *<a class=\"id\" href=\"#fpl\">fpl</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SECURITY_NETWORK\">CONFIG_SECURITY_NETWORK</a>", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> void <a class=\"id\" href=\"#unix_get_peersec_dgram\">unix_get_peersec_dgram</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_socket_getpeersec_dgram\">security_socket_getpeersec_dgram</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, &amp;<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"}", 
"#else", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> void <a class=\"id\" href=\"#unix_get_peersec_dgram\">unix_get_peersec_dgram</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{ }", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_SECURITY_NETWORK */</span>", 
"", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> void <a class=\"id\" href=\"#scm_set_cred\">scm_set_cred</a>(struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#pid\">pid</a> *<a class=\"id\" href=\"#pid\">pid</a>, const struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#cred\">cred</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#pid\">pid</a>  = <a class=\"id\" href=\"#get_pid\">get_pid</a>(<a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#get_cred\">get_cred</a>(<a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cred_to_ucred\">cred_to_ucred</a>(<a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#cred\">cred</a>, &amp;<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#creds\">creds</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> void <a class=\"id\" href=\"#scm_destroy_cred\">scm_destroy_cred</a>(struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_pid\">put_pid</a>(<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#pid\">pid</a>  = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#cred\">cred</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_cred\">put_cred</a>(<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> void <a class=\"id\" href=\"#scm_destroy\">scm_destroy</a>(struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_destroy_cred\">scm_destroy_cred</a>(<a class=\"id\" href=\"#scm\">scm</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#scm\">scm</a> && <a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__scm_destroy\">__scm_destroy</a>(<a class=\"id\" href=\"#scm\">scm</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> int <a class=\"id\" href=\"#scm_send\">scm_send</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_set_cred\">scm_set_cred</a>(<a class=\"id\" href=\"#scm\">scm</a>, <a class=\"id\" href=\"#task_tgid\">task_tgid</a>(<a class=\"id\" href=\"#current\">current</a>), <a class=\"id\" href=\"#current_cred\">current_cred</a>());", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unix_get_peersec_dgram\">unix_get_peersec_dgram</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#scm\">scm</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__scm_send\">__scm_send</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#scm\">scm</a>);", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SECURITY_NETWORK\">CONFIG_SECURITY_NETWORK</a>", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#scm_passec\">scm_passec</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#secdata\">secdata</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seclen\">seclen</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#SOCK_PASSSEC\">SOCK_PASSSEC</a>, &amp;<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#flags\">flags</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_secid_to_secctx\">security_secid_to_secctx</a>(<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#secid\">secid</a>, &amp;<a class=\"id\" href=\"#secdata\">secdata</a>, &amp;<a class=\"id\" href=\"#seclen\">seclen</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_cmsg\">put_cmsg</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#SOL_SOCKET\">SOL_SOCKET</a>, <a class=\"id\" href=\"#SCM_SECURITY\">SCM_SECURITY</a>, <a class=\"id\" href=\"#seclen\">seclen</a>, <a class=\"id\" href=\"#secdata\">secdata</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_release_secctx\">security_release_secctx</a>(<a class=\"id\" href=\"#secdata\">secdata</a>, <a class=\"id\" href=\"#seclen\">seclen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"#else", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#scm_passec\">scm_passec</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{ }", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_SECURITY_NETWORK */</span>", 
"", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> void <a class=\"id\" href=\"#scm_recv\">scm_recv</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>, int <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_control\">msg_control</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#SOCK_PASSCRED\">SOCK_PASSCRED</a>, &amp;<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#flags\">flags</a>) || <a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_CTRUNC\">MSG_CTRUNC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scm_destroy\">scm_destroy</a>(<a class=\"id\" href=\"#scm\">scm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#SOCK_PASSCRED\">SOCK_PASSCRED</a>, &amp;<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#flags\">flags</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_cmsg\">put_cmsg</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#SOL_SOCKET\">SOL_SOCKET</a>, <a class=\"id\" href=\"#SCM_CREDENTIALS\">SCM_CREDENTIALS</a>, sizeof(<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#creds\">creds</a>), &amp;<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#creds\">creds</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_destroy_cred\">scm_destroy_cred</a>(<a class=\"id\" href=\"#scm\">scm</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_passec\">scm_passec</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#scm\">scm</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_detach_fds\">scm_detach_fds</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#scm\">scm</a>);", 
"}", 
"", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* __LINUX_NET_SCM_H */</span>", 
"", 
];
xr_frag_insert('l/61/24011e746b2e2ac1ed2cc3ce3fa9e1ee57d857.xr', __xr_tmp);
