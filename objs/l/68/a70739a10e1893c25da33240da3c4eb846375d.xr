var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * net/dsa/tag_trailer.c - Trailer tag format handling</span>", 
"<span class=\"comment\"> * Copyright (c) 2008-2009 Marvell Semiconductor</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of the GNU General Public License as published by</span>", 
"<span class=\"comment\"> * the Free Software Foundation; either version 2 of the License, or</span>", 
"<span class=\"comment\"> * (at your option) any later version.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#etherdevice\">etherdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"dsa_priv.h\"", 
"", 
"<a class=\"id\" href=\"#netdev_tx_t\">netdev_tx_t</a> <a class=\"id\" href=\"#trailer_xmit\">trailer_xmit</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dsa_slave_priv\">dsa_slave_priv</a> *<a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#nskb\">nskb</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#padlen\">padlen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#trailer\">trailer</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#tx_packets\">tx_packets</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#tx_bytes\">tx_bytes</a> += <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * We have to make sure that the trailer ends up as the very</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * last 4 bytes of the packet.  This means that we have to pad</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * the packet to the minimum ethernet frame size, if necessary,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * before adding the trailer.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#padlen\">padlen</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> &lt; 60)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#padlen\">padlen</a> = 60 - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nskb\">nskb</a> = <a class=\"id\" href=\"#alloc_skb\">alloc_skb</a>(<a class=\"id\" href=\"#NET_IP_ALIGN\">NET_IP_ALIGN</a> + <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> + <a class=\"id\" href=\"#padlen\">padlen</a> + 4, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nskb\">nskb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NETDEV_TX_OK\">NETDEV_TX_OK</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reserve\">skb_reserve</a>(<a class=\"id\" href=\"#nskb\">nskb</a>, <a class=\"id\" href=\"#NET_IP_ALIGN\">NET_IP_ALIGN</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reset_mac_header\">skb_reset_mac_header</a>(<a class=\"id\" href=\"#nskb\">nskb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_set_network_header\">skb_set_network_header</a>(<a class=\"id\" href=\"#nskb\">nskb</a>, <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>) - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_set_transport_header\">skb_set_transport_header</a>(<a class=\"id\" href=\"#nskb\">nskb</a>, <a class=\"id\" href=\"#skb_transport_header\">skb_transport_header</a>(<a class=\"id\" href=\"#skb\">skb</a>) - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_copy_and_csum_dev\">skb_copy_and_csum_dev</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#nskb\">nskb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#padlen\">padlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#pad\">pad</a> = <a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#nskb\">nskb</a>, <a class=\"id\" href=\"#padlen\">padlen</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#pad\">pad</a>, 0, <a class=\"id\" href=\"#padlen\">padlen</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#trailer\">trailer</a> = <a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#nskb\">nskb</a>, 4);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#trailer\">trailer</a>[0] = 0x80;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#trailer\">trailer</a>[1] = 1 << <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#port\">port</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#trailer\">trailer</a>[2] = 0x10;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#trailer\">trailer</a>[3] = 0x00;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nskb\">nskb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#ETH_P_TRAILER\">ETH_P_TRAILER</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nskb\">nskb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#master_netdev\">master_netdev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_queue_xmit\">dev_queue_xmit</a>(<a class=\"id\" href=\"#nskb\">nskb</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NETDEV_TX_OK\">NETDEV_TX_OK</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#trailer_rcv\">trailer_rcv</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#packet_type\">packet_type</a> *<a class=\"id\" href=\"#pt\">pt</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#orig_dev\">orig_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dsa_switch_tree\">dsa_switch_tree</a> *<a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dsa_ptr\">dsa_ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dsa_switch\">dsa_switch</a> *<a class=\"id\" href=\"#ds\">ds</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#trailer\">trailer</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#source_port\">source_port</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#dst\">dst</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_drop\">out_drop</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ds\">ds</a> = <a class=\"id\" href=\"#dst\">dst</a>-><a class=\"id\" href=\"#ds\">ds</a>[0];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb_unshare\">skb_unshare</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_linearize\">skb_linearize</a>(<a class=\"id\" href=\"#skb\">skb</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_drop\">out_drop</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#trailer\">trailer</a> = <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>) - 4;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#trailer\">trailer</a>[0] != 0x80 || (<a class=\"id\" href=\"#trailer\">trailer</a>[1] &amp; 0xf8) != 0x00 ||", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#trailer\">trailer</a>[3] &amp; 0xef) != 0x00 || <a class=\"id\" href=\"#trailer\">trailer</a>[3] != 0x00)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_drop\">out_drop</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#source_port\">source_port</a> = <a class=\"id\" href=\"#trailer\">trailer</a>[1] &amp; 7;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#source_port\">source_port</a> >= <a class=\"id\" href=\"#DSA_MAX_PORTS\">DSA_MAX_PORTS</a> || <a class=\"id\" href=\"#ds\">ds</a>-><a class=\"id\" href=\"#ports\">ports</a>[<a class=\"id\" href=\"#source_port\">source_port</a>] == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_drop\">out_drop</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pskb_trim_rcsum\">pskb_trim_rcsum</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> - 4);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ds\">ds</a>-><a class=\"id\" href=\"#ports\">ports</a>[<a class=\"id\" href=\"#source_port\">source_port</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_push\">skb_push</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ETH_HLEN\">ETH_HLEN</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a> = <a class=\"id\" href=\"#PACKET_HOST\">PACKET_HOST</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#eth_type_trans\">eth_type_trans</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#rx_packets\">rx_packets</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#rx_bytes\">rx_bytes</a> += <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netif_receive_skb\">netif_receive_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#out_drop\">out_drop</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#packet_type\">packet_type</a> <a class=\"id\" href=\"#trailer_packet_type\">trailer_packet_type</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#type\">type</a><span class=\"ts\"/>= <a class=\"id\" href=\"#cpu_to_be16\">cpu_to_be16</a>(<a class=\"id\" href=\"#ETH_P_TRAILER\">ETH_P_TRAILER</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#func\">func</a><span class=\"ts\"/>= <a class=\"id\" href=\"#trailer_rcv\">trailer_rcv</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#trailer_init_module\">trailer_init_module</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_add_pack\">dev_add_pack</a>(&amp;<a class=\"id\" href=\"#trailer_packet_type\">trailer_packet_type</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#module_init\">module_init</a>(<a class=\"id\" href=\"#trailer_init_module\">trailer_init_module</a>);", 
"", 
"static void <a class=\"id\" href=\"#__exit\">__exit</a> <a class=\"id\" href=\"#trailer_cleanup_module\">trailer_cleanup_module</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_remove_pack\">dev_remove_pack</a>(&amp;<a class=\"id\" href=\"#trailer_packet_type\">trailer_packet_type</a>);", 
"}", 
"<a class=\"id\" href=\"#module_exit\">module_exit</a>(<a class=\"id\" href=\"#trailer_cleanup_module\">trailer_cleanup_module</a>);", 
];
xr_frag_insert('l/68/a70739a10e1893c25da33240da3c4eb846375d.xr', __xr_tmp);
