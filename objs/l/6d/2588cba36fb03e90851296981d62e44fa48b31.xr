var __xr_tmp = [
"<span class=\"comment\">/* -*- linux-c -*- ------------------------------------------------------- *</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *   Copyright (C) 1991, 1992 Linus Torvalds</span>", 
"<span class=\"comment\"> *   Copyright 2007 rPath, Inc. - All Rights Reserved</span>", 
"<span class=\"comment\"> *   Copyright 2009 Intel Corporation; author H. Peter Anvin</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *   This file is part of the Linux kernel, and is made available under</span>", 
"<span class=\"comment\"> *   the terms of the GNU General Public License version 2.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * ----------------------------------------------------------------------- */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * VESA text modes</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> \"boot.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"video.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"vesa.h\"", 
"", 
"<span class=\"comment\">/* VESA information */</span>", 
"static struct <a class=\"id\" href=\"#vesa_general_info\">vesa_general_info</a> <a class=\"id\" href=\"#vginfo\">vginfo</a>;", 
"static struct <a class=\"id\" href=\"#vesa_mode_info\">vesa_mode_info</a> <a class=\"id\" href=\"#vminfo\">vminfo</a>;", 
"", 
"static <a class=\"id\" href=\"#__videocard\">__videocard</a> <a class=\"id\" href=\"#video_vesa\">video_vesa</a>;", 
"", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#_WAKEUP\">_WAKEUP</a>", 
"static void <a class=\"id\" href=\"#vesa_store_mode_params_graphics\">vesa_store_mode_params_graphics</a>(void);", 
"#else <span class=\"comment\">/* _WAKEUP */</span>", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#vesa_store_mode_params_graphics\">vesa_store_mode_params_graphics</a>(void) {}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* _WAKEUP */</span>", 
"", 
"static int <a class=\"id\" href=\"#vesa_probe\">vesa_probe</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#biosregs\">biosregs</a> <a class=\"id\" href=\"#ireg\">ireg</a>, <a class=\"id\" href=\"#oreg\">oreg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addr_t\">addr_t</a> <a class=\"id\" href=\"#mode_ptr\">mode_ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mode_info\">mode_info</a> *<a class=\"id\" href=\"#mi\">mi</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nmodes\">nmodes</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#video_vesa\">video_vesa</a>.<a class=\"id\" href=\"#modes\">modes</a> = <a class=\"id\" href=\"#GET_HEAP\">GET_HEAP</a>(struct <a class=\"id\" href=\"#mode_info\">mode_info</a>, 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#initregs\">initregs</a>(&amp;<a class=\"id\" href=\"#ireg\">ireg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f00;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#di\">di</a> = (<a class=\"id\" href=\"#size_t\">size_t</a>)&amp;<a class=\"id\" href=\"#vginfo\">vginfo</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#ax\">ax</a> != 0x004f ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#vginfo\">vginfo</a>.<a class=\"id\" href=\"#signature\">signature</a> != <a class=\"id\" href=\"#VESA_MAGIC\">VESA_MAGIC</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#vginfo\">vginfo</a>.<a class=\"id\" href=\"#version\">version</a> &lt; 0x0102)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;<span class=\"ts\"/><span class=\"comment\">/* Not present */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_fs\">set_fs</a>(<a class=\"id\" href=\"#vginfo\">vginfo</a>.<a class=\"id\" href=\"#video_mode_ptr\">video_mode_ptr</a>.<a class=\"id\" href=\"#seg\">seg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mode_ptr\">mode_ptr</a> = <a class=\"id\" href=\"#vginfo\">vginfo</a>.<a class=\"id\" href=\"#video_mode_ptr\">video_mode_ptr</a>.<a class=\"id\" href=\"#off\">off</a>;", 
"", 
"<span class=\"ts\"/>while ((<a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#rdfs16\">rdfs16</a>(<a class=\"id\" href=\"#mode_ptr\">mode_ptr</a>)) != 0xffff) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mode_ptr\">mode_ptr</a> += 2;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#heap_free\">heap_free</a>(sizeof(struct <a class=\"id\" href=\"#mode_info\">mode_info</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;<span class=\"ts\"/><span class=\"comment\">/* Heap full, can't save mode info */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mode\">mode</a> &amp; ~0x1ff)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#vminfo\">vminfo</a>, 0, sizeof <a class=\"id\" href=\"#vminfo\">vminfo</a>); <span class=\"comment\">/* Just in case... */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f01;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#cx\">cx</a> = <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#di\">di</a> = (<a class=\"id\" href=\"#size_t\">size_t</a>)&amp;<a class=\"id\" href=\"#vminfo\">vminfo</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#ax\">ax</a> != 0x004f)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#mode_attr\">mode_attr</a> &amp; 0x15) == 0x05) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Text Mode, TTY BIOS supported,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   supported by hardware */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a> = <a class=\"id\" href=\"#GET_HEAP\">GET_HEAP</a>(struct <a class=\"id\" href=\"#mode_info\">mode_info</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#mode\">mode</a>  = <a class=\"id\" href=\"#mode\">mode</a> + <a class=\"id\" href=\"#VIDEO_FIRST_VESA\">VIDEO_FIRST_VESA</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#depth\">depth</a> = 0; <span class=\"comment\">/* text */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#x\">x</a>     = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#h_res\">h_res</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#y\">y</a>     = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#v_res\">v_res</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nmodes\">nmodes</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if ((<a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#mode_attr\">mode_attr</a> &amp; 0x99) == 0x99 &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   (<a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#memory_layout\">memory_layout</a> == 4 ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#memory_layout\">memory_layout</a> == 6) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#memory_planes\">memory_planes</a> == 1) {", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_FB_BOOT_VESA_SUPPORT\">CONFIG_FB_BOOT_VESA_SUPPORT</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Graphics mode, color, linear frame buffer</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   supported.  Only register the mode if</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   if framebuffer is configured, however,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   otherwise the user will be left without a screen. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a> = <a class=\"id\" href=\"#GET_HEAP\">GET_HEAP</a>(struct <a class=\"id\" href=\"#mode_info\">mode_info</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#mode\">mode</a> + <a class=\"id\" href=\"#VIDEO_FIRST_VESA\">VIDEO_FIRST_VESA</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#depth\">depth</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#bpp\">bpp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#h_res\">h_res</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mi\">mi</a>-><a class=\"id\" href=\"#y\">y</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#v_res\">v_res</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nmodes\">nmodes</a>++;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#nmodes\">nmodes</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#vesa_set_mode\">vesa_set_mode</a>(struct <a class=\"id\" href=\"#mode_info\">mode_info</a> *<a class=\"id\" href=\"#mode\">mode</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#biosregs\">biosregs</a> <a class=\"id\" href=\"#ireg\">ireg</a>, <a class=\"id\" href=\"#oreg\">oreg</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#is_graphic\">is_graphic</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#vesa_mode\">vesa_mode</a> = <a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#mode\">mode</a> - <a class=\"id\" href=\"#VIDEO_FIRST_VESA\">VIDEO_FIRST_VESA</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#vminfo\">vminfo</a>, 0, sizeof <a class=\"id\" href=\"#vminfo\">vminfo</a>); <span class=\"comment\">/* Just in case... */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#initregs\">initregs</a>(&amp;<a class=\"id\" href=\"#ireg\">ireg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f01;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#cx\">cx</a> = <a class=\"id\" href=\"#vesa_mode\">vesa_mode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#di\">di</a> = (<a class=\"id\" href=\"#size_t\">size_t</a>)&amp;<a class=\"id\" href=\"#vminfo\">vminfo</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#ax\">ax</a> != 0x004f)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#mode_attr\">mode_attr</a> &amp; 0x15) == 0x05) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* It's a supported text mode */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#is_graphic\">is_graphic</a> = 0;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_FB_BOOT_VESA_SUPPORT\">CONFIG_FB_BOOT_VESA_SUPPORT</a>", 
"<span class=\"ts\"/>} else if ((<a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#mode_attr\">mode_attr</a> &amp; 0x99) == 0x99) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* It's a graphics mode with linear frame buffer */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#is_graphic\">is_graphic</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vesa_mode\">vesa_mode</a> |= 0x4000; <span class=\"comment\">/* Request linear frame buffer */</span>", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;<span class=\"ts\"/><span class=\"comment\">/* Invalid mode */</span>", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#initregs\">initregs</a>(&amp;<a class=\"id\" href=\"#ireg\">ireg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f02;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#bx\">bx</a> = <a class=\"id\" href=\"#vesa_mode\">vesa_mode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#ax\">ax</a> != 0x004f)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#graphic_mode\">graphic_mode</a> = <a class=\"id\" href=\"#is_graphic\">is_graphic</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#is_graphic\">is_graphic</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Text mode */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#force_x\">force_x</a> = <a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#force_y\">force_y</a> = <a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#y\">y</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_restore\">do_restore</a> = 1;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Graphics mode */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vesa_store_mode_params_graphics\">vesa_store_mode_params_graphics</a>();", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#_WAKEUP\">_WAKEUP</a>", 
"", 
"<span class=\"comment\">/* Switch DAC to 8-bit mode */</span>", 
"static void <a class=\"id\" href=\"#vesa_dac_set_8bits\">vesa_dac_set_8bits</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#biosregs\">biosregs</a> <a class=\"id\" href=\"#ireg\">ireg</a>, <a class=\"id\" href=\"#oreg\">oreg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#dac_size\">dac_size</a> = 6;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* If possible, switch the DAC to 8-bit mode */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vginfo\">vginfo</a>.<a class=\"id\" href=\"#capabilities\">capabilities</a> &amp; 1) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#initregs\">initregs</a>(&amp;<a class=\"id\" href=\"#ireg\">ireg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f08;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#bh\">bh</a> = 0x08;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#ax\">ax</a> == 0x004f)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dac_size\">dac_size</a> = <a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#bh\">bh</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Set the color sizes to the DAC size, and offsets to 0 */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#red_size\">red_size</a>   = <a class=\"id\" href=\"#dac_size\">dac_size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#green_size\">green_size</a> = <a class=\"id\" href=\"#dac_size\">dac_size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#blue_size\">blue_size</a>  = <a class=\"id\" href=\"#dac_size\">dac_size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#rsvd_size\">rsvd_size</a>  = <a class=\"id\" href=\"#dac_size\">dac_size</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#red_pos\">red_pos</a>    = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#green_pos\">green_pos</a>  = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#blue_pos\">blue_pos</a>   = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#rsvd_pos\">rsvd_pos</a>   = 0;", 
"}", 
"", 
"<span class=\"comment\">/* Save the VESA protected mode info */</span>", 
"static void <a class=\"id\" href=\"#vesa_store_pm_info\">vesa_store_pm_info</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#biosregs\">biosregs</a> <a class=\"id\" href=\"#ireg\">ireg</a>, <a class=\"id\" href=\"#oreg\">oreg</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#initregs\">initregs</a>(&amp;<a class=\"id\" href=\"#ireg\">ireg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f0a;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#ax\">ax</a> != 0x004f)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#vesapm_seg\">vesapm_seg</a> = <a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#es\">es</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#vesapm_off\">vesapm_off</a> = <a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#di\">di</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Save video mode parameters for graphics mode</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#vesa_store_mode_params_graphics\">vesa_store_mode_params_graphics</a>(void)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* Tell the kernel we're in VESA graphics mode */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#orig_video_isVGA\">orig_video_isVGA</a> = <a class=\"id\" href=\"#VIDEO_TYPE_VLFB\">VIDEO_TYPE_VLFB</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Mode parameters */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#vesa_attributes\">vesa_attributes</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#mode_attr\">mode_attr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#lfb_linelength\">lfb_linelength</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#logical_scan\">logical_scan</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#lfb_width\">lfb_width</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#h_res\">h_res</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#lfb_height\">lfb_height</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#v_res\">v_res</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#lfb_depth\">lfb_depth</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#bpp\">bpp</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#pages\">pages</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#image_planes\">image_planes</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#lfb_base\">lfb_base</a> = <a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#lfb_ptr\">lfb_ptr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#red_size\">red_size</a>,", 
"<span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#rmask\">rmask</a>, 8);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* General parameters */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#screen_info\">screen_info</a>.<a class=\"id\" href=\"#lfb_size\">lfb_size</a> = <a class=\"id\" href=\"#vginfo\">vginfo</a>.<a class=\"id\" href=\"#total_memory\">total_memory</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vminfo\">vminfo</a>.<a class=\"id\" href=\"#bpp\">bpp</a> <= 8)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vesa_dac_set_8bits\">vesa_dac_set_8bits</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vesa_store_pm_info\">vesa_store_pm_info</a>();", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Save EDID information for the kernel; this is invoked, separately,</span>", 
"<span class=\"comment\"> * after mode-setting.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#vesa_store_edid\">vesa_store_edid</a>(void)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_FIRMWARE_EDID\">CONFIG_FIRMWARE_EDID</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#biosregs\">biosregs</a> <a class=\"id\" href=\"#ireg\">ireg</a>, <a class=\"id\" href=\"#oreg\">oreg</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Apparently used as a nonsense token... */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#edid_info\">edid_info</a>, 0x13, sizeof <a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#edid_info\">edid_info</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vginfo\">vginfo</a>.<a class=\"id\" href=\"#version\">version</a> &lt; 0x0200)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* EDID requires VBE 2.0+ */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#initregs\">initregs</a>(&amp;<a class=\"id\" href=\"#ireg\">ireg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f15;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* VBE DDC */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* ireg.bx = 0x0000; */</span><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Report DDC capabilities */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* ireg.cx = 0;<span class=\"ts\"/>*/</span><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Controller 0 */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#es\">es</a> = 0;<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* ES:DI must be 0 by spec */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#oreg\">oreg</a>.<a class=\"id\" href=\"#ax\">ax</a> != 0x004f)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* No EDID */</span>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* BH = time in seconds to transfer EDD information */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* BL = DDC level supported */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#ax\">ax</a> = 0x4f15;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* VBE DDC */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#bx\">bx</a> = 0x0001;<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Read EDID */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* ireg.cx = 0; */</span><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Controller 0 */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* ireg.dx = 0;<span class=\"ts\"/>*/</span><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* EDID block number */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#es\">es</a> = <a class=\"id\" href=\"#ds\">ds</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireg\">ireg</a>.<a class=\"id\" href=\"#di\">di</a> =(<a class=\"id\" href=\"#size_t\">size_t</a>)&amp;<a class=\"id\" href=\"#boot_params\">boot_params</a>.<a class=\"id\" href=\"#edid_info\">edid_info</a>; <span class=\"comment\">/* (ES:)Pointer to block */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#intcall\">intcall</a>(0x10, &amp;<a class=\"id\" href=\"#ireg\">ireg</a>, &amp;<a class=\"id\" href=\"#oreg\">oreg</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_FIRMWARE_EDID */</span>", 
"}", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* not _WAKEUP */</span>", 
"", 
"static <a class=\"id\" href=\"#__videocard\">__videocard</a> <a class=\"id\" href=\"#video_vesa\">video_vesa</a> =", 
"{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#card_name\">card_name</a><span class=\"ts\"/>= \"VESA\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#probe\">probe</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#vesa_probe\">vesa_probe</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#set_mode\">set_mode</a><span class=\"ts\"/>= <a class=\"id\" href=\"#vesa_set_mode\">vesa_set_mode</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#xmode_first\">xmode_first</a><span class=\"ts\"/>= <a class=\"id\" href=\"#VIDEO_FIRST_VESA\">VIDEO_FIRST_VESA</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#xmode_n\">xmode_n</a><span class=\"ts\"/>= 0x200,", 
"};", 
];
xr_frag_insert('l/6d/2588cba36fb03e90851296981d62e44fa48b31.xr', __xr_tmp);
