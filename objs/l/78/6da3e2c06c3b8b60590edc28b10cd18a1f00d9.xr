var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * linux/fs/ext4/xattr_trusted.c</span>", 
"<span class=\"comment\"> * Handler for trusted extended attributes.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (C) 2003 by Andreas Gruenbacher, &lt;a.gruenbacher@computer.org&gt;</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#capability\">capability</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#fs\">fs</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"ext4_jbd2.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"ext4.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"xattr.h\"", 
"", 
"static <a class=\"id\" href=\"#size_t\">size_t</a>", 
"<a class=\"id\" href=\"#ext4_xattr_trusted_list\">ext4_xattr_trusted_list</a>(struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, char *<a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#list_size\">list_size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>const char *<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#name_len\">name_len</a>, int <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#prefix_len\">prefix_len</a> = <a class=\"id\" href=\"#XATTR_TRUSTED_PREFIX_LEN\">XATTR_TRUSTED_PREFIX_LEN</a>;", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#total_len\">total_len</a> = <a class=\"id\" href=\"#prefix_len\">prefix_len</a> + <a class=\"id\" href=\"#name_len\">name_len</a> + 1;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_ADMIN\">CAP_SYS_ADMIN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list\">list</a> && <a class=\"id\" href=\"#total_len\">total_len</a> <= <a class=\"id\" href=\"#list_size\">list_size</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#XATTR_TRUSTED_PREFIX\">XATTR_TRUSTED_PREFIX</a>, <a class=\"id\" href=\"#prefix_len\">prefix_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#list\">list</a>+<a class=\"id\" href=\"#prefix_len\">prefix_len</a>, <a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#name_len\">name_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list\">list</a>[<a class=\"id\" href=\"#prefix_len\">prefix_len</a> + <a class=\"id\" href=\"#name_len\">name_len</a>] = '\\0';", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#total_len\">total_len</a>;", 
"}", 
"", 
"static int", 
"<a class=\"id\" href=\"#ext4_xattr_trusted_get\">ext4_xattr_trusted_get</a>(struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, const char *<a class=\"id\" href=\"#name\">name</a>, void *<a class=\"id\" href=\"#buffer\">buffer</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>, int <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#name\">name</a>, \"\") == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ext4_xattr_get\">ext4_xattr_get</a>(<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>, <a class=\"id\" href=\"#EXT4_XATTR_INDEX_TRUSTED\">EXT4_XATTR_INDEX_TRUSTED</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#buffer\">buffer</a>, <a class=\"id\" href=\"#size\">size</a>);", 
"}", 
"", 
"static int", 
"<a class=\"id\" href=\"#ext4_xattr_trusted_set\">ext4_xattr_trusted_set</a>(struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>, const char *<a class=\"id\" href=\"#name\">name</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>const void *<a class=\"id\" href=\"#value\">value</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>, int <a class=\"id\" href=\"#flags\">flags</a>, int <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#name\">name</a>, \"\") == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ext4_xattr_set\">ext4_xattr_set</a>(<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>, <a class=\"id\" href=\"#EXT4_XATTR_INDEX_TRUSTED\">EXT4_XATTR_INDEX_TRUSTED</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#value\">value</a>, <a class=\"id\" href=\"#size\">size</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"", 
"const struct <a class=\"id\" href=\"#xattr_handler\">xattr_handler</a> <a class=\"id\" href=\"#ext4_xattr_trusted_handler\">ext4_xattr_trusted_handler</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#prefix\">prefix</a><span class=\"ts\"/>= <a class=\"id\" href=\"#XATTR_TRUSTED_PREFIX\">XATTR_TRUSTED_PREFIX</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#list\">list</a><span class=\"ts\"/>= <a class=\"id\" href=\"#ext4_xattr_trusted_list\">ext4_xattr_trusted_list</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get\">get</a><span class=\"ts\"/>= <a class=\"id\" href=\"#ext4_xattr_trusted_get\">ext4_xattr_trusted_get</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#set\">set</a><span class=\"ts\"/>= <a class=\"id\" href=\"#ext4_xattr_trusted_set\">ext4_xattr_trusted_set</a>,", 
"};", 
];
xr_frag_insert('l/78/6da3e2c06c3b8b60590edc28b10cd18a1f00d9.xr', __xr_tmp);
