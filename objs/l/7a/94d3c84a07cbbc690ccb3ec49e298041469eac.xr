var __xr_tmp = [
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * __audit_log_capset - store information about the arguments to the capset syscall</span>", 
"<span class=\"comment\"> * @pid: target pid of the capset call</span>", 
"<span class=\"comment\"> * @new: the new credentials</span>", 
"<span class=\"comment\"> * @old: the old (current) credentials</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Record the aguments userspace sent to sys_capset for later printing by the</span>", 
"<span class=\"comment\"> * audit system if applicable</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#__audit_log_capset\">__audit_log_capset</a>(<a class=\"id\" href=\"#pid_t\">pid_t</a> <a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#new\">new</a>, const struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#old\">old</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_context\">audit_context</a> *<a class=\"id\" href=\"#context\">context</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#audit_context\">audit_context</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#capset\">capset</a>.<a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#capset\">capset</a>.<a class=\"id\" href=\"#cap\">cap</a>.<a class=\"id\" href=\"#effective\">effective</a>   = <a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#cap_effective\">cap_effective</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#capset\">capset</a>.<a class=\"id\" href=\"#cap\">cap</a>.<a class=\"id\" href=\"#inheritable\">inheritable</a> = <a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#cap_effective\">cap_effective</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#capset\">capset</a>.<a class=\"id\" href=\"#cap\">cap</a>.<a class=\"id\" href=\"#permitted\">permitted</a>   = <a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#cap_permitted\">cap_permitted</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#AUDIT_CAPSET\">AUDIT_CAPSET</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * audit_core_dumps - record information about processes that end abnormally</span>", 
"<span class=\"comment\"> * @signr: signal value</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * If a process ends with a core dump, something fishy is going on and we</span>", 
"<span class=\"comment\"> * should record the event for investigation.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#audit_core_dumps\">audit_core_dumps</a>(long <a class=\"id\" href=\"#signr\">signr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#ab\">ab</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#uid_t\">uid_t</a> <a class=\"id\" href=\"#auid\">auid</a> = <a class=\"id\" href=\"#audit_get_loginuid\">audit_get_loginuid</a>(<a class=\"id\" href=\"#current\">current</a>), <a class=\"id\" href=\"#uid\">uid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#gid_t\">gid_t</a> <a class=\"id\" href=\"#gid\">gid</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#sessionid\">sessionid</a> = <a class=\"id\" href=\"#audit_get_sessionid\">audit_get_sessionid</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#audit_enabled\">audit_enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#signr\">signr</a> == <a class=\"id\" href=\"#SIGQUIT\">SIGQUIT</a>)<span class=\"ts\"/><span class=\"comment\">/* don't care for those */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ab\">ab</a> = <a class=\"id\" href=\"#audit_log_start\">audit_log_start</a>(<a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>, <a class=\"id\" href=\"#AUDIT_ANOM_ABEND\">AUDIT_ANOM_ABEND</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#current_uid_gid\">current_uid_gid</a>(&amp;<a class=\"id\" href=\"#uid\">uid</a>, &amp;<a class=\"id\" href=\"#gid\">gid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \"auid=%u uid=%u gid=%u ses=%u\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#auid\">auid</a>, <a class=\"id\" href=\"#uid\">uid</a>, <a class=\"id\" href=\"#gid\">gid</a>, <a class=\"id\" href=\"#sessionid\">sessionid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_task_getsecid\">security_task_getsecid</a>(<a class=\"id\" href=\"#current\">current</a>, &amp;<a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sid\">sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>char *<a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#security_secid_to_secctx\">security_secid_to_secctx</a>(<a class=\"id\" href=\"#sid\">sid</a>, &amp;<a class=\"id\" href=\"#ctx\">ctx</a>, &amp;<a class=\"id\" href=\"#len\">len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" ssid=%u\", <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" subj=%s\", <a class=\"id\" href=\"#ctx\">ctx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_release_secctx\">security_release_secctx</a>(<a class=\"id\" href=\"#ctx\">ctx</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" pid=%d comm=\", <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_untrustedstring\">audit_log_untrustedstring</a>(<a class=\"id\" href=\"#ab\">ab</a>, <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#comm\">comm</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" sig=%ld\", <a class=\"id\" href=\"#signr\">signr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#ab\">ab</a>);", 
"}", 
"", 
"struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#audit_killed_trees\">audit_killed_trees</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_context\">audit_context</a> *<a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#audit_context\">audit_context</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(!<a class=\"id\" href=\"#ctx\">ctx</a> || !<a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#in_syscall\">in_syscall</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>return &amp;<a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#killed_trees\">killed_trees</a>;", 
"}", 
];
xr_frag_insert('l/7a/94d3c84a07cbbc690ccb3ec49e298041469eac.xr', __xr_tmp);
