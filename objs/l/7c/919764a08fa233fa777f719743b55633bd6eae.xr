var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"i8042.c: Can't write CTR while resetting.\\n\");", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Disable MUX mode if present.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_mux_present\">i8042_mux_present</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_set_mux_mode\">i8042_set_mux_mode</a>(<a class=\"id\" href=\"#false\">false</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Reset the controller if requested.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_reset\">i8042_reset</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_controller_selftest\">i8042_controller_selftest</a>();", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Restore the original control register setting.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_command\">i8042_command</a>(&amp;<a class=\"id\" href=\"#i8042_initial_ctr\">i8042_initial_ctr</a>, <a class=\"id\" href=\"#I8042_CMD_CTL_WCTR\">I8042_CMD_CTL_WCTR</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"i8042.c: Can't restore CTR.\\n\");", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * i8042_panic_blink() will turn the keyboard LEDs on or off and is called</span>", 
"<span class=\"comment\"> * when kernel panics. Flashing LEDs is useful for users running X who may</span>", 
"<span class=\"comment\"> * not see the console and will help distingushing panics from \"real\"</span>", 
"<span class=\"comment\"> * lockups.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Note that DELAY has a limit of 10ms so we will not get stuck here</span>", 
"<span class=\"comment\"> * waiting for KBC to free up even if KBD interrupt is off</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DELAY\">DELAY</a> do { <a class=\"id\" href=\"#mdelay\">mdelay</a>(1); if (++<a class=\"id\" href=\"#delay\">delay</a> &gt; 10) return <a class=\"id\" href=\"#delay\">delay</a>; } while(0)", 
"", 
"static long <a class=\"id\" href=\"#i8042_panic_blink\">i8042_panic_blink</a>(int <a class=\"id\" href=\"#state\">state</a>)", 
"{", 
"<span class=\"ts\"/>long <a class=\"id\" href=\"#delay\">delay</a> = 0;", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#led\">led</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#led\">led</a> = (<a class=\"id\" href=\"#state\">state</a>) ? 0x01 | 0x04 : 0;", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#i8042_read_status\">i8042_read_status</a>() &amp; <a class=\"id\" href=\"#I8042_STR_IBF\">I8042_STR_IBF</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DELAY\">DELAY</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dbg\">dbg</a>(\"%02x -> i8042 (panic blink)\", 0xed);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_suppress_kbd_ack\">i8042_suppress_kbd_ack</a> = 2;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_write_data\">i8042_write_data</a>(0xed); <span class=\"comment\">/* set leds */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DELAY\">DELAY</a>;", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#i8042_read_status\">i8042_read_status</a>() &amp; <a class=\"id\" href=\"#I8042_STR_IBF\">I8042_STR_IBF</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#DELAY\">DELAY</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DELAY\">DELAY</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dbg\">dbg</a>(\"%02x -> i8042 (panic blink)\", <a class=\"id\" href=\"#led\">led</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_write_data\">i8042_write_data</a>(<a class=\"id\" href=\"#led\">led</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DELAY\">DELAY</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#delay\">delay</a>;", 
"}", 
"", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#DELAY\">DELAY</a>", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86\">CONFIG_X86</a>", 
"static void <a class=\"id\" href=\"#i8042_dritek_enable\">i8042_dritek_enable</a>(void)", 
"{", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#param\">param</a> = 0x90;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_command\">i8042_command</a>(&amp;<a class=\"id\" href=\"#param\">param</a>, 0x1059);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"Failed to enable DRITEK extension: %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a>);", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_PM\">CONFIG_PM</a>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Here we try to reset everything back to a state we had</span>", 
"<span class=\"comment\"> * before suspending.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#i8042_controller_resume\">i8042_controller_resume</a>(<a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#force_reset\">force_reset</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_controller_check\">i8042_controller_check</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_reset\">i8042_reset</a> || <a class=\"id\" href=\"#force_reset\">force_reset</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_controller_selftest\">i8042_controller_selftest</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Restore original CTR value and disable all ports</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a> = <a class=\"id\" href=\"#i8042_initial_ctr\">i8042_initial_ctr</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_direct\">i8042_direct</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a> &= ~<a class=\"id\" href=\"#I8042_CTR_XLATE\">I8042_CTR_XLATE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a> |= <a class=\"id\" href=\"#I8042_CTR_AUXDIS\">I8042_CTR_AUXDIS</a> | <a class=\"id\" href=\"#I8042_CTR_KBDDIS\">I8042_CTR_KBDDIS</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a> &= ~(<a class=\"id\" href=\"#I8042_CTR_AUXINT\">I8042_CTR_AUXINT</a> | <a class=\"id\" href=\"#I8042_CTR_KBDINT\">I8042_CTR_KBDINT</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_command\">i8042_command</a>(&amp;<a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a>, <a class=\"id\" href=\"#I8042_CMD_CTL_WCTR\">I8042_CMD_CTL_WCTR</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"i8042: Can't write CTR to resume, retrying...\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msleep\">msleep</a>(50);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_command\">i8042_command</a>(&amp;<a class=\"id\" href=\"#i8042_ctr\">i8042_ctr</a>, <a class=\"id\" href=\"#I8042_CMD_CTL_WCTR\">I8042_CMD_CTL_WCTR</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"i8042: CTR write retry failed\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EIO\">EIO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86\">CONFIG_X86</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_dritek\">i8042_dritek</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_dritek_enable\">i8042_dritek_enable</a>();", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_mux_present\">i8042_mux_present</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_set_mux_mode\">i8042_set_mux_mode</a>(<a class=\"id\" href=\"#true\">true</a>, <a class=\"id\" href=\"#NULL\">NULL</a>) || <a class=\"id\" href=\"#i8042_enable_mux_ports\">i8042_enable_mux_ports</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"i8042: failed to resume active multiplexor, \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"mouse won't work.\\n\");", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#I8042_AUX_PORT_NO\">I8042_AUX_PORT_NO</a>].<a class=\"id\" href=\"#serio\">serio</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_enable_aux_port\">i8042_enable_aux_port</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#I8042_KBD_PORT_NO\">I8042_KBD_PORT_NO</a>].<a class=\"id\" href=\"#serio\">serio</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_enable_kbd_port\">i8042_enable_kbd_port</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_interrupt\">i8042_interrupt</a>(0, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Here we try to restore the original BIOS settings to avoid</span>", 
"<span class=\"comment\"> * upsetting it.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#i8042_pm_reset\">i8042_pm_reset</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_controller_reset\">i8042_controller_reset</a>();", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#i8042_pm_resume\">i8042_pm_resume</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * On resume from S2R we always try to reset the controller</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * to bring it in a sane state. (In case of S2D we expect</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * BIOS to reset the controller for us.)</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#i8042_controller_resume\">i8042_controller_resume</a>(<a class=\"id\" href=\"#true\">true</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#i8042_pm_thaw\">i8042_pm_thaw</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_interrupt\">i8042_interrupt</a>(0, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#i8042_pm_restore\">i8042_pm_restore</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#i8042_controller_resume\">i8042_controller_resume</a>(<a class=\"id\" href=\"#false\">false</a>);", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#dev_pm_ops\">dev_pm_ops</a> <a class=\"id\" href=\"#i8042_pm_ops\">i8042_pm_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#suspend\">suspend</a><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_pm_reset\">i8042_pm_reset</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#resume\">resume</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_pm_resume\">i8042_pm_resume</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#thaw\">thaw</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_pm_thaw\">i8042_pm_thaw</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#poweroff\">poweroff</a><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_pm_reset\">i8042_pm_reset</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#restore\">restore</a><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_pm_restore\">i8042_pm_restore</a>,", 
"};", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_PM */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * We need to reset the 8042 back to original mode on system shutdown,</span>", 
"<span class=\"comment\"> * because otherwise BIOSes will be confused.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#i8042_shutdown\">i8042_shutdown</a>(struct <a class=\"id\" href=\"#platform_device\">platform_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_controller_reset\">i8042_controller_reset</a>();", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_create_kbd_port\">i8042_create_kbd_port</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#serio\">serio</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i8042_port\">i8042_port</a> *<a class=\"id\" href=\"#port\">port</a> = &amp;<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#I8042_KBD_PORT_NO\">I8042_KBD_PORT_NO</a>];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#serio\">serio</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#serio\">serio</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#type\">type</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_direct\">i8042_direct</a> ? <a class=\"id\" href=\"#SERIO_8042\">SERIO_8042</a> : <a class=\"id\" href=\"#SERIO_8042_XL\">SERIO_8042_XL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#write\">write</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_dumbkbd\">i8042_dumbkbd</a> ? <a class=\"id\" href=\"#NULL\">NULL</a> : <a class=\"id\" href=\"#i8042_kbd_write\">i8042_kbd_write</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#start\">start</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_start\">i8042_start</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#stop\">stop</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_stop\">i8042_stop</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#close\">close</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_port_close\">i8042_port_close</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#port_data\">port_data</a><span class=\"ts\"/>= <a class=\"id\" href=\"#port\">port</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#parent\">parent</a><span class=\"ts\"/>= &amp;<a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strlcpy\">strlcpy</a>(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#name\">name</a>, \"i8042 KBD port\", sizeof(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#name\">name</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strlcpy\">strlcpy</a>(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#phys\">phys</a>, <a class=\"id\" href=\"#I8042_KBD_PHYS_DESC\">I8042_KBD_PHYS_DESC</a>, sizeof(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#phys\">phys</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#serio\">serio</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#irq\">irq</a> = <a class=\"id\" href=\"#I8042_KBD_IRQ\">I8042_KBD_IRQ</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_create_aux_port\">i8042_create_aux_port</a>(int <a class=\"id\" href=\"#idx\">idx</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#serio\">serio</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#port_no\">port_no</a> = <a class=\"id\" href=\"#idx\">idx</a> &lt; 0 ? <a class=\"id\" href=\"#I8042_AUX_PORT_NO\">I8042_AUX_PORT_NO</a> : <a class=\"id\" href=\"#I8042_MUX_PORT_NO\">I8042_MUX_PORT_NO</a> + <a class=\"id\" href=\"#idx\">idx</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#i8042_port\">i8042_port</a> *<a class=\"id\" href=\"#port\">port</a> = &amp;<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#port_no\">port_no</a>];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#serio\">serio</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#serio\">serio</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#type\">type</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#SERIO_8042\">SERIO_8042</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#write\">write</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_aux_write\">i8042_aux_write</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#start\">start</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_start\">i8042_start</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#stop\">stop</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_stop\">i8042_stop</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#port_data\">port_data</a><span class=\"ts\"/>= <a class=\"id\" href=\"#port\">port</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#parent\">parent</a><span class=\"ts\"/>= &amp;<a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#idx\">idx</a> &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strlcpy\">strlcpy</a>(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#name\">name</a>, \"i8042 AUX port\", sizeof(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#name\">name</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strlcpy\">strlcpy</a>(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#phys\">phys</a>, <a class=\"id\" href=\"#I8042_AUX_PHYS_DESC\">I8042_AUX_PHYS_DESC</a>, sizeof(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#phys\">phys</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#close\">close</a> = <a class=\"id\" href=\"#i8042_port_close\">i8042_port_close</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snprintf\">snprintf</a>(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#name\">name</a>, sizeof(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#name\">name</a>), \"i8042 AUX%d port\", <a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snprintf\">snprintf</a>(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#phys\">phys</a>, sizeof(<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#phys\">phys</a>), <a class=\"id\" href=\"#I8042_MUX_PHYS_DESC\">I8042_MUX_PHYS_DESC</a>, <a class=\"id\" href=\"#idx\">idx</a> + 1);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#serio\">serio</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#mux\">mux</a> = <a class=\"id\" href=\"#idx\">idx</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#port\">port</a>-><a class=\"id\" href=\"#irq\">irq</a> = <a class=\"id\" href=\"#I8042_AUX_IRQ\">I8042_AUX_IRQ</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_free_kbd_port\">i8042_free_kbd_port</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#I8042_KBD_PORT_NO\">I8042_KBD_PORT_NO</a>].<a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#I8042_KBD_PORT_NO\">I8042_KBD_PORT_NO</a>].<a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_free_aux_ports\">i8042_free_aux_ports</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#I8042_AUX_PORT_NO\">I8042_AUX_PORT_NO</a>; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#I8042_NUM_PORTS\">I8042_NUM_PORTS</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_register_ports\">i8042_register_ports</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#I8042_NUM_PORTS\">I8042_NUM_PORTS</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"serio: %s at %#lx,%#lx irq %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#name\">name</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned long) <a class=\"id\" href=\"#I8042_DATA_REG\">I8042_DATA_REG</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned long) <a class=\"id\" href=\"#I8042_COMMAND_REG\">I8042_COMMAND_REG</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#irq\">irq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#serio_register_port\">serio_register_port</a>(<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__devexit\">__devexit</a> <a class=\"id\" href=\"#i8042_unregister_ports\">i8042_unregister_ports</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#I8042_NUM_PORTS\">I8042_NUM_PORTS</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#serio_unregister_port\">serio_unregister_port</a>(<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Checks whether port belongs to i8042 controller.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#i8042_check_port_owner\">i8042_check_port_owner</a>(const struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#port\">port</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#I8042_NUM_PORTS\">I8042_NUM_PORTS</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_ports\">i8042_ports</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#serio\">serio</a> == <a class=\"id\" href=\"#port\">port</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#true\">true</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#i8042_check_port_owner\">i8042_check_port_owner</a>);", 
"", 
"static void <a class=\"id\" href=\"#i8042_free_irqs\">i8042_free_irqs</a>(void)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_aux_irq_registered\">i8042_aux_irq_registered</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_irq\">free_irq</a>(<a class=\"id\" href=\"#I8042_AUX_IRQ\">I8042_AUX_IRQ</a>, <a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_kbd_irq_registered\">i8042_kbd_irq_registered</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_irq\">free_irq</a>(<a class=\"id\" href=\"#I8042_KBD_IRQ\">I8042_KBD_IRQ</a>, <a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_aux_irq_registered\">i8042_aux_irq_registered</a> = <a class=\"id\" href=\"#i8042_kbd_irq_registered\">i8042_kbd_irq_registered</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_setup_aux\">i8042_setup_aux</a>(void)", 
"{", 
"<span class=\"ts\"/>int (*<a class=\"id\" href=\"#aux_enable\">aux_enable</a>)(void);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_check_aux\">i8042_check_aux</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_nomux\">i8042_nomux</a> || <a class=\"id\" href=\"#i8042_check_mux\">i8042_check_mux</a>()) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_create_aux_port\">i8042_create_aux_port</a>(-1);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_ports\">err_free_ports</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux_enable\">aux_enable</a> = <a class=\"id\" href=\"#i8042_enable_aux_port\">i8042_enable_aux_port</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#I8042_NUM_MUX_PORTS\">I8042_NUM_MUX_PORTS</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_create_aux_port\">i8042_create_aux_port</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_ports\">err_free_ports</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux_enable\">aux_enable</a> = <a class=\"id\" href=\"#i8042_enable_mux_ports\">i8042_enable_mux_ports</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#request_irq\">request_irq</a>(<a class=\"id\" href=\"#I8042_AUX_IRQ\">I8042_AUX_IRQ</a>, <a class=\"id\" href=\"#i8042_interrupt\">i8042_interrupt</a>, <a class=\"id\" href=\"#IRQF_SHARED\">IRQF_SHARED</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    \"i8042\", <a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_ports\">err_free_ports</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#aux_enable\">aux_enable</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_irq\">err_free_irq</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_aux_irq_registered\">i8042_aux_irq_registered</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
" <a class=\"id\" href=\"#err_free_irq\">err_free_irq</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_irq\">free_irq</a>(<a class=\"id\" href=\"#I8042_AUX_IRQ\">I8042_AUX_IRQ</a>, <a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>);", 
" <a class=\"id\" href=\"#err_free_ports\">err_free_ports</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_free_aux_ports\">i8042_free_aux_ports</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_setup_kbd\">i8042_setup_kbd</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_create_kbd_port\">i8042_create_kbd_port</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#request_irq\">request_irq</a>(<a class=\"id\" href=\"#I8042_KBD_IRQ\">I8042_KBD_IRQ</a>, <a class=\"id\" href=\"#i8042_interrupt\">i8042_interrupt</a>, <a class=\"id\" href=\"#IRQF_SHARED\">IRQF_SHARED</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    \"i8042\", <a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_port\">err_free_port</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_enable_kbd_port\">i8042_enable_kbd_port</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_irq\">err_free_irq</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_kbd_irq_registered\">i8042_kbd_irq_registered</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
" <a class=\"id\" href=\"#err_free_irq\">err_free_irq</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_irq\">free_irq</a>(<a class=\"id\" href=\"#I8042_KBD_IRQ\">I8042_KBD_IRQ</a>, <a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>);", 
" <a class=\"id\" href=\"#err_free_port\">err_free_port</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_free_kbd_port\">i8042_free_kbd_port</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_probe\">i8042_probe</a>(struct <a class=\"id\" href=\"#platform_device\">platform_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_reset\">i8042_reset</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_controller_selftest\">i8042_controller_selftest</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_controller_init\">i8042_controller_init</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86\">CONFIG_X86</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_dritek\">i8042_dritek</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_dritek_enable\">i8042_dritek_enable</a>();", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#i8042_noaux\">i8042_noaux</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_setup_aux\">i8042_setup_aux</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a> && <a class=\"id\" href=\"#error\">error</a> != -<a class=\"id\" href=\"#ENODEV\">ENODEV</a> && <a class=\"id\" href=\"#error\">error</a> != -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fail\">out_fail</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#i8042_nokbd\">i8042_nokbd</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#i8042_setup_kbd\">i8042_setup_kbd</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_fail\">out_fail</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Ok, everything is ready, let's register all serio ports</span>", 
"<span class=\"comment\"> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_register_ports\">i8042_register_ports</a>();", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
" <a class=\"id\" href=\"#out_fail\">out_fail</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_free_aux_ports\">i8042_free_aux_ports</a>();<span class=\"ts\"/><span class=\"comment\">/* in case KBD failed but AUX not */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_free_irqs\">i8042_free_irqs</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_controller_reset\">i8042_controller_reset</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__devexit\">__devexit</a> <a class=\"id\" href=\"#i8042_remove\">i8042_remove</a>(struct <a class=\"id\" href=\"#platform_device\">platform_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_unregister_ports\">i8042_unregister_ports</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_free_irqs\">i8042_free_irqs</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_controller_reset\">i8042_controller_reset</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#platform_driver\">platform_driver</a> <a class=\"id\" href=\"#i8042_driver\">i8042_driver</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#driver\">driver</a><span class=\"ts\"/><span class=\"ts\"/>= {", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a><span class=\"ts\"/>= \"i8042\",", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a><span class=\"ts\"/>= <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_PM\">CONFIG_PM</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#pm\">pm</a><span class=\"ts\"/>= &amp;<a class=\"id\" href=\"#i8042_pm_ops\">i8042_pm_ops</a>,", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#remove\">remove</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#__devexit_p\">__devexit_p</a>(<a class=\"id\" href=\"#i8042_remove\">i8042_remove</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#shutdown\">shutdown</a><span class=\"ts\"/>= <a class=\"id\" href=\"#i8042_shutdown\">i8042_shutdown</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#i8042_init\">i8042_init</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#platform_device\">platform_device</a> *<a class=\"id\" href=\"#pdev\">pdev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dbg_init\">dbg_init</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#i8042_platform_init\">i8042_platform_init</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#i8042_controller_check\">i8042_controller_check</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_platform_exit\">err_platform_exit</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pdev\">pdev</a> = <a class=\"id\" href=\"#platform_create_bundle\">platform_create_bundle</a>(&amp;<a class=\"id\" href=\"#i8042_driver\">i8042_driver</a>, <a class=\"id\" href=\"#i8042_probe\">i8042_probe</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, 0, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#pdev\">pdev</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#pdev\">pdev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_platform_exit\">err_platform_exit</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#panic_blink\">panic_blink</a> = <a class=\"id\" href=\"#i8042_panic_blink\">i8042_panic_blink</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
" <a class=\"id\" href=\"#err_platform_exit\">err_platform_exit</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_platform_exit\">i8042_platform_exit</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__exit\">__exit</a> <a class=\"id\" href=\"#i8042_exit\">i8042_exit</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#platform_device_unregister\">platform_device_unregister</a>(<a class=\"id\" href=\"#i8042_platform_device\">i8042_platform_device</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#platform_driver_unregister\">platform_driver_unregister</a>(&amp;<a class=\"id\" href=\"#i8042_driver\">i8042_driver</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i8042_platform_exit\">i8042_platform_exit</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#panic_blink\">panic_blink</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#module_init\">module_init</a>(<a class=\"id\" href=\"#i8042_init\">i8042_init</a>);", 
"<a class=\"id\" href=\"#module_exit\">module_exit</a>(<a class=\"id\" href=\"#i8042_exit\">i8042_exit</a>);", 
];
xr_frag_insert('l/7c/919764a08fa233fa777f719743b55633bd6eae.xr', __xr_tmp);
