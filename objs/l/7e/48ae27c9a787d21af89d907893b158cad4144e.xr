var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * PS/2 driver library</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (c) 1999-2002 Vojtech Pavlik</span>", 
"<span class=\"comment\"> * Copyright (c) 2004 Dmitry Torokhov</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify it</span>", 
"<span class=\"comment\"> * under the terms of the GNU General Public License version 2 as published by</span>", 
"<span class=\"comment\"> * the Free Software Foundation.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#delay\">delay</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sched\">sched</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#interrupt\">interrupt</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#input\">input</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#serio\">serio</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#i8042\">i8042</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#libps2\">libps2</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DRIVER_DESC\">DRIVER_DESC</a><span class=\"ts\"/>\"PS/2 driver library\"", 
"", 
"<a class=\"id\" href=\"#MODULE_AUTHOR\">MODULE_AUTHOR</a>(\"Dmitry Torokhov <dtor@mail.ru>\");", 
"<a class=\"id\" href=\"#MODULE_DESCRIPTION\">MODULE_DESCRIPTION</a>(\"PS/2 driver library\");", 
"<a class=\"id\" href=\"#MODULE_LICENSE\">MODULE_LICENSE</a>(\"GPL\");", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_sendbyte() sends a byte to the device and waits for acknowledge.</span>", 
"<span class=\"comment\"> * It doesn't handle retransmission, though it could - because if there</span>", 
"<span class=\"comment\"> * is a need for retransmissions device has to be replaced anyway.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * ps2_sendbyte() can only be called from a process context.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ps2_sendbyte\">ps2_sendbyte</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, unsigned char <a class=\"id\" href=\"#byte\">byte</a>, int <a class=\"id\" href=\"#timeout\">timeout</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_pause_rx\">serio_pause_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#PS2_FLAG_ACK\">PS2_FLAG_ACK</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_continue_rx\">serio_continue_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#serio_write\">serio_write</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>, <a class=\"id\" href=\"#byte\">byte</a>) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wait_event_timeout\">wait_event_timeout</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   !(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_ACK\">PS2_FLAG_ACK</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#msecs_to_jiffies\">msecs_to_jiffies</a>(<a class=\"id\" href=\"#timeout\">timeout</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_pause_rx\">serio_pause_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#PS2_FLAG_ACK\">PS2_FLAG_ACK</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_continue_rx\">serio_continue_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_sendbyte\">ps2_sendbyte</a>);", 
"", 
"void <a class=\"id\" href=\"#ps2_begin_command\">ps2_begin_command</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmd_mutex\">cmd_mutex</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_check_port_owner\">i8042_check_port_owner</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_lock_chip\">i8042_lock_chip</a>();", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_begin_command\">ps2_begin_command</a>);", 
"", 
"void <a class=\"id\" href=\"#ps2_end_command\">ps2_end_command</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i8042_check_port_owner\">i8042_check_port_owner</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i8042_unlock_chip\">i8042_unlock_chip</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmd_mutex\">cmd_mutex</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_end_command\">ps2_end_command</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_drain() waits for device to transmit requested number of bytes</span>", 
"<span class=\"comment\"> * and discards them.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ps2_drain\">ps2_drain</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, int <a class=\"id\" href=\"#maxbytes\">maxbytes</a>, int <a class=\"id\" href=\"#timeout\">timeout</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#maxbytes\">maxbytes</a> &gt; sizeof(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#maxbytes\">maxbytes</a> = sizeof(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2_begin_command\">ps2_begin_command</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_pause_rx\">serio_pause_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#PS2_FLAG_CMD\">PS2_FLAG_CMD</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a> = <a class=\"id\" href=\"#maxbytes\">maxbytes</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_continue_rx\">serio_continue_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wait_event_timeout\">wait_event_timeout</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   !(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_CMD\">PS2_FLAG_CMD</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#msecs_to_jiffies\">msecs_to_jiffies</a>(<a class=\"id\" href=\"#timeout\">timeout</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2_end_command\">ps2_end_command</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_drain\">ps2_drain</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_is_keyboard_id() checks received ID byte against the list of</span>", 
"<span class=\"comment\"> * known keyboard IDs.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ps2_is_keyboard_id\">ps2_is_keyboard_id</a>(char <a class=\"id\" href=\"#id_byte\">id_byte</a>)", 
"{", 
"<span class=\"ts\"/>static const char <a class=\"id\" href=\"#keyboard_ids\">keyboard_ids</a>[] = {", 
"<span class=\"ts\"/><span class=\"ts\"/>0xab,<span class=\"ts\"/><span class=\"comment\">/* Regular keyboards<span class=\"ts\"/><span class=\"ts\"/>*/</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>0xac,<span class=\"ts\"/><span class=\"comment\">/* NCD Sun keyboard<span class=\"ts\"/><span class=\"ts\"/>*/</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>0x2b,<span class=\"ts\"/><span class=\"comment\">/* Trust keyboard, translated<span class=\"ts\"/>*/</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>0x5d,<span class=\"ts\"/><span class=\"comment\">/* Trust keyboard<span class=\"ts\"/><span class=\"ts\"/>*/</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>0x60,<span class=\"ts\"/><span class=\"comment\">/* NMB SGI keyboard, translated */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>0x47,<span class=\"ts\"/><span class=\"comment\">/* NMB SGI keyboard<span class=\"ts\"/><span class=\"ts\"/>*/</span>", 
"<span class=\"ts\"/>};", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#memchr\">memchr</a>(<a class=\"id\" href=\"#keyboard_ids\">keyboard_ids</a>, <a class=\"id\" href=\"#id_byte\">id_byte</a>, sizeof(<a class=\"id\" href=\"#keyboard_ids\">keyboard_ids</a>)) != <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_is_keyboard_id\">ps2_is_keyboard_id</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_adjust_timeout() is called after receiving 1st byte of command</span>", 
"<span class=\"comment\"> * response and tries to reduce remaining timeout to speed up command</span>", 
"<span class=\"comment\"> * completion.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#ps2_adjust_timeout\">ps2_adjust_timeout</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, int <a class=\"id\" href=\"#command\">command</a>, int <a class=\"id\" href=\"#timeout\">timeout</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#command\">command</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#PS2_CMD_RESET_BAT\">PS2_CMD_RESET_BAT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Device has sent the first response byte after</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * reset command, reset is thus done, so we can</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * shorten the timeout.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * The next byte will come soon (keyboard) or not</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * at all (mouse).</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#timeout\">timeout</a> &gt; <a class=\"id\" href=\"#msecs_to_jiffies\">msecs_to_jiffies</a>(100))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = <a class=\"id\" href=\"#msecs_to_jiffies\">msecs_to_jiffies</a>(100);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#PS2_CMD_GETID\">PS2_CMD_GETID</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Microsoft Natural Elite keyboard responds to</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * the GET ID command as it were a mouse, with</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * a single byte. Fail the command so atkbd will</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * use alternative probe to detect it.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>[1] == 0xaa) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#serio_pause_rx\">serio_pause_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#serio_continue_rx\">serio_continue_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * If device behind the port is not a keyboard there</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * won't be 2nd byte of ID response.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#ps2_is_keyboard_id\">ps2_is_keyboard_id</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>[1])) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#serio_pause_rx\">serio_pause_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#serio_continue_rx\">serio_continue_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#timeout\">timeout</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_command() sends a command and its parameters to the mouse,</span>", 
"<span class=\"comment\"> * then waits for the response and puts it in the param array.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * ps2_command() can only be called from a process context</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#__ps2_command\">__ps2_command</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, unsigned char *<a class=\"id\" href=\"#param\">param</a>, int <a class=\"id\" href=\"#command\">command</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#timeout\">timeout</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#send\">send</a> = (<a class=\"id\" href=\"#command\">command</a> >> 12) &amp; 0xf;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#receive\">receive</a> = (<a class=\"id\" href=\"#command\">command</a> >> 8) &amp; 0xf;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a> = -1;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#receive\">receive</a> &gt; sizeof(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(1);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#send\">send</a> && !<a class=\"id\" href=\"#param\">param</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(1);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_pause_rx\">serio_pause_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#command\">command</a> == <a class=\"id\" href=\"#PS2_CMD_GETID\">PS2_CMD_GETID</a> ? <a class=\"id\" href=\"#PS2_FLAG_WAITID\">PS2_FLAG_WAITID</a> : 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a> = <a class=\"id\" href=\"#receive\">receive</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#receive\">receive</a> && <a class=\"id\" href=\"#param\">param</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#receive\">receive</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>[(<a class=\"id\" href=\"#receive\">receive</a> - 1) - <a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#param\">param</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_continue_rx\">serio_continue_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Some devices (Synaptics) peform the reset before</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * ACKing the reset command, and so it can take a long</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * time before the ACK arrrives.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2_sendbyte\">ps2_sendbyte</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, <a class=\"id\" href=\"#command\">command</a> &amp; 0xff,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#command\">command</a> == <a class=\"id\" href=\"#PS2_CMD_RESET_BAT\">PS2_CMD_RESET_BAT</a> ? 1000 : 200))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#send\">send</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2_sendbyte\">ps2_sendbyte</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, <a class=\"id\" href=\"#param\">param</a>[<a class=\"id\" href=\"#i\">i</a>], 200))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * The reset command takes a long time to execute.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = <a class=\"id\" href=\"#msecs_to_jiffies\">msecs_to_jiffies</a>(<a class=\"id\" href=\"#command\">command</a> == <a class=\"id\" href=\"#PS2_CMD_RESET_BAT\">PS2_CMD_RESET_BAT</a> ? 4000 : 500);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = <a class=\"id\" href=\"#wait_event_timeout\">wait_event_timeout</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     !(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_CMD1\">PS2_FLAG_CMD1</a>), <a class=\"id\" href=\"#timeout\">timeout</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a> && !(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_CMD1\">PS2_FLAG_CMD1</a>)) {", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#timeout\">timeout</a> = <a class=\"id\" href=\"#ps2_adjust_timeout\">ps2_adjust_timeout</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, <a class=\"id\" href=\"#command\">command</a>, <a class=\"id\" href=\"#timeout\">timeout</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wait_event_timeout\">wait_event_timeout</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   !(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_CMD\">PS2_FLAG_CMD</a>), <a class=\"id\" href=\"#timeout\">timeout</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#param\">param</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#receive\">receive</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#param\">param</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>[(<a class=\"id\" href=\"#receive\">receive</a> - 1) - <a class=\"id\" href=\"#i\">i</a>];", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a> && (<a class=\"id\" href=\"#command\">command</a> != <a class=\"id\" href=\"#PS2_CMD_RESET_BAT\">PS2_CMD_RESET_BAT</a> || <a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a> != 1))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_pause_rx\">serio_pause_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serio_continue_rx\">serio_continue_rx</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#__ps2_command\">__ps2_command</a>);", 
"", 
"int <a class=\"id\" href=\"#ps2_command\">ps2_command</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, unsigned char *<a class=\"id\" href=\"#param\">param</a>, int <a class=\"id\" href=\"#command\">command</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2_begin_command\">ps2_begin_command</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#__ps2_command\">__ps2_command</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, <a class=\"id\" href=\"#param\">param</a>, <a class=\"id\" href=\"#command\">command</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2_end_command\">ps2_end_command</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_command\">ps2_command</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_init() initializes ps2dev structure</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ps2_init\">ps2_init</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, struct <a class=\"id\" href=\"#serio\">serio</a> *<a class=\"id\" href=\"#serio\">serio</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_init\">mutex_init</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmd_mutex\">cmd_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#lockdep_set_subclass\">lockdep_set_subclass</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmd_mutex\">cmd_mutex</a>, <a class=\"id\" href=\"#serio\">serio</a>-><a class=\"id\" href=\"#depth\">depth</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#init_waitqueue_head\">init_waitqueue_head</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#serio\">serio</a> = <a class=\"id\" href=\"#serio\">serio</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_init\">ps2_init</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_handle_ack() is supposed to be used in interrupt handler</span>", 
"<span class=\"comment\"> * to properly process ACK/NAK of a command from a PS/2 device.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ps2_handle_ack\">ps2_handle_ack</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, unsigned char <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#data\">data</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#PS2_RET_ACK\">PS2_RET_ACK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#PS2_RET_NAK\">PS2_RET_NAK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#PS2_FLAG_NAK\">PS2_FLAG_NAK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a> = <a class=\"id\" href=\"#PS2_RET_NAK\">PS2_RET_NAK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#PS2_RET_ERR\">PS2_RET_ERR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_NAK\">PS2_FLAG_NAK</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#PS2_FLAG_NAK\">PS2_FLAG_NAK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a> = <a class=\"id\" href=\"#PS2_RET_ERR\">PS2_RET_ERR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Workaround for mice which don't ACK the Get ID command.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * These are valid mouse IDs that we recognize.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>case 0x00:", 
"<span class=\"ts\"/><span class=\"ts\"/>case 0x03:", 
"<span class=\"ts\"/><span class=\"ts\"/>case 0x04:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_WAITID\">PS2_FLAG_WAITID</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Fall through */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#PS2_FLAG_NAK\">PS2_FLAG_NAK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#PS2_FLAG_CMD\">PS2_FLAG_CMD</a> | <a class=\"id\" href=\"#PS2_FLAG_CMD1\">PS2_FLAG_CMD1</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#PS2_FLAG_ACK\">PS2_FLAG_ACK</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#data\">data</a> != <a class=\"id\" href=\"#PS2_RET_ACK\">PS2_RET_ACK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2_handle_response\">ps2_handle_response</a>(<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_handle_ack\">ps2_handle_ack</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * ps2_handle_response() is supposed to be used in interrupt handler</span>", 
"<span class=\"comment\"> * to properly store device's response to a command and notify process</span>", 
"<span class=\"comment\"> * waiting for completion of the command.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ps2_handle_response\">ps2_handle_response</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>, unsigned char <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdbuf\">cmdbuf</a>[--<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a>] = <a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_CMD1\">PS2_FLAG_CMD1</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#PS2_FLAG_CMD1\">PS2_FLAG_CMD1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#cmdcnt\">cmdcnt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#PS2_FLAG_CMD\">PS2_FLAG_CMD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_handle_response\">ps2_handle_response</a>);", 
"", 
"void <a class=\"id\" href=\"#ps2_cmd_aborted\">ps2_cmd_aborted</a>(struct <a class=\"id\" href=\"#ps2dev\">ps2dev</a> *<a class=\"id\" href=\"#ps2dev\">ps2dev</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#PS2_FLAG_ACK\">PS2_FLAG_ACK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#nak\">nak</a> = 1;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; (<a class=\"id\" href=\"#PS2_FLAG_ACK\">PS2_FLAG_ACK</a> | <a class=\"id\" href=\"#PS2_FLAG_CMD\">PS2_FLAG_CMD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#wait\">wait</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* reset all flags except last nack */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ps2dev\">ps2dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &= <a class=\"id\" href=\"#PS2_FLAG_NAK\">PS2_FLAG_NAK</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ps2_cmd_aborted\">ps2_cmd_aborted</a>);", 
];
xr_frag_insert('l/7e/48ae27c9a787d21af89d907893b158cad4144e.xr', __xr_tmp);
