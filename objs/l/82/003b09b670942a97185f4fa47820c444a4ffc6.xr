var __xr_tmp = [
"<span class=\"ts\"/>return <a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#reject_unknown\">reject_unknown</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#security_get_allow_unknown\">security_get_allow_unknown</a>(void)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#allow_unknown\">allow_unknown</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * security_policycap_supported - Check for a specific policy capability</span>", 
"<span class=\"comment\"> * @req_cap: capability</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function queries the currently loaded policy to see if it supports the</span>", 
"<span class=\"comment\"> * capability specified by @req_cap.  Returns true (1) if the capability is</span>", 
"<span class=\"comment\"> * supported, false (0) if it isn't supported.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#security_policycap_supported\">security_policycap_supported</a>(unsigned int <a class=\"id\" href=\"#req_cap\">req_cap</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#ebitmap_get_bit\">ebitmap_get_bit</a>(&amp;<a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#policycaps\">policycaps</a>, <a class=\"id\" href=\"#req_cap\">req_cap</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"struct <a class=\"id\" href=\"#selinux_audit_rule\">selinux_audit_rule</a> {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#au_seqno\">au_seqno</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#context\">context</a> <a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>;", 
"};", 
"", 
"void <a class=\"id\" href=\"#selinux_audit_rule_free\">selinux_audit_rule_free</a>(void *<a class=\"id\" href=\"#vrule\">vrule</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#selinux_audit_rule\">selinux_audit_rule</a> *<a class=\"id\" href=\"#rule\">rule</a> = <a class=\"id\" href=\"#vrule\">vrule</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rule\">rule</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context_destroy\">context_destroy</a>(&amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#rule\">rule</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"int <a class=\"id\" href=\"#selinux_audit_rule_init\">selinux_audit_rule_init</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#field\">field</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#op\">op</a>, char *<a class=\"id\" href=\"#rulestr\">rulestr</a>, void **<a class=\"id\" href=\"#vrule\">vrule</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#selinux_audit_rule\">selinux_audit_rule</a> *<a class=\"id\" href=\"#tmprule\">tmprule</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#role_datum\">role_datum</a> *<a class=\"id\" href=\"#roledatum\">roledatum</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#type_datum\">type_datum</a> *<a class=\"id\" href=\"#typedatum\">typedatum</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#user_datum\">user_datum</a> *<a class=\"id\" href=\"#userdatum\">userdatum</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#selinux_audit_rule\">selinux_audit_rule</a> **<a class=\"id\" href=\"#rule\">rule</a> = (struct <a class=\"id\" href=\"#selinux_audit_rule\">selinux_audit_rule</a> **)<a class=\"id\" href=\"#vrule\">vrule</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#rule\">rule</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ss_initialized\">ss_initialized</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EOPNOTSUPP\">EOPNOTSUPP</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#field\">field</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_USER\">AUDIT_SUBJ_USER</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_ROLE\">AUDIT_SUBJ_ROLE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_TYPE\">AUDIT_SUBJ_TYPE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_USER\">AUDIT_OBJ_USER</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_ROLE\">AUDIT_OBJ_ROLE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_TYPE\">AUDIT_OBJ_TYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* only 'equals' and 'not equals' fit user, role, and type */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#op\">op</a> != <a class=\"id\" href=\"#Audit_equal\">Audit_equal</a> && <a class=\"id\" href=\"#op\">op</a> != <a class=\"id\" href=\"#Audit_not_equal\">Audit_not_equal</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_SEN\">AUDIT_SUBJ_SEN</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_CLR\">AUDIT_SUBJ_CLR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_LOW\">AUDIT_OBJ_LEV_LOW</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_HIGH\">AUDIT_OBJ_LEV_HIGH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* we do not allow a range, indicated by the presense of '-' */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strchr\">strchr</a>(<a class=\"id\" href=\"#rulestr\">rulestr</a>, '-'))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* only the above fields are valid */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmprule\">tmprule</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#selinux_audit_rule\">selinux_audit_rule</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tmprule\">tmprule</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context_init\">context_init</a>(&amp;<a class=\"id\" href=\"#tmprule\">tmprule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmprule\">tmprule</a>-><a class=\"id\" href=\"#au_seqno\">au_seqno</a> = <a class=\"id\" href=\"#latest_granting\">latest_granting</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#field\">field</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_USER\">AUDIT_SUBJ_USER</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_USER\">AUDIT_OBJ_USER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#userdatum\">userdatum</a> = <a class=\"id\" href=\"#hashtab_search\">hashtab_search</a>(<a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#p_users\">p_users</a>.<a class=\"id\" href=\"#table\">table</a>, <a class=\"id\" href=\"#rulestr\">rulestr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#userdatum\">userdatum</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmprule\">tmprule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#user\">user</a> = <a class=\"id\" href=\"#userdatum\">userdatum</a>-><a class=\"id\" href=\"#value\">value</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_ROLE\">AUDIT_SUBJ_ROLE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_ROLE\">AUDIT_OBJ_ROLE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#roledatum\">roledatum</a> = <a class=\"id\" href=\"#hashtab_search\">hashtab_search</a>(<a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#p_roles\">p_roles</a>.<a class=\"id\" href=\"#table\">table</a>, <a class=\"id\" href=\"#rulestr\">rulestr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#roledatum\">roledatum</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmprule\">tmprule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#role\">role</a> = <a class=\"id\" href=\"#roledatum\">roledatum</a>-><a class=\"id\" href=\"#value\">value</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_TYPE\">AUDIT_SUBJ_TYPE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_TYPE\">AUDIT_OBJ_TYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#typedatum\">typedatum</a> = <a class=\"id\" href=\"#hashtab_search\">hashtab_search</a>(<a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#p_types\">p_types</a>.<a class=\"id\" href=\"#table\">table</a>, <a class=\"id\" href=\"#rulestr\">rulestr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#typedatum\">typedatum</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmprule\">tmprule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#typedatum\">typedatum</a>-><a class=\"id\" href=\"#value\">value</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_SEN\">AUDIT_SUBJ_SEN</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_CLR\">AUDIT_SUBJ_CLR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_LOW\">AUDIT_OBJ_LEV_LOW</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_HIGH\">AUDIT_OBJ_LEV_HIGH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#mls_from_string\">mls_from_string</a>(<a class=\"id\" href=\"#rulestr\">rulestr</a>, &amp;<a class=\"id\" href=\"#tmprule\">tmprule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#selinux_audit_rule_free\">selinux_audit_rule_free</a>(<a class=\"id\" href=\"#tmprule\">tmprule</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmprule\">tmprule</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#rule\">rule</a> = <a class=\"id\" href=\"#tmprule\">tmprule</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Check to see if the rule contains any selinux fields */</span>", 
"int <a class=\"id\" href=\"#selinux_audit_rule_known\">selinux_audit_rule_known</a>(struct <a class=\"id\" href=\"#audit_krule\">audit_krule</a> *<a class=\"id\" href=\"#rule\">rule</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#field_count\">field_count</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_field\">audit_field</a> *<a class=\"id\" href=\"#f\">f</a> = &amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#fields\">fields</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_USER\">AUDIT_SUBJ_USER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_ROLE\">AUDIT_SUBJ_ROLE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_TYPE\">AUDIT_SUBJ_TYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_SEN\">AUDIT_SUBJ_SEN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_CLR\">AUDIT_SUBJ_CLR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_USER\">AUDIT_OBJ_USER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_ROLE\">AUDIT_OBJ_ROLE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_TYPE\">AUDIT_OBJ_TYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_LOW\">AUDIT_OBJ_LEV_LOW</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_HIGH\">AUDIT_OBJ_LEV_HIGH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#selinux_audit_rule_match\">selinux_audit_rule_match</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#field\">field</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#op\">op</a>, void *<a class=\"id\" href=\"#vrule\">vrule</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#audit_context\">audit_context</a> *<a class=\"id\" href=\"#actx\">actx</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#ctxt\">ctxt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#mls_level\">mls_level</a> *<a class=\"id\" href=\"#level\">level</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#selinux_audit_rule\">selinux_audit_rule</a> *<a class=\"id\" href=\"#rule\">rule</a> = <a class=\"id\" href=\"#vrule\">vrule</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#match\">match</a> = 0;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rule\">rule</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log\">audit_log</a>(<a class=\"id\" href=\"#actx\">actx</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>, <a class=\"id\" href=\"#AUDIT_SELINUX_ERR\">AUDIT_SELINUX_ERR</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"selinux_audit_rule_match: missing rule\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_seqno\">au_seqno</a> &lt; <a class=\"id\" href=\"#latest_granting\">latest_granting</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log\">audit_log</a>(<a class=\"id\" href=\"#actx\">actx</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>, <a class=\"id\" href=\"#AUDIT_SELINUX_ERR\">AUDIT_SELINUX_ERR</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"selinux_audit_rule_match: stale rule\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = -<a class=\"id\" href=\"#ESTALE\">ESTALE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctxt\">ctxt</a> = <a class=\"id\" href=\"#sidtab_search\">sidtab_search</a>(&amp;<a class=\"id\" href=\"#sidtab\">sidtab</a>, <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ctxt\">ctxt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log\">audit_log</a>(<a class=\"id\" href=\"#actx\">actx</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>, <a class=\"id\" href=\"#AUDIT_SELINUX_ERR\">AUDIT_SELINUX_ERR</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  \"selinux_audit_rule_match: unrecognized SID %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* a field/op pair that is not caught here will simply fall through</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   without a match */</span>", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#field\">field</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_USER\">AUDIT_SUBJ_USER</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_USER\">AUDIT_OBJ_USER</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#op\">op</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_equal\">Audit_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#user\">user</a> == <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#user\">user</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_not_equal\">Audit_not_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#user\">user</a> != <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#user\">user</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_ROLE\">AUDIT_SUBJ_ROLE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_ROLE\">AUDIT_OBJ_ROLE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#op\">op</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_equal\">Audit_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#role\">role</a> == <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#role\">role</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_not_equal\">Audit_not_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#role\">role</a> != <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#role\">role</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_TYPE\">AUDIT_SUBJ_TYPE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_TYPE\">AUDIT_OBJ_TYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#op\">op</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_equal\">Audit_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_not_equal\">Audit_not_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_SEN\">AUDIT_SUBJ_SEN</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_SUBJ_CLR\">AUDIT_SUBJ_CLR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_LOW\">AUDIT_OBJ_LEV_LOW</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_OBJ_LEV_HIGH\">AUDIT_OBJ_LEV_HIGH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#level\">level</a> = ((<a class=\"id\" href=\"#field\">field</a> == <a class=\"id\" href=\"#AUDIT_SUBJ_SEN\">AUDIT_SUBJ_SEN</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#field\">field</a> == <a class=\"id\" href=\"#AUDIT_OBJ_LEV_LOW\">AUDIT_OBJ_LEV_LOW</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0] : &amp;<a class=\"id\" href=\"#ctxt\">ctxt</a>-><a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[1]);", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#op\">op</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_equal\">Audit_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = <a class=\"id\" href=\"#mls_level_eq\">mls_level_eq</a>(&amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_not_equal\">Audit_not_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = !<a class=\"id\" href=\"#mls_level_eq\">mls_level_eq</a>(&amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_lt\">Audit_lt</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#mls_level_dom\">mls_level_dom</a>(&amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#level\">level</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> !<a class=\"id\" href=\"#mls_level_eq\">mls_level_eq</a>(&amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#level\">level</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_le\">Audit_le</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = <a class=\"id\" href=\"#mls_level_dom\">mls_level_dom</a>(&amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#level\">level</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_gt\">Audit_gt</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = (<a class=\"id\" href=\"#mls_level_dom\">mls_level_dom</a>(<a class=\"id\" href=\"#level\">level</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0]) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> !<a class=\"id\" href=\"#mls_level_eq\">mls_level_eq</a>(<a class=\"id\" href=\"#level\">level</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0]));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_ge\">Audit_ge</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#match\">match</a> = <a class=\"id\" href=\"#mls_level_dom\">mls_level_dom</a>(<a class=\"id\" href=\"#level\">level</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#au_ctxt\">au_ctxt</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#match\">match</a>;", 
"}", 
"", 
"static int (*<a class=\"id\" href=\"#aurule_callback\">aurule_callback</a>)(void) = <a class=\"id\" href=\"#audit_update_lsm_rules\">audit_update_lsm_rules</a>;", 
"", 
"static int <a class=\"id\" href=\"#aurule_avc_callback\">aurule_avc_callback</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event\">event</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#ssid\">ssid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tsid\">tsid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#class\">class</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#perms\">perms</a>, <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#retained\">retained</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#event\">event</a> == <a class=\"id\" href=\"#AVC_CALLBACK_RESET\">AVC_CALLBACK_RESET</a> && <a class=\"id\" href=\"#aurule_callback\">aurule_callback</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#aurule_callback\">aurule_callback</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#aurule_init\">aurule_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#avc_add_callback\">avc_add_callback</a>(<a class=\"id\" href=\"#aurule_avc_callback\">aurule_avc_callback</a>, <a class=\"id\" href=\"#AVC_CALLBACK_RESET\">AVC_CALLBACK_RESET</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>, <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>, <a class=\"id\" href=\"#SECCLASS_NULL\">SECCLASS_NULL</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#panic\">panic</a>(\"avc_add_callback() failed, error %d\\n\", <a class=\"id\" href=\"#err\">err</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#__initcall\">__initcall</a>(<a class=\"id\" href=\"#aurule_init\">aurule_init</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NETLABEL\">CONFIG_NETLABEL</a>", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * security_netlbl_cache_add - Add an entry to the NetLabel cache</span>", 
"<span class=\"comment\"> * @secattr: the NetLabel packet security attributes</span>", 
"<span class=\"comment\"> * @sid: the SELinux SID</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Attempt to cache the context in @ctx, which was derived from the packet in</span>", 
"<span class=\"comment\"> * @skb, in the NetLabel subsystem cache.  This function assumes @secattr has</span>", 
"<span class=\"comment\"> * already been initialized.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#security_netlbl_cache_add\">security_netlbl_cache_add</a>(struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#sid_cache\">sid_cache</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sid_cache\">sid_cache</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#sid_cache\">sid_cache</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sid_cache\">sid_cache</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a> = <a class=\"id\" href=\"#netlbl_secattr_cache_alloc\">netlbl_secattr_cache_alloc</a>(<a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#sid_cache\">sid_cache</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#sid_cache\">sid_cache</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a>-><a class=\"id\" href=\"#free\">free</a> = <a class=\"id\" href=\"#kfree\">kfree</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a>-><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#sid_cache\">sid_cache</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_CACHE\">NETLBL_SECATTR_CACHE</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * security_netlbl_secattr_to_sid - Convert a NetLabel secattr to a SELinux SID</span>", 
"<span class=\"comment\"> * @secattr: the NetLabel packet security attributes</span>", 
"<span class=\"comment\"> * @sid: the SELinux SID</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Convert the given NetLabel security attributes in @secattr into a</span>", 
"<span class=\"comment\"> * SELinux SID.  If the @secattr field does not contain a full SELinux</span>", 
"<span class=\"comment\"> * SID/context then use SECINITSID_NETMSG as the foundation.  If possibile the</span>", 
"<span class=\"comment\"> * 'cache' field of @secattr is set and the CACHE flag is set; this is to</span>", 
"<span class=\"comment\"> * allow the @secattr to be used by NetLabel to cache the secattr to SID</span>", 
"<span class=\"comment\"> * conversion for future lookups.  Returns zero on success, negative values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#security_netlbl_secattr_to_sid\">security_netlbl_secattr_to_sid</a>(struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EIDRM\">EIDRM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#ctx\">ctx</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#context\">context</a> <a class=\"id\" href=\"#ctx_new\">ctx_new</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ss_initialized\">ss_initialized</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_CACHE\">NETLBL_SECATTR_CACHE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#sid\">sid</a> = *(<a class=\"id\" href=\"#u32\">u32</a> *)<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#cache\">cache</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_SECID\">NETLBL_SECATTR_SECID</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_LVL\">NETLBL_SECATTR_MLS_LVL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#sidtab_search\">sidtab_search</a>(&amp;<a class=\"id\" href=\"#sidtab\">sidtab</a>, <a class=\"id\" href=\"#SECINITSID_NETMSG\">SECINITSID_NETMSG</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ctx\">ctx</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_secattr_to_sid_return\">netlbl_secattr_to_sid_return</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context_init\">context_init</a>(&amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#user\">user</a> = <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#user\">user</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#role\">role</a> = <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#role\">role</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mls_import_netlbl_lvl\">mls_import_netlbl_lvl</a>(&amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>, <a class=\"id\" href=\"#secattr\">secattr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLBL_SECATTR_MLS_CAT\">NETLBL_SECATTR_MLS_CAT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ebitmap_netlbl_import\">ebitmap_netlbl_import</a>(&amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0].<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#mls\">mls</a>.<a class=\"id\" href=\"#cat\">cat</a>) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_secattr_to_sid_return\">netlbl_secattr_to_sid_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[1].<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0].<a class=\"id\" href=\"#cat\">cat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       sizeof(<a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0].<a class=\"id\" href=\"#cat\">cat</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mls_context_isvalid\">mls_context_isvalid</a>(&amp;<a class=\"id\" href=\"#policydb\">policydb</a>, &amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>) != 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_secattr_to_sid_return_cleanup\">netlbl_secattr_to_sid_return_cleanup</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#sidtab_context_to_sid\">sidtab_context_to_sid</a>(&amp;<a class=\"id\" href=\"#sidtab\">sidtab</a>, &amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>, <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_secattr_to_sid_return_cleanup\">netlbl_secattr_to_sid_return_cleanup</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_netlbl_cache_add\">security_netlbl_cache_add</a>(<a class=\"id\" href=\"#secattr\">secattr</a>, *<a class=\"id\" href=\"#sid\">sid</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ebitmap_destroy\">ebitmap_destroy</a>(&amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0].<a class=\"id\" href=\"#cat\">cat</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#netlbl_secattr_to_sid_return\">netlbl_secattr_to_sid_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"<a class=\"id\" href=\"#netlbl_secattr_to_sid_return_cleanup\">netlbl_secattr_to_sid_return_cleanup</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ebitmap_destroy\">ebitmap_destroy</a>(&amp;<a class=\"id\" href=\"#ctx_new\">ctx_new</a>.<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0].<a class=\"id\" href=\"#cat\">cat</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_secattr_to_sid_return\">netlbl_secattr_to_sid_return</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * security_netlbl_sid_to_secattr - Convert a SELinux SID to a NetLabel secattr</span>", 
"<span class=\"comment\"> * @sid: the SELinux SID</span>", 
"<span class=\"comment\"> * @secattr: the NetLabel packet security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Convert the given SELinux SID in @sid into a NetLabel security attribute.</span>", 
"<span class=\"comment\"> * Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#security_netlbl_sid_to_secattr\">security_netlbl_sid_to_secattr</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>, struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#ctx\">ctx</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ss_initialized\">ss_initialized</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#sidtab_search\">sidtab_search</a>(&amp;<a class=\"id\" href=\"#sidtab\">sidtab</a>, <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ctx\">ctx</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_sid_to_secattr_failure\">netlbl_sid_to_secattr_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#domain\">domain</a> = <a class=\"id\" href=\"#kstrdup\">kstrdup</a>(<a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#p_type_val_to_name\">p_type_val_to_name</a>[<a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#type\">type</a> - 1],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#domain\">domain</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_sid_to_secattr_failure\">netlbl_sid_to_secattr_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#secid\">secid</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_DOMAIN_CPY\">NETLBL_SECATTR_DOMAIN_CPY</a> | <a class=\"id\" href=\"#NETLBL_SECATTR_SECID\">NETLBL_SECATTR_SECID</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mls_export_netlbl_lvl\">mls_export_netlbl_lvl</a>(<a class=\"id\" href=\"#ctx\">ctx</a>, <a class=\"id\" href=\"#secattr\">secattr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#mls_export_netlbl_cat\">mls_export_netlbl_cat</a>(<a class=\"id\" href=\"#ctx\">ctx</a>, <a class=\"id\" href=\"#secattr\">secattr</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#netlbl_sid_to_secattr_failure\">netlbl_sid_to_secattr_failure</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#netlbl_sid_to_secattr_failure\">netlbl_sid_to_secattr_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#policy_rwlock\">policy_rwlock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_NETLABEL */</span>", 
];
xr_frag_insert('l/82/003b09b670942a97185f4fa47820c444a4ffc6.xr', __xr_tmp);
