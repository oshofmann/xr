var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * security/tomoyo/mount.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (C) 2005-2010  NTT DATA CORPORATION</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"common.h\"", 
"", 
"<span class=\"comment\">/* Keywords for mount restrictions. */</span>", 
"", 
"<span class=\"comment\">/* Allow to call 'mount --bind /source_dir /dest_dir' */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TOMOYO_MOUNT_BIND_KEYWORD\">TOMOYO_MOUNT_BIND_KEYWORD</a>                        \"--bind\"", 
"<span class=\"comment\">/* Allow to call 'mount --move /old_dir    /new_dir ' */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TOMOYO_MOUNT_MOVE_KEYWORD\">TOMOYO_MOUNT_MOVE_KEYWORD</a>                        \"--move\"", 
"<span class=\"comment\">/* Allow to call 'mount -o remount /dir             ' */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TOMOYO_MOUNT_REMOUNT_KEYWORD\">TOMOYO_MOUNT_REMOUNT_KEYWORD</a>                     \"--remount\"", 
"<span class=\"comment\">/* Allow to call 'mount --make-unbindable /dir'       */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD\">TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD</a>             \"--make-unbindable\"", 
"<span class=\"comment\">/* Allow to call 'mount --make-private /dir'          */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD\">TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD</a>                \"--make-private\"", 
"<span class=\"comment\">/* Allow to call 'mount --make-slave /dir'            */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD\">TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD</a>                  \"--make-slave\"", 
"<span class=\"comment\">/* Allow to call 'mount --make-shared /dir'           */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SHARED_KEYWORD\">TOMOYO_MOUNT_MAKE_SHARED_KEYWORD</a>                 \"--make-shared\"", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_audit_mount_log - Audit mount log.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @r: Pointer to \"struct tomoyo_request_info\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#tomoyo_audit_mount_log\">tomoyo_audit_mount_log</a>(struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> *<a class=\"id\" href=\"#r\">r</a>)", 
"{", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#dir\">dir</a> = <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dir\">dir</a>-><a class=\"id\" href=\"#name\">name</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#name\">name</a>;", 
"<span class=\"ts\"/>const unsigned long <a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#granted\">granted</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_REMOUNT_KEYWORD\">TOMOYO_MOUNT_REMOUNT_KEYWORD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_warn_log\">tomoyo_warn_log</a>(<a class=\"id\" href=\"#r\">r</a>, \"mount -o remount %s 0x%lX\", <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_BIND_KEYWORD\">TOMOYO_MOUNT_BIND_KEYWORD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/> || !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MOVE_KEYWORD\">TOMOYO_MOUNT_MOVE_KEYWORD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_warn_log\">tomoyo_warn_log</a>(<a class=\"id\" href=\"#r\">r</a>, \"mount %s %s %s 0x%lX\", <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#dir\">dir</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>else if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD\">TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/> !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD\">TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/> !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD\">TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/> !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SHARED_KEYWORD\">TOMOYO_MOUNT_MAKE_SHARED_KEYWORD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_warn_log\">tomoyo_warn_log</a>(<a class=\"id\" href=\"#r\">r</a>, \"mount %s %s 0x%lX\", <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_warn_log\">tomoyo_warn_log</a>(<a class=\"id\" href=\"#r\">r</a>, \"mount -t %s %s %s 0x%lX\", <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#dir\">dir</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_supervisor\">tomoyo_supervisor</a>(<a class=\"id\" href=\"#r\">r</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#TOMOYO_KEYWORD_ALLOW_MOUNT\">TOMOYO_KEYWORD_ALLOW_MOUNT</a> \"%s %s %s 0x%lX\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tomoyo_pattern\">tomoyo_pattern</a>(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dev\">dev</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tomoyo_pattern\">tomoyo_pattern</a>(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dir\">dir</a>), <a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_check_mount_acl\">tomoyo_check_mount_acl</a>(struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> *<a class=\"id\" href=\"#r\">r</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   const struct <a class=\"id\" href=\"#tomoyo_acl_info\">tomoyo_acl_info</a> *<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_mount_acl\">tomoyo_mount_acl</a> *<a class=\"id\" href=\"#acl\">acl</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#ptr\">ptr</a>, <a class=\"id\" href=\"#typeof\">typeof</a>(*<a class=\"id\" href=\"#acl\">acl</a>), <a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_compare_number_union\">tomoyo_compare_number_union</a>(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#flags\">flags</a>, &amp;<a class=\"id\" href=\"#acl\">acl</a>-><a class=\"id\" href=\"#flags\">flags</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_compare_name_union\">tomoyo_compare_name_union</a>(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#type\">type</a>, &amp;<a class=\"id\" href=\"#acl\">acl</a>-><a class=\"id\" href=\"#fs_type\">fs_type</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_compare_name_union\">tomoyo_compare_name_union</a>(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dir\">dir</a>, &amp;<a class=\"id\" href=\"#acl\">acl</a>-><a class=\"id\" href=\"#dir_name\">dir_name</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>(!<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#need_dev\">need_dev</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#tomoyo_compare_name_union\">tomoyo_compare_name_union</a>(<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#acl\">acl</a>-><a class=\"id\" href=\"#dev_name\">dev_name</a>));", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_mount_acl - Check permission for mount() operation.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @r:        Pointer to \"struct tomoyo_request_info\".</span>", 
"<span class=\"comment\"> * @dev_name: Name of device file.</span>", 
"<span class=\"comment\"> * @dir:      Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> * @type:     Name of filesystem type.</span>", 
"<span class=\"comment\"> * @flags:    Mount options.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Caller holds tomoyo_read_lock().</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#tomoyo_mount_acl\">tomoyo_mount_acl</a>(struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> *<a class=\"id\" href=\"#r\">r</a>, char *<a class=\"id\" href=\"#dev_name\">dev_name</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#dir\">dir</a>, char *<a class=\"id\" href=\"#type\">type</a>, unsigned long <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#path\">path</a> <a class=\"id\" href=\"#path\">path</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file_system_type\">file_system_type</a> *<a class=\"id\" href=\"#fstype\">fstype</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#requested_type\">requested_type</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#requested_dir_name\">requested_dir_name</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#requested_dev_name\">requested_dev_name</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#rtype\">rtype</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#rdev\">rdev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#rdir\">rdir</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#need_dev\">need_dev</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Get fstype. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#requested_type\">requested_type</a> = <a class=\"id\" href=\"#tomoyo_encode\">tomoyo_encode</a>(<a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#requested_type\">requested_type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtype\">rtype</a>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#requested_type\">requested_type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_fill_path_info\">tomoyo_fill_path_info</a>(&amp;<a class=\"id\" href=\"#rtype\">rtype</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Get mount point. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#requested_dir_name\">requested_dir_name</a> = <a class=\"id\" href=\"#tomoyo_realpath_from_path\">tomoyo_realpath_from_path</a>(<a class=\"id\" href=\"#dir\">dir</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#requested_dir_name\">requested_dir_name</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdir\">rdir</a>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#requested_dir_name\">requested_dir_name</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_fill_path_info\">tomoyo_fill_path_info</a>(&amp;<a class=\"id\" href=\"#rdir\">rdir</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Compare fs name. */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_REMOUNT_KEYWORD\">TOMOYO_MOUNT_REMOUNT_KEYWORD</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* dev_name is ignored. */</span>", 
"<span class=\"ts\"/>} else if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD\">TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>   !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD\">TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>   !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD\">TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>   !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SHARED_KEYWORD\">TOMOYO_MOUNT_MAKE_SHARED_KEYWORD</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* dev_name is ignored. */</span>", 
"<span class=\"ts\"/>} else if (!<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_BIND_KEYWORD\">TOMOYO_MOUNT_BIND_KEYWORD</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>   !<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#TOMOYO_MOUNT_MOVE_KEYWORD\">TOMOYO_MOUNT_MOVE_KEYWORD</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#need_dev\">need_dev</a> = -1; <span class=\"comment\">/* dev_name is a directory */</span>", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fstype\">fstype</a> = <a class=\"id\" href=\"#get_fs_type\">get_fs_type</a>(<a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fstype\">fstype</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fstype\">fstype</a>-><a class=\"id\" href=\"#fs_flags\">fs_flags</a> &amp; <a class=\"id\" href=\"#FS_REQUIRES_DEV\">FS_REQUIRES_DEV</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* dev_name is a block device file. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#need_dev\">need_dev</a> = 1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#need_dev\">need_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Get mount point or device file. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#kern_path\">kern_path</a>(<a class=\"id\" href=\"#dev_name\">dev_name</a>, <a class=\"id\" href=\"#LOOKUP_FOLLOW\">LOOKUP_FOLLOW</a>, &amp;<a class=\"id\" href=\"#path\">path</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#requested_dev_name\">requested_dev_name</a> = <a class=\"id\" href=\"#tomoyo_realpath_from_path\">tomoyo_realpath_from_path</a>(&amp;<a class=\"id\" href=\"#path\">path</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#requested_dev_name\">requested_dev_name</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Map dev_name to \"&lt;NULL&gt;\" if no dev_name given. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev_name\">dev_name</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_name\">dev_name</a> = \"<NULL>\";", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#requested_dev_name\">requested_dev_name</a> = <a class=\"id\" href=\"#tomoyo_encode\">tomoyo_encode</a>(<a class=\"id\" href=\"#dev_name\">dev_name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#requested_dev_name\">requested_dev_name</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdev\">rdev</a>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#requested_dev_name\">requested_dev_name</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_fill_path_info\">tomoyo_fill_path_info</a>(&amp;<a class=\"id\" href=\"#rdev\">rdev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param_type\">param_type</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_MOUNT_ACL\">TOMOYO_TYPE_MOUNT_ACL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#need_dev\">need_dev</a> = <a class=\"id\" href=\"#need_dev\">need_dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dev\">dev</a> = &amp;<a class=\"id\" href=\"#rdev\">rdev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#dir\">dir</a> = &amp;<a class=\"id\" href=\"#rdir\">rdir</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#type\">type</a> = &amp;<a class=\"id\" href=\"#rtype\">rtype</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mount\">mount</a>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_check_acl\">tomoyo_check_acl</a>(<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#tomoyo_check_mount_acl\">tomoyo_check_mount_acl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_audit_mount_log\">tomoyo_audit_mount_log</a>(<a class=\"id\" href=\"#r\">r</a>);", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#error\">error</a> == <a class=\"id\" href=\"#TOMOYO_RETRY_REQUEST\">TOMOYO_RETRY_REQUEST</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#requested_dev_name\">requested_dev_name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#requested_dir_name\">requested_dir_name</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fstype\">fstype</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_filesystem\">put_filesystem</a>(<a class=\"id\" href=\"#fstype\">fstype</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#requested_type\">requested_type</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_mount_permission - Check permission for mount() operation.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @dev_name:  Name of device file.</span>", 
"<span class=\"comment\"> * @path:      Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> * @type:      Name of filesystem type. May be NULL.</span>", 
"<span class=\"comment\"> * @flags:     Mount options.</span>", 
"<span class=\"comment\"> * @data_page: Optional data. May be NULL.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_mount_permission\">tomoyo_mount_permission</a>(char *<a class=\"id\" href=\"#dev_name\">dev_name</a>, struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#path\">path</a>, char *<a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    unsigned long <a class=\"id\" href=\"#flags\">flags</a>, void *<a class=\"id\" href=\"#data_page\">data_page</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> <a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_init_request_info\">tomoyo_init_request_info</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#TOMOYO_MAC_FILE_MOUNT\">TOMOYO_MAC_FILE_MOUNT</a>)", 
"<span class=\"ts\"/>    == <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_MGC_MSK\">MS_MGC_MSK</a>) == <a class=\"id\" href=\"#MS_MGC_VAL\">MS_MGC_VAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_MGC_MSK\">MS_MGC_MSK</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_REMOUNT\">MS_REMOUNT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_MOUNT_REMOUNT_KEYWORD\">TOMOYO_MOUNT_REMOUNT_KEYWORD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_REMOUNT\">MS_REMOUNT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_MOVE\">MS_MOVE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_MOUNT_MOVE_KEYWORD\">TOMOYO_MOUNT_MOVE_KEYWORD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_MOVE\">MS_MOVE</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_BIND\">MS_BIND</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_MOUNT_BIND_KEYWORD\">TOMOYO_MOUNT_BIND_KEYWORD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_BIND\">MS_BIND</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_UNBINDABLE\">MS_UNBINDABLE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD\">TOMOYO_MOUNT_MAKE_UNBINDABLE_KEYWORD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_UNBINDABLE\">MS_UNBINDABLE</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_PRIVATE\">MS_PRIVATE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD\">TOMOYO_MOUNT_MAKE_PRIVATE_KEYWORD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_PRIVATE\">MS_PRIVATE</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_SLAVE\">MS_SLAVE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD\">TOMOYO_MOUNT_MAKE_SLAVE_KEYWORD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_SLAVE\">MS_SLAVE</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MS_SHARED\">MS_SHARED</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_MOUNT_MAKE_SHARED_KEYWORD\">TOMOYO_MOUNT_MAKE_SHARED_KEYWORD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#MS_SHARED\">MS_SHARED</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = \"<NULL>\";", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#tomoyo_read_lock\">tomoyo_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_mount_acl\">tomoyo_mount_acl</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#dev_name\">dev_name</a>, <a class=\"id\" href=\"#path\">path</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_read_unlock\">tomoyo_read_unlock</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_same_mount_acl\">tomoyo_same_mount_acl</a>(const struct <a class=\"id\" href=\"#tomoyo_acl_info\">tomoyo_acl_info</a> *<a class=\"id\" href=\"#a\">a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  const struct <a class=\"id\" href=\"#tomoyo_acl_info\">tomoyo_acl_info</a> *<a class=\"id\" href=\"#b\">b</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_mount_acl\">tomoyo_mount_acl</a> *<a class=\"id\" href=\"#p1\">p1</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#a\">a</a>, <a class=\"id\" href=\"#typeof\">typeof</a>(*<a class=\"id\" href=\"#p1\">p1</a>), <a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_mount_acl\">tomoyo_mount_acl</a> *<a class=\"id\" href=\"#p2\">p2</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#b\">b</a>, <a class=\"id\" href=\"#typeof\">typeof</a>(*<a class=\"id\" href=\"#p2\">p2</a>), <a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_same_acl_head\">tomoyo_same_acl_head</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#head\">head</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#head\">head</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_same_name_union\">tomoyo_same_name_union</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#dev_name\">dev_name</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#dev_name\">dev_name</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_same_name_union\">tomoyo_same_name_union</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#dir_name\">dir_name</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#dir_name\">dir_name</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_same_name_union\">tomoyo_same_name_union</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#fs_type\">fs_type</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#fs_type\">fs_type</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_same_number_union\">tomoyo_same_number_union</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#flags\">flags</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_write_mount - Write \"struct tomoyo_mount_acl\" list.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @data:      String to parse.</span>", 
"<span class=\"comment\"> * @domain:    Pointer to \"struct tomoyo_domain_info\".</span>", 
"<span class=\"comment\"> * @is_delete: True if it is a delete request.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Caller holds tomoyo_read_lock().</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_write_mount\">tomoyo_write_mount</a>(char *<a class=\"id\" href=\"#data\">data</a>, struct <a class=\"id\" href=\"#tomoyo_domain_info\">tomoyo_domain_info</a> *<a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       const <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#is_delete\">is_delete</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_mount_acl\">tomoyo_mount_acl</a> <a class=\"id\" href=\"#e\">e</a> = { .<a class=\"id\" href=\"#head\">head</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_MOUNT_ACL\">TOMOYO_TYPE_MOUNT_ACL</a> };", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#is_delete\">is_delete</a> ? -<a class=\"id\" href=\"#ENOENT\">ENOENT</a> : -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#w\">w</a>[4];", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_tokenize\">tomoyo_tokenize</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#w\">w</a>, sizeof(<a class=\"id\" href=\"#w\">w</a>)) || !<a class=\"id\" href=\"#w\">w</a>[3][0])", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_parse_name_union\">tomoyo_parse_name_union</a>(<a class=\"id\" href=\"#w\">w</a>[0], &amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#dev_name\">dev_name</a>) ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#tomoyo_parse_name_union\">tomoyo_parse_name_union</a>(<a class=\"id\" href=\"#w\">w</a>[1], &amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#dir_name\">dir_name</a>) ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#tomoyo_parse_name_union\">tomoyo_parse_name_union</a>(<a class=\"id\" href=\"#w\">w</a>[2], &amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#fs_type\">fs_type</a>) ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#tomoyo_parse_number_union\">tomoyo_parse_number_union</a>(<a class=\"id\" href=\"#w\">w</a>[3], &amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#flags\">flags</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_update_domain\">tomoyo_update_domain</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#head\">head</a>, sizeof(<a class=\"id\" href=\"#e\">e</a>), <a class=\"id\" href=\"#is_delete\">is_delete</a>, <a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#tomoyo_same_mount_acl\">tomoyo_same_mount_acl</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_name_union\">tomoyo_put_name_union</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#dev_name\">dev_name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_name_union\">tomoyo_put_name_union</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#dir_name\">dir_name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_name_union\">tomoyo_put_name_union</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#fs_type\">fs_type</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_number_union\">tomoyo_put_number_union</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
];
xr_frag_insert('l/8b/1e1992a78103a1787c8210827ba5d2f7c69b2e.xr', __xr_tmp);
