var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Network node table</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * SELinux must keep a mapping of network nodes to labels/SIDs.  This</span>", 
"<span class=\"comment\"> * mapping is maintained as part of the normal policy but a fast cache is</span>", 
"<span class=\"comment\"> * needed to reduce the lookup overhead since most of these queries happen on</span>", 
"<span class=\"comment\"> * a per-packet basis.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author: Paul Moore &lt;paul.moore@hp.com&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This code is heavily based on the \"netif\" concept originally developed by</span>", 
"<span class=\"comment\"> * James Morris &lt;jmorris@redhat.com&gt;</span>", 
"<span class=\"comment\"> *   (see security/selinux/netif.c for more information)</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * (c) Copyright Hewlett-Packard Development Company, L.P., 2007</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software: you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of version 2 of the GNU General Public License as</span>", 
"<span class=\"comment\"> * published by the Free Software Foundation.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is distributed in the hope that it will be useful,</span>", 
"<span class=\"comment\"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>", 
"<span class=\"comment\"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>", 
"<span class=\"comment\"> * GNU General Public License for more details.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#rcupdate\">rcupdate</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#spinlock\">spinlock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#in\">in</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#in6\">in6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> \"netnode.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"objsec.h\"", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#SEL_NETNODE_HASH_SIZE\">SEL_NETNODE_HASH_SIZE</a>       256", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#SEL_NETNODE_HASH_BKT_LIMIT\">SEL_NETNODE_HASH_BKT_LIMIT</a>   16", 
"", 
"struct <a class=\"id\" href=\"#sel_netnode_bkt\">sel_netnode_bkt</a> {", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> <a class=\"id\" href=\"#list\">list</a>;", 
"};", 
"", 
"struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netnode_security_struct\">netnode_security_struct</a> <a class=\"id\" href=\"#nsec\">nsec</a>;", 
"", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> <a class=\"id\" href=\"#list\">list</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> <a class=\"id\" href=\"#rcu\">rcu</a>;", 
"};", 
"", 
"<span class=\"comment\">/* NOTE: we are using a combined hash table for both IPv4 and IPv6, the reason</span>", 
"<span class=\"comment\"> * for this is that I suspect most users will not make heavy use of both</span>", 
"<span class=\"comment\"> * address families at the same time so one table will usually end up wasted,</span>", 
"<span class=\"comment\"> * if this becomes a problem we can always add a hash table for each address</span>", 
"<span class=\"comment\"> * family later */</span>", 
"", 
"static <a class=\"id\" href=\"#LIST_HEAD\">LIST_HEAD</a>(<a class=\"id\" href=\"#sel_netnode_list\">sel_netnode_list</a>);", 
"static <a class=\"id\" href=\"#DEFINE_SPINLOCK\">DEFINE_SPINLOCK</a>(<a class=\"id\" href=\"#sel_netnode_lock\">sel_netnode_lock</a>);", 
"static struct <a class=\"id\" href=\"#sel_netnode_bkt\">sel_netnode_bkt</a> <a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#SEL_NETNODE_HASH_SIZE\">SEL_NETNODE_HASH_SIZE</a>];", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_free - Frees a node entry</span>", 
"<span class=\"comment\"> * @p: the entry's RCU field</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function is designed to be used as a callback to the call_rcu()</span>", 
"<span class=\"comment\"> * function so that memory allocated to a hash table node entry can be</span>", 
"<span class=\"comment\"> * released safely.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#sel_netnode_free\">sel_netnode_free</a>(struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> *<a class=\"id\" href=\"#p\">p</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#node\">node</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#p\">p</a>, struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a>, <a class=\"id\" href=\"#rcu\">rcu</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#node\">node</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_hashfn_ipv4 - IPv4 hashing function for the node table</span>", 
"<span class=\"comment\"> * @addr: IPv4 address</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This is the IPv4 hashing function for the node interface table, it returns</span>", 
"<span class=\"comment\"> * the bucket number for the given IP address.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static unsigned int <a class=\"id\" href=\"#sel_netnode_hashfn_ipv4\">sel_netnode_hashfn_ipv4</a>(<a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* at some point we should determine if the mismatch in byte order</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * affects the hash function dramatically */</span>", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#addr\">addr</a> &amp; (<a class=\"id\" href=\"#SEL_NETNODE_HASH_SIZE\">SEL_NETNODE_HASH_SIZE</a> - 1));", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_hashfn_ipv6 - IPv6 hashing function for the node table</span>", 
"<span class=\"comment\"> * @addr: IPv6 address</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This is the IPv6 hashing function for the node interface table, it returns</span>", 
"<span class=\"comment\"> * the bucket number for the given IP address.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static unsigned int <a class=\"id\" href=\"#sel_netnode_hashfn_ipv6\">sel_netnode_hashfn_ipv6</a>(const struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* just hash the least significant 32 bits to keep things fast (they</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * are the most likely to be different anyway), we can revisit this</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * later if needed */</span>", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[3] &amp; (<a class=\"id\" href=\"#SEL_NETNODE_HASH_SIZE\">SEL_NETNODE_HASH_SIZE</a> - 1));", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_find - Search for a node record</span>", 
"<span class=\"comment\"> * @addr: IP address</span>", 
"<span class=\"comment\"> * @family: address family</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Search the network node table and return the record matching @addr.  If an</span>", 
"<span class=\"comment\"> * entry can not be found in the table return NULL.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#sel_netnode_find\">sel_netnode_find</a>(const void *<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#idx\">idx</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET\">PF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#sel_netnode_hashfn_ipv4\">sel_netnode_hashfn_ipv4</a>(*(<a class=\"id\" href=\"#__be32\">__be32</a> *)<a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#sel_netnode_hashfn_ipv6\">sel_netnode_hashfn_ipv6</a>(<a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#node\">node</a>, &amp;<a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#list\">list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#family\">family</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET\">PF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#ipv4\">ipv4</a> == *(<a class=\"id\" href=\"#__be32\">__be32</a> *)<a class=\"id\" href=\"#addr\">addr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ipv6_addr_equal\">ipv6_addr_equal</a>(&amp;<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#ipv6\">ipv6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_insert - Insert a new node into the table</span>", 
"<span class=\"comment\"> * @node: the new node record</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Add a new node record to the network address hash table.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#sel_netnode_insert\">sel_netnode_insert</a>(struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#node\">node</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET\">PF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#sel_netnode_hashfn_ipv4\">sel_netnode_hashfn_ipv4</a>(<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#ipv4\">ipv4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#sel_netnode_hashfn_ipv6\">sel_netnode_hashfn_ipv6</a>(&amp;<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#ipv6\">ipv6</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* we need to impose a limit on the growth of the hash table so check</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * this bucket to make sure it is within the specified bounds */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add_rcu\">list_add_rcu</a>(&amp;<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#size\">size</a> == <a class=\"id\" href=\"#SEL_NETNODE_HASH_BKT_LIMIT\">SEL_NETNODE_HASH_BKT_LIMIT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#tail\">tail</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tail\">tail</a> = <a class=\"id\" href=\"#list_entry\">list_entry</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#prev\">prev</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a>, <a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#tail\">tail</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#tail\">tail</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#sel_netnode_free\">sel_netnode_free</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#size\">size</a>++;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_sid_slow - Lookup the SID of a network address using the policy</span>", 
"<span class=\"comment\"> * @addr: the IP address</span>", 
"<span class=\"comment\"> * @family: the address family</span>", 
"<span class=\"comment\"> * @sid: node SID</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function determines the SID of a network address by quering the</span>", 
"<span class=\"comment\"> * security policy.  The result is added to the network address table to</span>", 
"<span class=\"comment\"> * speedup future queries.  Returns zero on success, negative values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#sel_netnode_sid_slow\">sel_netnode_sid_slow</a>(void *<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#new\">new</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#sel_netnode_lock\">sel_netnode_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#node\">node</a> = <a class=\"id\" href=\"#sel_netnode_find\">sel_netnode_find</a>(<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#node\">node</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sel_netnode_lock\">sel_netnode_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#new\">new</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new\">new</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET\">PF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#security_node_sid\">security_node_sid</a>(<a class=\"id\" href=\"#PF_INET\">PF_INET</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>, sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>), <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#ipv4\">ipv4</a> = *(<a class=\"id\" href=\"#__be32\">__be32</a> *)<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#security_node_sid\">security_node_sid</a>(<a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>, sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>), <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>(&amp;<a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#ipv6\">ipv6</a>, <a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#sid\">sid</a> = *<a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sel_netnode_insert\">sel_netnode_insert</a>(<a class=\"id\" href=\"#new\">new</a>);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sel_netnode_lock\">sel_netnode_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#ret\">ret</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>       \"SELinux: failure in sel_netnode_sid_slow(),\"", 
"<span class=\"ts\"/><span class=\"ts\"/>       \" unable to determine network node label\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#new\">new</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_sid - Lookup the SID of a network address</span>", 
"<span class=\"comment\"> * @addr: the IP address</span>", 
"<span class=\"comment\"> * @family: the address family</span>", 
"<span class=\"comment\"> * @sid: node SID</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function determines the SID of a network address using the fastest</span>", 
"<span class=\"comment\"> * method possible.  First the address table is queried, but if an entry</span>", 
"<span class=\"comment\"> * can't be found then the policy is queried and the result is added to the</span>", 
"<span class=\"comment\"> * table to speedup future queries.  Returns zero on success, negative values</span>", 
"<span class=\"comment\"> * on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#sel_netnode_sid\">sel_netnode_sid</a>(void *<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#node\">node</a> = <a class=\"id\" href=\"#sel_netnode_find\">sel_netnode_find</a>(<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#node\">node</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#nsec\">nsec</a>.<a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sel_netnode_sid_slow\">sel_netnode_sid_slow</a>(<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#sid\">sid</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * sel_netnode_flush - Flush the entire network address table</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Remove all entries from the network address table.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#sel_netnode_flush\">sel_netnode_flush</a>(void)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#idx\">idx</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sel_netnode\">sel_netnode</a> *<a class=\"id\" href=\"#node\">node</a>, *<a class=\"id\" href=\"#node_tmp\">node_tmp</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#sel_netnode_lock\">sel_netnode_lock</a>);", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#idx\">idx</a> = 0; <a class=\"id\" href=\"#idx\">idx</a> &lt; <a class=\"id\" href=\"#SEL_NETNODE_HASH_SIZE\">SEL_NETNODE_HASH_SIZE</a>; <a class=\"id\" href=\"#idx\">idx</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_safe\">list_for_each_entry_safe</a>(<a class=\"id\" href=\"#node\">node</a>, <a class=\"id\" href=\"#node_tmp\">node_tmp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#node\">node</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#sel_netnode_free\">sel_netnode_free</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#size\">size</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sel_netnode_lock\">sel_netnode_lock</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#sel_netnode_avc_callback\">sel_netnode_avc_callback</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event\">event</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#ssid\">ssid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tsid\">tsid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#class\">class</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#perms\">perms</a>, <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#retained\">retained</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#event\">event</a> == <a class=\"id\" href=\"#AVC_CALLBACK_RESET\">AVC_CALLBACK_RESET</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sel_netnode_flush\">sel_netnode_flush</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#synchronize_net\">synchronize_net</a>();", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#__init\">__init</a> int <a class=\"id\" href=\"#sel_netnode_init\">sel_netnode_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#iter\">iter</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#selinux_enabled\">selinux_enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#SEL_NETNODE_HASH_SIZE\">SEL_NETNODE_HASH_SIZE</a>; <a class=\"id\" href=\"#iter\">iter</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sel_netnode_hash\">sel_netnode_hash</a>[<a class=\"id\" href=\"#iter\">iter</a>].<a class=\"id\" href=\"#size\">size</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#avc_add_callback\">avc_add_callback</a>(<a class=\"id\" href=\"#sel_netnode_avc_callback\">sel_netnode_avc_callback</a>, <a class=\"id\" href=\"#AVC_CALLBACK_RESET\">AVC_CALLBACK_RESET</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>, <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>, <a class=\"id\" href=\"#SECCLASS_NULL\">SECCLASS_NULL</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#panic\">panic</a>(\"avc_add_callback() failed, error %d\\n\", <a class=\"id\" href=\"#ret\">ret</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#__initcall\">__initcall</a>(<a class=\"id\" href=\"#sel_netnode_init\">sel_netnode_init</a>);", 
];
xr_frag_insert('l/8b/9b468125d7ca214c67e6f465b652f594a190a0.xr', __xr_tmp);
