var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Implementation of the SID table type.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author : Stephen Smalley, &lt;sds@epoch.ncsc.mil&gt;</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#spinlock\">spinlock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"flask.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"security.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"sidtab.h\"", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#SIDTAB_HASH\">SIDTAB_HASH</a>(<a class=\"id\" href=\"#sid\">sid</a>) \\", 
"(<a class=\"id\" href=\"#sid\">sid</a> &amp; <a class=\"id\" href=\"#SIDTAB_HASH_MASK\">SIDTAB_HASH_MASK</a>)", 
"", 
"int <a class=\"id\" href=\"#sidtab_init\">sidtab_init</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*(<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>)) * <a class=\"id\" href=\"#SIDTAB_SIZE\">SIDTAB_SIZE</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#SIDTAB_SIZE\">SIDTAB_SIZE</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#nel\">nel</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#next_sid\">next_sid</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#shutdown\">shutdown</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#sidtab_insert\">sidtab_insert</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>, struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#context\">context</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#hvalue\">hvalue</a>, <a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sidtab_node\">sidtab_node</a> *<a class=\"id\" href=\"#prev\">prev</a>, *<a class=\"id\" href=\"#cur\">cur</a>, *<a class=\"id\" href=\"#newnode\">newnode</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#s\">s</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hvalue\">hvalue</a> = <a class=\"id\" href=\"#SIDTAB_HASH\">SIDTAB_HASH</a>(<a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#prev\">prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#hvalue\">hvalue</a>];", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#cur\">cur</a> && <a class=\"id\" href=\"#sid\">sid</a> &gt; <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prev\">prev</a> = <a class=\"id\" href=\"#cur\">cur</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cur\">cur</a> && <a class=\"id\" href=\"#sid\">sid</a> == <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newnode\">newnode</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#newnode\">newnode</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#newnode\">newnode</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#newnode\">newnode</a>-><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#context_cpy\">context_cpy</a>(&amp;<a class=\"id\" href=\"#newnode\">newnode</a>-><a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#context\">context</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#newnode\">newnode</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#prev\">prev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newnode\">newnode</a>-><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#prev\">prev</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wmb\">wmb</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prev\">prev</a>-><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#newnode\">newnode</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newnode\">newnode</a>-><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#hvalue\">hvalue</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wmb\">wmb</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#hvalue\">hvalue</a>] = <a class=\"id\" href=\"#newnode\">newnode</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#nel\">nel</a>++;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sid\">sid</a> >= <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#next_sid\">next_sid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#next_sid\">next_sid</a> = <a class=\"id\" href=\"#sid\">sid</a> + 1;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#sidtab_search_core\">sidtab_search_core</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>, int <a class=\"id\" href=\"#force\">force</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#hvalue\">hvalue</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sidtab_node\">sidtab_node</a> *<a class=\"id\" href=\"#cur\">cur</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#s\">s</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hvalue\">hvalue</a> = <a class=\"id\" href=\"#SIDTAB_HASH\">SIDTAB_HASH</a>(<a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#hvalue\">hvalue</a>];", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#cur\">cur</a> && <a class=\"id\" href=\"#sid\">sid</a> &gt; <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#force\">force</a> && <a class=\"id\" href=\"#cur\">cur</a> && <a class=\"id\" href=\"#sid\">sid</a> == <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a> && <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#context\">context</a>.<a class=\"id\" href=\"#len\">len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return &amp;<a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#context\">context</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cur\">cur</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || <a class=\"id\" href=\"#sid\">sid</a> != <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a> || <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#context\">context</a>.<a class=\"id\" href=\"#len\">len</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Remap invalid SIDs to the unlabeled SID. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#SECINITSID_UNLABELED\">SECINITSID_UNLABELED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hvalue\">hvalue</a> = <a class=\"id\" href=\"#SIDTAB_HASH\">SIDTAB_HASH</a>(<a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#hvalue\">hvalue</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cur\">cur</a> && <a class=\"id\" href=\"#sid\">sid</a> &gt; <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#cur\">cur</a> || <a class=\"id\" href=\"#sid\">sid</a> != <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return &amp;<a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#context\">context</a>;", 
"}", 
"", 
"struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#sidtab_search\">sidtab_search</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sidtab_search_core\">sidtab_search_core</a>(<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#sid\">sid</a>, 0);", 
"}", 
"", 
"struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#sidtab_search_force\">sidtab_search_force</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sidtab_search_core\">sidtab_search_core</a>(<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#sid\">sid</a>, 1);", 
"}", 
"", 
"int <a class=\"id\" href=\"#sidtab_map\">sidtab_map</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>,", 
"<span class=\"ts\"/>       int (*<a class=\"id\" href=\"#apply\">apply</a>) (<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#context\">context</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     void *<a class=\"id\" href=\"#args\">args</a>),", 
"<span class=\"ts\"/>       void *<a class=\"id\" href=\"#args\">args</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#rc\">rc</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sidtab_node\">sidtab_node</a> *<a class=\"id\" href=\"#cur\">cur</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#s\">s</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#SIDTAB_SIZE\">SIDTAB_SIZE</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cur\">cur</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#apply\">apply</a>(<a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a>, &amp;<a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#args\">args</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sidtab_search_context\">sidtab_search_context</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#context\">context</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sidtab_node\">sidtab_node</a> *<a class=\"id\" href=\"#cur\">cur</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#SIDTAB_SIZE\">SIDTAB_SIZE</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cur\">cur</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#context_cmp\">context_cmp</a>(&amp;<a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#context\">context</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#sidtab_context_to_sid\">sidtab_context_to_sid</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#context\">context</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#out_sid\">out_sid</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#out_sid\">out_sid</a> = <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#sidtab_search_context\">sidtab_search_context</a>(<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sid\">sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Rescan now that we hold the lock. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#sidtab_search_context\">sidtab_search_context</a>(<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sid\">sid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock_out\">unlock_out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* No SID exists for the context.  Allocate a new one. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#next_sid\">next_sid</a> == <a class=\"id\" href=\"#UINT_MAX\">UINT_MAX</a> || <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#shutdown\">shutdown</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock_out\">unlock_out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#next_sid\">next_sid</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#len\">len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>       \"SELinux:  Context %s is not valid (left unmapped).\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#str\">str</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#sidtab_insert\">sidtab_insert</a>(<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#next_sid\">next_sid</a>--;", 
"<a class=\"id\" href=\"#unlock_out\">unlock_out</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#lock\">lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#out_sid\">out_sid</a> = <a class=\"id\" href=\"#sid\">sid</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"void <a class=\"id\" href=\"#sidtab_hash_eval\">sidtab_hash_eval</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#h\">h</a>, char *<a class=\"id\" href=\"#tag\">tag</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#chain_len\">chain_len</a>, <a class=\"id\" href=\"#slots_used\">slots_used</a>, <a class=\"id\" href=\"#max_chain_len\">max_chain_len</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sidtab_node\">sidtab_node</a> *<a class=\"id\" href=\"#cur\">cur</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#slots_used\">slots_used</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#max_chain_len\">max_chain_len</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#SIDTAB_SIZE\">SIDTAB_SIZE</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#h\">h</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cur\">cur</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#slots_used\">slots_used</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#chain_len\">chain_len</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cur\">cur</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#chain_len\">chain_len</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#chain_len\">chain_len</a> &gt; <a class=\"id\" href=\"#max_chain_len\">max_chain_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#max_chain_len\">max_chain_len</a> = <a class=\"id\" href=\"#chain_len\">chain_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"%s:  %d entries and %d/%d buckets used, longest \"", 
"<span class=\"ts\"/>       \"chain length %d\\n\", <a class=\"id\" href=\"#tag\">tag</a>, <a class=\"id\" href=\"#h\">h</a>-><a class=\"id\" href=\"#nel\">nel</a>, <a class=\"id\" href=\"#slots_used\">slots_used</a>, <a class=\"id\" href=\"#SIDTAB_SIZE\">SIDTAB_SIZE</a>,", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#max_chain_len\">max_chain_len</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#sidtab_destroy\">sidtab_destroy</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sidtab_node\">sidtab_node</a> *<a class=\"id\" href=\"#cur\">cur</a>, *<a class=\"id\" href=\"#temp\">temp</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#s\">s</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#SIDTAB_SIZE\">SIDTAB_SIZE</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#cur\">cur</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#temp\">temp</a> = <a class=\"id\" href=\"#cur\">cur</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cur\">cur</a> = <a class=\"id\" href=\"#cur\">cur</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context_destroy\">context_destroy</a>(&amp;<a class=\"id\" href=\"#temp\">temp</a>-><a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#temp\">temp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#htable\">htable</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#nel\">nel</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#next_sid\">next_sid</a> = 1;", 
"}", 
"", 
"void <a class=\"id\" href=\"#sidtab_set\">sidtab_set</a>(struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#dst\">dst</a>, struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#src\">src</a>)", 
];
xr_frag_insert('l/90/93330d423b8c373d92b75cf307b2974ac7977e.xr', __xr_tmp);
