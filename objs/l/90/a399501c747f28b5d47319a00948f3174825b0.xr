var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_DOWN\">NETDEV_DOWN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> == <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__dev_remove_pack\">__dev_remove_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__sock_put\">__sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_err\">sk_err</a> = <a class=\"id\" href=\"#ENETDOWN\">ENETDOWN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#sock_flag\">sock_flag</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#SOCK_DEAD\">SOCK_DEAD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_report\">sk_error_report</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a> == <a class=\"id\" href=\"#NETDEV_UNREGISTER\">NETDEV_UNREGISTER</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> = -1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_UP\">NETDEV_UP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> == <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a> && !<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_add_pack\">dev_add_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_hold\">sock_hold</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"}", 
"", 
"", 
"static int <a class=\"id\" href=\"#packet_ioctl\">packet_ioctl</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, unsigned int <a class=\"id\" href=\"#cmd\">cmd</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCOUTQ\">SIOCOUTQ</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#amount\">amount</a> = <a class=\"id\" href=\"#sk_wmem_alloc_get\">sk_wmem_alloc_get</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#amount\">amount</a>, (int <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCINQ\">SIOCINQ</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#amount\">amount</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb_peek\">skb_peek</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#amount\">amount</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#amount\">amount</a>, (int <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGSTAMP\">SIOCGSTAMP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#sock_get_timestamp\">sock_get_timestamp</a>(<a class=\"id\" href=\"#sk\">sk</a>, (struct <a class=\"id\" href=\"#timeval\">timeval</a> <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGSTAMPNS\">SIOCGSTAMPNS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#sock_get_timestampns\">sock_get_timestampns</a>(<a class=\"id\" href=\"#sk\">sk</a>, (struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#arg\">arg</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_INET\">CONFIG_INET</a>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCADDRT\">SIOCADDRT</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCDELRT\">SIOCDELRT</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCDARP\">SIOCDARP</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGARP\">SIOCGARP</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSARP\">SIOCSARP</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGIFADDR\">SIOCGIFADDR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSIFADDR\">SIOCSIFADDR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGIFBRDADDR\">SIOCGIFBRDADDR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSIFBRDADDR\">SIOCSIFBRDADDR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGIFNETMASK\">SIOCGIFNETMASK</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSIFNETMASK\">SIOCSIFNETMASK</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCGIFDSTADDR\">SIOCGIFDSTADDR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSIFDSTADDR\">SIOCSIFDSTADDR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCSIFFLAGS\">SIOCSIFFLAGS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#inet_dgram_ops\">inet_dgram_ops</a>.<a class=\"id\" href=\"#ioctl\">ioctl</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#arg\">arg</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOIOCTLCMD\">ENOIOCTLCMD</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static unsigned int <a class=\"id\" href=\"#packet_poll\">packet_poll</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#poll_table\">poll_table</a> *<a class=\"id\" href=\"#wait\">wait</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#datagram_poll\">datagram_poll</a>(<a class=\"id\" href=\"#file\">file</a>, <a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#wait\">wait</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#packet_previous_frame\">packet_previous_frame</a>(<a class=\"id\" href=\"#po\">po</a>, &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>, <a class=\"id\" href=\"#TP_STATUS_KERNEL\">TP_STATUS_KERNEL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> |= <a class=\"id\" href=\"#POLLIN\">POLLIN</a> | <a class=\"id\" href=\"#POLLRDNORM\">POLLRDNORM</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_write_queue\">sk_write_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#packet_current_frame\">packet_current_frame</a>(<a class=\"id\" href=\"#po\">po</a>, &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>, <a class=\"id\" href=\"#TP_STATUS_AVAILABLE\">TP_STATUS_AVAILABLE</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> |= <a class=\"id\" href=\"#POLLOUT\">POLLOUT</a> | <a class=\"id\" href=\"#POLLWRNORM\">POLLWRNORM</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_write_queue\">sk_write_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#mask\">mask</a>;", 
"}", 
"", 
"", 
"<span class=\"comment\">/* Dirty? Well, I still did not learn better way to account</span>", 
"<span class=\"comment\"> * for user mmaps.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#packet_mm_open\">packet_mm_open</a>(struct <a class=\"id\" href=\"#vm_area_struct\">vm_area_struct</a> *<a class=\"id\" href=\"#vma\">vma</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a> = <a class=\"id\" href=\"#vma\">vma</a>-><a class=\"id\" href=\"#vm_file\">vm_file</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#file\">file</a>-><a class=\"id\" href=\"#private_data\">private_data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#mapped\">mapped</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#packet_mm_close\">packet_mm_close</a>(struct <a class=\"id\" href=\"#vm_area_struct\">vm_area_struct</a> *<a class=\"id\" href=\"#vma\">vma</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a> = <a class=\"id\" href=\"#vma\">vma</a>-><a class=\"id\" href=\"#vm_file\">vm_file</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#file\">file</a>-><a class=\"id\" href=\"#private_data\">private_data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_dec\">atomic_dec</a>(&amp;<a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#mapped\">mapped</a>);", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#vm_operations_struct\">vm_operations_struct</a> <a class=\"id\" href=\"#packet_mmap_ops\">packet_mmap_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#open\">open</a><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#packet_mm_open\">packet_mm_open</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#close\">close</a><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#packet_mm_close\">packet_mm_close</a>,", 
"};", 
"", 
"static void <a class=\"id\" href=\"#free_pg_vec\">free_pg_vec</a>(char **<a class=\"id\" href=\"#pg_vec\">pg_vec</a>, unsigned int <a class=\"id\" href=\"#order\">order</a>, unsigned int <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#len\">len</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#pg_vec\">pg_vec</a>[<a class=\"id\" href=\"#i\">i</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_pages\">free_pages</a>((unsigned long) <a class=\"id\" href=\"#pg_vec\">pg_vec</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#order\">order</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#pg_vec\">pg_vec</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> char *<a class=\"id\" href=\"#alloc_one_pg_vec_page\">alloc_one_pg_vec_page</a>(unsigned long <a class=\"id\" href=\"#order\">order</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#gfp_t\">gfp_t</a> <a class=\"id\" href=\"#gfp_flags\">gfp_flags</a> = <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a> | <a class=\"id\" href=\"#__GFP_COMP\">__GFP_COMP</a> | <a class=\"id\" href=\"#__GFP_ZERO\">__GFP_ZERO</a> | <a class=\"id\" href=\"#__GFP_NOWARN\">__GFP_NOWARN</a>;", 
"", 
"<span class=\"ts\"/>return (char *) <a class=\"id\" href=\"#__get_free_pages\">__get_free_pages</a>(<a class=\"id\" href=\"#gfp_flags\">gfp_flags</a>, <a class=\"id\" href=\"#order\">order</a>);", 
"}", 
"", 
"static char **<a class=\"id\" href=\"#alloc_pg_vec\">alloc_pg_vec</a>(struct <a class=\"id\" href=\"#tpacket_req\">tpacket_req</a> *<a class=\"id\" href=\"#req\">req</a>, int <a class=\"id\" href=\"#order\">order</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#block_nr\">block_nr</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_nr\">tp_block_nr</a>;", 
"<span class=\"ts\"/>char **<a class=\"id\" href=\"#pg_vec\">pg_vec</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pg_vec\">pg_vec</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(<a class=\"id\" href=\"#block_nr\">block_nr</a> * sizeof(char *), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#pg_vec\">pg_vec</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#block_nr\">block_nr</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pg_vec\">pg_vec</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#alloc_one_pg_vec_page\">alloc_one_pg_vec_page</a>(<a class=\"id\" href=\"#order\">order</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#pg_vec\">pg_vec</a>[<a class=\"id\" href=\"#i\">i</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free_pgvec\">out_free_pgvec</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#pg_vec\">pg_vec</a>;", 
"", 
"<a class=\"id\" href=\"#out_free_pgvec\">out_free_pgvec</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_pg_vec\">free_pg_vec</a>(<a class=\"id\" href=\"#pg_vec\">pg_vec</a>, <a class=\"id\" href=\"#order\">order</a>, <a class=\"id\" href=\"#block_nr\">block_nr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pg_vec\">pg_vec</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_set_ring\">packet_set_ring</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#tpacket_req\">tpacket_req</a> *<a class=\"id\" href=\"#req\">req</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#closing\">closing</a>, int <a class=\"id\" href=\"#tx_ring\">tx_ring</a>)", 
"{", 
"<span class=\"ts\"/>char **<a class=\"id\" href=\"#pg_vec\">pg_vec</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#was_running\">was_running</a>, <a class=\"id\" href=\"#order\">order</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_ring_buffer\">packet_ring_buffer</a> *<a class=\"id\" href=\"#rb\">rb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff_head\">sk_buff_head</a> *<a class=\"id\" href=\"#rb_queue\">rb_queue</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rb\">rb</a> = <a class=\"id\" href=\"#tx_ring\">tx_ring</a> ? &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a> : &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rb_queue\">rb_queue</a> = <a class=\"id\" href=\"#tx_ring\">tx_ring</a> ? &amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_write_queue\">sk_write_queue</a> : &amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#closing\">closing</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mapped\">mapped</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pending\">pending</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_nr\">tp_block_nr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Sanity tests and some calculations */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec\">pg_vec</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_version\">tp_version</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#TPACKET_V1\">TPACKET_V1</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_hdrlen\">tp_hdrlen</a> = <a class=\"id\" href=\"#TPACKET_HDRLEN\">TPACKET_HDRLEN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#TPACKET_V2\">TPACKET_V2</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_hdrlen\">tp_hdrlen</a> = <a class=\"id\" href=\"#TPACKET2_HDRLEN\">TPACKET2_HDRLEN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>((int)<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_size\">tp_block_size</a> <= 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_size\">tp_block_size</a> &amp; (<a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a> - 1)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_frame_size\">tp_frame_size</a> &lt; <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_hdrlen\">tp_hdrlen</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_reserve\">tp_reserve</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_frame_size\">tp_frame_size</a> &amp; (<a class=\"id\" href=\"#TPACKET_ALIGNMENT\">TPACKET_ALIGNMENT</a> - 1)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#frames_per_block\">frames_per_block</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_size\">tp_block_size</a>/<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_frame_size\">tp_frame_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#frames_per_block\">frames_per_block</a> <= 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>((<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#frames_per_block\">frames_per_block</a> * <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_nr\">tp_block_nr</a>) !=", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_frame_nr\">tp_frame_nr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#order\">order</a> = <a class=\"id\" href=\"#get_order\">get_order</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_size\">tp_block_size</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pg_vec\">pg_vec</a> = <a class=\"id\" href=\"#alloc_pg_vec\">alloc_pg_vec</a>(<a class=\"id\" href=\"#req\">req</a>, <a class=\"id\" href=\"#order\">order</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#pg_vec\">pg_vec</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"comment\">/* Done */</span>", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_frame_nr\">tp_frame_nr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#lock_sock\">lock_sock</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Detach socket from network */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#was_running\">was_running</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#num\">num</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#was_running\">was_running</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__dev_remove_pack\">__dev_remove_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__sock_put\">__sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#synchronize_net\">synchronize_net</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#pg_vec_lock\">pg_vec_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#closing\">closing</a> || <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mapped\">mapped</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#XC\">XC</a>(<a class=\"id\" href=\"#a\">a</a>, <a class=\"id\" href=\"#b\">b</a>) ({ <a class=\"id\" href=\"#__typeof__\">__typeof__</a> ((<a class=\"id\" href=\"#a\">a</a>)) <a class=\"id\" href=\"#__t\">__t</a>; <a class=\"id\" href=\"#__t\">__t</a> = (<a class=\"id\" href=\"#a\">a</a>); (<a class=\"id\" href=\"#a\">a</a>) = (<a class=\"id\" href=\"#b\">b</a>); <a class=\"id\" href=\"#__t\">__t</a>; })", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#rb_queue\">rb_queue</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pg_vec\">pg_vec</a> = <a class=\"id\" href=\"#XC\">XC</a>(<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec\">pg_vec</a>, <a class=\"id\" href=\"#pg_vec\">pg_vec</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#frame_max\">frame_max</a> = (<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_frame_nr\">tp_frame_nr</a> - 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#head\">head</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#frame_size\">frame_size</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_frame_size\">tp_frame_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#rb_queue\">rb_queue</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#order\">order</a> = <a class=\"id\" href=\"#XC\">XC</a>(<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec_order\">pg_vec_order</a>, <a class=\"id\" href=\"#order\">order</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_nr\">tp_block_nr</a> = <a class=\"id\" href=\"#XC\">XC</a>(<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec_len\">pg_vec_len</a>, <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_nr\">tp_block_nr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec_pages\">pg_vec_pages</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_size\">tp_block_size</a>/<a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#func\">func</a> = (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tpacket_rcv\">tpacket_rcv</a> : <a class=\"id\" href=\"#packet_rcv\">packet_rcv</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_queue_purge\">skb_queue_purge</a>(<a class=\"id\" href=\"#rb_queue\">rb_queue</a>);", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#XC\">XC</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mapped\">mapped</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pr_err\">pr_err</a>(\"packet_mmap: vma is busy: %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mapped\">mapped</a>));", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#pg_vec_lock\">pg_vec_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#was_running\">was_running</a> && !<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_hold\">sock_hold</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a> = <a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_add_pack\">dev_add_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#release_sock\">release_sock</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pg_vec\">pg_vec</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_pg_vec\">free_pg_vec</a>(<a class=\"id\" href=\"#pg_vec\">pg_vec</a>, <a class=\"id\" href=\"#order\">order</a>, <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#tp_block_nr\">tp_block_nr</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_mmap\">packet_mmap</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#vm_area_struct\">vm_area_struct</a> *<a class=\"id\" href=\"#vma\">vma</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#size\">size</a>, <a class=\"id\" href=\"#expected_size\">expected_size</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_ring_buffer\">packet_ring_buffer</a> *<a class=\"id\" href=\"#rb\">rb</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#start\">start</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vma\">vma</a>-><a class=\"id\" href=\"#vm_pgoff\">vm_pgoff</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#pg_vec_lock\">pg_vec_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#expected_size\">expected_size</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#rb\">rb</a> = &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>; <a class=\"id\" href=\"#rb\">rb</a> <= &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>; <a class=\"id\" href=\"#rb\">rb</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec\">pg_vec</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#expected_size\">expected_size</a> += <a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec_len\">pg_vec_len</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>* <a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec_pages\">pg_vec_pages</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>* <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#expected_size\">expected_size</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size\">size</a> = <a class=\"id\" href=\"#vma\">vma</a>-><a class=\"id\" href=\"#vm_end\">vm_end</a> - <a class=\"id\" href=\"#vma\">vma</a>-><a class=\"id\" href=\"#vm_start\">vm_start</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#size\">size</a> != <a class=\"id\" href=\"#expected_size\">expected_size</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = <a class=\"id\" href=\"#vma\">vma</a>-><a class=\"id\" href=\"#vm_start\">vm_start</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#rb\">rb</a> = &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>; <a class=\"id\" href=\"#rb\">rb</a> <= &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>; <a class=\"id\" href=\"#rb\">rb</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec\">pg_vec</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec_len\">pg_vec_len</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#page\">page</a> *<a class=\"id\" href=\"#page\">page</a> = <a class=\"id\" href=\"#virt_to_page\">virt_to_page</a>(<a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec\">pg_vec</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#pg_num\">pg_num</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#pg_num\">pg_num</a> = 0; <a class=\"id\" href=\"#pg_num\">pg_num</a> &lt; <a class=\"id\" href=\"#rb\">rb</a>-><a class=\"id\" href=\"#pg_vec_pages\">pg_vec_pages</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pg_num\">pg_num</a>++, <a class=\"id\" href=\"#page\">page</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#vm_insert_page\">vm_insert_page</a>(<a class=\"id\" href=\"#vma\">vma</a>, <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#page\">page</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#err\">err</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> += <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mapped\">mapped</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vma\">vma</a>-><a class=\"id\" href=\"#vm_ops\">vm_ops</a> = &amp;<a class=\"id\" href=\"#packet_mmap_ops\">packet_mmap_ops</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#pg_vec_lock\">pg_vec_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#proto_ops\">proto_ops</a> <a class=\"id\" href=\"#packet_ops_spkt\">packet_ops_spkt</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#family\">family</a> =<span class=\"ts\"/><a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a> =<span class=\"ts\"/><a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#release\">release</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_release\">packet_release</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#bind\">bind</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_bind_spkt\">packet_bind_spkt</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#connect\">connect</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_connect\">sock_no_connect</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#socketpair\">socketpair</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_socketpair\">sock_no_socketpair</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#accept\">accept</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_accept\">sock_no_accept</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#getname\">getname</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_getname_spkt\">packet_getname_spkt</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#poll\">poll</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#datagram_poll\">datagram_poll</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#ioctl\">ioctl</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_ioctl\">packet_ioctl</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#listen\">listen</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_listen\">sock_no_listen</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#shutdown\">shutdown</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_shutdown\">sock_no_shutdown</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#setsockopt\">setsockopt</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_setsockopt\">sock_no_setsockopt</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#getsockopt\">getsockopt</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_getsockopt\">sock_no_getsockopt</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#sendmsg\">sendmsg</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_sendmsg_spkt\">packet_sendmsg_spkt</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#recvmsg\">recvmsg</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_recvmsg\">packet_recvmsg</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#mmap\">mmap</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_no_mmap\">sock_no_mmap</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#sendpage\">sendpage</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_sendpage\">sock_no_sendpage</a>,", 
"};", 
"", 
"static const struct <a class=\"id\" href=\"#proto_ops\">proto_ops</a> <a class=\"id\" href=\"#packet_ops\">packet_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#family\">family</a> =<span class=\"ts\"/><a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a> =<span class=\"ts\"/><a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#release\">release</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_release\">packet_release</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#bind\">bind</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_bind\">packet_bind</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#connect\">connect</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_connect\">sock_no_connect</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#socketpair\">socketpair</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_socketpair\">sock_no_socketpair</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#accept\">accept</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_accept\">sock_no_accept</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#getname\">getname</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_getname\">packet_getname</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#poll\">poll</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_poll\">packet_poll</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#ioctl\">ioctl</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_ioctl\">packet_ioctl</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#listen\">listen</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_listen\">sock_no_listen</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#shutdown\">shutdown</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_shutdown\">sock_no_shutdown</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#setsockopt\">setsockopt</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_setsockopt\">packet_setsockopt</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#getsockopt\">getsockopt</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_getsockopt\">packet_getsockopt</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#sendmsg\">sendmsg</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_sendmsg\">packet_sendmsg</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#recvmsg\">recvmsg</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_recvmsg\">packet_recvmsg</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#mmap\">mmap</a> =<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_mmap\">packet_mmap</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#sendpage\">sendpage</a> =<span class=\"ts\"/><a class=\"id\" href=\"#sock_no_sendpage\">sock_no_sendpage</a>,", 
"};", 
"", 
"static const struct <a class=\"id\" href=\"#net_proto_family\">net_proto_family</a> <a class=\"id\" href=\"#packet_family_ops\">packet_family_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#family\">family</a> =<span class=\"ts\"/><a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#create\">create</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_create\">packet_create</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a><span class=\"ts\"/>=<span class=\"ts\"/><a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> <a class=\"id\" href=\"#packet_netdev_notifier\">packet_netdev_notifier</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#notifier_call\">notifier_call</a> =<span class=\"ts\"/><a class=\"id\" href=\"#packet_notifier\">packet_notifier</a>,", 
"};", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_PROC_FS\">CONFIG_PROC_FS</a>", 
"", 
"static void *<a class=\"id\" href=\"#packet_seq_start\">packet_seq_start</a>(struct <a class=\"id\" href=\"#seq_file\">seq_file</a> *<a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#loff_t\">loff_t</a> *<a class=\"id\" href=\"#pos\">pos</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__acquires\">__acquires</a>(<a class=\"id\" href=\"#RCU\">RCU</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#seq_file_net\">seq_file_net</a>(<a class=\"id\" href=\"#seq\">seq</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#seq_hlist_start_head_rcu\">seq_hlist_start_head_rcu</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist\">sklist</a>, *<a class=\"id\" href=\"#pos\">pos</a>);", 
"}", 
"", 
"static void *<a class=\"id\" href=\"#packet_seq_next\">packet_seq_next</a>(struct <a class=\"id\" href=\"#seq_file\">seq_file</a> *<a class=\"id\" href=\"#seq\">seq</a>, void *<a class=\"id\" href=\"#v\">v</a>, <a class=\"id\" href=\"#loff_t\">loff_t</a> *<a class=\"id\" href=\"#pos\">pos</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#seq_file_net\">seq_file_net</a>(<a class=\"id\" href=\"#seq\">seq</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#seq_hlist_next_rcu\">seq_hlist_next_rcu</a>(<a class=\"id\" href=\"#v\">v</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist\">sklist</a>, <a class=\"id\" href=\"#pos\">pos</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#packet_seq_stop\">packet_seq_stop</a>(struct <a class=\"id\" href=\"#seq_file\">seq_file</a> *<a class=\"id\" href=\"#seq\">seq</a>, void *<a class=\"id\" href=\"#v\">v</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__releases\">__releases</a>(<a class=\"id\" href=\"#RCU\">RCU</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_seq_show\">packet_seq_show</a>(struct <a class=\"id\" href=\"#seq_file\">seq_file</a> *<a class=\"id\" href=\"#seq\">seq</a>, void *<a class=\"id\" href=\"#v\">v</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#v\">v</a> == <a class=\"id\" href=\"#SEQ_START_TOKEN\">SEQ_START_TOKEN</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_puts\">seq_puts</a>(<a class=\"id\" href=\"#seq\">seq</a>, \"sk       RefCnt Type Proto  Iface R Rmem   User   Inode\\n\");", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#s\">s</a> = <a class=\"id\" href=\"#sk_entry\">sk_entry</a>(<a class=\"id\" href=\"#v\">v</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#s\">s</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_printf\">seq_printf</a>(<a class=\"id\" href=\"#seq\">seq</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   \"%p %-6d %-4d %04x   %-5d %1d %-6u %-6u %-6lu\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#s\">s</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#sk_refcnt\">sk_refcnt</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#sk_type\">sk_type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#sk_rmem_alloc\">sk_rmem_alloc</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#sock_i_uid\">sock_i_uid</a>(<a class=\"id\" href=\"#s\">s</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#sock_i_ino\">sock_i_ino</a>(<a class=\"id\" href=\"#s\">s</a>));", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#seq_operations\">seq_operations</a> <a class=\"id\" href=\"#packet_seq_ops\">packet_seq_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#start\">start</a><span class=\"ts\"/>= <a class=\"id\" href=\"#packet_seq_start\">packet_seq_start</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#next\">next</a><span class=\"ts\"/>= <a class=\"id\" href=\"#packet_seq_next\">packet_seq_next</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#stop\">stop</a><span class=\"ts\"/>= <a class=\"id\" href=\"#packet_seq_stop\">packet_seq_stop</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#show\">show</a><span class=\"ts\"/>= <a class=\"id\" href=\"#packet_seq_show\">packet_seq_show</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#packet_seq_open\">packet_seq_open</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>, struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#seq_open_net\">seq_open_net</a>(<a class=\"id\" href=\"#inode\">inode</a>, <a class=\"id\" href=\"#file\">file</a>, &amp;<a class=\"id\" href=\"#packet_seq_ops\">packet_seq_ops</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    sizeof(struct <a class=\"id\" href=\"#seq_net_private\">seq_net_private</a>));", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#file_operations\">file_operations</a> <a class=\"id\" href=\"#packet_seq_fops\">packet_seq_fops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#open\">open</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#packet_seq_open\">packet_seq_open</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#read\">read</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#seq_read\">seq_read</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#llseek\">llseek</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#seq_lseek\">seq_lseek</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#release\">release</a><span class=\"ts\"/>= <a class=\"id\" href=\"#seq_release_net\">seq_release_net</a>,", 
"};", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#packet_net_init\">packet_net_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist_lock\">sklist_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_HEAD\">INIT_HLIST_HEAD</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist\">sklist</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#proc_net_fops_create\">proc_net_fops_create</a>(<a class=\"id\" href=\"#net\">net</a>, \"packet\", 0, &amp;<a class=\"id\" href=\"#packet_seq_fops\">packet_seq_fops</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__net_exit\">__net_exit</a> <a class=\"id\" href=\"#packet_net_exit\">packet_net_exit</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#proc_net_remove\">proc_net_remove</a>(<a class=\"id\" href=\"#net\">net</a>, \"packet\");", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#pernet_operations\">pernet_operations</a> <a class=\"id\" href=\"#packet_net_ops\">packet_net_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#init\">init</a> = <a class=\"id\" href=\"#packet_net_init\">packet_net_init</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#exit\">exit</a> = <a class=\"id\" href=\"#packet_net_exit\">packet_net_exit</a>,", 
"};", 
"", 
"", 
"static void <a class=\"id\" href=\"#__exit\">__exit</a> <a class=\"id\" href=\"#packet_exit\">packet_exit</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unregister_netdevice_notifier\">unregister_netdevice_notifier</a>(&amp;<a class=\"id\" href=\"#packet_netdev_notifier\">packet_netdev_notifier</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#unregister_pernet_subsys\">unregister_pernet_subsys</a>(&amp;<a class=\"id\" href=\"#packet_net_ops\">packet_net_ops</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_unregister\">sock_unregister</a>(<a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#proto_unregister\">proto_unregister</a>(&amp;<a class=\"id\" href=\"#packet_proto\">packet_proto</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#packet_init\">packet_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#proto_register\">proto_register</a>(&amp;<a class=\"id\" href=\"#packet_proto\">packet_proto</a>, 0);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_register\">sock_register</a>(&amp;<a class=\"id\" href=\"#packet_family_ops\">packet_family_ops</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#register_pernet_subsys\">register_pernet_subsys</a>(&amp;<a class=\"id\" href=\"#packet_net_ops\">packet_net_ops</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#register_netdevice_notifier\">register_netdevice_notifier</a>(&amp;<a class=\"id\" href=\"#packet_netdev_notifier\">packet_netdev_notifier</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"<a class=\"id\" href=\"#module_init\">module_init</a>(<a class=\"id\" href=\"#packet_init\">packet_init</a>);", 
"<a class=\"id\" href=\"#module_exit\">module_exit</a>(<a class=\"id\" href=\"#packet_exit\">packet_exit</a>);", 
"<a class=\"id\" href=\"#MODULE_LICENSE\">MODULE_LICENSE</a>(\"GPL\");", 
"<a class=\"id\" href=\"#MODULE_ALIAS_NETPROTO\">MODULE_ALIAS_NETPROTO</a>(<a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>);", 
];
xr_frag_insert('l/90/a399501c747f28b5d47319a00948f3174825b0.xr', __xr_tmp);
