var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#audit_make_reply\">audit_make_reply</a>(<a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#AUDIT_LIST_RULES\">AUDIT_LIST_RULES</a>, 1, 1, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_queue_tail\">skb_queue_tail</a>(<a class=\"id\" href=\"#q\">q</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Log rule additions and removals */</span>", 
"static void <a class=\"id\" href=\"#audit_log_rule_change\">audit_log_rule_change</a>(<a class=\"id\" href=\"#uid_t\">uid_t</a> <a class=\"id\" href=\"#loginuid\">loginuid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  char *<a class=\"id\" href=\"#action\">action</a>, struct <a class=\"id\" href=\"#audit_krule\">audit_krule</a> *<a class=\"id\" href=\"#rule\">rule</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  int <a class=\"id\" href=\"#res\">res</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#ab\">ab</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#audit_enabled\">audit_enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ab\">ab</a> = <a class=\"id\" href=\"#audit_log_start\">audit_log_start</a>(<a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>, <a class=\"id\" href=\"#AUDIT_CONFIG_CHANGE\">AUDIT_CONFIG_CHANGE</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ab\">ab</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \"auid=%u ses=%u\", <a class=\"id\" href=\"#loginuid\">loginuid</a>, <a class=\"id\" href=\"#sessionid\">sessionid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sid\">sid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>char *<a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#security_secid_to_secctx\">security_secid_to_secctx</a>(<a class=\"id\" href=\"#sid\">sid</a>, &amp;<a class=\"id\" href=\"#ctx\">ctx</a>, &amp;<a class=\"id\" href=\"#len\">len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" ssid=%u\", <a class=\"id\" href=\"#sid\">sid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" subj=%s\", <a class=\"id\" href=\"#ctx\">ctx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_release_secctx\">security_release_secctx</a>(<a class=\"id\" href=\"#ctx\">ctx</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" op=\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_string\">audit_log_string</a>(<a class=\"id\" href=\"#ab\">ab</a>, <a class=\"id\" href=\"#action\">action</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_key\">audit_log_key</a>(<a class=\"id\" href=\"#ab\">ab</a>, <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#filterkey\">filterkey</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#ab\">ab</a>, \" list=%d res=%d\", <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#listnr\">listnr</a>, <a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#ab\">ab</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * audit_receive_filter - apply all rules to the specified message type</span>", 
"<span class=\"comment\"> * @type: audit message type</span>", 
"<span class=\"comment\"> * @pid: target pid for netlink audit messages</span>", 
"<span class=\"comment\"> * @uid: target uid for netlink audit messages</span>", 
"<span class=\"comment\"> * @seq: netlink audit message sequence (serial) number</span>", 
"<span class=\"comment\"> * @data: payload data</span>", 
"<span class=\"comment\"> * @datasz: size of payload data</span>", 
"<span class=\"comment\"> * @loginuid: loginuid of sender</span>", 
"<span class=\"comment\"> * @sessionid: sessionid for netlink audit message</span>", 
"<span class=\"comment\"> * @sid: SE Linux Security ID of sender</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#audit_receive_filter\">audit_receive_filter</a>(int <a class=\"id\" href=\"#type\">type</a>, int <a class=\"id\" href=\"#pid\">pid</a>, int <a class=\"id\" href=\"#uid\">uid</a>, int <a class=\"id\" href=\"#seq\">seq</a>, void *<a class=\"id\" href=\"#data\">data</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#datasz\">datasz</a>, <a class=\"id\" href=\"#uid_t\">uid_t</a> <a class=\"id\" href=\"#loginuid\">loginuid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_netlink_list\">audit_netlink_list</a> *<a class=\"id\" href=\"#dest\">dest</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_entry\">audit_entry</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_LIST\">AUDIT_LIST</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_LIST_RULES\">AUDIT_LIST_RULES</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* We can't just spew out the rules here because we might fill</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * the available socket buffer space and deadlock waiting for</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * auditctl to read from it... which isn't ever going to</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * happen if we're actually running in the context of auditctl</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * trying to _send_ the stuff */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dest\">dest</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(struct <a class=\"id\" href=\"#audit_netlink_list\">audit_netlink_list</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dest\">dest</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dest\">dest</a>-><a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_queue_head_init\">skb_queue_head_init</a>(&amp;<a class=\"id\" href=\"#dest\">dest</a>-><a class=\"id\" href=\"#q\">q</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#audit_filter_mutex\">audit_filter_mutex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#AUDIT_LIST\">AUDIT_LIST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_list\">audit_list</a>(<a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>, &amp;<a class=\"id\" href=\"#dest\">dest</a>-><a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_list_rules\">audit_list_rules</a>(<a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#seq\">seq</a>, &amp;<a class=\"id\" href=\"#dest\">dest</a>-><a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#audit_filter_mutex\">audit_filter_mutex</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#kthread_run\">kthread_run</a>(<a class=\"id\" href=\"#audit_send_list\">audit_send_list</a>, <a class=\"id\" href=\"#dest\">dest</a>, \"audit_send_list\");", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#tsk\">tsk</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_queue_purge\">skb_queue_purge</a>(&amp;<a class=\"id\" href=\"#dest\">dest</a>-><a class=\"id\" href=\"#q\">q</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#dest\">dest</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_ADD\">AUDIT_ADD</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_ADD_RULE\">AUDIT_ADD_RULE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#AUDIT_ADD\">AUDIT_ADD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#audit_rule_to_entry\">audit_rule_to_entry</a>(<a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#audit_data_to_entry\">audit_data_to_entry</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#datasz\">datasz</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#entry\">entry</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#audit_add_rule\">audit_add_rule</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_rule_change\">audit_log_rule_change</a>(<a class=\"id\" href=\"#loginuid\">loginuid</a>, <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#sid\">sid</a>, \"add rule\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#rule\">rule</a>, !<a class=\"id\" href=\"#err\">err</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_free_rule\">audit_free_rule</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_DEL\">AUDIT_DEL</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_DEL_RULE\">AUDIT_DEL_RULE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#AUDIT_DEL\">AUDIT_DEL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#audit_rule_to_entry\">audit_rule_to_entry</a>(<a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#audit_data_to_entry\">audit_data_to_entry</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#datasz\">datasz</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#entry\">entry</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#audit_del_rule\">audit_del_rule</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_rule_change\">audit_log_rule_change</a>(<a class=\"id\" href=\"#loginuid\">loginuid</a>, <a class=\"id\" href=\"#sessionid\">sessionid</a>, <a class=\"id\" href=\"#sid\">sid</a>, \"remove rule\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#rule\">rule</a>, !<a class=\"id\" href=\"#err\">err</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_free_rule\">audit_free_rule</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#audit_comparator\">audit_comparator</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#left\">left</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#op\">op</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#right\">right</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#op\">op</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_equal\">Audit_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#left\">left</a> == <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_not_equal\">Audit_not_equal</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#left\">left</a> != <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_lt\">Audit_lt</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#left\">left</a> &lt; <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_le\">Audit_le</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#left\">left</a> <= <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_gt\">Audit_gt</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#left\">left</a> &gt; <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_ge\">Audit_ge</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#left\">left</a> >= <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_bitmask\">Audit_bitmask</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#left\">left</a> &amp; <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#Audit_bittest\">Audit_bittest</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return ((<a class=\"id\" href=\"#left\">left</a> &amp; <a class=\"id\" href=\"#right\">right</a>) == <a class=\"id\" href=\"#right\">right</a>);", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/* Compare given dentry name with last component in given path,</span>", 
"<span class=\"comment\"> * return of 0 indicates a match. */</span>", 
"int <a class=\"id\" href=\"#audit_compare_dname_path\">audit_compare_dname_path</a>(const char *<a class=\"id\" href=\"#dname\">dname</a>, const char *<a class=\"id\" href=\"#path\">path</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     int *<a class=\"id\" href=\"#dirlen\">dirlen</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#dlen\">dlen</a>, <a class=\"id\" href=\"#plen\">plen</a>;", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#p\">p</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dname\">dname</a> || !<a class=\"id\" href=\"#path\">path</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dlen\">dlen</a> = <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#dname\">dname</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#plen\">plen</a> = <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#path\">path</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#plen\">plen</a> &lt; <a class=\"id\" href=\"#dlen\">dlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* disregard trailing slashes */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#path\">path</a> + <a class=\"id\" href=\"#plen\">plen</a> - 1;", 
"<span class=\"ts\"/>while ((*<a class=\"id\" href=\"#p\">p</a> == '/') && (<a class=\"id\" href=\"#p\">p</a> &gt; <a class=\"id\" href=\"#path\">path</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a>--;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* find last path component */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#p\">p</a> - <a class=\"id\" href=\"#dlen\">dlen</a> + 1;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#p\">p</a> &lt; <a class=\"id\" href=\"#path\">path</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#p\">p</a> &gt; <a class=\"id\" href=\"#path\">path</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (*--<a class=\"id\" href=\"#p\">p</a> != '/')", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a>++;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* return length of path's directory component */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dirlen\">dirlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#dirlen\">dirlen</a> = <a class=\"id\" href=\"#p\">p</a> - <a class=\"id\" href=\"#path\">path</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#strncmp\">strncmp</a>(<a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#dname\">dname</a>, <a class=\"id\" href=\"#dlen\">dlen</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#audit_filter_user_rules\">audit_filter_user_rules</a>(struct <a class=\"id\" href=\"#netlink_skb_parms\">netlink_skb_parms</a> *<a class=\"id\" href=\"#cb\">cb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#audit_krule\">audit_krule</a> *<a class=\"id\" href=\"#rule\">rule</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   enum <a class=\"id\" href=\"#audit_state\">audit_state</a> *<a class=\"id\" href=\"#state\">state</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#field_count\">field_count</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_field\">audit_field</a> *<a class=\"id\" href=\"#f\">f</a> = &amp;<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#fields\">fields</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#result\">result</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_PID\">AUDIT_PID</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#audit_comparator\">audit_comparator</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#op\">op</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_UID\">AUDIT_UID</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#audit_comparator\">audit_comparator</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#uid\">uid</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#op\">op</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_GID\">AUDIT_GID</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#audit_comparator\">audit_comparator</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#gid\">gid</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#op\">op</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_LOGINUID\">AUDIT_LOGINUID</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#audit_comparator\">audit_comparator</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#loginuid\">loginuid</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#op\">op</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#result\">result</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#action\">action</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_NEVER\">AUDIT_NEVER</a>:    *<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#AUDIT_DISABLED\">AUDIT_DISABLED</a>;<span class=\"ts\"/>    break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#AUDIT_ALWAYS\">AUDIT_ALWAYS</a>:   *<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#AUDIT_RECORD_CONTEXT\">AUDIT_RECORD_CONTEXT</a>; break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"int <a class=\"id\" href=\"#audit_filter_user\">audit_filter_user</a>(struct <a class=\"id\" href=\"#netlink_skb_parms\">netlink_skb_parms</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>enum <a class=\"id\" href=\"#audit_state\">audit_state</a> <a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#AUDIT_DISABLED\">AUDIT_DISABLED</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_entry\">audit_entry</a> *<a class=\"id\" href=\"#e\">e</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = 1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#e\">e</a>, &amp;<a class=\"id\" href=\"#audit_filter_list\">audit_filter_list</a>[<a class=\"id\" href=\"#AUDIT_FILTER_USER\">AUDIT_FILTER_USER</a>], <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_filter_user_rules\">audit_filter_user_rules</a>(<a class=\"id\" href=\"#cb\">cb</a>, &amp;<a class=\"id\" href=\"#e\">e</a>-><a class=\"id\" href=\"#rule\">rule</a>, &amp;<a class=\"id\" href=\"#state\">state</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#AUDIT_DISABLED\">AUDIT_DISABLED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>; <span class=\"comment\">/* Audit by default */</span>", 
"}", 
"", 
"int <a class=\"id\" href=\"#audit_filter_type\">audit_filter_type</a>(int <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_entry\">audit_entry</a> *<a class=\"id\" href=\"#e\">e</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#result\">result</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#audit_filter_list\">audit_filter_list</a>[<a class=\"id\" href=\"#AUDIT_FILTER_TYPE\">AUDIT_FILTER_TYPE</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock_and_return\">unlock_and_return</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#e\">e</a>, &amp;<a class=\"id\" href=\"#audit_filter_list\">audit_filter_list</a>[<a class=\"id\" href=\"#AUDIT_FILTER_TYPE\">AUDIT_FILTER_TYPE</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#e\">e</a>-><a class=\"id\" href=\"#rule\">rule</a>.<a class=\"id\" href=\"#field_count\">field_count</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_field\">audit_field</a> *<a class=\"id\" href=\"#f\">f</a> = &amp;<a class=\"id\" href=\"#e\">e</a>-><a class=\"id\" href=\"#rule\">rule</a>.<a class=\"id\" href=\"#fields\">fields</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#AUDIT_MSGTYPE\">AUDIT_MSGTYPE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#audit_comparator\">audit_comparator</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#op\">op</a>, <a class=\"id\" href=\"#f\">f</a>-><a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#result\">result</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
];
xr_frag_insert('l/90/ae00b32e4e90c1100cb74529cc5dd68b95dab1.xr', __xr_tmp);
