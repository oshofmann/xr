var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *  Syncookies implementation for the Linux kernel</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  Copyright (C) 1997 Andi Kleen</span>", 
"<span class=\"comment\"> *  Based on ideas by D.J.Bernstein and Eric Schenk.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>This program is free software; you can redistribute it and/or</span>", 
"<span class=\"comment\"> *      modify it under the terms of the GNU General Public License</span>", 
"<span class=\"comment\"> *      as published by the Free Software Foundation; either version</span>", 
"<span class=\"comment\"> *      2 of the License, or (at your option) any later version.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#tcp\">tcp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#random\">random</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#cryptohash\">cryptohash</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#tcp\">tcp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#route\">route</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"<span class=\"comment\">/* Timestamps: lowest bits store TCP options */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TSBITS\">TSBITS</a> 6", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TSMASK\">TSMASK</a> (((<a class=\"id\" href=\"#__u32\">__u32</a>)1 << <a class=\"id\" href=\"#TSBITS\">TSBITS</a>) - 1)", 
"", 
"extern int <a class=\"id\" href=\"#sysctl_tcp_syncookies\">sysctl_tcp_syncookies</a>;", 
"", 
"<a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#syncookie_secret\">syncookie_secret</a>[2][16-4+<a class=\"id\" href=\"#SHA_DIGEST_WORDS\">SHA_DIGEST_WORDS</a>];", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#syncookie_secret\">syncookie_secret</a>);", 
"", 
"static <a class=\"id\" href=\"#__init\">__init</a> int <a class=\"id\" href=\"#init_syncookies\">init_syncookies</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#get_random_bytes\">get_random_bytes</a>(<a class=\"id\" href=\"#syncookie_secret\">syncookie_secret</a>, sizeof(<a class=\"id\" href=\"#syncookie_secret\">syncookie_secret</a>));", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#__initcall\">__initcall</a>(<a class=\"id\" href=\"#init_syncookies\">init_syncookies</a>);", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#COOKIEBITS\">COOKIEBITS</a> 24<span class=\"ts\"/><span class=\"comment\">/* Upper bits store count */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#COOKIEMASK\">COOKIEMASK</a> (((<a class=\"id\" href=\"#__u32\">__u32</a>)1 << <a class=\"id\" href=\"#COOKIEBITS\">COOKIEBITS</a>) - 1)", 
"", 
"static <a class=\"id\" href=\"#DEFINE_PER_CPU\">DEFINE_PER_CPU</a>(<a class=\"id\" href=\"#__u32\">__u32</a> [16 + 5 + <a class=\"id\" href=\"#SHA_WORKSPACE_WORDS\">SHA_WORKSPACE_WORDS</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#ipv4_cookie_scratch\">ipv4_cookie_scratch</a>);", 
"", 
"static <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cookie_hash\">cookie_hash</a>(<a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#sport\">sport</a>, <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#dport\">dport</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#count\">count</a>, int <a class=\"id\" href=\"#c\">c</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__u32\">__u32</a> *<a class=\"id\" href=\"#tmp\">tmp</a> = <a class=\"id\" href=\"#__get_cpu_var\">__get_cpu_var</a>(<a class=\"id\" href=\"#ipv4_cookie_scratch\">ipv4_cookie_scratch</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#tmp\">tmp</a> + 4, <a class=\"id\" href=\"#syncookie_secret\">syncookie_secret</a>[<a class=\"id\" href=\"#c\">c</a>], sizeof(<a class=\"id\" href=\"#syncookie_secret\">syncookie_secret</a>[<a class=\"id\" href=\"#c\">c</a>]));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a>[0] = (<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a>[1] = (<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a>[2] = ((<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#sport\">sport</a> << 16) + (<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#u32\">u32</a>)<a class=\"id\" href=\"#dport\">dport</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a>[3] = <a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sha_transform\">sha_transform</a>(<a class=\"id\" href=\"#tmp\">tmp</a> + 16, (<a class=\"id\" href=\"#__u8\">__u8</a> *)<a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#tmp\">tmp</a> + 16 + 5);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tmp\">tmp</a>[17];", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * when syncookies are in effect and tcp timestamps are enabled we encode</span>", 
"<span class=\"comment\"> * tcp options in the lower bits of the timestamp value that will be</span>", 
"<span class=\"comment\"> * sent in the syn-ack.</span>", 
"<span class=\"comment\"> * Since subsequent timestamps use the normal tcp_time_stamp value, we</span>", 
"<span class=\"comment\"> * must make sure that the resulting initial timestamp is &lt;= tcp_time_stamp.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#cookie_init_timestamp\">cookie_init_timestamp</a>(struct <a class=\"id\" href=\"#request_sock\">request_sock</a> *<a class=\"id\" href=\"#req\">req</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_request_sock\">inet_request_sock</a> *<a class=\"id\" href=\"#ireq\">ireq</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#ts\">ts</a>, <a class=\"id\" href=\"#ts_now\">ts_now</a> = <a class=\"id\" href=\"#tcp_time_stamp\">tcp_time_stamp</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#options\">options</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a> = <a class=\"id\" href=\"#inet_rsk\">inet_rsk</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#options\">options</a> = <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#wscale_ok\">wscale_ok</a> ? <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#snd_wscale\">snd_wscale</a> : 0xf;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#options\">options</a> |= <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#sack_ok\">sack_ok</a> << 4;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#options\">options</a> |= <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#ecn_ok\">ecn_ok</a> << 5;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#ts_now\">ts_now</a> &amp; ~<a class=\"id\" href=\"#TSMASK\">TSMASK</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> |= <a class=\"id\" href=\"#options\">options</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ts\">ts</a> &gt; <a class=\"id\" href=\"#ts_now\">ts_now</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> >>= <a class=\"id\" href=\"#TSBITS\">TSBITS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> <<= <a class=\"id\" href=\"#TSBITS\">TSBITS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> |= <a class=\"id\" href=\"#options\">options</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ts\">ts</a>;", 
"}", 
"", 
"", 
"static <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#secure_tcp_syn_cookie\">secure_tcp_syn_cookie</a>(<a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#sport\">sport</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#dport\">dport</a>, <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#sseq\">sseq</a>, <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#count\">count</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Compute the secure sequence number.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * The output should be:</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *   HASH(sec1,saddr,sport,daddr,dport,sec1) + sseq + (count * 2^24)</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *      + (HASH(sec2,saddr,sport,daddr,dport,count,sec2) % 2^24).</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Where sseq is their sequence number and count increases every</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * minute by 1.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * As an extra hack, we add a small \"data\" value that encodes the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * MSS into the second hash value.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#cookie_hash\">cookie_hash</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#sport\">sport</a>, <a class=\"id\" href=\"#dport\">dport</a>, 0, 0) +", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sseq\">sseq</a> + (<a class=\"id\" href=\"#count\">count</a> << <a class=\"id\" href=\"#COOKIEBITS\">COOKIEBITS</a>) +", 
"<span class=\"ts\"/><span class=\"ts\"/>((<a class=\"id\" href=\"#cookie_hash\">cookie_hash</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#sport\">sport</a>, <a class=\"id\" href=\"#dport\">dport</a>, <a class=\"id\" href=\"#count\">count</a>, 1) + <a class=\"id\" href=\"#data\">data</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/> &amp; <a class=\"id\" href=\"#COOKIEMASK\">COOKIEMASK</a>));", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * This retrieves the small \"data\" value from the syncookie.</span>", 
"<span class=\"comment\"> * If the syncookie is bad, the data returned will be out of</span>", 
"<span class=\"comment\"> * range.  This must be checked by the caller.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * The count value used to generate the cookie must be within</span>", 
"<span class=\"comment\"> * \"maxdiff\" if the current (passed-in) \"count\".  The return value</span>", 
"<span class=\"comment\"> * is (__u32)-1 if this test fails.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#check_tcp_syn_cookie\">check_tcp_syn_cookie</a>(<a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#cookie\">cookie</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#sport\">sport</a>, <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#dport\">dport</a>, <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#sseq\">sseq</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#count\">count</a>, <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#maxdiff\">maxdiff</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#diff\">diff</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Strip away the layers from the cookie */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cookie\">cookie</a> -= <a class=\"id\" href=\"#cookie_hash\">cookie_hash</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#sport\">sport</a>, <a class=\"id\" href=\"#dport\">dport</a>, 0, 0) + <a class=\"id\" href=\"#sseq\">sseq</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Cookie is now reduced to (count * 2^24) ^ (hash % 2^24) */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#diff\">diff</a> = (<a class=\"id\" href=\"#count\">count</a> - (<a class=\"id\" href=\"#cookie\">cookie</a> >> <a class=\"id\" href=\"#COOKIEBITS\">COOKIEBITS</a>)) &amp; ((<a class=\"id\" href=\"#__u32\">__u32</a>) - 1 >> <a class=\"id\" href=\"#COOKIEBITS\">COOKIEBITS</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#diff\">diff</a> >= <a class=\"id\" href=\"#maxdiff\">maxdiff</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#__u32\">__u32</a>)-1;", 
"", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#cookie\">cookie</a> -", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cookie_hash\">cookie_hash</a>(<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#sport\">sport</a>, <a class=\"id\" href=\"#dport\">dport</a>, <a class=\"id\" href=\"#count\">count</a> - <a class=\"id\" href=\"#diff\">diff</a>, 1))", 
"<span class=\"ts\"/><span class=\"ts\"/>&amp; <a class=\"id\" href=\"#COOKIEMASK\">COOKIEMASK</a>;<span class=\"ts\"/><span class=\"comment\">/* Leaving the data behind */</span>", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * MSS Values are taken from the 2009 paper</span>", 
"<span class=\"comment\"> * 'Measuring TCP Maximum Segment Size' by S. Alcock and R. Nelson:</span>", 
"<span class=\"comment\"> *  - values 1440 to 1460 accounted for 80% of observed mss values</span>", 
"<span class=\"comment\"> *  - values outside the 536-1460 range are rare (&lt;0.2%).</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Table must be sorted.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#__u16\">__u16</a> const <a class=\"id\" href=\"#msstab\">msstab</a>[] = {", 
"<span class=\"ts\"/>64,", 
"<span class=\"ts\"/>512,", 
"<span class=\"ts\"/>536,", 
"<span class=\"ts\"/>1024,", 
"<span class=\"ts\"/>1440,", 
"<span class=\"ts\"/>1460,", 
"<span class=\"ts\"/>4312,", 
"<span class=\"ts\"/>8960,", 
"};", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Generate a syncookie.  mssp points to the mss, which is returned</span>", 
"<span class=\"comment\"> * rounded down to the value encoded in the cookie.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#cookie_v4_init_sequence\">cookie_v4_init_sequence</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__u16\">__u16</a> *<a class=\"id\" href=\"#mssp\">mssp</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph\">iph</a> = <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tcphdr\">tcphdr</a> *<a class=\"id\" href=\"#th\">th</a> = <a class=\"id\" href=\"#tcp_hdr\">tcp_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#mssind\">mssind</a>;", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#__u16\">__u16</a> <a class=\"id\" href=\"#mss\">mss</a> = *<a class=\"id\" href=\"#mssp\">mssp</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tcp_synq_overflow\">tcp_synq_overflow</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#mssind\">mssind</a> = <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#msstab\">msstab</a>) - 1; <a class=\"id\" href=\"#mssind\">mssind</a> ; <a class=\"id\" href=\"#mssind\">mssind</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mss\">mss</a> >= <a class=\"id\" href=\"#msstab\">msstab</a>[<a class=\"id\" href=\"#mssind\">mssind</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#mssp\">mssp</a> = <a class=\"id\" href=\"#msstab\">msstab</a>[<a class=\"id\" href=\"#mssind\">mssind</a>];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NET_INC_STATS_BH\">NET_INC_STATS_BH</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#LINUX_MIB_SYNCOOKIESSENT\">LINUX_MIB_SYNCOOKIESSENT</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#secure_tcp_syn_cookie\">secure_tcp_syn_cookie</a>(<a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#source\">source</a>, <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#dest\">dest</a>, <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#seq\">seq</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#jiffies\">jiffies</a> / (<a class=\"id\" href=\"#HZ\">HZ</a> * 60), <a class=\"id\" href=\"#mssind\">mssind</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * This (misnamed) value is the age of syncookie which is permitted.</span>", 
"<span class=\"comment\"> * Its ideal value should be dependent on TCP_TIMEOUT_INIT and</span>", 
"<span class=\"comment\"> * sysctl_tcp_retries1. It's a rather complicated formula (exponential</span>", 
"<span class=\"comment\"> * backoff) to compute at runtime so it's currently hardcoded here.</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#COUNTER_TRIES\">COUNTER_TRIES</a> 4", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Check if a ack sequence number is a valid syncookie.</span>", 
"<span class=\"comment\"> * Return the decoded mss if it is, or 0 if not.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#cookie_check\">cookie_check</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#cookie\">cookie</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph\">iph</a> = <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tcphdr\">tcphdr</a> *<a class=\"id\" href=\"#th\">th</a> = <a class=\"id\" href=\"#tcp_hdr\">tcp_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#seq\">seq</a>) - 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#mssind\">mssind</a> = <a class=\"id\" href=\"#check_tcp_syn_cookie\">check_tcp_syn_cookie</a>(<a class=\"id\" href=\"#cookie\">cookie</a>, <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#source\">source</a>, <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#dest\">dest</a>, <a class=\"id\" href=\"#seq\">seq</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#jiffies\">jiffies</a> / (<a class=\"id\" href=\"#HZ\">HZ</a> * 60),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#COUNTER_TRIES\">COUNTER_TRIES</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#mssind\">mssind</a> &lt; <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#msstab\">msstab</a>) ? <a class=\"id\" href=\"#msstab\">msstab</a>[<a class=\"id\" href=\"#mssind\">mssind</a>] : 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#get_cookie_sock\">get_cookie_sock</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#request_sock\">request_sock</a> *<a class=\"id\" href=\"#req\">req</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#dst_entry\">dst_entry</a> *<a class=\"id\" href=\"#dst\">dst</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_connection_sock\">inet_connection_sock</a> *<a class=\"id\" href=\"#icsk\">icsk</a> = <a class=\"id\" href=\"#inet_csk\">inet_csk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#child\">child</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#child\">child</a> = <a class=\"id\" href=\"#icsk\">icsk</a>-><a class=\"id\" href=\"#icsk_af_ops\">icsk_af_ops</a>-><a class=\"id\" href=\"#syn_recv_sock\">syn_recv_sock</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#req\">req</a>, <a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#child\">child</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#inet_csk_reqsk_queue_add\">inet_csk_reqsk_queue_add</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#req\">req</a>, <a class=\"id\" href=\"#child\">child</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reqsk_free\">reqsk_free</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#child\">child</a>;", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * when syncookies are in effect and tcp timestamps are enabled we stored</span>", 
"<span class=\"comment\"> * additional tcp options in the timestamp.</span>", 
"<span class=\"comment\"> * This extracts these options from the timestamp echo.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * The lowest 4 bits store snd_wscale.</span>", 
"<span class=\"comment\"> * next 2 bits indicate SACK and ECN support.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * return false if we decode an option that should not be.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#cookie_check_timestamp\">cookie_check_timestamp</a>(struct <a class=\"id\" href=\"#tcp_options_received\">tcp_options_received</a> *<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>, <a class=\"id\" href=\"#bool\">bool</a> *<a class=\"id\" href=\"#ecn_ok\">ecn_ok</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* echoed timestamp, lowest bits contain options */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#options\">options</a> = <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>-><a class=\"id\" href=\"#rcv_tsecr\">rcv_tsecr</a> &amp; <a class=\"id\" href=\"#TSMASK\">TSMASK</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>-><a class=\"id\" href=\"#saw_tstamp\">saw_tstamp</a>)  {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tcp_clear_options\">tcp_clear_options</a>(<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sysctl_tcp_timestamps\">sysctl_tcp_timestamps</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>-><a class=\"id\" href=\"#sack_ok\">sack_ok</a> = (<a class=\"id\" href=\"#options\">options</a> >> 4) &amp; 0x1;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#ecn_ok\">ecn_ok</a> = (<a class=\"id\" href=\"#options\">options</a> >> 5) &amp; 1;", 
"<span class=\"ts\"/>if (*<a class=\"id\" href=\"#ecn_ok\">ecn_ok</a> && !<a class=\"id\" href=\"#sysctl_tcp_ecn\">sysctl_tcp_ecn</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>-><a class=\"id\" href=\"#sack_ok\">sack_ok</a> && !<a class=\"id\" href=\"#sysctl_tcp_sack\">sysctl_tcp_sack</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#false\">false</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#options\">options</a> &amp; 0xf) == 0xf)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#true\">true</a>; <span class=\"comment\">/* no window scaling */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>-><a class=\"id\" href=\"#wscale_ok\">wscale_ok</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>-><a class=\"id\" href=\"#snd_wscale\">snd_wscale</a> = <a class=\"id\" href=\"#options\">options</a> &amp; 0xf;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sysctl_tcp_window_scaling\">sysctl_tcp_window_scaling</a> != 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#cookie_check_timestamp\">cookie_check_timestamp</a>);", 
"", 
"struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#cookie_v4_check\">cookie_v4_check</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#ip_options\">ip_options</a> *<a class=\"id\" href=\"#opt\">opt</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tcp_options_received\">tcp_options_received</a> <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#hash_location\">hash_location</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_request_sock\">inet_request_sock</a> *<a class=\"id\" href=\"#ireq\">ireq</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tcp_request_sock\">tcp_request_sock</a> *<a class=\"id\" href=\"#treq\">treq</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tcp_sock\">tcp_sock</a> *<a class=\"id\" href=\"#tp\">tp</a> = <a class=\"id\" href=\"#tcp_sk\">tcp_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tcphdr\">tcphdr</a> *<a class=\"id\" href=\"#th\">th</a> = <a class=\"id\" href=\"#tcp_hdr\">tcp_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__u32\">__u32</a> <a class=\"id\" href=\"#cookie\">cookie</a> = <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#ack_seq\">ack_seq</a>) - 1;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request_sock\">request_sock</a> *<a class=\"id\" href=\"#req\">req</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#mss\">mss</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__u8\">__u8</a> <a class=\"id\" href=\"#rcv_wscale\">rcv_wscale</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#ecn_ok\">ecn_ok</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sysctl_tcp_syncookies\">sysctl_tcp_syncookies</a> || !<a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#ack\">ack</a> || <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#rst\">rst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tcp_synq_no_recent_overflow\">tcp_synq_no_recent_overflow</a>(<a class=\"id\" href=\"#sk\">sk</a>) ||", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#mss\">mss</a> = <a class=\"id\" href=\"#cookie_check\">cookie_check</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cookie\">cookie</a>)) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NET_INC_STATS_BH\">NET_INC_STATS_BH</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#LINUX_MIB_SYNCOOKIESFAILED\">LINUX_MIB_SYNCOOKIESFAILED</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NET_INC_STATS_BH\">NET_INC_STATS_BH</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#LINUX_MIB_SYNCOOKIESRECV\">LINUX_MIB_SYNCOOKIESRECV</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* check for timestamp cookie support */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>, 0, sizeof(<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tcp_parse_options\">tcp_parse_options</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>, &amp;<a class=\"id\" href=\"#hash_location\">hash_location</a>, 0);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#cookie_check_timestamp\">cookie_check_timestamp</a>(&amp;<a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>, &amp;<a class=\"id\" href=\"#ecn_ok\">ecn_ok</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a> = <a class=\"id\" href=\"#inet_reqsk_alloc\">inet_reqsk_alloc</a>(&amp;<a class=\"id\" href=\"#tcp_request_sock_ops\">tcp_request_sock_ops</a>); <span class=\"comment\">/* for safety */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#req\">req</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a> = <a class=\"id\" href=\"#inet_rsk\">inet_rsk</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#treq\">treq</a> = <a class=\"id\" href=\"#tcp_rsk\">tcp_rsk</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#treq\">treq</a>-><a class=\"id\" href=\"#rcv_isn\">rcv_isn</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#ntohl\">ntohl</a>(<a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#seq\">seq</a>) - 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#treq\">treq</a>-><a class=\"id\" href=\"#snt_isn\">snt_isn</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#cookie\">cookie</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#mss\">mss</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#mss\">mss</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#loc_port\">loc_port</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#dest\">dest</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_port\">rmt_port</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#source\">source</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#loc_addr\">loc_addr</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#daddr\">daddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_addr\">rmt_addr</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#saddr\">saddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#ecn_ok\">ecn_ok</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#ecn_ok\">ecn_ok</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#snd_wscale\">snd_wscale</a><span class=\"ts\"/>= <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>.<a class=\"id\" href=\"#snd_wscale\">snd_wscale</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#sack_ok\">sack_ok</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>.<a class=\"id\" href=\"#sack_ok\">sack_ok</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#wscale_ok\">wscale_ok</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>.<a class=\"id\" href=\"#wscale_ok\">wscale_ok</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#tstamp_ok\">tstamp_ok</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>.<a class=\"id\" href=\"#saw_tstamp\">saw_tstamp</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#ts_recent\">ts_recent</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>.<a class=\"id\" href=\"#saw_tstamp\">saw_tstamp</a> ? <a class=\"id\" href=\"#tcp_opt\">tcp_opt</a>.<a class=\"id\" href=\"#rcv_tsval\">rcv_tsval</a> : 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* We throwed the options of the initial SYN away, so we hope</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * the ACK carries the same options again (see RFC1122 4.2.3.8)</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#opt\">opt</a> && <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#optlen\">optlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#opt_size\">opt_size</a> = sizeof(struct <a class=\"id\" href=\"#ip_options\">ip_options</a>) + <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#optlen\">optlen</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#opt\">opt</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(<a class=\"id\" href=\"#opt_size\">opt_size</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#opt\">opt</a> != <a class=\"id\" href=\"#NULL\">NULL</a> && <a class=\"id\" href=\"#ip_options_echo\">ip_options_echo</a>(<a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#opt\">opt</a>, <a class=\"id\" href=\"#skb\">skb</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#opt\">opt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#opt\">opt</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#security_inet_conn_request\">security_inet_conn_request</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#req\">req</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reqsk_free\">reqsk_free</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#expires\">expires</a><span class=\"ts\"/>= 0UL;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#retrans\">retrans</a><span class=\"ts\"/>= 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * We need to lookup the route here to get at the correct</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * window size. We should better make sure that the window size</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * hasn't changed since we received the original syn, but I see</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * no easy way to do this.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_mark\">sk_mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      { .<a class=\"id\" href=\"#daddr\">daddr</a> = ((<a class=\"id\" href=\"#opt\">opt</a> && <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#srr\">srr</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#opt\">opt</a>-><a class=\"id\" href=\"#faddr\">faddr</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rmt_addr\">rmt_addr</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#loc_addr\">loc_addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#RT_CONN_FLAGS\">RT_CONN_FLAGS</a>(<a class=\"id\" href=\"#sk\">sk</a>) } },", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#IPPROTO_TCP\">IPPROTO_TCP</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#inet_sk_flowi_flags\">inet_sk_flowi_flags</a>(<a class=\"id\" href=\"#sk\">sk</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#uli_u\">uli_u</a> = { .<a class=\"id\" href=\"#ports\">ports</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       { .<a class=\"id\" href=\"#sport\">sport</a> = <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#dest\">dest</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> .<a class=\"id\" href=\"#dport\">dport</a> = <a class=\"id\" href=\"#th\">th</a>-><a class=\"id\" href=\"#source\">source</a> } } };", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_req_classify_flow\">security_req_classify_flow</a>(<a class=\"id\" href=\"#req\">req</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ip_route_output_key\">ip_route_output_key</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), &amp;<a class=\"id\" href=\"#rt\">rt</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reqsk_free\">reqsk_free</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Try to redo what tcp_v4_send_synack did. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#window_clamp\">window_clamp</a> = <a class=\"id\" href=\"#tp\">tp</a>-><a class=\"id\" href=\"#window_clamp\">window_clamp</a> ? :<a class=\"id\" href=\"#dst_metric\">dst_metric</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_WINDOW\">RTAX_WINDOW</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tcp_select_initial_window\">tcp_select_initial_window</a>(<a class=\"id\" href=\"#tcp_full_space\">tcp_full_space</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#mss\">mss</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#rcv_wnd\">rcv_wnd</a>, &amp;<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#window_clamp\">window_clamp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#wscale_ok\">wscale_ok</a>, &amp;<a class=\"id\" href=\"#rcv_wscale\">rcv_wscale</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#dst_metric\">dst_metric</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#RTAX_INITRWND\">RTAX_INITRWND</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ireq\">ireq</a>-><a class=\"id\" href=\"#rcv_wscale\">rcv_wscale</a>  = <a class=\"id\" href=\"#rcv_wscale\">rcv_wscale</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#get_cookie_sock\">get_cookie_sock</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#req\">req</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
];
xr_frag_insert('l/94/c76492e442db28ffe99ebda02a99cb08ae9871.xr', __xr_tmp);
