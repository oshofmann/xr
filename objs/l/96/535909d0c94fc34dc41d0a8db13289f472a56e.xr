var __xr_tmp = [
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_ONE_QUEUE\">TUN_ONE_QUEUE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#IFF_ONE_QUEUE\">IFF_ONE_QUEUE</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#TUN_VNET_HDR\">TUN_VNET_HDR</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#IFF_VNET_HDR\">IFF_VNET_HDR</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#flags\">flags</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#tun_show_flags\">tun_show_flags</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#device_attribute\">device_attribute</a> *<a class=\"id\" href=\"#attr\">attr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      char *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#to_net_dev\">to_net_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#buf\">buf</a>, \"0x%x\\n\", <a class=\"id\" href=\"#tun_flags\">tun_flags</a>(<a class=\"id\" href=\"#tun\">tun</a>));", 
"}", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#tun_show_owner\">tun_show_owner</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#device_attribute\">device_attribute</a> *<a class=\"id\" href=\"#attr\">attr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      char *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#to_net_dev\">to_net_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#buf\">buf</a>, \"%d\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#owner\">owner</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#ssize_t\">ssize_t</a> <a class=\"id\" href=\"#tun_show_group\">tun_show_group</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#device_attribute\">device_attribute</a> *<a class=\"id\" href=\"#attr\">attr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      char *<a class=\"id\" href=\"#buf\">buf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#to_net_dev\">to_net_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#buf\">buf</a>, \"%d\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#group\">group</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#DEVICE_ATTR\">DEVICE_ATTR</a>(<a class=\"id\" href=\"#tun_flags\">tun_flags</a>, 0444, <a class=\"id\" href=\"#tun_show_flags\">tun_show_flags</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"static <a class=\"id\" href=\"#DEVICE_ATTR\">DEVICE_ATTR</a>(<a class=\"id\" href=\"#owner\">owner</a>, 0444, <a class=\"id\" href=\"#tun_show_owner\">tun_show_owner</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"static <a class=\"id\" href=\"#DEVICE_ATTR\">DEVICE_ATTR</a>(<a class=\"id\" href=\"#group\">group</a>, 0444, <a class=\"id\" href=\"#tun_show_group\">tun_show_group</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"static int <a class=\"id\" href=\"#tun_set_iff\">tun_set_iff</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>, struct <a class=\"id\" href=\"#ifreq\">ifreq</a> *<a class=\"id\" href=\"#ifr\">ifr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#__dev_get_by_name\">__dev_get_by_name</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_name\">ifr_name</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#current_cred\">current_cred</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_TUN_EXCL\">IFF_TUN_EXCL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_TUN\">IFF_TUN</a>) && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#netdev_ops\">netdev_ops</a> == &amp;<a class=\"id\" href=\"#tun_netdev_ops\">tun_netdev_ops</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else if ((<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_TAP\">IFF_TAP</a>) && <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#netdev_ops\">netdev_ops</a> == &amp;<a class=\"id\" href=\"#tap_netdev_ops\">tap_netdev_ops</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (((<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#owner\">owner</a> != -1 && <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#euid\">euid</a> != <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#owner\">owner</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>     (<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#group\">group</a> != -1 && !<a class=\"id\" href=\"#in_egroup_p\">in_egroup_p</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#group\">group</a>))) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_NET_ADMIN\">CAP_NET_ADMIN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_tun_dev_attach\">security_tun_dev_attach</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#tun_attach\">tun_attach</a>(<a class=\"id\" href=\"#tun\">tun</a>, <a class=\"id\" href=\"#file\">file</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/>char *<a class=\"id\" href=\"#name\">name</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_NET_ADMIN\">CAP_NET_ADMIN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_tun_dev_create\">security_tun_dev_create</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Set dev type */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_TUN\">IFF_TUN</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* TUN device */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_TUN_DEV\">TUN_TUN_DEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#name\">name</a> = \"tun%d\";", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_TAP\">IFF_TAP</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* TAP device */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_TAP_DEV\">TUN_TAP_DEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#name\">name</a> = \"tap%d\";", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_name\">ifr_name</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_name\">ifr_name</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#alloc_netdev\">alloc_netdev</a>(sizeof(struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a>), <a class=\"id\" href=\"#name\">name</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#tun_setup\">tun_setup</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_net_set\">dev_net_set</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#rtnl_link_ops\">rtnl_link_ops</a> = &amp;<a class=\"id\" href=\"#tun_link_ops\">tun_link_ops</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#netdev_priv\">netdev_priv</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#txflt\">txflt</a>.<a class=\"id\" href=\"#count\">count</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a> = sizeof(struct <a class=\"id\" href=\"#virtio_net_hdr\">virtio_net_hdr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sk_alloc\">sk_alloc</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#AF_UNSPEC\">AF_UNSPEC</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>, &amp;<a class=\"id\" href=\"#tun_proto\">tun_proto</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#sk\">sk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_dev\">err_free_dev</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#wq\">wq</a> = &amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#wq\">wq</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#init_waitqueue_head\">init_waitqueue_head</a>(&amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#wq\">wq</a>.<a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#ops\">ops</a> = &amp;<a class=\"id\" href=\"#tun_socket_ops\">tun_socket_ops</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_init_data\">sock_init_data</a>(&amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#socket\">socket</a>, <a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_write_space\">sk_write_space</a> = <a class=\"id\" href=\"#tun_sock_write_space\">tun_sock_write_space</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_sndbuf\">sk_sndbuf</a> = <a class=\"id\" href=\"#INT_MAX\">INT_MAX</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun_sk\">tun_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#tun\">tun</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_tun_dev_post_create\">security_tun_dev_post_create</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun_net_init\">tun_net_init</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strchr\">strchr</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, '%')) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#dev_alloc_name\">dev_alloc_name</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_sk\">err_free_sk</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#register_netdevice\">register_netdevice</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#err_free_sk\">err_free_sk</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#device_create_file\">device_create_file</a>(&amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#dev_attr_tun_flags\">dev_attr_tun_flags</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#device_create_file\">device_create_file</a>(&amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#dev_attr_owner\">dev_attr_owner</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#device_create_file\">device_create_file</a>(&amp;<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, &amp;<a class=\"id\" href=\"#dev_attr_group\">dev_attr_group</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"Failed to create tun sysfs files\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_destruct\">sk_destruct</a> = <a class=\"id\" href=\"#tun_sock_destruct\">tun_sock_destruct</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#tun_attach\">tun_attach</a>(<a class=\"id\" href=\"#tun\">tun</a>, <a class=\"id\" href=\"#file\">file</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#failed\">failed</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: tun_set_iff\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_NO_PI\">IFF_NO_PI</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_NO_PI\">TUN_NO_PI</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#TUN_NO_PI\">TUN_NO_PI</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_ONE_QUEUE\">IFF_ONE_QUEUE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_ONE_QUEUE\">TUN_ONE_QUEUE</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#TUN_ONE_QUEUE\">TUN_ONE_QUEUE</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> &amp; <a class=\"id\" href=\"#IFF_VNET_HDR\">IFF_VNET_HDR</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#TUN_VNET_HDR\">TUN_VNET_HDR</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#TUN_VNET_HDR\">TUN_VNET_HDR</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Make sure persistent devices do not get stuck in</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * xoff state.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#netif_running\">netif_running</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netif_wake_queue\">netif_wake_queue</a>(<a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_name\">ifr_name</a>, <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>return 0;", 
"", 
" <a class=\"id\" href=\"#err_free_sk\">err_free_sk</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_put\">sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
" <a class=\"id\" href=\"#err_free_dev\">err_free_dev</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_netdev\">free_netdev</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
" <a class=\"id\" href=\"#failed\">failed</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tun_get_iff\">tun_get_iff</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#ifreq\">ifreq</a> *<a class=\"id\" href=\"#ifr\">ifr</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DBG\">DBG</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"%s: tun_get_iff\\n\", <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_name\">ifr_name</a>, <a class=\"id\" href=\"#tun\">tun</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ifr\">ifr</a>-><a class=\"id\" href=\"#ifr_flags\">ifr_flags</a> = <a class=\"id\" href=\"#tun_flags\">tun_flags</a>(<a class=\"id\" href=\"#tun\">tun</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/* This is like a cut-down ethtool ops, except done via tun fd so no</span>", 
"<span class=\"comment\"> * privs required. */</span>", 
"static int <a class=\"id\" href=\"#set_offload\">set_offload</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, unsigned long <a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#old_features\">old_features</a>, <a class=\"id\" href=\"#features\">features</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_features\">old_features</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#features\">features</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* Unset features, set them as we chew on the arg. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#features\">features</a> = (<a class=\"id\" href=\"#old_features\">old_features</a> &amp; ~(<a class=\"id\" href=\"#NETIF_F_HW_CSUM\">NETIF_F_HW_CSUM</a>|<a class=\"id\" href=\"#NETIF_F_SG\">NETIF_F_SG</a>|<a class=\"id\" href=\"#NETIF_F_FRAGLIST\">NETIF_F_FRAGLIST</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    |<a class=\"id\" href=\"#NETIF_F_TSO_ECN\">NETIF_F_TSO_ECN</a>|<a class=\"id\" href=\"#NETIF_F_TSO\">NETIF_F_TSO</a>|<a class=\"id\" href=\"#NETIF_F_TSO6\">NETIF_F_TSO6</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    |<a class=\"id\" href=\"#NETIF_F_UFO\">NETIF_F_UFO</a>));", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &amp; <a class=\"id\" href=\"#TUN_F_CSUM\">TUN_F_CSUM</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#features\">features</a> |= <a class=\"id\" href=\"#NETIF_F_HW_CSUM\">NETIF_F_HW_CSUM</a>|<a class=\"id\" href=\"#NETIF_F_SG\">NETIF_F_SG</a>|<a class=\"id\" href=\"#NETIF_F_FRAGLIST\">NETIF_F_FRAGLIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> &= ~<a class=\"id\" href=\"#TUN_F_CSUM\">TUN_F_CSUM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &amp; (<a class=\"id\" href=\"#TUN_F_TSO4\">TUN_F_TSO4</a>|<a class=\"id\" href=\"#TUN_F_TSO6\">TUN_F_TSO6</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &amp; <a class=\"id\" href=\"#TUN_F_TSO_ECN\">TUN_F_TSO_ECN</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#features\">features</a> |= <a class=\"id\" href=\"#NETIF_F_TSO_ECN\">NETIF_F_TSO_ECN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> &= ~<a class=\"id\" href=\"#TUN_F_TSO_ECN\">TUN_F_TSO_ECN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &amp; <a class=\"id\" href=\"#TUN_F_TSO4\">TUN_F_TSO4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#features\">features</a> |= <a class=\"id\" href=\"#NETIF_F_TSO\">NETIF_F_TSO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &amp; <a class=\"id\" href=\"#TUN_F_TSO6\">TUN_F_TSO6</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#features\">features</a> |= <a class=\"id\" href=\"#NETIF_F_TSO6\">NETIF_F_TSO6</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> &= ~(<a class=\"id\" href=\"#TUN_F_TSO4\">TUN_F_TSO4</a>|<a class=\"id\" href=\"#TUN_F_TSO6\">TUN_F_TSO6</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a> &amp; <a class=\"id\" href=\"#TUN_F_UFO\">TUN_F_UFO</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#features\">features</a> |= <a class=\"id\" href=\"#NETIF_F_UFO\">NETIF_F_UFO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#arg\">arg</a> &= ~<a class=\"id\" href=\"#TUN_F_UFO\">TUN_F_UFO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* This gives the user a way to test for new features in future by</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * trying to set them. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#arg\">arg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#features\">features</a> = <a class=\"id\" href=\"#features\">features</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#old_features\">old_features</a> != <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#features\">features</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netdev_features_change\">netdev_features_change</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static long <a class=\"id\" href=\"#__tun_chr_ioctl\">__tun_chr_ioctl</a>(struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>, unsigned int <a class=\"id\" href=\"#cmd\">cmd</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    unsigned long <a class=\"id\" href=\"#arg\">arg</a>, int <a class=\"id\" href=\"#ifreq_len\">ifreq_len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_file\">tun_file</a> *<a class=\"id\" href=\"#tfile\">tfile</a> = <a class=\"id\" href=\"#file\">file</a>-><a class=\"id\" href=\"#private_data\">private_data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tun_struct\">tun_struct</a> *<a class=\"id\" href=\"#tun\">tun</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__user\">__user</a>* <a class=\"id\" href=\"#argp\">argp</a> = (void <a class=\"id\" href=\"#__user\">__user</a>*)<a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock_fprog\">sock_fprog</a> <a class=\"id\" href=\"#fprog\">fprog</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ifreq\">ifreq</a> <a class=\"id\" href=\"#ifr\">ifr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#sndbuf\">sndbuf</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#vnet_hdr_sz\">vnet_hdr_sz</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#TUNSETIFF\">TUNSETIFF</a> || <a class=\"id\" href=\"#_IOC_TYPE\">_IOC_TYPE</a>(<a class=\"id\" href=\"#cmd\">cmd</a>) == 0x89)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#ifr\">ifr</a>, <a class=\"id\" href=\"#argp\">argp</a>, <a class=\"id\" href=\"#ifreq_len\">ifreq_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#TUNGETFEATURES\">TUNGETFEATURES</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Currently this just means: \"what IFF flags are valid?\".</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * This is needed because we never checked for invalid flags on</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * TUNSETIFF. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#IFF_TUN\">IFF_TUN</a> | <a class=\"id\" href=\"#IFF_TAP\">IFF_TAP</a> | <a class=\"id\" href=\"#IFF_NO_PI\">IFF_NO_PI</a> | <a class=\"id\" href=\"#IFF_ONE_QUEUE\">IFF_ONE_QUEUE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IFF_VNET_HDR\">IFF_VNET_HDR</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned int <a class=\"id\" href=\"#__user\">__user</a>*)<a class=\"id\" href=\"#argp\">argp</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tun\">tun</a> = <a class=\"id\" href=\"#__tun_get\">__tun_get</a>(<a class=\"id\" href=\"#tfile\">tfile</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#TUNSETIFF\">TUNSETIFF</a> && !<a class=\"id\" href=\"#tun\">tun</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ifr\">ifr</a>.<a class=\"id\" href=\"#ifr_name\">ifr_name</a>[<a class=\"id\" href=\"#IFNAMSIZ\">IFNAMSIZ</a>-1] = '\\0';", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#tun_set_iff\">tun_set_iff</a>(<a class=\"id\" href=\"#tfile\">tfile</a>-><a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#file\">file</a>, &amp;<a class=\"id\" href=\"#ifr\">ifr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#argp\">argp</a>, &amp;<a class=\"id\" href=\"#ifr\">ifr</a>, <a class=\"id\" href=\"#ifreq_len\">ifreq_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"<span class=\"ts\"/>}", 
];
xr_frag_insert('l/96/535909d0c94fc34dc41d0a8db13289f472a56e.xr', __xr_tmp);
