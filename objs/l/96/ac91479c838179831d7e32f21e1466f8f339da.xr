var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * xfrm_state.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Changes:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Mitsuru KANDA @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>Kazunori MIYAZAWA @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>Kunihiro Ishiguro &lt;kunihiro@ipinfusion.com&gt;</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/><span class=\"ts\"/>IPv6 support</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>YOSHIFUJI Hideaki @USAGI</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/><span class=\"ts\"/>Split up af-specific functions</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Derek Atkins &lt;derek@ihtfp.com&gt;</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Add UDP Encapsulation</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#workqueue\">workqueue</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pfkeyv2\">pfkeyv2</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ipsec\">ipsec</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#cache\">cache</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#audit\">audit</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ktime\">ktime</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#interrupt\">interrupt</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> \"xfrm_hash.h\"", 
"", 
"<span class=\"comment\">/* Each xfrm_state may be linked to two tables:</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\">   1. Hash table by (spi,daddr,ah/esp) to find SA by SPI. (input,ctl)</span>", 
"<span class=\"comment\">   2. Hash table by (daddr,family,reqid) to find what SAs exist for given</span>", 
"<span class=\"comment\">      destination/tunnel endpoint. (output)</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#DEFINE_SPINLOCK\">DEFINE_SPINLOCK</a>(<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"static unsigned int <a class=\"id\" href=\"#xfrm_state_hashmax\">xfrm_state_hashmax</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = 1 * 1024 * 1024;", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(unsigned int <a class=\"id\" href=\"#family\">family</a>);", 
"static void <a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_AUDITSYSCALL\">CONFIG_AUDITSYSCALL</a>", 
"static void <a class=\"id\" href=\"#xfrm_audit_state_replay\">xfrm_audit_state_replay</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#net_seq\">net_seq</a>);", 
"#else", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#xfrm_audit_state_replay\">xfrm_audit_state_replay</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#sq\">sq</a>)<span class=\"ts\"/>do { ; } while (0)", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_AUDITSYSCALL */</span>", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned int <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#reqid\">reqid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__xfrm_dst_hash\">__xfrm_dst_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned int <a class=\"id\" href=\"#xfrm_src_hash\">xfrm_src_hash</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__xfrm_src_hash\">__xfrm_src_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned int", 
"<a class=\"id\" href=\"#xfrm_spi_hash\">xfrm_spi_hash</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__xfrm_spi_hash\">__xfrm_spi_hash</a>(<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_hash_transfer\">xfrm_hash_transfer</a>(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#list\">list</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#ndsttable\">ndsttable</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#nsrctable\">nsrctable</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#nspitable\">nspitable</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       unsigned int <a class=\"id\" href=\"#nhashmask\">nhashmask</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry_safe\">hlist_for_each_entry_safe</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#__xfrm_dst_hash\">__xfrm_dst_hash</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>, <a class=\"id\" href=\"#ndsttable\">ndsttable</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#__xfrm_src_hash\">__xfrm_src_hash</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bysrc\">bysrc</a>, <a class=\"id\" href=\"#nsrctable\">nsrctable</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#__xfrm_spi_hash\">__xfrm_spi_hash</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#byspi\">byspi</a>, <a class=\"id\" href=\"#nspitable\">nspitable</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static unsigned long <a class=\"id\" href=\"#xfrm_hash_new_size\">xfrm_hash_new_size</a>(unsigned int <a class=\"id\" href=\"#state_hmask\">state_hmask</a>)", 
"{", 
"<span class=\"ts\"/>return ((<a class=\"id\" href=\"#state_hmask\">state_hmask</a> + 1) << 1) * sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#DEFINE_MUTEX\">DEFINE_MUTEX</a>(<a class=\"id\" href=\"#hash_resize_mutex\">hash_resize_mutex</a>);", 
"", 
"static void <a class=\"id\" href=\"#xfrm_hash_resize\">xfrm_hash_resize</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#work\">work</a>, struct <a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hash_work\">state_hash_work</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#ndst\">ndst</a>, *<a class=\"id\" href=\"#nsrc\">nsrc</a>, *<a class=\"id\" href=\"#nspi\">nspi</a>, *<a class=\"id\" href=\"#odst\">odst</a>, *<a class=\"id\" href=\"#osrc\">osrc</a>, *<a class=\"id\" href=\"#ospi\">ospi</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#nsize\">nsize</a>, <a class=\"id\" href=\"#osize\">osize</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#nhashmask\">nhashmask</a>, <a class=\"id\" href=\"#ohashmask\">ohashmask</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#hash_resize_mutex\">hash_resize_mutex</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nsize\">nsize</a> = <a class=\"id\" href=\"#xfrm_hash_new_size\">xfrm_hash_new_size</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ndst\">ndst</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ndst\">ndst</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nsrc\">nsrc</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#nsrc\">nsrc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#ndst\">ndst</a>, <a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nspi\">nspi</a> = <a class=\"id\" href=\"#xfrm_hash_alloc\">xfrm_hash_alloc</a>(<a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#nspi\">nspi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#ndst\">ndst</a>, <a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#nsrc\">nsrc</a>, <a class=\"id\" href=\"#nsize\">nsize</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nhashmask\">nhashmask</a> = (<a class=\"id\" href=\"#nsize\">nsize</a> / sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>)) - 1U;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>; <a class=\"id\" href=\"#i\">i</a> >= 0; <a class=\"id\" href=\"#i\">i</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_transfer\">xfrm_hash_transfer</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#ndst\">ndst</a>, <a class=\"id\" href=\"#nsrc\">nsrc</a>, <a class=\"id\" href=\"#nspi\">nspi</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#nhashmask\">nhashmask</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#odst\">odst</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#osrc\">osrc</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ospi\">ospi</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ohashmask\">ohashmask</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a> = <a class=\"id\" href=\"#ndst\">ndst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a> = <a class=\"id\" href=\"#nsrc\">nsrc</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a> = <a class=\"id\" href=\"#nspi\">nspi</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a> = <a class=\"id\" href=\"#nhashmask\">nhashmask</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#osize\">osize</a> = (<a class=\"id\" href=\"#ohashmask\">ohashmask</a> + 1) * sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#odst\">odst</a>, <a class=\"id\" href=\"#osize\">osize</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#osrc\">osrc</a>, <a class=\"id\" href=\"#osize\">osize</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_free\">xfrm_hash_free</a>(<a class=\"id\" href=\"#ospi\">ospi</a>, <a class=\"id\" href=\"#osize\">osize</a>);", 
"", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#hash_resize_mutex\">hash_resize_mutex</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#DEFINE_RWLOCK\">DEFINE_RWLOCK</a>(<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"static struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#NPROTO\">NPROTO</a>];", 
"", 
"static <a class=\"id\" href=\"#DEFINE_SPINLOCK\">DEFINE_SPINLOCK</a>(<a class=\"id\" href=\"#xfrm_state_gc_lock\">xfrm_state_gc_lock</a>);", 
"", 
"int <a class=\"id\" href=\"#__xfrm_state_delete\">__xfrm_state_delete</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>);", 
"", 
"int <a class=\"id\" href=\"#km_query\">km_query</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a> *<a class=\"id\" href=\"#t\">t</a>, struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>);", 
"void <a class=\"id\" href=\"#km_state_expired\">km_state_expired</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#hard\">hard</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>);", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#xfrm_state_lock_afinfo\">xfrm_state_lock_afinfo</a>(unsigned int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#family\">family</a> >= <a class=\"id\" href=\"#NPROTO\">NPROTO</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a>[<a class=\"id\" href=\"#family\">family</a>];", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#afinfo\">afinfo</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_state_unlock_afinfo\">xfrm_state_unlock_afinfo</a>(struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__releases\">__releases</a>(<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_afinfo_lock\">xfrm_state_afinfo_lock</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#xfrm_register_type\">xfrm_register_type</a>(const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> *<a class=\"id\" href=\"#type\">type</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_lock_afinfo\">xfrm_state_lock_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> **<a class=\"id\" href=\"#typemap\">typemap</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#typemap\">typemap</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#type_map\">type_map</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#typemap\">typemap</a>[<a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#proto\">proto</a>] == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#typemap\">typemap</a>[<a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#proto\">proto</a>] = <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_unlock_afinfo\">xfrm_state_unlock_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_register_type\">xfrm_register_type</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_unregister_type\">xfrm_unregister_type</a>(const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> *<a class=\"id\" href=\"#type\">type</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_lock_afinfo\">xfrm_state_lock_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> **<a class=\"id\" href=\"#typemap\">typemap</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#typemap\">typemap</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#type_map\">type_map</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#typemap\">typemap</a>[<a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#proto\">proto</a>] != <a class=\"id\" href=\"#type\">type</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#typemap\">typemap</a>[<a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#proto\">proto</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_unlock_afinfo\">xfrm_state_unlock_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_unregister_type\">xfrm_unregister_type</a>);", 
"", 
"static const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> *<a class=\"id\" href=\"#xfrm_get_type\">xfrm_get_type</a>(<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> **<a class=\"id\" href=\"#typemap\">typemap</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> *<a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#modload_attempted\">modload_attempted</a> = 0;", 
"", 
"<a class=\"id\" href=\"#retry\">retry</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#typemap\">typemap</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#type_map\">type_map</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#typemap\">typemap</a>[<a class=\"id\" href=\"#proto\">proto</a>];", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#type\">type</a> && !<a class=\"id\" href=\"#try_module_get\">try_module_get</a>(<a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#owner\">owner</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#type\">type</a> && !<a class=\"id\" href=\"#modload_attempted\">modload_attempted</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#request_module\">request_module</a>(\"xfrm-type-%d-%d\", <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#proto\">proto</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#modload_attempted\">modload_attempted</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#retry\">retry</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#type\">type</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_put_type\">xfrm_put_type</a>(const struct <a class=\"id\" href=\"#xfrm_type\">xfrm_type</a> *<a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#module_put\">module_put</a>(<a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#owner\">owner</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#xfrm_register_mode\">xfrm_register_mode</a>(struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> *<a class=\"id\" href=\"#mode\">mode</a>, int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> **<a class=\"id\" href=\"#modemap\">modemap</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#encap\">encap</a> >= <a class=\"id\" href=\"#XFRM_MODE_MAX\">XFRM_MODE_MAX</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_lock_afinfo\">xfrm_state_lock_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#modemap\">modemap</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#mode_map\">mode_map</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#modemap\">modemap</a>[<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#encap\">encap</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#try_module_get\">try_module_get</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#owner\">owner</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#modemap\">modemap</a>[<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#encap\">encap</a>] = <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_unlock_afinfo\">xfrm_state_unlock_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_register_mode\">xfrm_register_mode</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_unregister_mode\">xfrm_unregister_mode</a>(struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> *<a class=\"id\" href=\"#mode\">mode</a>, int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> **<a class=\"id\" href=\"#modemap\">modemap</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#encap\">encap</a> >= <a class=\"id\" href=\"#XFRM_MODE_MAX\">XFRM_MODE_MAX</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_lock_afinfo\">xfrm_state_lock_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#modemap\">modemap</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#mode_map\">mode_map</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#modemap\">modemap</a>[<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#encap\">encap</a>] == <a class=\"id\" href=\"#mode\">mode</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#modemap\">modemap</a>[<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#encap\">encap</a>] = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#module_put\">module_put</a>(<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#owner\">owner</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_unlock_afinfo\">xfrm_state_unlock_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_unregister_mode\">xfrm_unregister_mode</a>);", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> *<a class=\"id\" href=\"#xfrm_get_mode\">xfrm_get_mode</a>(unsigned int <a class=\"id\" href=\"#encap\">encap</a>, int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> *<a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#modload_attempted\">modload_attempted</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#encap\">encap</a> >= <a class=\"id\" href=\"#XFRM_MODE_MAX\">XFRM_MODE_MAX</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<a class=\"id\" href=\"#retry\">retry</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#mode_map\">mode_map</a>[<a class=\"id\" href=\"#encap\">encap</a>];", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#mode\">mode</a> && !<a class=\"id\" href=\"#try_module_get\">try_module_get</a>(<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#owner\">owner</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#mode\">mode</a> && !<a class=\"id\" href=\"#modload_attempted\">modload_attempted</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#request_module\">request_module</a>(\"xfrm-mode-%d-%d\", <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#encap\">encap</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#modload_attempted\">modload_attempted</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#retry\">retry</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#mode\">mode</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_put_mode\">xfrm_put_mode</a>(struct <a class=\"id\" href=\"#xfrm_mode\">xfrm_mode</a> *<a class=\"id\" href=\"#mode\">mode</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#module_put\">module_put</a>(<a class=\"id\" href=\"#mode\">mode</a>-><a class=\"id\" href=\"#owner\">owner</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_state_gc_destroy\">xfrm_state_gc_destroy</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_cancel\">tasklet_hrtimer_cancel</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#del_timer_sync\">del_timer_sync</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#rtimer\">rtimer</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#aalg\">aalg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#ealg\">ealg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#calg\">calg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#encap\">encap</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode\">inner_mode</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_put_mode\">xfrm_put_mode</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode\">inner_mode</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_put_mode\">xfrm_put_mode</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#outer_mode\">outer_mode</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_put_mode\">xfrm_put_mode</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#outer_mode\">outer_mode</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>-><a class=\"id\" href=\"#destructor\">destructor</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_put_type\">xfrm_put_type</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#type\">type</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_xfrm_state_free\">security_xfrm_state_free</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_state_gc_task\">xfrm_state_gc_task</a>(struct <a class=\"id\" href=\"#work_struct\">work_struct</a> *<a class=\"id\" href=\"#work\">work</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#work\">work</a>, struct <a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_gc_work\">state_gc_work</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> <a class=\"id\" href=\"#gc_list\">gc_list</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_gc_lock\">xfrm_state_gc_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_move_list\">hlist_move_list</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_gc_list\">state_gc_list</a>, &amp;<a class=\"id\" href=\"#gc_list\">gc_list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_gc_lock\">xfrm_state_gc_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry_safe\">hlist_for_each_entry_safe</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, &amp;<a class=\"id\" href=\"#gc_list\">gc_list</a>, <a class=\"id\" href=\"#gclist\">gclist</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_gc_destroy\">xfrm_state_gc_destroy</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#km_waitq\">km_waitq</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned long <a class=\"id\" href=\"#make_jiffies\">make_jiffies</a>(long <a class=\"id\" href=\"#secs\">secs</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#secs\">secs</a> >= (<a class=\"id\" href=\"#MAX_SCHEDULE_TIMEOUT\">MAX_SCHEDULE_TIMEOUT</a>-1)/<a class=\"id\" href=\"#HZ\">HZ</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#MAX_SCHEDULE_TIMEOUT\">MAX_SCHEDULE_TIMEOUT</a>-1;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#secs\">secs</a>*<a class=\"id\" href=\"#HZ\">HZ</a>;", 
"}", 
"", 
"static enum <a class=\"id\" href=\"#hrtimer_restart\">hrtimer_restart</a> <a class=\"id\" href=\"#xfrm_timer_handler\">xfrm_timer_handler</a>(struct <a class=\"id\" href=\"#hrtimer\">hrtimer</a> * <a class=\"id\" href=\"#me\">me</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tasklet_hrtimer\">tasklet_hrtimer</a> *<a class=\"id\" href=\"#thr\">thr</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#me\">me</a>, struct <a class=\"id\" href=\"#tasklet_hrtimer\">tasklet_hrtimer</a>, <a class=\"id\" href=\"#timer\">timer</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#thr\">thr</a>, struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a>, <a class=\"id\" href=\"#mtimer\">mtimer</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#now\">now</a> = <a class=\"id\" href=\"#get_seconds\">get_seconds</a>();", 
"<span class=\"ts\"/>long <a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#LONG_MAX\">LONG_MAX</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#warn\">warn</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_EXPIRED\">XFRM_STATE_EXPIRED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#expired\">expired</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_add_expires_seconds\">hard_add_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_add_expires_seconds\">hard_add_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#expired\">expired</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_use_expires_seconds\">hard_use_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_use_expires_seconds\">hard_use_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a> ? : <a class=\"id\" href=\"#now\">now</a>) - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#expired\">expired</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#resched\">resched</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_add_expires_seconds\">soft_add_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_add_expires_seconds\">soft_add_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#warn\">warn</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_use_expires_seconds\">soft_use_expires_seconds</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>long <a class=\"id\" href=\"#tmo\">tmo</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_use_expires_seconds\">soft_use_expires_seconds</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a> ? : <a class=\"id\" href=\"#now\">now</a>) - <a class=\"id\" href=\"#now\">now</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmo\">tmo</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#warn\">warn</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#tmo\">tmo</a> &lt; <a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#tmo\">tmo</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> = <a class=\"id\" href=\"#warn\">warn</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#warn\">warn</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#km_state_expired\">km_state_expired</a>(<a class=\"id\" href=\"#x\">x</a>, 0, 0);", 
"<a class=\"id\" href=\"#resched\">resched</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#next\">next</a> != <a class=\"id\" href=\"#LONG_MAX\">LONG_MAX</a>){", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_start\">tasklet_hrtimer_start</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>, <a class=\"id\" href=\"#ktime_set\">ktime_set</a>(<a class=\"id\" href=\"#next\">next</a>, 0), <a class=\"id\" href=\"#HRTIMER_MODE_REL\">HRTIMER_MODE_REL</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<a class=\"id\" href=\"#expired\">expired</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_ACQ\">XFRM_STATE_ACQ</a> && <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_EXPIRED\">XFRM_STATE_EXPIRED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#km_waitq\">km_waitq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#next\">next</a> = 2;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#resched\">resched</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__xfrm_state_delete\">__xfrm_state_delete</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a> && <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#km_state_expired\">km_state_expired</a>(<a class=\"id\" href=\"#x\">x</a>, 1, 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_state_delete\">xfrm_audit_state_delete</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#err\">err</a> ? 0 : 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_get_loginuid\">audit_get_loginuid</a>(<a class=\"id\" href=\"#current\">current</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_get_sessionid\">audit_get_sessionid</a>(<a class=\"id\" href=\"#current\">current</a>), 0);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#HRTIMER_NORESTART\">HRTIMER_NORESTART</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_replay_timer_handler\">xfrm_replay_timer_handler</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>);", 
"", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#xfrm_state_alloc\">xfrm_state_alloc</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_pnet\">write_pnet</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#xs_net\">xs_net</a>, <a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#tunnel_users\">tunnel_users</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_NODE\">INIT_HLIST_NODE</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_NODE\">INIT_HLIST_NODE</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bysrc\">bysrc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_NODE\">INIT_HLIST_NODE</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#byspi\">byspi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_init\">tasklet_hrtimer_init</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>, <a class=\"id\" href=\"#xfrm_timer_handler\">xfrm_timer_handler</a>, <a class=\"id\" href=\"#CLOCK_REALTIME\">CLOCK_REALTIME</a>, <a class=\"id\" href=\"#HRTIMER_MODE_ABS\">HRTIMER_MODE_ABS</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#setup_timer\">setup_timer</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#rtimer\">rtimer</a>, <a class=\"id\" href=\"#xfrm_replay_timer_handler\">xfrm_replay_timer_handler</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned long)<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> = <a class=\"id\" href=\"#get_seconds\">get_seconds</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_byte_limit\">soft_byte_limit</a> = <a class=\"id\" href=\"#XFRM_INF\">XFRM_INF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_packet_limit\">soft_packet_limit</a> = <a class=\"id\" href=\"#XFRM_INF\">XFRM_INF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_byte_limit\">hard_byte_limit</a> = <a class=\"id\" href=\"#XFRM_INF\">XFRM_INF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_packet_limit\">hard_packet_limit</a> = <a class=\"id\" href=\"#XFRM_INF\">XFRM_INF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxage\">replay_maxage</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxdiff\">replay_maxdiff</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode\">inner_mode</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#inner_mode_iaf\">inner_mode_iaf</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_alloc\">xfrm_state_alloc</a>);", 
"", 
"void <a class=\"id\" href=\"#__xfrm_state_destroy\">__xfrm_state_destroy</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> != <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_gc_lock\">xfrm_state_gc_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#gclist\">gclist</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_gc_list\">state_gc_list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_gc_lock\">xfrm_state_gc_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#schedule_work\">schedule_work</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_gc_work\">state_gc_work</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#__xfrm_state_destroy\">__xfrm_state_destroy</a>);", 
"", 
"int <a class=\"id\" href=\"#__xfrm_state_delete\">__xfrm_state_delete</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> != <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#all\">all</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bysrc\">bysrc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#byspi\">byspi</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_num\">state_num</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* All xfrm_state objects are created by xfrm_state_alloc.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * The xfrm_state_alloc call gives a reference, and that</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * is what we are dropping here.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#__xfrm_state_delete\">__xfrm_state_delete</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_delete\">xfrm_state_delete</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__xfrm_state_delete\">__xfrm_state_delete</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_delete\">xfrm_state_delete</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SECURITY_NETWORK_XFRM\">CONFIG_SECURITY_NETWORK_XFRM</a>", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#xfrm_state_flush_secctx_check\">xfrm_state_flush_secctx_check</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, struct <a class=\"id\" href=\"#xfrm_audit\">xfrm_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> <= <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_id_proto_match\">xfrm_id_proto_match</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#proto\">proto</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   (<a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_xfrm_state_delete\">security_xfrm_state_delete</a>(<a class=\"id\" href=\"#x\">x</a>)) != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_state_delete\">xfrm_audit_state_delete</a>(<a class=\"id\" href=\"#x\">x</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#loginuid\">loginuid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#sessionid\">sessionid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"#else", 
"static <a class=\"id\" href=\"#inline\">inline</a> int", 
"<a class=\"id\" href=\"#xfrm_state_flush_secctx_check\">xfrm_state_flush_secctx_check</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, struct <a class=\"id\" href=\"#xfrm_audit\">xfrm_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>return 0;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_flush\">xfrm_state_flush</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, struct <a class=\"id\" href=\"#xfrm_audit\">xfrm_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#err\">err</a> = 0, <a class=\"id\" href=\"#cnt\">cnt</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_state_flush_secctx_check\">xfrm_state_flush_secctx_check</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> <= <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<a class=\"id\" href=\"#restart\">restart</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#xfrm_state_kern\">xfrm_state_kern</a>(<a class=\"id\" href=\"#x\">x</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_id_proto_match\">xfrm_id_proto_match</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#proto\">proto</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_state_delete\">xfrm_state_delete</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_audit_state_delete\">xfrm_audit_state_delete</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#err\">err</a> ? 0 : 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#loginuid\">loginuid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#sessionid\">sessionid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cnt\">cnt</a>++;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#restart\">restart</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cnt\">cnt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#km_waitq\">km_waitq</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_flush\">xfrm_state_flush</a>);", 
"", 
"void <a class=\"id\" href=\"#xfrm_sad_getinfo\">xfrm_sad_getinfo</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#xfrmk_sadinfo\">xfrmk_sadinfo</a> *<a class=\"id\" href=\"#si\">si</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#sadcnt\">sadcnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_num\">state_num</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#sadhcnt\">sadhcnt</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#si\">si</a>-><a class=\"id\" href=\"#sadhmcnt\">sadhmcnt</a> = <a class=\"id\" href=\"#xfrm_state_hashmax\">xfrm_state_hashmax</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_sad_getinfo\">xfrm_sad_getinfo</a>);", 
"", 
"static int", 
"<a class=\"id\" href=\"#xfrm_init_tempstate\">xfrm_init_tempstate</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a> *<a class=\"id\" href=\"#tmpl\">tmpl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state_afinfo\">xfrm_state_afinfo</a> *<a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#init_tempsel\">init_tempsel</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#fl\">fl</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#encap_family\">encap_family</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a> = <a class=\"id\" href=\"#xfrm_state_get_afinfo\">xfrm_state_get_afinfo</a>(<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#encap_family\">encap_family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#afinfo\">afinfo</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#afinfo\">afinfo</a>-><a class=\"id\" href=\"#init_temprop\">init_temprop</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put_afinfo\">xfrm_state_put_afinfo</a>(<a class=\"id\" href=\"#afinfo\">afinfo</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#__xfrm_state_lookup\">__xfrm_state_lookup</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_spi_hash\">xfrm_spi_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>+<a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#byspi\">byspi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#family\">family</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>       != <a class=\"id\" href=\"#spi\">spi</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>     != <a class=\"id\" href=\"#proto\">proto</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#family\">family</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) != <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#__xfrm_state_lookup_byaddr\">__xfrm_state_lookup_byaddr</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_src_hash\">xfrm_src_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>+<a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#bysrc\">bysrc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#family\">family</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>     != <a class=\"id\" href=\"#proto\">proto</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#family\">family</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) != <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *", 
"<a class=\"id\" href=\"#__xfrm_state_locate\">__xfrm_state_locate</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, int <a class=\"id\" href=\"#use_spi\">use_spi</a>, int <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#use_spi\">use_spi</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#__xfrm_state_lookup\">__xfrm_state_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#__xfrm_state_lookup_byaddr\">__xfrm_state_lookup_byaddr</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_hash_grow_check\">xfrm_hash_grow_check</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#have_hash_collision\">have_hash_collision</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#have_hash_collision\">have_hash_collision</a> &&", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a> + 1) &lt; <a class=\"id\" href=\"#xfrm_state_hashmax\">xfrm_state_hashmax</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_num\">state_num</a> &gt; <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hmask\">state_hmask</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule_work\">schedule_work</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_hash_work\">state_hash_work</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#xfrm_state_look_at\">xfrm_state_look_at</a>(struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> **<a class=\"id\" href=\"#best\">best</a>, int *<a class=\"id\" href=\"#acq_in_progress\">acq_in_progress</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       int *<a class=\"id\" href=\"#error\">error</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* Resolution logic:</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * 1. There is a valid state with matching selector. Done.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * 2. Valid state with inappropriate selector. Skip.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Entering area of \"sysdeps\".</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * 3. If state is not valid, selector is temporary, it selects</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *    only session which triggered previous resolution. Key</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *    manager will do something to install a state with proper</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *    selector.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#family\">family</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>     !<a class=\"id\" href=\"#xfrm_selector_match\">xfrm_selector_match</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#family\">family</a>)) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#security_xfrm_state_pol_flow_match\">security_xfrm_state_pol_flow_match</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#fl\">fl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!*<a class=\"id\" href=\"#best\">best</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    (*<a class=\"id\" href=\"#best\">best</a>)-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> &gt; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    ((*<a class=\"id\" href=\"#best\">best</a>)-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>     (*<a class=\"id\" href=\"#best\">best</a>)-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> &lt; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#best\">best</a> = <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_ACQ\">XFRM_STATE_ACQ</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#acq_in_progress\">acq_in_progress</a> = 1;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_ERROR\">XFRM_STATE_ERROR</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_EXPIRED\">XFRM_STATE_EXPIRED</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_selector_match\">xfrm_selector_match</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#family\">family</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#security_xfrm_state_pol_flow_match\">security_xfrm_state_pol_flow_match</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#fl\">fl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *", 
"<a class=\"id\" href=\"#xfrm_state_find\">xfrm_state_find</a>(<a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>, struct <a class=\"id\" href=\"#xfrm_tmpl\">xfrm_tmpl</a> *<a class=\"id\" href=\"#tmpl\">tmpl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_policy\">xfrm_policy</a> *<a class=\"id\" href=\"#pol\">pol</a>, int *<a class=\"id\" href=\"#err\">err</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>static <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> <a class=\"id\" href=\"#saddr_wildcard\">saddr_wildcard</a> = { };", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xp_net\">xp_net</a>(<a class=\"id\" href=\"#pol\">pol</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#h_wildcard\">h_wildcard</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>, *<a class=\"id\" href=\"#x0\">x0</a>, *<a class=\"id\" href=\"#to_put\">to_put</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#acquire_in_progress\">acquire_in_progress</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#best\">best</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &amp; <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>;", 
"<span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#encap_family\">encap_family</a> = <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#encap_family\">encap_family</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#encap_family\">encap_family</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a> == <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#reqid\">reqid</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_STATE_WILDRECV\">XFRM_STATE_WILDRECV</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_state_addr_check\">xfrm_state_addr_check</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#mode\">mode</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> || !<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_look_at\">xfrm_state_look_at</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#best\">best</a>, &amp;<a class=\"id\" href=\"#acquire_in_progress\">acquire_in_progress</a>, &amp;<a class=\"id\" href=\"#error\">error</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#best\">best</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#found\">found</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h_wildcard\">h_wildcard</a> = <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#saddr_wildcard\">saddr_wildcard</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h_wildcard\">h_wildcard</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#encap_family\">encap_family</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a> == <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#reqid\">reqid</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_STATE_WILDRECV\">XFRM_STATE_WILDRECV</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_state_addr_check\">xfrm_state_addr_check</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#mode\">mode</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> || !<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_look_at\">xfrm_state_look_at</a>(<a class=\"id\" href=\"#pol\">pol</a>, <a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#best\">best</a>, &amp;<a class=\"id\" href=\"#acquire_in_progress\">acquire_in_progress</a>, &amp;<a class=\"id\" href=\"#error\">error</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#found\">found</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#best\">best</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a> && !<a class=\"id\" href=\"#error\">error</a> && !<a class=\"id\" href=\"#acquire_in_progress\">acquire_in_progress</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#x0\">x0</a> = <a class=\"id\" href=\"#__xfrm_state_lookup\">__xfrm_state_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#tmpl\">tmpl</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>)) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#x0\">x0</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#xfrm_state_alloc\">xfrm_state_alloc</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Initialize temporary state matching only</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * to current session. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_init_tempstate\">xfrm_init_tempstate</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#fl\">fl</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>, &amp;<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mark\">mark</a>, sizeof(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#security_xfrm_state_alloc_acquire\">security_xfrm_state_alloc_acquire</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#security\">security</a>, <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#km_query\">km_query</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#tmpl\">tmpl</a>, <a class=\"id\" href=\"#pol\">pol</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_ACQ\">XFRM_STATE_ACQ</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#all\">all</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_all\">state_all</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_src_hash\">xfrm_src_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bysrc\">bysrc</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_spi_hash\">xfrm_spi_hash</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#encap_family\">encap_family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#byspi\">byspi</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_add_expires_seconds\">hard_add_expires_seconds</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#sysctl_acq_expires\">sysctl_acq_expires</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_start\">tasklet_hrtimer_start</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>, <a class=\"id\" href=\"#ktime_set\">ktime_set</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#sysctl_acq_expires\">sysctl_acq_expires</a>, 0), <a class=\"id\" href=\"#HRTIMER_MODE_REL\">HRTIMER_MODE_REL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_num\">state_num</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_grow_check\">xfrm_hash_grow_check</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>.<a class=\"id\" href=\"#next\">next</a> != <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_DEAD\">XFRM_STATE_DEAD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#acquire_in_progress\">acquire_in_progress</a> ? -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a> : <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#to_put\">to_put</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#to_put\">to_put</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"}", 
"", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *", 
"<a class=\"id\" href=\"#xfrm_stateonly_find\">xfrm_stateonly_find</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>    unsigned short <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#reqid\">reqid</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#rx\">rx</a> = <a class=\"id\" href=\"#NULL\">NULL</a>, *<a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> == <a class=\"id\" href=\"#family\">family</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a> == <a class=\"id\" href=\"#reqid\">reqid</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#XFRM_STATE_WILDRECV\">XFRM_STATE_WILDRECV</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_state_addr_check\">xfrm_state_addr_check</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#mode\">mode</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#proto\">proto</a> == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rx\">rx</a> = <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rx\">rx</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#rx\">rx</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rx\">rx</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_stateonly_find\">xfrm_stateonly_find</a>);", 
"", 
"static void <a class=\"id\" href=\"#__xfrm_state_insert\">__xfrm_state_insert</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#all\">all</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_all\">state_all</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_src_hash\">xfrm_src_hash</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bysrc\">bysrc</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_spi_hash\">xfrm_spi_hash</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#byspi\">byspi</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_byspi\">state_byspi</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_start\">tasklet_hrtimer_start</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>, <a class=\"id\" href=\"#ktime_set\">ktime_set</a>(1, 0), <a class=\"id\" href=\"#HRTIMER_MODE_REL\">HRTIMER_MODE_REL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxage\">replay_maxage</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#rtimer\">rtimer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a> + <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#replay_maxage\">replay_maxage</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wake_up\">wake_up</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#km_waitq\">km_waitq</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_num\">state_num</a>++;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_grow_check\">xfrm_hash_grow_check</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>.<a class=\"id\" href=\"#next\">next</a> != <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"}", 
"", 
"<span class=\"comment\">/* xfrm_state_lock is held */</span>", 
"static void <a class=\"id\" href=\"#__xfrm_state_bump_genids\">__xfrm_state_bump_genids</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#xnew\">xnew</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#xnew\">xnew</a>);", 
"<span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#reqid\">reqid</a> = <a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &amp; <a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a><span class=\"ts\"/>== <a class=\"id\" href=\"#family\">family</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a><span class=\"ts\"/>== <a class=\"id\" href=\"#reqid\">reqid</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) == <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#family\">family</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>, &amp;<a class=\"id\" href=\"#xnew\">xnew</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#genid\">genid</a>++;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"void <a class=\"id\" href=\"#xfrm_state_insert\">xfrm_state_insert</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_state_bump_genids\">__xfrm_state_bump_genids</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_state_insert\">__xfrm_state_insert</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_insert\">xfrm_state_insert</a>);", 
"", 
"<span class=\"comment\">/* xfrm_state_lock is held */</span>", 
"static struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#__find_acq_core\">__find_acq_core</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#xfrm_mark\">xfrm_mark</a> *<a class=\"id\" href=\"#m\">m</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>, int <a class=\"id\" href=\"#create\">create</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#v\">v</a> &amp; <a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#m\">m</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a>  != <a class=\"id\" href=\"#reqid\">reqid</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a>   != <a class=\"id\" href=\"#mode\">mode</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#family\">family</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a>     != <a class=\"id\" href=\"#XFRM_STATE_ACQ\">XFRM_STATE_ACQ</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#spi\">spi</a>       != 0 ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a><span class=\"ts\"/>    != <a class=\"id\" href=\"#proto\">proto</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#mark\">mark</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>) != <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#family\">family</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#create\">create</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#xfrm_state_alloc\">xfrm_state_alloc</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#x\">x</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET\">AF_INET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#daddr\">daddr</a>.<a class=\"id\" href=\"#a4\">a4</a> = <a class=\"id\" href=\"#daddr\">daddr</a>-><a class=\"id\" href=\"#a4\">a4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#saddr\">saddr</a>.<a class=\"id\" href=\"#a4\">a4</a> = <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#a4\">a4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#prefixlen_d\">prefixlen_d</a> = 32;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#prefixlen_s\">prefixlen_s</a> = 32;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>.<a class=\"id\" href=\"#a4\">a4</a> = <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#a4\">a4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>.<a class=\"id\" href=\"#a4\">a4</a> = <a class=\"id\" href=\"#daddr\">daddr</a>-><a class=\"id\" href=\"#a4\">a4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#AF_INET6\">AF_INET6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#daddr\">daddr</a>.<a class=\"id\" href=\"#a6\">a6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#daddr\">daddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#saddr\">saddr</a>.<a class=\"id\" href=\"#a6\">a6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#saddr\">saddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#prefixlen_d\">prefixlen_d</a> = 128;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>.<a class=\"id\" href=\"#prefixlen_s\">prefixlen_s</a> = 128;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>.<a class=\"id\" href=\"#a6\">a6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#saddr\">saddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>((struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>.<a class=\"id\" href=\"#a6\">a6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       (struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *)<a class=\"id\" href=\"#daddr\">daddr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_ACQ\">XFRM_STATE_ACQ</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a> = <a class=\"id\" href=\"#reqid\">reqid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> = <a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#v\">v</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a> = <a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#m\">m</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_add_expires_seconds\">hard_add_expires_seconds</a> = <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#sysctl_acq_expires\">sysctl_acq_expires</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_hold\">xfrm_state_hold</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_start\">tasklet_hrtimer_start</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>, <a class=\"id\" href=\"#ktime_set\">ktime_set</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#sysctl_acq_expires\">sysctl_acq_expires</a>, 0), <a class=\"id\" href=\"#HRTIMER_MODE_REL\">HRTIMER_MODE_REL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#all\">all</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_all\">state_all</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_src_hash\">xfrm_src_hash</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_add_head\">hlist_add_head</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bysrc\">bysrc</a>, <a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bysrc\">state_bysrc</a>+<a class=\"id\" href=\"#h\">h</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_num\">state_num</a>++;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_hash_grow_check\">xfrm_hash_grow_check</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#bydst\">bydst</a>.<a class=\"id\" href=\"#next\">next</a> != <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#__xfrm_find_acq_byseq\">__xfrm_find_acq_byseq</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_add\">xfrm_state_add</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x1\">x1</a>, *<a class=\"id\" href=\"#to_put\">to_put</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#v\">v</a> &amp; <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>.<a class=\"id\" href=\"#m\">m</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#use_spi\">use_spi</a> = <a class=\"id\" href=\"#xfrm_id_proto_match\">xfrm_id_proto_match</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#IPSEC_PROTO_ANY\">IPSEC_PROTO_ANY</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x1\">x1</a> = <a class=\"id\" href=\"#__xfrm_state_locate\">__xfrm_state_locate</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#use_spi\">use_spi</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x1\">x1</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#x1\">x1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x1\">x1</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#use_spi\">use_spi</a> && <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#seq\">seq</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x1\">x1</a> = <a class=\"id\" href=\"#__xfrm_find_acq_byseq\">__xfrm_find_acq_byseq</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#seq\">seq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x1\">x1</a> && ((<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a> != <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#xfrm_addr_cmp\">xfrm_addr_cmp</a>(&amp;<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#family\">family</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#x1\">x1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x1\">x1</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#use_spi\">use_spi</a> && !<a class=\"id\" href=\"#x1\">x1</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x1\">x1</a> = <a class=\"id\" href=\"#__find_acq_core\">__find_acq_core</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#family\">family</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#daddr\">daddr</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>, 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_state_bump_genids\">__xfrm_state_bump_genids</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_state_insert\">__xfrm_state_insert</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x1\">x1</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_delete\">xfrm_state_delete</a>(<a class=\"id\" href=\"#x1\">x1</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x1\">x1</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#to_put\">to_put</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#to_put\">to_put</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_add\">xfrm_state_add</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_XFRM_MIGRATE\">CONFIG_XFRM_MIGRATE</a>", 
"static struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#xfrm_state_clone\">xfrm_state_clone</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#orig\">orig</a>, int *<a class=\"id\" href=\"#errp\">errp</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#xs_net\">xs_net</a>(<a class=\"id\" href=\"#orig\">orig</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#xfrm_state_alloc\">xfrm_state_alloc</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>, &amp;<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#id\">id</a>, sizeof(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>, &amp;<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#sel\">sel</a>, sizeof(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>, &amp;<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#lft\">lft</a>, sizeof(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#replay_window\">replay_window</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#replay_window\">replay_window</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#reqid\">reqid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#saddr\">saddr</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#aalg\">aalg</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#aalg\">aalg</a> = <a class=\"id\" href=\"#xfrm_algo_auth_clone\">xfrm_algo_auth_clone</a>(<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#aalg\">aalg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#aalg\">aalg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#aalgo\">aalgo</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#aalgo\">aalgo</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#ealg\">ealg</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#ealg\">ealg</a> = <a class=\"id\" href=\"#xfrm_algo_clone\">xfrm_algo_clone</a>(<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#ealg\">ealg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#ealg\">ealg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#ealgo\">ealgo</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#ealgo\">ealgo</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#calg\">calg</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#calg\">calg</a> = <a class=\"id\" href=\"#xfrm_algo_clone\">xfrm_algo_clone</a>(<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#calg\">calg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#calg\">calg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#calgo\">calgo</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#calgo\">calgo</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#encap\">encap</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#encap\">encap</a> = <a class=\"id\" href=\"#kmemdup\">kmemdup</a>(<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#encap\">encap</a>, sizeof(*<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#encap\">encap</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#encap\">encap</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a> = <a class=\"id\" href=\"#kmemdup\">kmemdup</a>(<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>, sizeof(*<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>, &amp;<a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#mark\">mark</a>, sizeof(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mark\">mark</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#xfrm_init_state\">xfrm_init_state</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#add_time\">add_time</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#orig\">orig</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#seq\">seq</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"", 
" <a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#errp\">errp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#errp\">errp</a> = <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"<span class=\"comment\">/* xfrm_state_lock is held */</span>", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> * <a class=\"id\" href=\"#xfrm_migrate_state_find\">xfrm_migrate_state_find</a>(struct <a class=\"id\" href=\"#xfrm_migrate\">xfrm_migrate</a> *<a class=\"id\" href=\"#m\">m</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#reqid\">reqid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#xfrm_dst_hash\">xfrm_dst_hash</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, &amp;<a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#old_daddr\">old_daddr</a>, &amp;<a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#old_saddr\">old_saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#old_family\">old_family</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#init_net\">init_net</a>.<a class=\"id\" href=\"#xfrm\">xfrm</a>.<a class=\"id\" href=\"#state_bydst\">state_bydst</a>+<a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#bydst\">bydst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#m\">m</a>-><a class=\"id\" href=\"#mode\">mode</a> ||", 
];
xr_frag_insert('l/96/ac91479c838179831d7e32f21e1466f8f339da.xr', __xr_tmp);
