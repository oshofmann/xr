var __xr_tmp = [
"<span class=\"ts\"/>return <a class=\"id\" href=\"#xc\">xc</a>;", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#xc\">xc</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_migrate\">xfrm_state_migrate</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_update\">xfrm_state_update</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x1\">x1</a>, *<a class=\"id\" href=\"#to_put\">to_put</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#use_spi\">use_spi</a> = <a class=\"id\" href=\"#xfrm_id_proto_match\">xfrm_id_proto_match</a>(<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#id\">id</a>.<a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#IPSEC_PROTO_ANY\">IPSEC_PROTO_ANY</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x1\">x1</a> = <a class=\"id\" href=\"#__xfrm_state_locate\">__xfrm_state_locate</a>(<a class=\"id\" href=\"#x\">x</a>, <a class=\"id\" href=\"#use_spi\">use_spi</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#props\">props</a>.<a class=\"id\" href=\"#family\">family</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#x1\">x1</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#xfrm_state_kern\">xfrm_state_kern</a>(<a class=\"id\" href=\"#x1\">x1</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_put\">to_put</a> = <a class=\"id\" href=\"#x1\">x1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EEXIST\">EEXIST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_ACQ\">XFRM_STATE_ACQ</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__xfrm_state_insert\">__xfrm_state_insert</a>(<a class=\"id\" href=\"#x\">x</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#to_put\">to_put</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#to_put\">to_put</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_delete\">xfrm_state_delete</a>(<a class=\"id\" href=\"#x1\">x1</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x1\">x1</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#encap\">encap</a> && <a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#encap\">encap</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#encap\">encap</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#encap\">encap</a>, sizeof(*<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#encap\">encap</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a> && <a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>, <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>, sizeof(*<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#coaddr\">coaddr</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#use_spi\">use_spi</a> && <a class=\"id\" href=\"#memcmp\">memcmp</a>(&amp;<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#sel\">sel</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>, sizeof(<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#sel\">sel</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#sel\">sel</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#sel\">sel</a>, sizeof(<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#sel\">sel</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#lft\">lft</a>, &amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>, sizeof(<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#lft\">lft</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_start\">tasklet_hrtimer_start</a>(&amp;<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>, <a class=\"id\" href=\"#ktime_set\">ktime_set</a>(1, 0), <a class=\"id\" href=\"#HRTIMER_MODE_REL\">HRTIMER_MODE_REL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_check_expire\">xfrm_state_check_expire</a>(<a class=\"id\" href=\"#x1\">x1</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#x1\">x1</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#xfrm_state_put\">xfrm_state_put</a>(<a class=\"id\" href=\"#x1\">x1</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_update\">xfrm_state_update</a>);", 
"", 
"int <a class=\"id\" href=\"#xfrm_state_check_expire\">xfrm_state_check_expire</a>(struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>)", 
"{", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#use_time\">use_time</a> = <a class=\"id\" href=\"#get_seconds\">get_seconds</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> != <a class=\"id\" href=\"#XFRM_STATE_VALID\">XFRM_STATE_VALID</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#bytes\">bytes</a> >= <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_byte_limit\">hard_byte_limit</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#packets\">packets</a> >= <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#hard_packet_limit\">hard_packet_limit</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#XFRM_STATE_EXPIRED\">XFRM_STATE_EXPIRED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tasklet_hrtimer_start\">tasklet_hrtimer_start</a>(&amp;<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#mtimer\">mtimer</a>, <a class=\"id\" href=\"#ktime_set\">ktime_set</a>(0,0), <a class=\"id\" href=\"#HRTIMER_MODE_REL\">HRTIMER_MODE_REL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> &&", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#bytes\">bytes</a> >= <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_byte_limit\">soft_byte_limit</a> ||", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#curlft\">curlft</a>.<a class=\"id\" href=\"#packets\">packets</a> >= <a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#lft\">lft</a>.<a class=\"id\" href=\"#soft_packet_limit\">soft_packet_limit</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a>-><a class=\"id\" href=\"#km\">km</a>.<a class=\"id\" href=\"#dying\">dying</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#km_state_expired\">km_state_expired</a>(<a class=\"id\" href=\"#x\">x</a>, 0, 0);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_check_expire\">xfrm_state_check_expire</a>);", 
"", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *", 
"<a class=\"id\" href=\"#xfrm_state_lookup\">xfrm_state_lookup</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#spi\">spi</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#__xfrm_state_lookup\">__xfrm_state_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#spi\">spi</a>, <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_lookup\">xfrm_state_lookup</a>);", 
"", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *", 
"<a class=\"id\" href=\"#xfrm_state_lookup_byaddr\">xfrm_state_lookup_byaddr</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mark\">mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x\">x</a> = <a class=\"id\" href=\"#__xfrm_state_lookup_byaddr\">__xfrm_state_lookup_byaddr</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#saddr\">saddr</a>, <a class=\"id\" href=\"#proto\">proto</a>, <a class=\"id\" href=\"#family\">family</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#xfrm_state_lock\">xfrm_state_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#x\">x</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#xfrm_state_lookup_byaddr\">xfrm_state_lookup_byaddr</a>);", 
"", 
"struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *", 
"<a class=\"id\" href=\"#xfrm_find_acq\">xfrm_find_acq</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#xfrm_mark\">xfrm_mark</a> *<a class=\"id\" href=\"#mark\">mark</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#reqid\">reqid</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#proto\">proto</a>,", 
"<span class=\"ts\"/>      <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#daddr\">daddr</a>, <a class=\"id\" href=\"#xfrm_address_t\">xfrm_address_t</a> *<a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/>      int <a class=\"id\" href=\"#create\">create</a>, unsigned short <a class=\"id\" href=\"#family\">family</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#xfrm_state\">xfrm_state</a> *<a class=\"id\" href=\"#x\">x</a>;", 
];
xr_frag_insert('l/97/8dbda81011c6af2431b28f8518387ab6daeca4.xr', __xr_tmp);
