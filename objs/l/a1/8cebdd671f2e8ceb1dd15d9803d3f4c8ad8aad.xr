var __xr_tmp = [
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_push\">skb_push</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> - <a class=\"id\" href=\"#skb_mac_header\">skb_mac_header</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>The SOCK_PACKET socket receives _all_ frames.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spkt\">spkt</a>-><a class=\"id\" href=\"#spkt_family\">spkt_family</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strlcpy\">strlcpy</a>(<a class=\"id\" href=\"#spkt\">spkt</a>-><a class=\"id\" href=\"#spkt_device\">spkt_device</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, sizeof(<a class=\"id\" href=\"#spkt\">spkt</a>-><a class=\"id\" href=\"#spkt_device\">spkt_device</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spkt\">spkt</a>-><a class=\"id\" href=\"#spkt_protocol\">spkt_protocol</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Charge the memory to the socket. This is done specifically</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>to prevent sockets using all the memory up.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock_queue_rcv_skb\">sock_queue_rcv_skb</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#oom\">oom</a>:", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Output a raw packet to a device layer. This bypasses all the other</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>protocol layers and you must therefore supply it with a complete frame</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#packet_sendmsg_spkt\">packet_sendmsg_spkt</a>(struct <a class=\"id\" href=\"#kiocb\">kiocb</a> *<a class=\"id\" href=\"#iocb\">iocb</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_pkt\">sockaddr_pkt</a> *<a class=\"id\" href=\"#saddr\">saddr</a> = (struct <a class=\"id\" href=\"#sockaddr_pkt\">sockaddr_pkt</a> *)<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#proto\">proto</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Get and verify the address.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#saddr\">saddr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> &lt; sizeof(struct <a class=\"id\" href=\"#sockaddr\">sockaddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> == sizeof(struct <a class=\"id\" href=\"#sockaddr_pkt\">sockaddr_pkt</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#spkt_protocol\">spkt_protocol</a>;", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOTCONN\">ENOTCONN</a>;<span class=\"ts\"/><span class=\"comment\">/* SOCK_PACKET must be sent giving an address */</span>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Find the device first to size check it</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#spkt_device\">spkt_device</a>[13] = 0;", 
"<a class=\"id\" href=\"#retry\">retry</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_name_rcu\">dev_get_by_name_rcu</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#spkt_device\">spkt_device</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENETDOWN\">ENETDOWN</a>;", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFF_UP\">IFF_UP</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * You may not queue a frame bigger than the mtu. This is the lowest level</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * raw protocol and you must do your own fragmentation at this level.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &gt; <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a> + <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#reserved\">reserved</a> = <a class=\"id\" href=\"#LL_RESERVED_SPACE\">LL_RESERVED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#hhlen\">hhlen</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#header_ops\">header_ops</a> ? <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a> : 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#sock_wmalloc\">sock_wmalloc</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#len\">len</a> + <a class=\"id\" href=\"#reserved\">reserved</a>, 0, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* FIXME: Save some space for broken drivers that write a hard</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * header at transmission time by themselves. PPP is the notable</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * one here. This should really be fixed at the driver level.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_reserve\">skb_reserve</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#reserved\">reserved</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_reset_network_header\">skb_reset_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Try to align data part correctly */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#hhlen\">hhlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> -= <a class=\"id\" href=\"#hhlen\">hhlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tail\">tail</a> -= <a class=\"id\" href=\"#hhlen\">hhlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; <a class=\"id\" href=\"#hhlen\">hhlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_reset_network_header\">skb_reset_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#memcpy_fromiovec\">memcpy_fromiovec</a>(<a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#len\">len</a>), <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#retry\">retry</a>;", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#priority\">priority</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_priority\">sk_priority</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_mark\">sk_mark</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#sock_tx_timestamp\">sock_tx_timestamp</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb_tx\">skb_tx</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_queue_xmit\">dev_queue_xmit</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<a class=\"id\" href=\"#out_free\">out_free</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned int <a class=\"id\" href=\"#run_filter\">run_filter</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      unsigned int <a class=\"id\" href=\"#res\">res</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_filter\">sk_filter</a> *<a class=\"id\" href=\"#filter\">filter</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock_bh\">rcu_read_lock_bh</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#filter\">filter</a> = <a class=\"id\" href=\"#rcu_dereference_bh\">rcu_dereference_bh</a>(<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_filter\">sk_filter</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#filter\">filter</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#sk_run_filter\">sk_run_filter</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#filter\">filter</a>-><a class=\"id\" href=\"#insns\">insns</a>, <a class=\"id\" href=\"#filter\">filter</a>-><a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock_bh\">rcu_read_unlock_bh</a>();", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\">   This function makes lazy skb cloning in hope that most of packets</span>", 
"<span class=\"comment\">   are discarded by BPF.</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\">   Note tricky part: we DO mangle shared skb! skb-&gt;data, skb-&gt;len</span>", 
"<span class=\"comment\">   and skb-&gt;cb are mangled. It works because (and until) packets</span>", 
"<span class=\"comment\">   falling here are owned by current CPU. Output packets are cloned</span>", 
"<span class=\"comment\">   by dev_queue_xmit_nit(), input packets are processed by net_bh</span>", 
"<span class=\"comment\">   sequencially, so that if we return skb to original state on exit,</span>", 
"<span class=\"comment\">   we will not harm anyone.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#packet_rcv\">packet_rcv</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#packet_type\">packet_type</a> *<a class=\"id\" href=\"#pt\">pt</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#orig_dev\">orig_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *<a class=\"id\" href=\"#sll\">sll</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#skb_head\">skb_head</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#skb_len\">skb_len</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#snaplen\">snaplen</a>, <a class=\"id\" href=\"#res\">res</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a> == <a class=\"id\" href=\"#PACKET_LOOPBACK\">PACKET_LOOPBACK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop\">drop</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#pt\">pt</a>-><a class=\"id\" href=\"#af_packet_priv\">af_packet_priv</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#net_eq\">net_eq</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop\">drop</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#header_ops\">header_ops</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* The device has an explicit notion of ll header,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   exported to higher levels.</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   Otherwise, the device hides datails of it frame</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   structure, so that corresponding packet head</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   never delivered to user.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_type\">sk_type</a> != <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_push\">skb_push</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> - <a class=\"id\" href=\"#skb_mac_header\">skb_mac_header</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a> == <a class=\"id\" href=\"#PACKET_OUTGOING\">PACKET_OUTGOING</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Special case: outgoing packets have ll header at head */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_pull\">skb_pull</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb_network_offset\">skb_network_offset</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#snaplen\">snaplen</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#run_filter\">run_filter</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#snaplen\">snaplen</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#res\">res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop_n_restore\">drop_n_restore</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#snaplen\">snaplen</a> &gt; <a class=\"id\" href=\"#res\">res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snaplen\">snaplen</a> = <a class=\"id\" href=\"#res\">res</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_rmem_alloc\">sk_rmem_alloc</a>) + <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#truesize\">truesize</a> >=", 
"<span class=\"ts\"/>    (unsigned)<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_rcvbuf\">sk_rcvbuf</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop_n_acct\">drop_n_acct</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_shared\">skb_shared</a>(<a class=\"id\" href=\"#skb\">skb</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#nskb\">nskb</a> = <a class=\"id\" href=\"#skb_clone\">skb_clone</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nskb\">nskb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop_n_acct\">drop_n_acct</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_head\">skb_head</a> != <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#skb_head\">skb_head</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#skb_len\">skb_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#nskb\">nskb</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUILD_BUG_ON\">BUILD_BUG_ON</a>(sizeof(*<a class=\"id\" href=\"#PACKET_SKB_CB\">PACKET_SKB_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>)) + <a class=\"id\" href=\"#MAX_ADDR_LEN\">MAX_ADDR_LEN</a> - 8 &gt;", 
"<span class=\"ts\"/><span class=\"ts\"/>     sizeof(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#cb\">cb</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a> = &amp;<a class=\"id\" href=\"#PACKET_SKB_CB\">PACKET_SKB_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#sa\">sa</a>.<a class=\"id\" href=\"#ll\">ll</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_family\">sll_family</a> = <a class=\"id\" href=\"#AF_PACKET\">AF_PACKET</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_hatype\">sll_hatype</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_protocol\">sll_protocol</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_pkttype\">sll_pkttype</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#origdev\">origdev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a> = <a class=\"id\" href=\"#orig_dev\">orig_dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a> = <a class=\"id\" href=\"#dev_parse_header\">dev_parse_header</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_addr\">sll_addr</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#PACKET_SKB_CB\">PACKET_SKB_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#origlen\">origlen</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pskb_trim\">pskb_trim</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#snaplen\">snaplen</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop_n_acct\">drop_n_acct</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_set_owner_r\">skb_set_owner_r</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_drop\">skb_dst_drop</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* drop conntrack reference */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nf_reset\">nf_reset</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#tp_packets\">tp_packets</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dropcount\">dropcount</a> = <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_drops\">sk_drops</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__skb_queue_tail\">__skb_queue_tail</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_data_ready\">sk_data_ready</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#drop_n_acct\">drop_n_acct</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#tp_drops\">tp_drops</a> = <a class=\"id\" href=\"#atomic_inc_return\">atomic_inc_return</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_drops\">sk_drops</a>);", 
"", 
"<a class=\"id\" href=\"#drop_n_restore\">drop_n_restore</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_head\">skb_head</a> != <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> && <a class=\"id\" href=\"#skb_shared\">skb_shared</a>(<a class=\"id\" href=\"#skb\">skb</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#skb_head\">skb_head</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#skb_len\">skb_len</a>;", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#drop\">drop</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#consume_skb\">consume_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tpacket_rcv\">tpacket_rcv</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#packet_type\">packet_type</a> *<a class=\"id\" href=\"#pt\">pt</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#orig_dev\">orig_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *<a class=\"id\" href=\"#sll\">sll</a>;", 
"<span class=\"ts\"/>union {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#tpacket_hdr\">tpacket_hdr</a> *<a class=\"id\" href=\"#h1\">h1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#tpacket2_hdr\">tpacket2_hdr</a> *<a class=\"id\" href=\"#h2\">h2</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>void *<a class=\"id\" href=\"#raw\">raw</a>;", 
"<span class=\"ts\"/>} <a class=\"id\" href=\"#h\">h</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#skb_head\">skb_head</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#skb_len\">skb_len</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#snaplen\">snaplen</a>, <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#TP_STATUS_LOSING\">TP_STATUS_LOSING</a>|<a class=\"id\" href=\"#TP_STATUS_USER\">TP_STATUS_USER</a>;", 
"<span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#macoff\">macoff</a>, <a class=\"id\" href=\"#netoff\">netoff</a>, <a class=\"id\" href=\"#hdrlen\">hdrlen</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#copy_skb\">copy_skb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#timeval\">timeval</a> <a class=\"id\" href=\"#tv\">tv</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#timespec\">timespec</a> <a class=\"id\" href=\"#ts\">ts</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#skb_shared_hwtstamps\">skb_shared_hwtstamps</a> *<a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a> = <a class=\"id\" href=\"#skb_hwtstamps\">skb_hwtstamps</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a> == <a class=\"id\" href=\"#PACKET_LOOPBACK\">PACKET_LOOPBACK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop\">drop</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#pt\">pt</a>-><a class=\"id\" href=\"#af_packet_priv\">af_packet_priv</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#net_eq\">net_eq</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop\">drop</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#header_ops\">header_ops</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_type\">sk_type</a> != <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_push\">skb_push</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> - <a class=\"id\" href=\"#skb_mac_header\">skb_mac_header</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a> == <a class=\"id\" href=\"#PACKET_OUTGOING\">PACKET_OUTGOING</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Special case: outgoing packets have ll header at head */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_pull\">skb_pull</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#skb_network_offset\">skb_network_offset</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ip_summed\">ip_summed</a> == <a class=\"id\" href=\"#CHECKSUM_PARTIAL\">CHECKSUM_PARTIAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> |= <a class=\"id\" href=\"#TP_STATUS_CSUMNOTREADY\">TP_STATUS_CSUMNOTREADY</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#snaplen\">snaplen</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = <a class=\"id\" href=\"#run_filter\">run_filter</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#snaplen\">snaplen</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#res\">res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#drop_n_restore\">drop_n_restore</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#snaplen\">snaplen</a> &gt; <a class=\"id\" href=\"#res\">res</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snaplen\">snaplen</a> = <a class=\"id\" href=\"#res\">res</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_type\">sk_type</a> == <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#macoff\">macoff</a> = <a class=\"id\" href=\"#netoff\">netoff</a> = <a class=\"id\" href=\"#TPACKET_ALIGN\">TPACKET_ALIGN</a>(<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_hdrlen\">tp_hdrlen</a>) + 16 +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_reserve\">tp_reserve</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned <a class=\"id\" href=\"#maclen\">maclen</a> = <a class=\"id\" href=\"#skb_network_offset\">skb_network_offset</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netoff\">netoff</a> = <a class=\"id\" href=\"#TPACKET_ALIGN\">TPACKET_ALIGN</a>(<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_hdrlen\">tp_hdrlen</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       (<a class=\"id\" href=\"#maclen\">maclen</a> &lt; 16 ? 16 : <a class=\"id\" href=\"#maclen\">maclen</a>)) +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_reserve\">tp_reserve</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#macoff\">macoff</a> = <a class=\"id\" href=\"#netoff\">netoff</a> - <a class=\"id\" href=\"#maclen\">maclen</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#macoff\">macoff</a> + <a class=\"id\" href=\"#snaplen\">snaplen</a> &gt; <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>.<a class=\"id\" href=\"#frame_size\">frame_size</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#copy_thresh\">copy_thresh</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_rmem_alloc\">sk_rmem_alloc</a>) + <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#truesize\">truesize</a> &lt;", 
"<span class=\"ts\"/><span class=\"ts\"/>    (unsigned)<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_rcvbuf\">sk_rcvbuf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_shared\">skb_shared</a>(<a class=\"id\" href=\"#skb\">skb</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#copy_skb\">copy_skb</a> = <a class=\"id\" href=\"#skb_clone\">skb_clone</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#copy_skb\">copy_skb</a> = <a class=\"id\" href=\"#skb_get\">skb_get</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_head\">skb_head</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_skb\">copy_skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_set_owner_r\">skb_set_owner_r</a>(<a class=\"id\" href=\"#copy_skb\">copy_skb</a>, <a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snaplen\">snaplen</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>.<a class=\"id\" href=\"#frame_size\">frame_size</a> - <a class=\"id\" href=\"#macoff\">macoff</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((int)<a class=\"id\" href=\"#snaplen\">snaplen</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snaplen\">snaplen</a> = 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#raw\">raw</a> = <a class=\"id\" href=\"#packet_current_frame\">packet_current_frame</a>(<a class=\"id\" href=\"#po\">po</a>, &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>, <a class=\"id\" href=\"#TP_STATUS_KERNEL\">TP_STATUS_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#raw\">raw</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#ring_is_full\">ring_is_full</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#packet_increment_head\">packet_increment_head</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#tp_packets\">tp_packets</a>++;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_skb\">copy_skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> |= <a class=\"id\" href=\"#TP_STATUS_COPY\">TP_STATUS_COPY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__skb_queue_tail\">__skb_queue_tail</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>, <a class=\"id\" href=\"#copy_skb\">copy_skb</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#tp_drops\">tp_drops</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> &= ~<a class=\"id\" href=\"#TP_STATUS_LOSING\">TP_STATUS_LOSING</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_copy_bits\">skb_copy_bits</a>(<a class=\"id\" href=\"#skb\">skb</a>, 0, <a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#raw\">raw</a> + <a class=\"id\" href=\"#macoff\">macoff</a>, <a class=\"id\" href=\"#snaplen\">snaplen</a>);", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_version\">tp_version</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TPACKET_V1\">TPACKET_V1</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h1\">h1</a>-><a class=\"id\" href=\"#tp_len\">tp_len</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h1\">h1</a>-><a class=\"id\" href=\"#tp_snaplen\">tp_snaplen</a> = <a class=\"id\" href=\"#snaplen\">snaplen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h1\">h1</a>-><a class=\"id\" href=\"#tp_mac\">tp_mac</a> = <a class=\"id\" href=\"#macoff\">macoff</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h1\">h1</a>-><a class=\"id\" href=\"#tp_net\">tp_net</a> = <a class=\"id\" href=\"#netoff\">netoff</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_tstamp\">tp_tstamp</a> &amp; <a class=\"id\" href=\"#SOF_TIMESTAMPING_SYS_HARDWARE\">SOF_TIMESTAMPING_SYS_HARDWARE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&& <a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#syststamp\">syststamp</a>.<a class=\"id\" href=\"#tv64\">tv64</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tv\">tv</a> = <a class=\"id\" href=\"#ktime_to_timeval\">ktime_to_timeval</a>(<a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#syststamp\">syststamp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else if ((<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_tstamp\">tp_tstamp</a> &amp; <a class=\"id\" href=\"#SOF_TIMESTAMPING_RAW_HARDWARE\">SOF_TIMESTAMPING_RAW_HARDWARE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&& <a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#hwtstamp\">hwtstamp</a>.<a class=\"id\" href=\"#tv64\">tv64</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tv\">tv</a> = <a class=\"id\" href=\"#ktime_to_timeval\">ktime_to_timeval</a>(<a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#hwtstamp\">hwtstamp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tstamp\">tstamp</a>.<a class=\"id\" href=\"#tv64\">tv64</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tv\">tv</a> = <a class=\"id\" href=\"#ktime_to_timeval\">ktime_to_timeval</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tstamp\">tstamp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#do_gettimeofday\">do_gettimeofday</a>(&amp;<a class=\"id\" href=\"#tv\">tv</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h1\">h1</a>-><a class=\"id\" href=\"#tp_sec\">tp_sec</a> = <a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_sec\">tv_sec</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h1\">h1</a>-><a class=\"id\" href=\"#tp_usec\">tp_usec</a> = <a class=\"id\" href=\"#tv\">tv</a>.<a class=\"id\" href=\"#tv_usec\">tv_usec</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hdrlen\">hdrlen</a> = sizeof(*<a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h1\">h1</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TPACKET_V2\">TPACKET_V2</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_len\">tp_len</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_snaplen\">tp_snaplen</a> = <a class=\"id\" href=\"#snaplen\">snaplen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_mac\">tp_mac</a> = <a class=\"id\" href=\"#macoff\">macoff</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_net\">tp_net</a> = <a class=\"id\" href=\"#netoff\">netoff</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_tstamp\">tp_tstamp</a> &amp; <a class=\"id\" href=\"#SOF_TIMESTAMPING_SYS_HARDWARE\">SOF_TIMESTAMPING_SYS_HARDWARE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&& <a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#syststamp\">syststamp</a>.<a class=\"id\" href=\"#tv64\">tv64</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#ktime_to_timespec\">ktime_to_timespec</a>(<a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#syststamp\">syststamp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else if ((<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_tstamp\">tp_tstamp</a> &amp; <a class=\"id\" href=\"#SOF_TIMESTAMPING_RAW_HARDWARE\">SOF_TIMESTAMPING_RAW_HARDWARE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&& <a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#hwtstamp\">hwtstamp</a>.<a class=\"id\" href=\"#tv64\">tv64</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#ktime_to_timespec\">ktime_to_timespec</a>(<a class=\"id\" href=\"#shhwtstamps\">shhwtstamps</a>-><a class=\"id\" href=\"#hwtstamp\">hwtstamp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tstamp\">tstamp</a>.<a class=\"id\" href=\"#tv64\">tv64</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ts\">ts</a> = <a class=\"id\" href=\"#ktime_to_timespec\">ktime_to_timespec</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tstamp\">tstamp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#getnstimeofday\">getnstimeofday</a>(&amp;<a class=\"id\" href=\"#ts\">ts</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_sec\">tp_sec</a> = <a class=\"id\" href=\"#ts\">ts</a>.<a class=\"id\" href=\"#tv_sec\">tv_sec</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_nsec\">tp_nsec</a> = <a class=\"id\" href=\"#ts\">ts</a>.<a class=\"id\" href=\"#tv_nsec\">tv_nsec</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_vlan_tci\">tp_vlan_tci</a> = <a class=\"id\" href=\"#vlan_tx_tag_get\">vlan_tx_tag_get</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hdrlen\">hdrlen</a> = sizeof(*<a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#h2\">h2</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a> = <a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#raw\">raw</a> + <a class=\"id\" href=\"#TPACKET_ALIGN\">TPACKET_ALIGN</a>(<a class=\"id\" href=\"#hdrlen\">hdrlen</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a> = <a class=\"id\" href=\"#dev_parse_header\">dev_parse_header</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_addr\">sll_addr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_family\">sll_family</a> = <a class=\"id\" href=\"#AF_PACKET\">AF_PACKET</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_hatype\">sll_hatype</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_protocol\">sll_protocol</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_pkttype\">sll_pkttype</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#origdev\">origdev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a> = <a class=\"id\" href=\"#orig_dev\">orig_dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__packet_set_status\">__packet_set_status</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#raw\">raw</a>, <a class=\"id\" href=\"#status\">status</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#smp_mb\">smp_mb</a>();", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#page\">page</a> *<a class=\"id\" href=\"#p_start\">p_start</a>, *<a class=\"id\" href=\"#p_end\">p_end</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#h_end\">h_end</a> = <a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#raw\">raw</a> + <a class=\"id\" href=\"#macoff\">macoff</a> + <a class=\"id\" href=\"#snaplen\">snaplen</a> - 1;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_start\">p_start</a> = <a class=\"id\" href=\"#virt_to_page\">virt_to_page</a>(<a class=\"id\" href=\"#h\">h</a>.<a class=\"id\" href=\"#raw\">raw</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_end\">p_end</a> = <a class=\"id\" href=\"#virt_to_page\">virt_to_page</a>(<a class=\"id\" href=\"#h_end\">h_end</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>while (<a class=\"id\" href=\"#p_start\">p_start</a> <= <a class=\"id\" href=\"#p_end\">p_end</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flush_dcache_page\">flush_dcache_page</a>(<a class=\"id\" href=\"#p_start\">p_start</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p_start\">p_start</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_data_ready\">sk_data_ready</a>(<a class=\"id\" href=\"#sk\">sk</a>, 0);", 
"", 
"<a class=\"id\" href=\"#drop_n_restore\">drop_n_restore</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_head\">skb_head</a> != <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> && <a class=\"id\" href=\"#skb_shared\">skb_shared</a>(<a class=\"id\" href=\"#skb\">skb</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#skb_head\">skb_head</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#skb_len\">skb_len</a>;", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#drop\">drop</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#ring_is_full\">ring_is_full</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#stats\">stats</a>.<a class=\"id\" href=\"#tp_drops\">tp_drops</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_data_ready\">sk_data_ready</a>(<a class=\"id\" href=\"#sk\">sk</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#copy_skb\">copy_skb</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#drop_n_restore\">drop_n_restore</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#tpacket_destruct_skb\">tpacket_destruct_skb</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#ph\">ph</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ph\">ph</a> = <a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#destructor_arg\">destructor_arg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#__packet_get_status\">__packet_get_status</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#ph\">ph</a>) != <a class=\"id\" href=\"#TP_STATUS_SENDING\">TP_STATUS_SENDING</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pending\">pending</a>) == 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_dec\">atomic_dec</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pending\">pending</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__packet_set_status\">__packet_set_status</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#ph\">ph</a>, <a class=\"id\" href=\"#TP_STATUS_AVAILABLE\">TP_STATUS_AVAILABLE</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_wfree\">sock_wfree</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tpacket_fill_skb\">tpacket_fill_skb</a>(struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>void *<a class=\"id\" href=\"#frame\">frame</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, int <a class=\"id\" href=\"#size_max\">size_max</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#proto\">proto</a>, unsigned char *<a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>union {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#tpacket_hdr\">tpacket_hdr</a> *<a class=\"id\" href=\"#h1\">h1</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#tpacket2_hdr\">tpacket2_hdr</a> *<a class=\"id\" href=\"#h2\">h2</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>void *<a class=\"id\" href=\"#raw\">raw</a>;", 
"<span class=\"ts\"/>} <a class=\"id\" href=\"#ph\">ph</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#to_write\">to_write</a>, <a class=\"id\" href=\"#offset\">offset</a>, <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#tp_len\">tp_len</a>, <a class=\"id\" href=\"#nr_frags\">nr_frags</a>, <a class=\"id\" href=\"#len_max\">len_max</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#sk\">sk</a>.<a class=\"id\" href=\"#sk_socket\">sk_socket</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#page\">page</a> *<a class=\"id\" href=\"#page\">page</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ph\">ph</a>.<a class=\"id\" href=\"#raw\">raw</a> = <a class=\"id\" href=\"#frame\">frame</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#priority\">priority</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#sk\">sk</a>.<a class=\"id\" href=\"#sk_priority\">sk_priority</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#sk\">sk</a>.<a class=\"id\" href=\"#sk_mark\">sk_mark</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#destructor_arg\">destructor_arg</a> = <a class=\"id\" href=\"#ph\">ph</a>.<a class=\"id\" href=\"#raw\">raw</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_version\">tp_version</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TPACKET_V2\">TPACKET_V2</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tp_len\">tp_len</a> = <a class=\"id\" href=\"#ph\">ph</a>.<a class=\"id\" href=\"#h2\">h2</a>-><a class=\"id\" href=\"#tp_len\">tp_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tp_len\">tp_len</a> = <a class=\"id\" href=\"#ph\">ph</a>.<a class=\"id\" href=\"#h1\">h1</a>-><a class=\"id\" href=\"#tp_len\">tp_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#tp_len\">tp_len</a> &gt; <a class=\"id\" href=\"#size_max\">size_max</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pr_err\">pr_err</a>(\"packet size is too long (%d > %d)\\n\", <a class=\"id\" href=\"#tp_len\">tp_len</a>, <a class=\"id\" href=\"#size_max\">size_max</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reserve\">skb_reserve</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#LL_RESERVED_SPACE\">LL_RESERVED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reset_network_header\">skb_reset_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#ph\">ph</a>.<a class=\"id\" href=\"#raw\">raw</a> + <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_hdrlen\">tp_hdrlen</a> - sizeof(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#to_write\">to_write</a> = <a class=\"id\" href=\"#tp_len\">tp_len</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#dev_hard_header\">dev_hard_header</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#proto\">proto</a>), <a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#tp_len\">tp_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#err\">err</a> &lt; 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* net device doesn't like empty head */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#tp_len\">tp_len</a> <= <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pr_err\">pr_err</a>(\"packet size is too short (%d < %d)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#tp_len\">tp_len</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_push\">skb_push</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#skb_store_bits\">skb_store_bits</a>(<a class=\"id\" href=\"#skb\">skb</a>, 0, <a class=\"id\" href=\"#data\">data</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#err\">err</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> += <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_write\">to_write</a> -= <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#page\">page</a> = <a class=\"id\" href=\"#virt_to_page\">virt_to_page</a>(<a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#offset_in_page\">offset_in_page</a>(<a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#len_max\">len_max</a> = <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a> - <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = ((<a class=\"id\" href=\"#to_write\">to_write</a> &gt; <a class=\"id\" href=\"#len_max\">len_max</a>) ? <a class=\"id\" href=\"#len_max\">len_max</a> : <a class=\"id\" href=\"#to_write\">to_write</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data_len\">data_len</a> = <a class=\"id\" href=\"#to_write\">to_write</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> += <a class=\"id\" href=\"#to_write\">to_write</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#truesize\">truesize</a> += <a class=\"id\" href=\"#to_write\">to_write</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_add\">atomic_add</a>(<a class=\"id\" href=\"#to_write\">to_write</a>, &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#sk\">sk</a>.<a class=\"id\" href=\"#sk_wmem_alloc\">sk_wmem_alloc</a>);", 
"", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#to_write\">to_write</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr_frags\">nr_frags</a> = <a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#nr_frags\">nr_frags</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#nr_frags\">nr_frags</a> >= <a class=\"id\" href=\"#MAX_SKB_FRAGS\">MAX_SKB_FRAGS</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pr_err\">pr_err</a>(\"Packet exceed the number of skb frags(%lu)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#MAX_SKB_FRAGS\">MAX_SKB_FRAGS</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#flush_dcache_page\">flush_dcache_page</a>(<a class=\"id\" href=\"#page\">page</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#get_page\">get_page</a>(<a class=\"id\" href=\"#page\">page</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_fill_page_desc\">skb_fill_page_desc</a>(<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr_frags\">nr_frags</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#page\">page</a>++, <a class=\"id\" href=\"#offset\">offset</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#to_write\">to_write</a> -= <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len_max\">len_max</a> = <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = ((<a class=\"id\" href=\"#to_write\">to_write</a> &gt; <a class=\"id\" href=\"#len_max\">len_max</a>) ? <a class=\"id\" href=\"#len_max\">len_max</a> : <a class=\"id\" href=\"#to_write\">to_write</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tp_len\">tp_len</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#tpacket_snd\">tpacket_snd</a>(struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ifindex\">ifindex</a>, <a class=\"id\" href=\"#err\">err</a>, <a class=\"id\" href=\"#reserve\">reserve</a> = 0;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#ph\">ph</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *<a class=\"id\" href=\"#saddr\">saddr</a> = (struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *)<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#tp_len\">tp_len</a>, <a class=\"id\" href=\"#size_max\">size_max</a>;", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#len_sum\">len_sum</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#status\">status</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#sk\">sk</a>.<a class=\"id\" href=\"#sk_socket\">sk_socket</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#pg_vec_lock\">pg_vec_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#saddr\">saddr</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ifindex\">ifindex</a><span class=\"ts\"/>= <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#proto\">proto</a><span class=\"ts\"/>= <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> &lt; sizeof(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> &lt; (<a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>+ <a class=\"id\" href=\"#offsetof\">offsetof</a>(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll_addr\">sll_addr</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ifindex\">ifindex</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#proto\">proto</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_protocol\">sll_protocol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_addr\">sll_addr</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_index\">dev_get_by_index</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reserve\">reserve</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENETDOWN\">ENETDOWN</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFF_UP\">IFF_UP</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_put\">out_put</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_max\">size_max</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#frame_size\">frame_size</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>- (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_hdrlen\">tp_hdrlen</a> - sizeof(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>));", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#size_max\">size_max</a> &gt; <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a> + <a class=\"id\" href=\"#reserve\">reserve</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_max\">size_max</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a> + <a class=\"id\" href=\"#reserve\">reserve</a>;", 
"", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ph\">ph</a> = <a class=\"id\" href=\"#packet_current_frame\">packet_current_frame</a>(<a class=\"id\" href=\"#po\">po</a>, &amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#TP_STATUS_SEND_REQUEST\">TP_STATUS_SEND_REQUEST</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#ph\">ph</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#schedule\">schedule</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#TP_STATUS_SEND_REQUEST\">TP_STATUS_SEND_REQUEST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#sock_alloc_send_skb\">sock_alloc_send_skb</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#sk\">sk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#LL_ALLOCATED_SPACE\">LL_ALLOCATED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>+ sizeof(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>0, &amp;<a class=\"id\" href=\"#err\">err</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_status\">out_status</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tp_len\">tp_len</a> = <a class=\"id\" href=\"#tpacket_fill_skb\">tpacket_fill_skb</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#ph\">ph</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#size_max\">size_max</a>, <a class=\"id\" href=\"#proto\">proto</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#tp_len\">tp_len</a> &lt; 0)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_loss\">tp_loss</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__packet_set_status\">__packet_set_status</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#ph\">ph</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#TP_STATUS_AVAILABLE\">TP_STATUS_AVAILABLE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_increment_head\">packet_increment_head</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#TP_STATUS_WRONG_FORMAT\">TP_STATUS_WRONG_FORMAT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#tp_len\">tp_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_status\">out_status</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#destructor\">destructor</a> = <a class=\"id\" href=\"#tpacket_destruct_skb\">tpacket_destruct_skb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__packet_set_status\">__packet_set_status</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#ph\">ph</a>, <a class=\"id\" href=\"#TP_STATUS_SENDING\">TP_STATUS_SENDING</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pending\">pending</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#TP_STATUS_SEND_REQUEST\">TP_STATUS_SEND_REQUEST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#dev_queue_xmit\">dev_queue_xmit</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#err\">err</a> &gt; 0)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#net_xmit_errno\">net_xmit_errno</a>(<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> && <a class=\"id\" href=\"#__packet_get_status\">__packet_get_status</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#ph\">ph</a>) ==", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#TP_STATUS_AVAILABLE\">TP_STATUS_AVAILABLE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* skb was destructed already */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_status\">out_status</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * skb was dropped but not destructed yet;</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * let's treat it like congestion or err &lt; 0</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_increment_head\">packet_increment_head</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len_sum\">len_sum</a> += <a class=\"id\" href=\"#tp_len\">tp_len</a>;", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#likely\">likely</a>((<a class=\"id\" href=\"#ph\">ph</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>((!(<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> &amp; <a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>)) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> (<a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pending\">pending</a>))))", 
"<span class=\"ts\"/><span class=\"ts\"/>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#len_sum\">len_sum</a>;", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out_put\">out_put</a>;", 
"", 
"<a class=\"id\" href=\"#out_status\">out_status</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__packet_set_status\">__packet_set_status</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#ph\">ph</a>, <a class=\"id\" href=\"#status\">status</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#out_put\">out_put</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#pg_vec_lock\">pg_vec_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#packet_alloc_skb\">packet_alloc_skb</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#prepad\">prepad</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#reserve\">reserve</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#linear\">linear</a>, int <a class=\"id\" href=\"#noblock\">noblock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       int *<a class=\"id\" href=\"#err\">err</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Under a page?  Don't bother with paged skb. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#prepad\">prepad</a> + <a class=\"id\" href=\"#len\">len</a> &lt; <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a> || !<a class=\"id\" href=\"#linear\">linear</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#linear\">linear</a> = <a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#sock_alloc_send_pskb\">sock_alloc_send_pskb</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#prepad\">prepad</a> + <a class=\"id\" href=\"#linear\">linear</a>, <a class=\"id\" href=\"#len\">len</a> - <a class=\"id\" href=\"#linear\">linear</a>, <a class=\"id\" href=\"#noblock\">noblock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reserve\">skb_reserve</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#reserve\">reserve</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#linear\">linear</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data_len\">data_len</a> = <a class=\"id\" href=\"#len\">len</a> - <a class=\"id\" href=\"#linear\">linear</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> += <a class=\"id\" href=\"#len\">len</a> - <a class=\"id\" href=\"#linear\">linear</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_snd\">packet_snd</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *<a class=\"id\" href=\"#saddr\">saddr</a> = (struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *)<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/>unsigned char *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ifindex\">ifindex</a>, <a class=\"id\" href=\"#err\">err</a>, <a class=\"id\" href=\"#reserve\">reserve</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#virtio_net_hdr\">virtio_net_hdr</a> <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a> = { 0 };", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#offset\">offset</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>unsigned short <a class=\"id\" href=\"#gso_type\">gso_type</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Get and verify the address.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#saddr\">saddr</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ifindex\">ifindex</a><span class=\"ts\"/>= <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#proto\">proto</a><span class=\"ts\"/>= <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a><span class=\"ts\"/>= <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> &lt; sizeof(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> &lt; (<a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a> + <a class=\"id\" href=\"#offsetof\">offsetof</a>(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>, <a class=\"id\" href=\"#sll_addr\">sll_addr</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ifindex\">ifindex</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#proto\">proto</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_protocol\">sll_protocol</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a><span class=\"ts\"/>= <a class=\"id\" href=\"#saddr\">saddr</a>-><a class=\"id\" href=\"#sll_addr\">sll_addr</a>;", 
"<span class=\"ts\"/>}", 
"", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_index\">dev_get_by_index</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#SOCK_RAW\">SOCK_RAW</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reserve\">reserve</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#hard_header_len\">hard_header_len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENETDOWN\">ENETDOWN</a>;", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFF_UP\">IFF_UP</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#has_vnet_hdr\">has_vnet_hdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a> = sizeof(<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> -= <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#memcpy_fromiovec\">memcpy_fromiovec</a>((void *)&amp;<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>, <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#VIRTIO_NET_HDR_F_NEEDS_CSUM\">VIRTIO_NET_HDR_F_NEEDS_CSUM</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_start\">csum_start</a> + <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_offset\">csum_offset</a> + 2 &gt;", 
"<span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#hdr_len\">hdr_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#hdr_len\">hdr_len</a> = <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_start\">csum_start</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_offset\">csum_offset</a> + 2;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#hdr_len\">hdr_len</a> &gt; <a class=\"id\" href=\"#len\">len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> != <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_NONE\">VIRTIO_NET_HDR_GSO_NONE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> &amp; ~<a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_ECN\">VIRTIO_NET_HDR_GSO_ECN</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_TCPV4\">VIRTIO_NET_HDR_GSO_TCPV4</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#SKB_GSO_TCPV4\">SKB_GSO_TCPV4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_TCPV6\">VIRTIO_NET_HDR_GSO_TCPV6</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#SKB_GSO_TCPV6\">SKB_GSO_TCPV6</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_UDP\">VIRTIO_NET_HDR_GSO_UDP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#SKB_GSO_UDP\">SKB_GSO_UDP</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> &amp; <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_ECN\">VIRTIO_NET_HDR_GSO_ECN</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#gso_type\">gso_type</a> |= <a class=\"id\" href=\"#SKB_GSO_TCP_ECN\">SKB_GSO_TCP_ECN</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_size\">gso_size</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#gso_type\">gso_type</a> && (<a class=\"id\" href=\"#len\">len</a> &gt; <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a>+<a class=\"id\" href=\"#reserve\">reserve</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#packet_alloc_skb\">packet_alloc_skb</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#LL_ALLOCATED_SPACE\">LL_ALLOCATED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#LL_RESERVED_SPACE\">LL_RESERVED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#hdr_len\">hdr_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> &amp; <a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>, &amp;<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_set_network_header\">skb_set_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#reserve\">reserve</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a> &&", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#dev_hard_header\">dev_hard_header</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#proto\">proto</a>), <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#len\">len</a>)) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Returns -EFAULT on error */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#skb_copy_datagram_from_iovec\">skb_copy_datagram_from_iovec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#offset\">offset</a>, <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>, 0, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#sock_tx_timestamp\">sock_tx_timestamp</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb_tx\">skb_tx</a>(<a class=\"id\" href=\"#skb\">skb</a>));", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#priority\">priority</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_priority\">sk_priority</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_mark\">sk_mark</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#has_vnet_hdr\">has_vnet_hdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#VIRTIO_NET_HDR_F_NEEDS_CSUM\">VIRTIO_NET_HDR_F_NEEDS_CSUM</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb_partial_csum_set\">skb_partial_csum_set</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_start\">csum_start</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_offset\">csum_offset</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#gso_size\">gso_size</a> = <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_size\">gso_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#gso_type\">gso_type</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Header must be checked, and gso_segs computed. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#gso_type\">gso_type</a> |= <a class=\"id\" href=\"#SKB_GSO_DODGY\">SKB_GSO_DODGY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#gso_segs\">gso_segs</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> += <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Now send it</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#dev_queue_xmit\">dev_queue_xmit</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &gt; 0 && (<a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#net_xmit_errno\">net_xmit_errno</a>(<a class=\"id\" href=\"#err\">err</a>)) != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<a class=\"id\" href=\"#out_free\">out_free</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_sendmsg\">packet_sendmsg</a>(struct <a class=\"id\" href=\"#kiocb\">kiocb</a> *<a class=\"id\" href=\"#iocb\">iocb</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#tpacket_snd\">tpacket_snd</a>(<a class=\"id\" href=\"#po\">po</a>, <a class=\"id\" href=\"#msg\">msg</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#packet_snd\">packet_snd</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Close a PACKET socket. This is fairly simple. We immediately go</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>to 'closed' state and remove our protocol entry in the device list.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#packet_release\">packet_release</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tpacket_req\">tpacket_req</a> <a class=\"id\" href=\"#req\">req</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#sk\">sk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist_lock\">sklist_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_del_node_init_rcu\">sk_del_node_init_rcu</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_prot_inuse_add\">sock_prot_inuse_add</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_prot\">sk_prot</a>, -1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist_lock\">sklist_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Remove from protocol table</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__dev_remove_pack\">__dev_remove_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__sock_put\">__sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#packet_flush_mclist\">packet_flush_mclist</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#req\">req</a>, 0, sizeof(<a class=\"id\" href=\"#req\">req</a>));", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_set_ring\">packet_set_ring</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#req\">req</a>, 1, 0);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_set_ring\">packet_set_ring</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#req\">req</a>, 1, 1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#synchronize_net\">synchronize_net</a>();", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Now the socket is dead. No more input will appear.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_orphan\">sock_orphan</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Purge queues */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_queue_purge\">skb_queue_purge</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_refcnt_debug_release\">sk_refcnt_debug_release</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_put\">sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Attach a packet hook.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#packet_do_bind\">packet_do_bind</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#protocol\">protocol</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Detach an existing hook if present.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#lock_sock\">lock_sock</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__sock_put\">__sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_remove_pack\">dev_remove_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a> = <a class=\"id\" href=\"#protocol\">protocol</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#protocol\">protocol</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> = <a class=\"id\" href=\"#dev\">dev</a> ? <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> : 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#protocol\">protocol</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a> || (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#IFF_UP\">IFF_UP</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_add_pack\">dev_add_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_hold\">sock_hold</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 1;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_err\">sk_err</a> = <a class=\"id\" href=\"#ENETDOWN\">ENETDOWN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#sock_flag\">sock_flag</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#SOCK_DEAD\">SOCK_DEAD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_report\">sk_error_report</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#release_sock\">release_sock</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Bind a packet socket to a device</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#packet_bind_spkt\">packet_bind_spkt</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#sockaddr\">sockaddr</a> *<a class=\"id\" href=\"#uaddr\">uaddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    int <a class=\"id\" href=\"#addr_len\">addr_len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#name\">name</a>[15];", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Check legality</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#addr_len\">addr_len</a> != sizeof(struct <a class=\"id\" href=\"#sockaddr\">sockaddr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#strlcpy\">strlcpy</a>(<a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#uaddr\">uaddr</a>-><a class=\"id\" href=\"#sa_data\">sa_data</a>, sizeof(<a class=\"id\" href=\"#name\">name</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_name\">dev_get_by_name</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#packet_do_bind\">packet_do_bind</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#num\">num</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_bind\">packet_bind</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#sockaddr\">sockaddr</a> *<a class=\"id\" href=\"#uaddr\">uaddr</a>, int <a class=\"id\" href=\"#addr_len\">addr_len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *<a class=\"id\" href=\"#sll\">sll</a> = (struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *)<a class=\"id\" href=\"#uaddr\">uaddr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Check legality</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#addr_len\">addr_len</a> &lt; sizeof(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_family\">sll_family</a> != <a class=\"id\" href=\"#AF_PACKET\">AF_PACKET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_index\">dev_get_by_index</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#packet_do_bind\">packet_do_bind</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_protocol\">sll_protocol</a> ? : <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#num\">num</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#proto\">proto</a> <a class=\"id\" href=\"#packet_proto\">packet_proto</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a><span class=\"ts\"/>  = \"PACKET\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a><span class=\"ts\"/>  = <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#obj_size\">obj_size</a> = sizeof(struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a>),", 
"};", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Create a packet of type SOCK_PACKET.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#packet_create\">packet_create</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, int <a class=\"id\" href=\"#protocol\">protocol</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> int <a class=\"id\" href=\"#kern\">kern</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be16\">__be16</a> <a class=\"id\" href=\"#proto\">proto</a> = (<a class=\"id\" href=\"#__force\">__force</a> <a class=\"id\" href=\"#__be16\">__be16</a>)<a class=\"id\" href=\"#protocol\">protocol</a>; <span class=\"comment\">/* weird, but documented */</span>", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_NET_RAW\">CAP_NET_RAW</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a> && <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#SOCK_RAW\">SOCK_RAW</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#SOCK_PACKET\">SOCK_PACKET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ESOCKTNOSUPPORT\">ESOCKTNOSUPPORT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#state\">state</a> = <a class=\"id\" href=\"#SS_UNCONNECTED\">SS_UNCONNECTED</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sk_alloc\">sk_alloc</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>, &amp;<a class=\"id\" href=\"#packet_proto\">packet_proto</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#ops\">ops</a> = &amp;<a class=\"id\" href=\"#packet_ops\">packet_ops</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#SOCK_PACKET\">SOCK_PACKET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#ops\">ops</a> = &amp;<a class=\"id\" href=\"#packet_ops_spkt\">packet_ops_spkt</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_init_data\">sock_init_data</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_family\">sk_family</a> = <a class=\"id\" href=\"#PF_PACKET\">PF_PACKET</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a> = <a class=\"id\" href=\"#proto\">proto</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_destruct\">sk_destruct</a> = <a class=\"id\" href=\"#packet_sock_destruct\">packet_sock_destruct</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_refcnt_debug_inc\">sk_refcnt_debug_inc</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Attach a protocol block</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#bind_lock\">bind_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_init\">mutex_init</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#pg_vec_lock\">pg_vec_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#func\">func</a> = <a class=\"id\" href=\"#packet_rcv\">packet_rcv</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#SOCK_PACKET\">SOCK_PACKET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#func\">func</a> = <a class=\"id\" href=\"#packet_rcv_spkt\">packet_rcv_spkt</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#af_packet_priv\">af_packet_priv</a> = <a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#proto\">proto</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#proto\">proto</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_add_pack\">dev_add_pack</a>(&amp;<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#prot_hook\">prot_hook</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_hold\">sock_hold</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#running\">running</a> = 1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist_lock\">sklist_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_add_node_rcu\">sk_add_node_rcu</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist\">sklist</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_prot_inuse_add\">sock_prot_inuse_add</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#packet_proto\">packet_proto</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#packet\">packet</a>.<a class=\"id\" href=\"#sklist_lock\">sklist_lock</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_recv_error\">packet_recv_error</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, int <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock_exterr_skb\">sock_exterr_skb</a> *<a class=\"id\" href=\"#serr\">serr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, *<a class=\"id\" href=\"#skb2\">skb2</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#copied\">copied</a>, <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb_dequeue\">skb_dequeue</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_queue\">sk_error_queue</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copied\">copied</a> &gt; <a class=\"id\" href=\"#len\">len</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_TRUNC\">MSG_TRUNC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#skb_copy_datagram_iovec\">skb_copy_datagram_iovec</a>(<a class=\"id\" href=\"#skb\">skb</a>, 0, <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>, <a class=\"id\" href=\"#copied\">copied</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free_skb\">out_free_skb</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_recv_timestamp\">sock_recv_timestamp</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#serr\">serr</a> = <a class=\"id\" href=\"#SKB_EXT_ERR\">SKB_EXT_ERR</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_cmsg\">put_cmsg</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#SOL_PACKET\">SOL_PACKET</a>, <a class=\"id\" href=\"#PACKET_TX_TIMESTAMP\">PACKET_TX_TIMESTAMP</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/> sizeof(<a class=\"id\" href=\"#serr\">serr</a>-><a class=\"id\" href=\"#ee\">ee</a>), &amp;<a class=\"id\" href=\"#serr\">serr</a>-><a class=\"id\" href=\"#ee\">ee</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_ERRQUEUE\">MSG_ERRQUEUE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#copied\">copied</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Reset and regenerate socket error */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_queue\">sk_error_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_err\">sk_err</a> = 0;", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#skb2\">skb2</a> = <a class=\"id\" href=\"#skb_peek\">skb_peek</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_queue\">sk_error_queue</a>)) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_err\">sk_err</a> = <a class=\"id\" href=\"#SKB_EXT_ERR\">SKB_EXT_ERR</a>(<a class=\"id\" href=\"#skb2\">skb2</a>)-><a class=\"id\" href=\"#ee\">ee</a>.<a class=\"id\" href=\"#ee_errno\">ee_errno</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_queue\">sk_error_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_report\">sk_error_report</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_queue\">sk_error_queue</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<a class=\"id\" href=\"#out_free_skb\">out_free_skb</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Pull a packet from our receive queue and hand it to the user.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>If necessary we block.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#packet_recvmsg\">packet_recvmsg</a>(struct <a class=\"id\" href=\"#kiocb\">kiocb</a> *<a class=\"id\" href=\"#iocb\">iocb</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a>, int <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#copied\">copied</a>, <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *<a class=\"id\" href=\"#sll\">sll</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; ~(<a class=\"id\" href=\"#MSG_PEEK\">MSG_PEEK</a>|<a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>|<a class=\"id\" href=\"#MSG_TRUNC\">MSG_TRUNC</a>|<a class=\"id\" href=\"#MSG_CMSG_COMPAT\">MSG_CMSG_COMPAT</a>|<a class=\"id\" href=\"#MSG_ERRQUEUE\">MSG_ERRQUEUE</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"#if 0", 
"<span class=\"ts\"/><span class=\"comment\">/* What error should we return now? EUNATTACH? */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#ifindex\">ifindex</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MSG_ERRQUEUE\">MSG_ERRQUEUE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#packet_recv_error\">packet_recv_error</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Call the generic datagram receiver. This handles all sorts</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>of horrible races and re-entrancy so we can forget about it</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>in the protocol layers.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Now it will return ENETDOWN, if device have just gone down,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>but then it will block.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb_recv_datagram\">skb_recv_datagram</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#flags\">flags</a>, <a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>, &amp;<a class=\"id\" href=\"#err\">err</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>An error occurred so return it. Because skb_recv_datagram()</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>handles the blocking we don't see and worry about blocking</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>retries.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#has_vnet_hdr\">has_vnet_hdr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#virtio_net_hdr\">virtio_net_hdr</a> <a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a> = { 0 };", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a> = sizeof(<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#len\">len</a> -= <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a>) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_is_gso\">skb_is_gso</a>(<a class=\"id\" href=\"#skb\">skb</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#skb_shared_info\">skb_shared_info</a> *<a class=\"id\" href=\"#sinfo\">sinfo</a> = <a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* This is a hint as to how much should be linear. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#hdr_len\">hdr_len</a> = <a class=\"id\" href=\"#skb_headlen\">skb_headlen</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_size\">gso_size</a> = <a class=\"id\" href=\"#sinfo\">sinfo</a>-><a class=\"id\" href=\"#gso_size\">gso_size</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sinfo\">sinfo</a>-><a class=\"id\" href=\"#gso_type\">gso_type</a> &amp; <a class=\"id\" href=\"#SKB_GSO_TCPV4\">SKB_GSO_TCPV4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_TCPV4\">VIRTIO_NET_HDR_GSO_TCPV4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#sinfo\">sinfo</a>-><a class=\"id\" href=\"#gso_type\">gso_type</a> &amp; <a class=\"id\" href=\"#SKB_GSO_TCPV6\">SKB_GSO_TCPV6</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_TCPV6\">VIRTIO_NET_HDR_GSO_TCPV6</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#sinfo\">sinfo</a>-><a class=\"id\" href=\"#gso_type\">gso_type</a> &amp; <a class=\"id\" href=\"#SKB_GSO_UDP\">SKB_GSO_UDP</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_UDP\">VIRTIO_NET_HDR_GSO_UDP</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#sinfo\">sinfo</a>-><a class=\"id\" href=\"#gso_type\">gso_type</a> &amp; <a class=\"id\" href=\"#SKB_GSO_FCOE\">SKB_GSO_FCOE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sinfo\">sinfo</a>-><a class=\"id\" href=\"#gso_type\">gso_type</a> &amp; <a class=\"id\" href=\"#SKB_GSO_TCP_ECN\">SKB_GSO_TCP_ECN</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> |= <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_ECN\">VIRTIO_NET_HDR_GSO_ECN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#gso_type\">gso_type</a> = <a class=\"id\" href=\"#VIRTIO_NET_HDR_GSO_NONE\">VIRTIO_NET_HDR_GSO_NONE</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ip_summed\">ip_summed</a> == <a class=\"id\" href=\"#CHECKSUM_PARTIAL\">CHECKSUM_PARTIAL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#VIRTIO_NET_HDR_F_NEEDS_CSUM\">VIRTIO_NET_HDR_F_NEEDS_CSUM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_start\">csum_start</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#csum_start\">csum_start</a> -", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_headroom\">skb_headroom</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>.<a class=\"id\" href=\"#csum_offset\">csum_offset</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#csum_offset\">csum_offset</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} <span class=\"comment\">/* else everything is zero */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#memcpy_toiovec\">memcpy_toiovec</a>(<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>, (void *)&amp;<a class=\"id\" href=\"#vnet_hdr\">vnet_hdr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>If the address length field is there to be filled in, we fill</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>it in now.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a> = &amp;<a class=\"id\" href=\"#PACKET_SKB_CB\">PACKET_SKB_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#sa\">sa</a>.<a class=\"id\" href=\"#ll\">ll</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#SOCK_PACKET\">SOCK_PACKET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> = sizeof(struct <a class=\"id\" href=\"#sockaddr_pkt\">sockaddr_pkt</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> = <a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a> + <a class=\"id\" href=\"#offsetof\">offsetof</a>(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>, <a class=\"id\" href=\"#sll_addr\">sll_addr</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>You lose any data beyond the buffer you gave. If it worries a</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>user program they can ask the device for its MTU anyway.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copied\">copied</a> &gt; <a class=\"id\" href=\"#len\">len</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_TRUNC\">MSG_TRUNC</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#skb_copy_datagram_iovec\">skb_copy_datagram_iovec</a>(<a class=\"id\" href=\"#skb\">skb</a>, 0, <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>, <a class=\"id\" href=\"#copied\">copied</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_free\">out_free</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_recv_ts_and_drops\">sock_recv_ts_and_drops</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>, &amp;<a class=\"id\" href=\"#PACKET_SKB_CB\">PACKET_SKB_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#sa\">sa</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#auxdata\">auxdata</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#tpacket_auxdata\">tpacket_auxdata</a> <a class=\"id\" href=\"#aux\">aux</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux\">aux</a>.<a class=\"id\" href=\"#tp_status\">tp_status</a> = <a class=\"id\" href=\"#TP_STATUS_USER\">TP_STATUS_USER</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#ip_summed\">ip_summed</a> == <a class=\"id\" href=\"#CHECKSUM_PARTIAL\">CHECKSUM_PARTIAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux\">aux</a>.<a class=\"id\" href=\"#tp_status\">tp_status</a> |= <a class=\"id\" href=\"#TP_STATUS_CSUMNOTREADY\">TP_STATUS_CSUMNOTREADY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux\">aux</a>.<a class=\"id\" href=\"#tp_len\">tp_len</a> = <a class=\"id\" href=\"#PACKET_SKB_CB\">PACKET_SKB_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#origlen\">origlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux\">aux</a>.<a class=\"id\" href=\"#tp_snaplen\">tp_snaplen</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux\">aux</a>.<a class=\"id\" href=\"#tp_mac\">tp_mac</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux\">aux</a>.<a class=\"id\" href=\"#tp_net\">tp_net</a> = <a class=\"id\" href=\"#skb_network_offset\">skb_network_offset</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#aux\">aux</a>.<a class=\"id\" href=\"#tp_vlan_tci\">tp_vlan_tci</a> = <a class=\"id\" href=\"#vlan_tx_tag_get\">vlan_tx_tag_get</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_cmsg\">put_cmsg</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#SOL_PACKET\">SOL_PACKET</a>, <a class=\"id\" href=\"#PACKET_AUXDATA\">PACKET_AUXDATA</a>, sizeof(<a class=\"id\" href=\"#aux\">aux</a>), &amp;<a class=\"id\" href=\"#aux\">aux</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Free or return the buffer as appropriate. Again this</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>hides all the races and re-entrancy issues from us.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#vnet_hdr_len\">vnet_hdr_len</a> + ((<a class=\"id\" href=\"#flags\">flags</a>&amp;<a class=\"id\" href=\"#MSG_TRUNC\">MSG_TRUNC</a>) ? <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> : <a class=\"id\" href=\"#copied\">copied</a>);", 
"", 
"<a class=\"id\" href=\"#out_free\">out_free</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_free_datagram\">skb_free_datagram</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_getname_spkt\">packet_getname_spkt</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#sockaddr\">sockaddr</a> *<a class=\"id\" href=\"#uaddr\">uaddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       int *<a class=\"id\" href=\"#uaddr_len\">uaddr_len</a>, int <a class=\"id\" href=\"#peer\">peer</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a><span class=\"ts\"/>= <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#peer\">peer</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EOPNOTSUPP\">EOPNOTSUPP</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#uaddr\">uaddr</a>-><a class=\"id\" href=\"#sa_family\">sa_family</a> = <a class=\"id\" href=\"#AF_PACKET\">AF_PACKET</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_index_rcu\">dev_get_by_index_rcu</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strlcpy\">strlcpy</a>(<a class=\"id\" href=\"#uaddr\">uaddr</a>-><a class=\"id\" href=\"#sa_data\">sa_data</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>, 15);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#uaddr\">uaddr</a>-><a class=\"id\" href=\"#sa_data\">sa_data</a>, 0, 14);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#uaddr_len\">uaddr_len</a> = sizeof(*<a class=\"id\" href=\"#uaddr\">uaddr</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_getname\">packet_getname</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#sockaddr\">sockaddr</a> *<a class=\"id\" href=\"#uaddr\">uaddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  int *<a class=\"id\" href=\"#uaddr_len\">uaddr_len</a>, int <a class=\"id\" href=\"#peer\">peer</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DECLARE_SOCKADDR\">DECLARE_SOCKADDR</a>(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a> *, <a class=\"id\" href=\"#sll\">sll</a>, <a class=\"id\" href=\"#uaddr\">uaddr</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#peer\">peer</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EOPNOTSUPP\">EOPNOTSUPP</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_family\">sll_family</a> = <a class=\"id\" href=\"#AF_PACKET\">AF_PACKET</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_ifindex\">sll_ifindex</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_protocol\">sll_protocol</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_index_rcu\">dev_get_by_index_rcu</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_hatype\">sll_hatype</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_addr\">sll_addr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev_addr\">dev_addr</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_hatype\">sll_hatype</a> = 0;<span class=\"ts\"/><span class=\"comment\">/* Bad: we have no ARPHRD_UNSPEC */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#uaddr_len\">uaddr_len</a> = <a class=\"id\" href=\"#offsetof\">offsetof</a>(struct <a class=\"id\" href=\"#sockaddr_ll\">sockaddr_ll</a>, <a class=\"id\" href=\"#sll_addr\">sll_addr</a>) + <a class=\"id\" href=\"#sll\">sll</a>-><a class=\"id\" href=\"#sll_halen\">sll_halen</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_dev_mc\">packet_dev_mc</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#packet_mclist\">packet_mclist</a> *<a class=\"id\" href=\"#i\">i</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> int <a class=\"id\" href=\"#what\">what</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_MR_MULTICAST\">PACKET_MR_MULTICAST</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#alen\">alen</a> != <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#what\">what</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dev_mc_add\">dev_mc_add</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dev_mc_del\">dev_mc_del</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_MR_PROMISC\">PACKET_MR_PROMISC</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dev_set_promiscuity\">dev_set_promiscuity</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#what\">what</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_MR_ALLMULTI\">PACKET_MR_ALLMULTI</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dev_set_allmulti\">dev_set_allmulti</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#what\">what</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_MR_UNICAST\">PACKET_MR_UNICAST</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#alen\">alen</a> != <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#what\">what</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dev_uc_add\">dev_uc_add</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dev_uc_del\">dev_uc_del</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#packet_dev_mclist\">packet_dev_mclist</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#packet_mclist\">packet_mclist</a> *<a class=\"id\" href=\"#i\">i</a>, int <a class=\"id\" href=\"#what\">what</a>)", 
"{", 
"<span class=\"ts\"/>for ( ; <a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> == <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_dev_mc\">packet_dev_mc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#what\">what</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_mc_add\">packet_mc_add</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#packet_mreq_max\">packet_mreq_max</a> *<a class=\"id\" href=\"#mreq\">mreq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_mclist\">packet_mclist</a> *<a class=\"id\" href=\"#ml\">ml</a>, *<a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#__dev_get_by_index\">__dev_get_by_index</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_ifindex\">mr_ifindex</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_alen\">mr_alen</a> &gt; <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#addr_len\">addr_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#i\">i</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#ml\">ml</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mclist\">mclist</a>; <a class=\"id\" href=\"#ml\">ml</a>; <a class=\"id\" href=\"#ml\">ml</a> = <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> == <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_ifindex\">mr_ifindex</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_type\">mr_type</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#alen\">alen</a> == <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_alen\">mr_alen</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#memcmp\">memcmp</a>(<a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_address\">mr_address</a>, <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#alen\">alen</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#count\">count</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Free the new element ... */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_type\">mr_type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> = <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_ifindex\">mr_ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#alen\">alen</a> = <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_alen\">mr_alen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_address\">mr_address</a>, <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#alen\">alen</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#count\">count</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mclist\">mclist</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mclist\">mclist</a> = <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#packet_dev_mc\">packet_dev_mc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#i\">i</a>, 1);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mclist\">mclist</a> = <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#done\">done</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#packet_mc_drop\">packet_mc_drop</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#packet_mreq_max\">packet_mreq_max</a> *<a class=\"id\" href=\"#mreq\">mreq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_mclist\">packet_mclist</a> *<a class=\"id\" href=\"#ml\">ml</a>, **<a class=\"id\" href=\"#mlp\">mlp</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#mlp\">mlp</a> = &amp;<a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#mclist\">mclist</a>; (<a class=\"id\" href=\"#ml\">ml</a> = *<a class=\"id\" href=\"#mlp\">mlp</a>) != <a class=\"id\" href=\"#NULL\">NULL</a>; <a class=\"id\" href=\"#mlp\">mlp</a> = &amp;<a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> == <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_ifindex\">mr_ifindex</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_type\">mr_type</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#alen\">alen</a> == <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_alen\">mr_alen</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#memcmp\">memcmp</a>(<a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mreq\">mreq</a>-><a class=\"id\" href=\"#mr_address\">mr_address</a>, <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#alen\">alen</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (--<a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#count\">count</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#mlp\">mlp</a> = <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#__dev_get_by_index\">__dev_get_by_index</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_dev_mc\">packet_dev_mc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#ml\">ml</a>, -1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#ml\">ml</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EADDRNOTAVAIL\">EADDRNOTAVAIL</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#packet_flush_mclist\">packet_flush_mclist</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_mclist\">packet_mclist</a> *<a class=\"id\" href=\"#ml\">ml</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mclist\">mclist</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"<span class=\"ts\"/>while ((<a class=\"id\" href=\"#ml\">ml</a> = <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mclist\">mclist</a>) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#mclist\">mclist</a> = <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#__dev_get_by_index\">__dev_get_by_index</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#ml\">ml</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#packet_dev_mc\">packet_dev_mc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#ml\">ml</a>, -1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#ml\">ml</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"}", 
"", 
"static int", 
"<a class=\"id\" href=\"#packet_setsockopt\">packet_setsockopt</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, int <a class=\"id\" href=\"#level\">level</a>, int <a class=\"id\" href=\"#optname\">optname</a>, char <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#optval\">optval</a>, unsigned int <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_sock\">packet_sock</a> *<a class=\"id\" href=\"#po\">po</a> = <a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#level\">level</a> != <a class=\"id\" href=\"#SOL_PACKET\">SOL_PACKET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOPROTOOPT\">ENOPROTOOPT</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#optname\">optname</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_ADD_MEMBERSHIP\">PACKET_ADD_MEMBERSHIP</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_DROP_MEMBERSHIP\">PACKET_DROP_MEMBERSHIP</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#packet_mreq_max\">packet_mreq_max</a> <a class=\"id\" href=\"#mreq\">mreq</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#optlen\">optlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#mreq\">mreq</a>, 0, sizeof(<a class=\"id\" href=\"#mreq\">mreq</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; sizeof(struct <a class=\"id\" href=\"#packet_mreq\">packet_mreq</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &gt; sizeof(<a class=\"id\" href=\"#mreq\">mreq</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = sizeof(<a class=\"id\" href=\"#mreq\">mreq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#mreq\">mreq</a>, <a class=\"id\" href=\"#optval\">optval</a>, <a class=\"id\" href=\"#len\">len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; (<a class=\"id\" href=\"#mreq\">mreq</a>.<a class=\"id\" href=\"#mr_alen\">mr_alen</a> + <a class=\"id\" href=\"#offsetof\">offsetof</a>(struct <a class=\"id\" href=\"#packet_mreq\">packet_mreq</a>, <a class=\"id\" href=\"#mr_address\">mr_address</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optname\">optname</a> == <a class=\"id\" href=\"#PACKET_ADD_MEMBERSHIP\">PACKET_ADD_MEMBERSHIP</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#packet_mc_add\">packet_mc_add</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#mreq\">mreq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#packet_mc_drop\">packet_mc_drop</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#mreq\">mreq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_RX_RING\">PACKET_RX_RING</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_TX_RING\">PACKET_TX_RING</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#tpacket_req\">tpacket_req</a> <a class=\"id\" href=\"#req\">req</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> &lt; sizeof(<a class=\"id\" href=\"#req\">req</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#has_vnet_hdr\">has_vnet_hdr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#req\">req</a>, <a class=\"id\" href=\"#optval\">optval</a>, sizeof(<a class=\"id\" href=\"#req\">req</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#packet_set_ring\">packet_set_ring</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#req\">req</a>, 0, <a class=\"id\" href=\"#optname\">optname</a> == <a class=\"id\" href=\"#PACKET_TX_RING\">PACKET_TX_RING</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_COPY_THRESH\">PACKET_COPY_THRESH</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> != sizeof(<a class=\"id\" href=\"#val\">val</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#optval\">optval</a>, sizeof(<a class=\"id\" href=\"#val\">val</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pkt_sk\">pkt_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#copy_thresh\">copy_thresh</a> = <a class=\"id\" href=\"#val\">val</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_VERSION\">PACKET_VERSION</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> != sizeof(<a class=\"id\" href=\"#val\">val</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a> || <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#optval\">optval</a>, sizeof(<a class=\"id\" href=\"#val\">val</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#val\">val</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#TPACKET_V1\">TPACKET_V1</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#TPACKET_V2\">TPACKET_V2</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_version\">tp_version</a> = <a class=\"id\" href=\"#val\">val</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_RESERVE\">PACKET_RESERVE</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> != sizeof(<a class=\"id\" href=\"#val\">val</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#rx_ring\">rx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a> || <a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tx_ring\">tx_ring</a>.<a class=\"id\" href=\"#pg_vec\">pg_vec</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#optval\">optval</a>, sizeof(<a class=\"id\" href=\"#val\">val</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#po\">po</a>-><a class=\"id\" href=\"#tp_reserve\">tp_reserve</a> = <a class=\"id\" href=\"#val\">val</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PACKET_LOSS\">PACKET_LOSS</a>:", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> != sizeof(<a class=\"id\" href=\"#val\">val</a>))", 
];
xr_frag_insert('l/a1/8cebdd671f2e8ceb1dd15d9803d3f4c8ad8aad.xr', __xr_tmp);
