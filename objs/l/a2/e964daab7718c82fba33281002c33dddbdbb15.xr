var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" res=%u\", <a class=\"id\" href=\"#entry\">entry</a> != <a class=\"id\" href=\"#NULL\">NULL</a> ? 1 : 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#netlbl_unlhsh_free_addr4\">netlbl_unlhsh_free_addr4</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlhsh_remove_addr6 - Remove an IPv6 address entry</span>", 
"<span class=\"comment\"> * @net: network namespace</span>", 
"<span class=\"comment\"> * @iface: interface entry</span>", 
"<span class=\"comment\"> * @addr: IP address</span>", 
"<span class=\"comment\"> * @mask: IP address mask</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Remove an IP address entry from the unlabeled connection hash table.</span>", 
"<span class=\"comment\"> * Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlhsh_remove_addr6\">netlbl_unlhsh_remove_addr6</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      const struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#list_entry\">list_entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_addr6\">netlbl_unlhsh_addr6</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#secctx\">secctx</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secctx_len\">secctx_len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_entry\">list_entry</a> = <a class=\"id\" href=\"#netlbl_af6list_remove\">netlbl_af6list_remove</a>(<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>, &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr6_list\">addr6_list</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#list_entry\">list_entry</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#netlbl_unlhsh_addr6_entry\">netlbl_unlhsh_addr6_entry</a>(<a class=\"id\" href=\"#list_entry\">list_entry</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#netlbl_audit_start_common\">netlbl_audit_start_common</a>(<a class=\"id\" href=\"#AUDIT_MAC_UNLBL_STCDEL\">AUDIT_MAC_UNLBL_STCDEL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_index\">dev_get_by_index</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_audit_addr\">netlbl_af6list_audit_addr</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  (<a class=\"id\" href=\"#dev\">dev</a> != <a class=\"id\" href=\"#NULL\">NULL</a> ? <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a> : <a class=\"id\" href=\"#NULL\">NULL</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> != <a class=\"id\" href=\"#NULL\">NULL</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#security_secid_to_secctx\">security_secid_to_secctx</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#secid\">secid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     &amp;<a class=\"id\" href=\"#secctx\">secctx</a>, &amp;<a class=\"id\" href=\"#secctx_len\">secctx_len</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" sec_obj=%s\", <a class=\"id\" href=\"#secctx\">secctx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#security_release_secctx\">security_release_secctx</a>(<a class=\"id\" href=\"#secctx\">secctx</a>, <a class=\"id\" href=\"#secctx_len\">secctx_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>, \" res=%u\", <a class=\"id\" href=\"#entry\">entry</a> != <a class=\"id\" href=\"#NULL\">NULL</a> ? 1 : 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#netlbl_unlhsh_free_addr6\">netlbl_unlhsh_free_addr6</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlhsh_condremove_iface - Remove an interface entry</span>", 
"<span class=\"comment\"> * @iface: the interface entry</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Remove an interface entry from the unlabeled connection hash table if it is</span>", 
"<span class=\"comment\"> * empty.  An interface entry is considered to be empty if there are no</span>", 
"<span class=\"comment\"> * address entries assigned to it.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#netlbl_unlhsh_condremove_iface\">netlbl_unlhsh_condremove_iface</a>(struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#iter4\">iter4</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#iter6\">iter6</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_rcu\">netlbl_af4list_foreach_rcu</a>(<a class=\"id\" href=\"#iter4\">iter4</a>, &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr4_list\">addr4_list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlhsh_condremove_failure\">unlhsh_condremove_failure</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_foreach_rcu\">netlbl_af6list_foreach_rcu</a>(<a class=\"id\" href=\"#iter6\">iter6</a>, &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr6_list\">addr6_list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlhsh_condremove_failure\">unlhsh_condremove_failure</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#valid\">valid</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#netlbl_unlhsh_def\">netlbl_unlhsh_def</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#netlbl_unlhsh_free_iface\">netlbl_unlhsh_free_iface</a>);", 
"<span class=\"ts\"/>return;", 
"", 
"<a class=\"id\" href=\"#unlhsh_condremove_failure\">unlhsh_condremove_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlhsh_remove - Remove an entry from the unlabeled hash table</span>", 
"<span class=\"comment\"> * @net: network namespace</span>", 
"<span class=\"comment\"> * @dev_name: interface name</span>", 
"<span class=\"comment\"> * @addr: IP address in network byte order</span>", 
"<span class=\"comment\"> * @mask: address mask in network byte order</span>", 
"<span class=\"comment\"> * @addr_len: length of address/mask (4 for IPv4, 16 for IPv6)</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Removes and existing entry from the unlabeled connection hash table.</span>", 
"<span class=\"comment\"> * Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_unlhsh_remove\">netlbl_unlhsh_remove</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const char *<a class=\"id\" href=\"#dev_name\">dev_name</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const void *<a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const void *<a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#addr_len\">addr_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#addr_len\">addr_len</a> != sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>) &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#addr_len\">addr_len</a> != sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_name\">dev_name</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_name_rcu\">dev_get_by_name_rcu</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#dev_name\">dev_name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlhsh_remove_return\">unlhsh_remove_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#netlbl_unlhsh_search_iface\">netlbl_unlhsh_search_iface</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_unlhsh_def\">netlbl_unlhsh_def</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlhsh_remove_return\">unlhsh_remove_return</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#addr_len\">addr_len</a>) {", 
"<span class=\"ts\"/>case sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>):", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_unlhsh_remove_addr4\">netlbl_unlhsh_remove_addr4</a>(<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#iface\">iface</a>, <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>case sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>):", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_unlhsh_remove_addr6\">netlbl_unlhsh_remove_addr6</a>(<a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#iface\">iface</a>, <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_unlhsh_condremove_iface\">netlbl_unlhsh_condremove_iface</a>(<a class=\"id\" href=\"#iface\">iface</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_dec\">atomic_dec</a>(&amp;<a class=\"id\" href=\"#netlabel_mgmt_protocount\">netlabel_mgmt_protocount</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#unlhsh_remove_return\">unlhsh_remove_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * General Helper Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlhsh_netdev_handler - Network device notification handler</span>", 
"<span class=\"comment\"> * @this: notifier block</span>", 
"<span class=\"comment\"> * @event: the event</span>", 
"<span class=\"comment\"> * @ptr: the network device (cast to void)</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Handle network device events, although at present all we care about is a</span>", 
"<span class=\"comment\"> * network device going away.  In the case of a device going away we clear any</span>", 
"<span class=\"comment\"> * related entries from the unlabeled connection hash table.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlhsh_netdev_handler\">netlbl_unlhsh_netdev_handler</a>(struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> *<a class=\"id\" href=\"#this\">this</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#event\">event</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>void *<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#net_eq\">net_eq</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), &amp;<a class=\"id\" href=\"#init_net\">init_net</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* XXX - should this be a check for NETDEV_DOWN or _UNREGISTER? */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#event\">event</a> == <a class=\"id\" href=\"#NETDEV_DOWN\">NETDEV_DOWN</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#netlbl_unlhsh_search_iface\">netlbl_unlhsh_search_iface</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a> != <a class=\"id\" href=\"#NULL\">NULL</a> && <a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#valid\">valid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#valid\">valid</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#netlbl_unlhsh_free_iface\">netlbl_unlhsh_free_iface</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_acceptflg_set - Set the unlabeled accept flag</span>", 
"<span class=\"comment\"> * @value: desired value</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Set the value of the unlabeled accept flag to @value.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#netlbl_unlabel_acceptflg_set\">netlbl_unlabel_acceptflg_set</a>(<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#value\">value</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_buffer\">audit_buffer</a> *<a class=\"id\" href=\"#audit_buf\">audit_buf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#old_val\">old_val</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_val\">old_val</a> = <a class=\"id\" href=\"#netlabel_unlabel_acceptflg\">netlabel_unlabel_acceptflg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlabel_unlabel_acceptflg\">netlabel_unlabel_acceptflg</a> = <a class=\"id\" href=\"#value\">value</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_buf\">audit_buf</a> = <a class=\"id\" href=\"#netlbl_audit_start_common\">netlbl_audit_start_common</a>(<a class=\"id\" href=\"#AUDIT_MAC_UNLBL_ALLOW\">AUDIT_MAC_UNLBL_ALLOW</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#audit_buf\">audit_buf</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_format\">audit_log_format</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> \" unlbl_accept=%u old=%u\", <a class=\"id\" href=\"#value\">value</a>, <a class=\"id\" href=\"#old_val\">old_val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_end\">audit_log_end</a>(<a class=\"id\" href=\"#audit_buf\">audit_buf</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_addrinfo_get - Get the IPv4/6 address information</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> * @addr: the IP address</span>", 
"<span class=\"comment\"> * @mask: the IP address mask</span>", 
"<span class=\"comment\"> * @len: the address length</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Examine the Generic NETLINK message and extract the IP address information.</span>", 
"<span class=\"comment\"> * Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_addrinfo_get\">netlbl_unlabel_addrinfo_get</a>(struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       void **<a class=\"id\" href=\"#addr\">addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       void **<a class=\"id\" href=\"#mask\">mask</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr_len\">addr_len</a> = <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addr_len\">addr_len</a> != sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#addr_len\">addr_len</a> != <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4MASK\">NLBL_UNLABEL_A_IPV4MASK</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4MASK\">NLBL_UNLABEL_A_IPV4MASK</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr_len\">addr_len</a> = <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addr_len\">addr_len</a> != sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#addr_len\">addr_len</a> != <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6MASK\">NLBL_UNLABEL_A_IPV6MASK</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6MASK\">NLBL_UNLABEL_A_IPV6MASK</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * NetLabel Command Handlers</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_accept - Handle an ACCEPT message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated ACCEPT message and set the accept flag accordingly.</span>", 
"<span class=\"comment\"> * Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_accept\">netlbl_unlabel_accept</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#value\">value</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_ACPTFLG\">NLBL_UNLABEL_A_ACPTFLG</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#value\">value</a> = <a class=\"id\" href=\"#nla_get_u8\">nla_get_u8</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_ACPTFLG\">NLBL_UNLABEL_A_ACPTFLG</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#value\">value</a> == 1 || <a class=\"id\" href=\"#value\">value</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_netlink_auditinfo\">netlbl_netlink_auditinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_unlabel_acceptflg_set\">netlbl_unlabel_acceptflg_set</a>(<a class=\"id\" href=\"#value\">value</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_list - Handle a LIST message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated LIST message and respond with the current status.</span>", 
"<span class=\"comment\"> * Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_list\">netlbl_unlabel_list</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#ans_skb\">ans_skb</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ans_skb\">ans_skb</a> = <a class=\"id\" href=\"#nlmsg_new\">nlmsg_new</a>(<a class=\"id\" href=\"#NLMSG_DEFAULT_SIZE\">NLMSG_DEFAULT_SIZE</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ans_skb\">ans_skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure\">list_failure</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#genlmsg_put_reply\">genlmsg_put_reply</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#netlbl_unlabel_gnl_family\">netlbl_unlabel_gnl_family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> 0, <a class=\"id\" href=\"#NLBL_UNLABEL_C_LIST\">NLBL_UNLABEL_C_LIST</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#data\">data</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure\">list_failure</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_u8\">nla_put_u8</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#NLBL_UNLABEL_A_ACPTFLG\">NLBL_UNLABEL_A_ACPTFLG</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#netlabel_unlabel_acceptflg\">netlabel_unlabel_acceptflg</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_failure\">list_failure</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#genlmsg_end\">genlmsg_end</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#genlmsg_reply\">genlmsg_reply</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>, <a class=\"id\" href=\"#info\">info</a>);", 
"", 
"<a class=\"id\" href=\"#list_failure\">list_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#ans_skb\">ans_skb</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_staticadd - Handle a STATICADD message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated STATICADD message and add a new unlabeled</span>", 
"<span class=\"comment\"> * connection entry to the hash table.  Returns zero on success, negative</span>", 
"<span class=\"comment\"> * values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_staticadd\">netlbl_unlabel_staticadd</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#dev_name\">dev_name</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Don't allow users to add both IPv4 and IPv6 addresses for a</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * single entry.  However, allow users to create two entries, one each</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * for IPv4 and IPv4, with the same LSM security context which should</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * achieve the same result. */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_SECCTX\">NLBL_UNLABEL_A_SECCTX</a>] ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IFACE\">NLBL_UNLABEL_A_IFACE</a>] ||", 
"<span class=\"ts\"/>    !((!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4MASK\">NLBL_UNLABEL_A_IPV4MASK</a>]) ^", 
"<span class=\"ts\"/>      (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6MASK\">NLBL_UNLABEL_A_IPV6MASK</a>])))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_netlink_auditinfo\">netlbl_netlink_auditinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_unlabel_addrinfo_get\">netlbl_unlabel_addrinfo_get</a>(<a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#addr\">addr</a>, &amp;<a class=\"id\" href=\"#mask\">mask</a>, &amp;<a class=\"id\" href=\"#addr_len\">addr_len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_name\">dev_name</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IFACE\">NLBL_UNLABEL_A_IFACE</a>]);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#security_secctx_to_secid\">security_secctx_to_secid</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/>                  <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_SECCTX\">NLBL_UNLABEL_A_SECCTX</a>]),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_SECCTX\">NLBL_UNLABEL_A_SECCTX</a>]),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_unlhsh_add\">netlbl_unlhsh_add</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#dev_name\">dev_name</a>, <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>, <a class=\"id\" href=\"#addr_len\">addr_len</a>, <a class=\"id\" href=\"#secid\">secid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_staticadddef - Handle a STATICADDDEF message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated STATICADDDEF message and add a new default</span>", 
"<span class=\"comment\"> * unlabeled connection entry.  Returns zero on success, negative values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_staticadddef\">netlbl_unlabel_staticadddef</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Don't allow users to add both IPv4 and IPv6 addresses for a</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * single entry.  However, allow users to create two entries, one each</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * for IPv4 and IPv6, with the same LSM security context which should</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * achieve the same result. */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_SECCTX\">NLBL_UNLABEL_A_SECCTX</a>] ||", 
"<span class=\"ts\"/>    !((!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4MASK\">NLBL_UNLABEL_A_IPV4MASK</a>]) ^", 
"<span class=\"ts\"/>      (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6MASK\">NLBL_UNLABEL_A_IPV6MASK</a>])))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_netlink_auditinfo\">netlbl_netlink_auditinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_unlabel_addrinfo_get\">netlbl_unlabel_addrinfo_get</a>(<a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#addr\">addr</a>, &amp;<a class=\"id\" href=\"#mask\">mask</a>, &amp;<a class=\"id\" href=\"#addr_len\">addr_len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#security_secctx_to_secid\">security_secctx_to_secid</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/>                  <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_SECCTX\">NLBL_UNLABEL_A_SECCTX</a>]),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_SECCTX\">NLBL_UNLABEL_A_SECCTX</a>]),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_unlhsh_add\">netlbl_unlhsh_add</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>, <a class=\"id\" href=\"#addr_len\">addr_len</a>, <a class=\"id\" href=\"#secid\">secid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_staticremove - Handle a STATICREMOVE message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated STATICREMOVE message and remove the specified</span>", 
"<span class=\"comment\"> * unlabeled connection entry.  Returns zero on success, negative values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_staticremove\">netlbl_unlabel_staticremove</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#dev_name\">dev_name</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* See the note in netlbl_unlabel_staticadd() about not allowing both</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * IPv4 and IPv6 in the same entry. */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IFACE\">NLBL_UNLABEL_A_IFACE</a>] ||", 
"<span class=\"ts\"/>    !((!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4MASK\">NLBL_UNLABEL_A_IPV4MASK</a>]) ^", 
"<span class=\"ts\"/>      (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6MASK\">NLBL_UNLABEL_A_IPV6MASK</a>])))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_netlink_auditinfo\">netlbl_netlink_auditinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_unlabel_addrinfo_get\">netlbl_unlabel_addrinfo_get</a>(<a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#addr\">addr</a>, &amp;<a class=\"id\" href=\"#mask\">mask</a>, &amp;<a class=\"id\" href=\"#addr_len\">addr_len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_name\">dev_name</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IFACE\">NLBL_UNLABEL_A_IFACE</a>]);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_unlhsh_remove\">netlbl_unlhsh_remove</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#dev_name\">dev_name</a>, <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>, <a class=\"id\" href=\"#addr_len\">addr_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_staticremovedef - Handle a STATICREMOVEDEF message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated STATICREMOVEDEF message and remove the default</span>", 
"<span class=\"comment\"> * unlabeled connection entry.  Returns zero on success, negative values on</span>", 
"<span class=\"comment\"> * failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_staticremovedef\">netlbl_unlabel_staticremovedef</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#addr_len\">addr_len</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* See the note in netlbl_unlabel_staticadd() about not allowing both</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * IPv4 and IPv6 in the same entry. */</span>", 
"<span class=\"ts\"/>if (!((!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4MASK\">NLBL_UNLABEL_A_IPV4MASK</a>]) ^", 
"<span class=\"ts\"/>      (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>] ||", 
"<span class=\"ts\"/>       !<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6MASK\">NLBL_UNLABEL_A_IPV6MASK</a>])))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_netlink_auditinfo\">netlbl_netlink_auditinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_unlabel_addrinfo_get\">netlbl_unlabel_addrinfo_get</a>(<a class=\"id\" href=\"#info\">info</a>, &amp;<a class=\"id\" href=\"#addr\">addr</a>, &amp;<a class=\"id\" href=\"#mask\">mask</a>, &amp;<a class=\"id\" href=\"#addr_len\">addr_len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#netlbl_unlhsh_remove\">netlbl_unlhsh_remove</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#mask\">mask</a>, <a class=\"id\" href=\"#addr_len\">addr_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"}", 
"", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_staticlist_gen - Generate messages for STATICLIST[DEF]</span>", 
"<span class=\"comment\"> * @cmd: command/message</span>", 
"<span class=\"comment\"> * @iface: the interface entry</span>", 
"<span class=\"comment\"> * @addr4: the IPv4 address entry</span>", 
"<span class=\"comment\"> * @addr6: the IPv6 address entry</span>", 
"<span class=\"comment\"> * @arg: the netlbl_unlhsh_walk_arg structure</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * This function is designed to be used to generate a response for a</span>", 
"<span class=\"comment\"> * STATICLIST or STATICLISTDEF message.  When called either @addr4 or @addr6</span>", 
"<span class=\"comment\"> * can be specified, not both, the other unspecified entry should be set to</span>", 
"<span class=\"comment\"> * NULL by the caller.  Returns the size of the message on success, negative</span>", 
"<span class=\"comment\"> * values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_staticlist_gen\">netlbl_unlabel_staticlist_gen</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#cmd\">cmd</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#netlbl_unlhsh_addr4\">netlbl_unlhsh_addr4</a> *<a class=\"id\" href=\"#addr4\">addr4</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#netlbl_unlhsh_addr6\">netlbl_unlhsh_addr6</a> *<a class=\"id\" href=\"#addr6\">addr6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       void *<a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_walk_arg\">netlbl_unlhsh_walk_arg</a> *<a class=\"id\" href=\"#cb_arg\">cb_arg</a> = <a class=\"id\" href=\"#arg\">arg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#secctx\">secctx</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#secctx_len\">secctx_len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#genlmsg_put\">genlmsg_put</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#nl_cb\">nl_cb</a>-><a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#seq\">seq</a>, &amp;<a class=\"id\" href=\"#netlbl_unlabel_gnl_family\">netlbl_unlabel_gnl_family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#NLM_F_MULTI\">NLM_F_MULTI</a>, <a class=\"id\" href=\"#cmd\">cmd</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#data\">data</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev_get_by_index\">dev_get_by_index</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, <a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put_string\">nla_put_string</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#NLBL_UNLABEL_A_IFACE\">NLBL_UNLABEL_A_IFACE</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#addr4\">addr4</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_addr\">in_addr</a> <a class=\"id\" href=\"#addr_struct\">addr_struct</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr_struct\">addr_struct</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#addr4\">addr4</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put\">nla_put</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4ADDR\">NLBL_UNLABEL_A_IPV4ADDR</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#addr_struct\">addr_struct</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr_struct\">addr_struct</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#addr4\">addr4</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put\">nla_put</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV4MASK\">NLBL_UNLABEL_A_IPV4MASK</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#addr_struct\">addr_struct</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secid\">secid</a> = <a class=\"id\" href=\"#addr4\">addr4</a>-><a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put\">nla_put</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6ADDR\">NLBL_UNLABEL_A_IPV6ADDR</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#addr6\">addr6</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put\">nla_put</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NLBL_UNLABEL_A_IPV6MASK\">NLBL_UNLABEL_A_IPV6MASK</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  &amp;<a class=\"id\" href=\"#addr6\">addr6</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secid\">secid</a> = <a class=\"id\" href=\"#addr6\">addr6</a>-><a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#security_secid_to_secctx\">security_secid_to_secctx</a>(<a class=\"id\" href=\"#secid\">secid</a>, &amp;<a class=\"id\" href=\"#secctx\">secctx</a>, &amp;<a class=\"id\" href=\"#secctx_len\">secctx_len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#nla_put\">nla_put</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#NLBL_UNLABEL_A_SECCTX\">NLBL_UNLABEL_A_SECCTX</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#secctx_len\">secctx_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#secctx\">secctx</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_release_secctx\">security_release_secctx</a>(<a class=\"id\" href=\"#secctx\">secctx</a>, <a class=\"id\" href=\"#secctx_len\">secctx_len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#seq\">seq</a>++;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#genlmsg_end\">genlmsg_end</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"", 
"<a class=\"id\" href=\"#list_cb_failure\">list_cb_failure</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#genlmsg_cancel\">genlmsg_cancel</a>(<a class=\"id\" href=\"#cb_arg\">cb_arg</a>-><a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_staticlist - Handle a STATICLIST message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @cb: the NETLINK callback</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated STATICLIST message and dump the unlabeled</span>", 
"<span class=\"comment\"> * connection hash table in a form suitable for use in a kernel generated</span>", 
"<span class=\"comment\"> * STATICLIST message.  Returns the length of @skb.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_staticlist\">netlbl_unlabel_staticlist</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_walk_arg\">netlbl_unlhsh_walk_arg</a> <a class=\"id\" href=\"#cb_arg\">cb_arg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#skip_bkt\">skip_bkt</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#skip_chain\">skip_chain</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#skip_addr4\">skip_addr4</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[2];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#skip_addr6\">skip_addr6</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[3];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter_bkt\">iter_bkt</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter_chain\">iter_chain</a> = 0, <a class=\"id\" href=\"#iter_addr4\">iter_addr4</a> = 0, <a class=\"id\" href=\"#iter_addr6\">iter_addr6</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#iter_list\">iter_list</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#addr4\">addr4</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#addr6\">addr6</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#nl_cb\">nl_cb</a> = <a class=\"id\" href=\"#cb\">cb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_seq\">nlmsg_seq</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter_bkt\">iter_bkt</a> = <a class=\"id\" href=\"#skip_bkt\">skip_bkt</a>;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#iter_bkt\">iter_bkt</a> &lt; <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_unlhsh\">netlbl_unlhsh</a>)-><a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#iter_bkt\">iter_bkt</a>++, <a class=\"id\" href=\"#iter_chain\">iter_chain</a> = 0, <a class=\"id\" href=\"#iter_addr4\">iter_addr4</a> = 0, <a class=\"id\" href=\"#iter_addr6\">iter_addr6</a> = 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_list\">iter_list</a> = &amp;<a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_unlhsh\">netlbl_unlhsh</a>)-><a class=\"id\" href=\"#tbl\">tbl</a>[<a class=\"id\" href=\"#iter_bkt\">iter_bkt</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#iface\">iface</a>, <a class=\"id\" href=\"#iter_list\">iter_list</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#valid\">valid</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#iter_chain\">iter_chain</a>++ &lt; <a class=\"id\" href=\"#skip_chain\">skip_chain</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_rcu\">netlbl_af4list_foreach_rcu</a>(<a class=\"id\" href=\"#addr4\">addr4</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr4_list\">addr4_list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter_addr4\">iter_addr4</a>++ &lt; <a class=\"id\" href=\"#skip_addr4\">skip_addr4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#netlbl_unlabel_staticlist_gen\">netlbl_unlabel_staticlist_gen</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICLIST\">NLBL_UNLABEL_C_STATICLIST</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#iface\">iface</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#netlbl_unlhsh_addr4_entry\">netlbl_unlhsh_addr4_entry</a>(<a class=\"id\" href=\"#addr4\">addr4</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#cb_arg\">cb_arg</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_addr4\">iter_addr4</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_chain\">iter_chain</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_staticlist_return\">unlabel_staticlist_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_foreach_rcu\">netlbl_af6list_foreach_rcu</a>(<a class=\"id\" href=\"#addr6\">addr6</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr6_list\">addr6_list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter_addr6\">iter_addr6</a>++ &lt; <a class=\"id\" href=\"#skip_addr6\">skip_addr6</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#netlbl_unlabel_staticlist_gen\">netlbl_unlabel_staticlist_gen</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICLIST\">NLBL_UNLABEL_C_STATICLIST</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#iface\">iface</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#netlbl_unlhsh_addr6_entry\">netlbl_unlhsh_addr6_entry</a>(<a class=\"id\" href=\"#addr6\">addr6</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#cb_arg\">cb_arg</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_addr6\">iter_addr6</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_chain\">iter_chain</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_staticlist_return\">unlabel_staticlist_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#unlabel_staticlist_return\">unlabel_staticlist_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0] = <a class=\"id\" href=\"#skip_bkt\">skip_bkt</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1] = <a class=\"id\" href=\"#skip_chain\">skip_chain</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[2] = <a class=\"id\" href=\"#skip_addr4\">skip_addr4</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[3] = <a class=\"id\" href=\"#skip_addr6\">skip_addr6</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_staticlistdef - Handle a STATICLISTDEF message</span>", 
"<span class=\"comment\"> * @skb: the NETLINK buffer</span>", 
"<span class=\"comment\"> * @cb: the NETLINK callback</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Process a user generated STATICLISTDEF message and dump the default</span>", 
"<span class=\"comment\"> * unlabeled connection entry in a form suitable for use in a kernel generated</span>", 
"<span class=\"comment\"> * STATICLISTDEF message.  Returns the length of @skb.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_unlabel_staticlistdef\">netlbl_unlabel_staticlistdef</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_walk_arg\">netlbl_unlhsh_walk_arg</a> <a class=\"id\" href=\"#cb_arg\">cb_arg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#skip_addr4\">skip_addr4</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#skip_addr6\">skip_addr6</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter_addr4\">iter_addr4</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#addr4\">addr4</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter_addr6\">iter_addr6</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#addr6\">addr6</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#nl_cb\">nl_cb</a> = <a class=\"id\" href=\"#cb\">cb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb_arg\">cb_arg</a>.<a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_seq\">nlmsg_seq</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_unlhsh_def\">netlbl_unlhsh_def</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || !<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#valid\">valid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_staticlistdef_return\">unlabel_staticlistdef_return</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af4list_foreach_rcu\">netlbl_af4list_foreach_rcu</a>(<a class=\"id\" href=\"#addr4\">addr4</a>, &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr4_list\">addr4_list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter_addr4\">iter_addr4</a>++ &lt; <a class=\"id\" href=\"#skip_addr4\">skip_addr4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#netlbl_unlabel_staticlist_gen\">netlbl_unlabel_staticlist_gen</a>(<a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICLISTDEF\">NLBL_UNLABEL_C_STATICLISTDEF</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#iface\">iface</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#netlbl_unlhsh_addr4_entry\">netlbl_unlhsh_addr4_entry</a>(<a class=\"id\" href=\"#addr4\">addr4</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#cb_arg\">cb_arg</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_addr4\">iter_addr4</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_staticlistdef_return\">unlabel_staticlistdef_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_af6list_foreach_rcu\">netlbl_af6list_foreach_rcu</a>(<a class=\"id\" href=\"#addr6\">addr6</a>, &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr6_list\">addr6_list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iter_addr6\">iter_addr6</a>++ &lt; <a class=\"id\" href=\"#skip_addr6\">skip_addr6</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#netlbl_unlabel_staticlist_gen\">netlbl_unlabel_staticlist_gen</a>(<a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICLISTDEF\">NLBL_UNLABEL_C_STATICLISTDEF</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#iface\">iface</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#netlbl_unlhsh_addr6_entry\">netlbl_unlhsh_addr6_entry</a>(<a class=\"id\" href=\"#addr6\">addr6</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#cb_arg\">cb_arg</a>) &lt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iter_addr6\">iter_addr6</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_staticlistdef_return\">unlabel_staticlistdef_return</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"", 
"<a class=\"id\" href=\"#unlabel_staticlistdef_return\">unlabel_staticlistdef_return</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0] = <a class=\"id\" href=\"#skip_addr4\">skip_addr4</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1] = <a class=\"id\" href=\"#skip_addr6\">skip_addr6</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * NetLabel Generic NETLINK Command Definitions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static struct <a class=\"id\" href=\"#genl_ops\">genl_ops</a> <a class=\"id\" href=\"#netlbl_unlabel_genl_ops\">netlbl_unlabel_genl_ops</a>[] = {", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICADD\">NLBL_UNLABEL_C_STATICADD</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#GENL_ADMIN_PERM\">GENL_ADMIN_PERM</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#netlbl_unlabel_staticadd\">netlbl_unlabel_staticadd</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICREMOVE\">NLBL_UNLABEL_C_STATICREMOVE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#GENL_ADMIN_PERM\">GENL_ADMIN_PERM</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#netlbl_unlabel_staticremove\">netlbl_unlabel_staticremove</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICLIST\">NLBL_UNLABEL_C_STATICLIST</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = 0,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#netlbl_unlabel_staticlist\">netlbl_unlabel_staticlist</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICADDDEF\">NLBL_UNLABEL_C_STATICADDDEF</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#GENL_ADMIN_PERM\">GENL_ADMIN_PERM</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#netlbl_unlabel_staticadddef\">netlbl_unlabel_staticadddef</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICREMOVEDEF\">NLBL_UNLABEL_C_STATICREMOVEDEF</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#GENL_ADMIN_PERM\">GENL_ADMIN_PERM</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#netlbl_unlabel_staticremovedef\">netlbl_unlabel_staticremovedef</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_STATICLISTDEF\">NLBL_UNLABEL_C_STATICLISTDEF</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = 0,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#netlbl_unlabel_staticlistdef\">netlbl_unlabel_staticlistdef</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_ACCEPT\">NLBL_UNLABEL_C_ACCEPT</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#GENL_ADMIN_PERM\">GENL_ADMIN_PERM</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#netlbl_unlabel_accept\">netlbl_unlabel_accept</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#NLBL_UNLABEL_C_LIST\">NLBL_UNLABEL_C_LIST</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flags\">flags</a> = 0,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a> = <a class=\"id\" href=\"#netlbl_unlabel_genl_policy\">netlbl_unlabel_genl_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#doit\">doit</a> = <a class=\"id\" href=\"#netlbl_unlabel_list\">netlbl_unlabel_list</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dumpit\">dumpit</a> = <a class=\"id\" href=\"#NULL\">NULL</a>,", 
"<span class=\"ts\"/>},", 
"};", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * NetLabel Generic NETLINK Protocol Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_genl_init - Register the Unlabeled NetLabel component</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Register the unlabeled packet NetLabel component with the Generic NETLINK</span>", 
"<span class=\"comment\"> * mechanism.  Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#netlbl_unlabel_genl_init\">netlbl_unlabel_genl_init</a>(void)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#genl_register_family_with_ops\">genl_register_family_with_ops</a>(&amp;<a class=\"id\" href=\"#netlbl_unlabel_gnl_family\">netlbl_unlabel_gnl_family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlbl_unlabel_genl_ops\">netlbl_unlabel_genl_ops</a>, <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#netlbl_unlabel_genl_ops\">netlbl_unlabel_genl_ops</a>));", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * NetLabel KAPI Hooks</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> <a class=\"id\" href=\"#netlbl_unlhsh_netdev_notifier\">netlbl_unlhsh_netdev_notifier</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#notifier_call\">notifier_call</a> = <a class=\"id\" href=\"#netlbl_unlhsh_netdev_handler\">netlbl_unlhsh_netdev_handler</a>,", 
"};", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_init - Initialize the unlabeled connection hash table</span>", 
"<span class=\"comment\"> * @size: the number of bits to use for the hash buckets</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Initializes the unlabeled connection hash table and registers a network</span>", 
"<span class=\"comment\"> * device notification handler.  This function should only be called by the</span>", 
"<span class=\"comment\"> * NetLabel subsystem itself during initialization.  Returns zero on success,</span>", 
"<span class=\"comment\"> * non-zero values on error.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#netlbl_unlabel_init\">netlbl_unlabel_init</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#size\">size</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#iter\">iter</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_tbl\">netlbl_unlhsh_tbl</a> *<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#size\">size</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#size\">size</a> = 1 << <a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#kcalloc\">kcalloc</a>(<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#size\">size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       sizeof(struct <a class=\"id\" href=\"#list_head\">list_head</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#tbl\">tbl</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#iter\">iter</a> = 0; <a class=\"id\" href=\"#iter\">iter</a> &lt; <a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#size\">size</a>; <a class=\"id\" href=\"#iter\">iter</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>-><a class=\"id\" href=\"#tbl\">tbl</a>[<a class=\"id\" href=\"#iter\">iter</a>]);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#netlbl_unlhsh\">netlbl_unlhsh</a>, <a class=\"id\" href=\"#hsh_tbl\">hsh_tbl</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_lock\">netlbl_unlhsh_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#register_netdevice_notifier\">register_netdevice_notifier</a>(&amp;<a class=\"id\" href=\"#netlbl_unlhsh_netdev_notifier\">netlbl_unlhsh_netdev_notifier</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_getattr - Get the security attributes for an unlabled packet</span>", 
"<span class=\"comment\"> * @skb: the packet</span>", 
"<span class=\"comment\"> * @family: protocol family</span>", 
"<span class=\"comment\"> * @secattr: the security attributes</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Determine the security attributes, if any, for an unlabled packet and return</span>", 
"<span class=\"comment\"> * them in @secattr.  Returns zero on success and negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlbl_unlabel_getattr\">netlbl_unlabel_getattr</a>(const struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#family\">family</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#netlbl_lsm_secattr\">netlbl_lsm_secattr</a> *<a class=\"id\" href=\"#secattr\">secattr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_unlhsh_iface\">netlbl_unlhsh_iface</a> *<a class=\"id\" href=\"#iface\">iface</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#netlbl_unlhsh_search_iface\">netlbl_unlhsh_search_iface</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#skb_iif\">skb_iif</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iface\">iface</a> = <a class=\"id\" href=\"#rcu_dereference\">rcu_dereference</a>(<a class=\"id\" href=\"#netlbl_unlhsh_def\">netlbl_unlhsh_def</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iface\">iface</a> == <a class=\"id\" href=\"#NULL\">NULL</a> || !<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#valid\">valid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_getattr_nolabel\">unlabel_getattr_nolabel</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#family\">family</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET\">PF_INET</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#hdr4\">hdr4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af4list\">netlbl_af4list</a> *<a class=\"id\" href=\"#addr4\">addr4</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hdr4\">hdr4</a> = <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr4\">addr4</a> = <a class=\"id\" href=\"#netlbl_af4list_search\">netlbl_af4list_search</a>(<a class=\"id\" href=\"#hdr4\">hdr4</a>-><a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr4_list\">addr4_list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addr4\">addr4</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_getattr_nolabel\">unlabel_getattr_nolabel</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#secid\">secid</a> = <a class=\"id\" href=\"#netlbl_unlhsh_addr4_entry\">netlbl_unlhsh_addr4_entry</a>(<a class=\"id\" href=\"#addr4\">addr4</a>)-><a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PF_INET6\">PF_INET6</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ipv6hdr\">ipv6hdr</a> *<a class=\"id\" href=\"#hdr6\">hdr6</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_af6list\">netlbl_af6list</a> *<a class=\"id\" href=\"#addr6\">addr6</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hdr6\">hdr6</a> = <a class=\"id\" href=\"#ipv6_hdr\">ipv6_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr6\">addr6</a> = <a class=\"id\" href=\"#netlbl_af6list_search\">netlbl_af6list_search</a>(&amp;<a class=\"id\" href=\"#hdr6\">hdr6</a>-><a class=\"id\" href=\"#saddr\">saddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      &amp;<a class=\"id\" href=\"#iface\">iface</a>-><a class=\"id\" href=\"#addr6_list\">addr6_list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addr6\">addr6</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_getattr_nolabel\">unlabel_getattr_nolabel</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#attr\">attr</a>.<a class=\"id\" href=\"#secid\">secid</a> = <a class=\"id\" href=\"#netlbl_unlhsh_addr6_entry\">netlbl_unlhsh_addr6_entry</a>(<a class=\"id\" href=\"#addr6\">addr6</a>)-><a class=\"id\" href=\"#secid\">secid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlabel_getattr_nolabel\">unlabel_getattr_nolabel</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLBL_SECATTR_SECID\">NETLBL_SECATTR_SECID</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_UNLABELED\">NETLBL_NLTYPE_UNLABELED</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#unlabel_getattr_nolabel\">unlabel_getattr_nolabel</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#netlabel_unlabel_acceptflg\">netlabel_unlabel_acceptflg</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMSG\">ENOMSG</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#secattr\">secattr</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_UNLABELED\">NETLBL_NLTYPE_UNLABELED</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_unlabel_defconf - Set the default config to allow unlabeled packets</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Set the default NetLabel configuration to allow incoming unlabeled packets</span>", 
"<span class=\"comment\"> * and to send unlabeled network traffic by default.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#netlbl_unlabel_defconf\">netlbl_unlabel_defconf</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> <a class=\"id\" href=\"#audit_info\">audit_info</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Only the kernel is allowed to call this function and the only time</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * it is called is at bootup before the audit subsystem is reporting</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * messages so don't worry to much about these values. */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_task_getsecid\">security_task_getsecid</a>(<a class=\"id\" href=\"#current\">current</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>.<a class=\"id\" href=\"#secid\">secid</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>.<a class=\"id\" href=\"#loginuid\">loginuid</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#audit_info\">audit_info</a>.<a class=\"id\" href=\"#sessionid\">sessionid</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#entry\">entry</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_UNLABELED\">NETLBL_NLTYPE_UNLABELED</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_domhsh_add_default\">netlbl_domhsh_add_default</a>(<a class=\"id\" href=\"#entry\">entry</a>, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlbl_unlabel_acceptflg_set\">netlbl_unlabel_acceptflg_set</a>(1, &amp;<a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
];
xr_frag_insert('l/a2/e964daab7718c82fba33281002c33dddbdbb15.xr', __xr_tmp);
