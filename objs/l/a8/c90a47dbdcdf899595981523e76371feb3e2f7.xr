var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * AMD Family 10h mmconfig enablement</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci\">pci</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#dmi\">dmi</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#pci\">pci</a>-<a class=\"id\" href=\"#direct\">direct</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sort\">sort</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#io\">io</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#msr\">msr</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#acpi\">acpi</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#mmconfig\">mmconfig</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#pci_x86\">pci_x86</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"struct <a class=\"id\" href=\"#pci_hostbridge_probe\">pci_hostbridge_probe</a> {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#bus\">bus</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#slot\">slot</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#vendor\">vendor</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#device\">device</a>;", 
"};", 
"", 
"static <a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#__cpuinitdata\">__cpuinitdata</a> <a class=\"id\" href=\"#fam10h_pci_mmconf_base\">fam10h_pci_mmconf_base</a>;", 
"static int <a class=\"id\" href=\"#__cpuinitdata\">__cpuinitdata</a> <a class=\"id\" href=\"#fam10h_pci_mmconf_base_status\">fam10h_pci_mmconf_base_status</a>;", 
"", 
"static struct <a class=\"id\" href=\"#pci_hostbridge_probe\">pci_hostbridge_probe</a> <a class=\"id\" href=\"#pci_probes\">pci_probes</a>[] <a class=\"id\" href=\"#__cpuinitdata\">__cpuinitdata</a> = {", 
"<span class=\"ts\"/>{ 0, 0x18, <a class=\"id\" href=\"#PCI_VENDOR_ID_AMD\">PCI_VENDOR_ID_AMD</a>, 0x1200 },", 
"<span class=\"ts\"/>{ 0xff, 0, <a class=\"id\" href=\"#PCI_VENDOR_ID_AMD\">PCI_VENDOR_ID_AMD</a>, 0x1200 },", 
"};", 
"", 
"static int <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> <a class=\"id\" href=\"#cmp_range\">cmp_range</a>(const void *<a class=\"id\" href=\"#x1\">x1</a>, const void *<a class=\"id\" href=\"#x2\">x2</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#range\">range</a> *<a class=\"id\" href=\"#r1\">r1</a> = <a class=\"id\" href=\"#x1\">x1</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#range\">range</a> *<a class=\"id\" href=\"#r2\">r2</a> = <a class=\"id\" href=\"#x2\">x2</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#start1\">start1</a>, <a class=\"id\" href=\"#start2\">start2</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#start1\">start1</a> = <a class=\"id\" href=\"#r1\">r1</a>-><a class=\"id\" href=\"#start\">start</a> >> 32;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#start2\">start2</a> = <a class=\"id\" href=\"#r2\">r2</a>-><a class=\"id\" href=\"#start\">start</a> >> 32;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#start1\">start1</a> - <a class=\"id\" href=\"#start2\">start2</a>;", 
"}", 
"", 
"<span class=\"comment\">/*[47:0] */</span>", 
"<span class=\"comment\">/* need to avoid (0xfd&lt;&lt;32) and (0xfe&lt;&lt;32), ht used space */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#FAM10H_PCI_MMCONF_BASE\">FAM10H_PCI_MMCONF_BASE</a> (0xfcULL<<32)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#BASE_VALID\">BASE_VALID</a>(<a class=\"id\" href=\"#b\">b</a>) ((<a class=\"id\" href=\"#b\">b</a> != (0xfdULL << 32)) && (<a class=\"id\" href=\"#b\">b</a> != (0xfeULL << 32)))", 
"static void <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> <a class=\"id\" href=\"#get_fam10h_pci_mmconf_base\">get_fam10h_pci_mmconf_base</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#bus\">bus</a>;", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#slot\">slot</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#found\">found</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val\">val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#address\">address</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#tom2\">tom2</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#FAM10H_PCI_MMCONF_BASE\">FAM10H_PCI_MMCONF_BASE</a>;", 
"", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#range\">range</a> <a class=\"id\" href=\"#range\">range</a>[8];", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* only try to get setting from BSP */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* -1 or 1 */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fam10h_pci_mmconf_base_status\">fam10h_pci_mmconf_base_status</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#early_pci_allowed\">early_pci_allowed</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#found\">found</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#pci_probes\">pci_probes</a>); <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#id\">id</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#device\">device</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#vendor\">vendor</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus\">bus</a> = <a class=\"id\" href=\"#pci_probes\">pci_probes</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#bus\">bus</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#slot\">slot</a> = <a class=\"id\" href=\"#pci_probes\">pci_probes</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#slot\">slot</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#read_pci_config\">read_pci_config</a>(<a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#slot\">slot</a>, 0, <a class=\"id\" href=\"#PCI_VENDOR_ID\">PCI_VENDOR_ID</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vendor\">vendor</a> = <a class=\"id\" href=\"#id\">id</a> &amp; 0xffff;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#device\">device</a> = (<a class=\"id\" href=\"#id\">id</a>>>16) &amp; 0xffff;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pci_probes\">pci_probes</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#vendor\">vendor</a> == <a class=\"id\" href=\"#vendor\">vendor</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#pci_probes\">pci_probes</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#device\">device</a> == <a class=\"id\" href=\"#device\">device</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#found\">found</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#found\">found</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* SYS_CFG */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = <a class=\"id\" href=\"#MSR_K8_SYSCFG\">MSR_K8_SYSCFG</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdmsrl\">rdmsrl</a>(<a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* TOP_MEM2 is not enabled? */</span>", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#val\">val</a> &amp; (1<<21))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tom2\">tom2</a> = 0;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* TOP_MEM2 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = <a class=\"id\" href=\"#MSR_K8_TOP_MEM2\">MSR_K8_TOP_MEM2</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rdmsrl\">rdmsrl</a>(<a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tom2\">tom2</a> = <a class=\"id\" href=\"#val\">val</a> &amp; (0xffffULL<<32);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#base\">base</a> <= <a class=\"id\" href=\"#tom2\">tom2</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#tom2\">tom2</a> + (1ULL<<32);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * need to check if the range is in the high mmio range that is</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * above 4G</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; 8; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#reg\">reg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#start\">start</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#end\">end</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reg\">reg</a> = <a class=\"id\" href=\"#read_pci_config\">read_pci_config</a>(<a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#slot\">slot</a>, 1, 0x80 + (<a class=\"id\" href=\"#i\">i</a> << 3));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#reg\">reg</a> &amp; 3))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = (((<a class=\"id\" href=\"#u64\">u64</a>)<a class=\"id\" href=\"#reg\">reg</a>) << 8) &amp; (0xffULL << 32); <span class=\"comment\">/* 39:16 on 31:8*/</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reg\">reg</a> = <a class=\"id\" href=\"#read_pci_config\">read_pci_config</a>(<a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#slot\">slot</a>, 1, 0x84 + (<a class=\"id\" href=\"#i\">i</a> << 3));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#end\">end</a> = (((<a class=\"id\" href=\"#u64\">u64</a>)<a class=\"id\" href=\"#reg\">reg</a>) << 8) &amp; (0xffULL << 32); <span class=\"comment\">/* 39:16 on 31:8*/</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#end\">end</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#range\">range</a>[<a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a>].<a class=\"id\" href=\"#start\">start</a> = <a class=\"id\" href=\"#start\">start</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#range\">range</a>[<a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a>].<a class=\"id\" href=\"#end\">end</a> = <a class=\"id\" href=\"#end\">end</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a>++;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* sort the range */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sort\">sort</a>(<a class=\"id\" href=\"#range\">range</a>, <a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a>, sizeof(struct <a class=\"id\" href=\"#range\">range</a>), <a class=\"id\" href=\"#cmp_range\">cmp_range</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#range\">range</a>[<a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a> - 1].<a class=\"id\" href=\"#end\">end</a> &lt; <a class=\"id\" href=\"#base\">base</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#range\">range</a>[0].<a class=\"id\" href=\"#start\">start</a> &gt; <a class=\"id\" href=\"#base\">base</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* need to find one window */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#range\">range</a>[0].<a class=\"id\" href=\"#start\">start</a> - (1ULL << 32);", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#base\">base</a> &gt; <a class=\"id\" href=\"#tom2\">tom2</a>) && <a class=\"id\" href=\"#BASE_VALID\">BASE_VALID</a>(<a class=\"id\" href=\"#base\">base</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#range\">range</a>[<a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a> - 1].<a class=\"id\" href=\"#end\">end</a> + (1ULL << 32);", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#base\">base</a> &gt; <a class=\"id\" href=\"#tom2\">tom2</a>) && <a class=\"id\" href=\"#BASE_VALID\">BASE_VALID</a>(<a class=\"id\" href=\"#base\">base</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* need to find window between ranges */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a> &gt; 1)", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#hi_mmio_num\">hi_mmio_num</a> - 1; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#range\">range</a>[<a class=\"id\" href=\"#i\">i</a> + 1].<a class=\"id\" href=\"#start\">start</a> &gt; (<a class=\"id\" href=\"#range\">range</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#end\">end</a> + (1ULL << 32))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#range\">range</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#end\">end</a> + (1ULL << 32);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#base\">base</a> &gt; <a class=\"id\" href=\"#tom2\">tom2</a>) && <a class=\"id\" href=\"#BASE_VALID\">BASE_VALID</a>(<a class=\"id\" href=\"#base\">base</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#fail\">fail</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fam10h_pci_mmconf_base_status\">fam10h_pci_mmconf_base_status</a> = -1;", 
"<span class=\"ts\"/>return;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fam10h_pci_mmconf_base\">fam10h_pci_mmconf_base</a> = <a class=\"id\" href=\"#base\">base</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fam10h_pci_mmconf_base_status\">fam10h_pci_mmconf_base_status</a> = 1;", 
"}", 
"", 
"void <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> <a class=\"id\" href=\"#fam10h_check_enable_mmcfg\">fam10h_check_enable_mmcfg</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val\">val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#address\">address</a>;", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#pci_probe\">pci_probe</a> &amp; <a class=\"id\" href=\"#PCI_CHECK_ENABLE_AMD_MMCONF\">PCI_CHECK_ENABLE_AMD_MMCONF</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#address\">address</a> = <a class=\"id\" href=\"#MSR_FAM10H_MMIO_CONF_BASE\">MSR_FAM10H_MMIO_CONF_BASE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdmsrl\">rdmsrl</a>(<a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* try to make sure that AP's setting is identical to BSP setting */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#val\">val</a> &amp; <a class=\"id\" href=\"#FAM10H_MMIO_CONF_ENABLE\">FAM10H_MMIO_CONF_ENABLE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned <a class=\"id\" href=\"#busnbits\">busnbits</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#busnbits\">busnbits</a> = (<a class=\"id\" href=\"#val\">val</a> >> <a class=\"id\" href=\"#FAM10H_MMIO_CONF_BUSRANGE_SHIFT\">FAM10H_MMIO_CONF_BUSRANGE_SHIFT</a>) &amp;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#FAM10H_MMIO_CONF_BUSRANGE_MASK\">FAM10H_MMIO_CONF_BUSRANGE_MASK</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* only trust the one handle 256 buses, if acpi=off */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#acpi_pci_disabled\">acpi_pci_disabled</a> || <a class=\"id\" href=\"#busnbits\">busnbits</a> >= 8) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#base\">base</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#base\">base</a> = <a class=\"id\" href=\"#val\">val</a> &amp; (0xffffULL << 32);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fam10h_pci_mmconf_base_status\">fam10h_pci_mmconf_base_status</a> <= 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fam10h_pci_mmconf_base\">fam10h_pci_mmconf_base</a> = <a class=\"id\" href=\"#base\">base</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fam10h_pci_mmconf_base_status\">fam10h_pci_mmconf_base_status</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#fam10h_pci_mmconf_base\">fam10h_pci_mmconf_base</a> ==  <a class=\"id\" href=\"#base\">base</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * if it is not enabled, try to enable it and assume only one segment</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * with 256 buses</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#get_fam10h_pci_mmconf_base\">get_fam10h_pci_mmconf_base</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fam10h_pci_mmconf_base_status\">fam10h_pci_mmconf_base_status</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"Enable MMCONFIG on AMD Family 10h\\n\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> &= ~((<a class=\"id\" href=\"#FAM10H_MMIO_CONF_BASE_MASK\">FAM10H_MMIO_CONF_BASE_MASK</a><<<a class=\"id\" href=\"#FAM10H_MMIO_CONF_BASE_SHIFT\">FAM10H_MMIO_CONF_BASE_SHIFT</a>) |", 
"<span class=\"ts\"/>     (<a class=\"id\" href=\"#FAM10H_MMIO_CONF_BUSRANGE_MASK\">FAM10H_MMIO_CONF_BUSRANGE_MASK</a><<<a class=\"id\" href=\"#FAM10H_MMIO_CONF_BUSRANGE_SHIFT\">FAM10H_MMIO_CONF_BUSRANGE_SHIFT</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> |= <a class=\"id\" href=\"#fam10h_pci_mmconf_base\">fam10h_pci_mmconf_base</a> | (8 << <a class=\"id\" href=\"#FAM10H_MMIO_CONF_BUSRANGE_SHIFT\">FAM10H_MMIO_CONF_BUSRANGE_SHIFT</a>) |", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#FAM10H_MMIO_CONF_ENABLE\">FAM10H_MMIO_CONF_ENABLE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wrmsrl\">wrmsrl</a>(<a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__devinit\">__devinit</a> <a class=\"id\" href=\"#set_check_enable_amd_mmconf\">set_check_enable_amd_mmconf</a>(const struct <a class=\"id\" href=\"#dmi_system_id\">dmi_system_id</a> *<a class=\"id\" href=\"#d\">d</a>)", 
"{", 
"        <a class=\"id\" href=\"#pci_probe\">pci_probe</a> |= <a class=\"id\" href=\"#PCI_CHECK_ENABLE_AMD_MMCONF\">PCI_CHECK_ENABLE_AMD_MMCONF</a>;", 
"        return 0;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#dmi_system_id\">dmi_system_id</a> <a class=\"id\" href=\"#__cpuinitconst\">__cpuinitconst</a> <a class=\"id\" href=\"#mmconf_dmi_table\">mmconf_dmi_table</a>[] = {", 
"        {", 
"                .<a class=\"id\" href=\"#callback\">callback</a> = <a class=\"id\" href=\"#set_check_enable_amd_mmconf\">set_check_enable_amd_mmconf</a>,", 
"                .<a class=\"id\" href=\"#ident\">ident</a> = \"Sun Microsystems Machine\",", 
"                .<a class=\"id\" href=\"#matches\">matches</a> = {", 
"                        <a class=\"id\" href=\"#DMI_MATCH\">DMI_MATCH</a>(<a class=\"id\" href=\"#DMI_SYS_VENDOR\">DMI_SYS_VENDOR</a>, \"Sun Microsystems\"),", 
"                },", 
"        },", 
"<span class=\"ts\"/>{}", 
"};", 
"", 
"void <a class=\"id\" href=\"#__cpuinit\">__cpuinit</a> <a class=\"id\" href=\"#check_enable_amd_mmconf_dmi\">check_enable_amd_mmconf_dmi</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dmi_check_system\">dmi_check_system</a>(<a class=\"id\" href=\"#mmconf_dmi_table\">mmconf_dmi_table</a>);", 
"}", 
];
xr_frag_insert('l/a8/c90a47dbdcdf899595981523e76371feb3e2f7.xr', __xr_tmp);
