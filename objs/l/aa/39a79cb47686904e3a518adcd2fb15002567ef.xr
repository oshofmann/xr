var __xr_tmp = [
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#g\">g</a>, *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#fs\">fs</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#tasklist_lock\">tasklist_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#do_each_thread\">do_each_thread</a>(<a class=\"id\" href=\"#g\">g</a>, <a class=\"id\" href=\"#p\">p</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#task_lock\">task_lock</a>(<a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fs\">fs</a> = <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#fs\">fs</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fs\">fs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#root\">root</a>.<a class=\"id\" href=\"#dentry\">dentry</a> == <a class=\"id\" href=\"#old_root\">old_root</a>-><a class=\"id\" href=\"#dentry\">dentry</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    && <a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#root\">root</a>.<a class=\"id\" href=\"#mnt\">mnt</a> == <a class=\"id\" href=\"#old_root\">old_root</a>-><a class=\"id\" href=\"#mnt\">mnt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#path_get\">path_get</a>(<a class=\"id\" href=\"#new_root\">new_root</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#root\">root</a> = *<a class=\"id\" href=\"#new_root\">new_root</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#pwd\">pwd</a>.<a class=\"id\" href=\"#dentry\">dentry</a> == <a class=\"id\" href=\"#old_root\">old_root</a>-><a class=\"id\" href=\"#dentry\">dentry</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    && <a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#pwd\">pwd</a>.<a class=\"id\" href=\"#mnt\">mnt</a> == <a class=\"id\" href=\"#old_root\">old_root</a>-><a class=\"id\" href=\"#mnt\">mnt</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#path_get\">path_get</a>(<a class=\"id\" href=\"#new_root\">new_root</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#pwd\">pwd</a> = *<a class=\"id\" href=\"#new_root\">new_root</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#task_unlock\">task_unlock</a>(<a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/>} <a class=\"id\" href=\"#while_each_thread\">while_each_thread</a>(<a class=\"id\" href=\"#g\">g</a>, <a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#tasklist_lock\">tasklist_lock</a>);", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#count\">count</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#path_put\">path_put</a>(<a class=\"id\" href=\"#old_root\">old_root</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#free_fs_struct\">free_fs_struct</a>(struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#fs\">fs</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#path_put\">path_put</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#root\">root</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#path_put\">path_put</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#pwd\">pwd</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kmem_cache_free\">kmem_cache_free</a>(<a class=\"id\" href=\"#fs_cachep\">fs_cachep</a>, <a class=\"id\" href=\"#fs\">fs</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#exit_fs\">exit_fs</a>(struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#fs\">fs</a> = <a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#fs\">fs</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fs\">fs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#kill\">kill</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#task_lock\">task_lock</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#fs\">fs</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kill\">kill</a> = !--<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#users\">users</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#task_unlock\">task_unlock</a>(<a class=\"id\" href=\"#tsk\">tsk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#kill\">kill</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_fs_struct\">free_fs_struct</a>(<a class=\"id\" href=\"#fs\">fs</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#copy_fs_struct\">copy_fs_struct</a>(struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#old\">old</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#fs\">fs</a> = <a class=\"id\" href=\"#kmem_cache_alloc\">kmem_cache_alloc</a>(<a class=\"id\" href=\"#fs_cachep\">fs_cachep</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* We don't need to lock fs - think why ;-) */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fs\">fs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#users\">users</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#in_exec\">in_exec</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#umask\">umask</a> = <a class=\"id\" href=\"#old\">old</a>-><a class=\"id\" href=\"#umask\">umask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#get_fs_root_and_pwd\">get_fs_root_and_pwd</a>(<a class=\"id\" href=\"#old\">old</a>, &amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#root\">root</a>, &amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#pwd\">pwd</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#fs\">fs</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#unshare_fs_struct\">unshare_fs_struct</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#fs\">fs</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#fs\">fs</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#new_fs\">new_fs</a> = <a class=\"id\" href=\"#copy_fs_struct\">copy_fs_struct</a>(<a class=\"id\" href=\"#fs\">fs</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#kill\">kill</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#new_fs\">new_fs</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#task_lock\">task_lock</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kill\">kill</a> = !--<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#users\">users</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#fs\">fs</a> = <a class=\"id\" href=\"#new_fs\">new_fs</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#task_unlock\">task_unlock</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#kill\">kill</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_fs_struct\">free_fs_struct</a>(<a class=\"id\" href=\"#fs\">fs</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#unshare_fs_struct\">unshare_fs_struct</a>);", 
"", 
"int <a class=\"id\" href=\"#current_umask\">current_umask</a>(void)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#umask\">umask</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#current_umask\">current_umask</a>);", 
"", 
"<span class=\"comment\">/* to be mentioned only in INIT_TASK */</span>", 
"struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> <a class=\"id\" href=\"#init_fs\">init_fs</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#users\">users</a><span class=\"ts\"/><span class=\"ts\"/>= 1,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#lock\">lock</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#__SPIN_LOCK_UNLOCKED\">__SPIN_LOCK_UNLOCKED</a>(<a class=\"id\" href=\"#init_fs\">init_fs</a>.<a class=\"id\" href=\"#lock\">lock</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#umask\">umask</a><span class=\"ts\"/><span class=\"ts\"/>= 0022,", 
"};", 
"", 
"void <a class=\"id\" href=\"#daemonize_fs_struct\">daemonize_fs_struct</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fs_struct\">fs_struct</a> *<a class=\"id\" href=\"#fs\">fs</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#fs\">fs</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fs\">fs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#kill\">kill</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#task_lock\">task_lock</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#init_fs\">init_fs</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#init_fs\">init_fs</a>.<a class=\"id\" href=\"#users\">users</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#init_fs\">init_fs</a>.<a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock\">spin_lock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#fs\">fs</a> = &amp;<a class=\"id\" href=\"#init_fs\">init_fs</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kill\">kill</a> = !--<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#users\">users</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock\">spin_unlock</a>(&amp;<a class=\"id\" href=\"#fs\">fs</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#task_unlock\">task_unlock</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#kill\">kill</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#free_fs_struct\">free_fs_struct</a>(<a class=\"id\" href=\"#fs\">fs</a>);", 
"<span class=\"ts\"/>}", 
"}", 
];
xr_frag_insert('l/aa/39a79cb47686904e3a518adcd2fb15002567ef.xr', __xr_tmp);
