var __xr_tmp = [
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#iommu\">iommu</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#index\">index</a> = <a class=\"id\" href=\"#alloc_irte\">alloc_irte</a>(<a class=\"id\" href=\"#iommu\">iommu</a>, <a class=\"id\" href=\"#irq\">irq</a>, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#index\">index</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#msi_compose_msg\">msi_compose_msg</a>(<a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#hpet_msi_write\">hpet_msi_write</a>(<a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#msg\">msg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#desc\">desc</a>-><a class=\"id\" href=\"#status\">status</a> |= <a class=\"id\" href=\"#IRQ_MOVE_PCNTXT\">IRQ_MOVE_PCNTXT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#irq_remapped\">irq_remapped</a>(<a class=\"id\" href=\"#irq\">irq</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_irq_chip_and_handler_name\">set_irq_chip_and_handler_name</a>(<a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#ir_hpet_msi_type\">ir_hpet_msi_type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#handle_edge_irq\">handle_edge_irq</a>, \"edge\");", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_irq_chip_and_handler_name\">set_irq_chip_and_handler_name</a>(<a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#hpet_msi_type\">hpet_msi_type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#handle_edge_irq\">handle_edge_irq</a>, \"edge\");", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_PCI_MSI */</span>", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Hypertransport interrupt support</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_HT_IRQ\">CONFIG_HT_IRQ</a>", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"", 
"static void <a class=\"id\" href=\"#target_ht_irq\">target_ht_irq</a>(unsigned int <a class=\"id\" href=\"#irq\">irq</a>, unsigned int <a class=\"id\" href=\"#dest\">dest</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#vector\">vector</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ht_irq_msg\">ht_irq_msg</a> <a class=\"id\" href=\"#msg\">msg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fetch_ht_irq_msg\">fetch_ht_irq_msg</a>(<a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#msg\">msg</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>.<a class=\"id\" href=\"#address_lo\">address_lo</a> &= ~(<a class=\"id\" href=\"#HT_IRQ_LOW_VECTOR_MASK\">HT_IRQ_LOW_VECTOR_MASK</a> | <a class=\"id\" href=\"#HT_IRQ_LOW_DEST_ID_MASK\">HT_IRQ_LOW_DEST_ID_MASK</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>.<a class=\"id\" href=\"#address_hi\">address_hi</a> &= ~(<a class=\"id\" href=\"#HT_IRQ_HIGH_DEST_ID_MASK\">HT_IRQ_HIGH_DEST_ID_MASK</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>.<a class=\"id\" href=\"#address_lo\">address_lo</a> |= <a class=\"id\" href=\"#HT_IRQ_LOW_VECTOR\">HT_IRQ_LOW_VECTOR</a>(<a class=\"id\" href=\"#vector\">vector</a>) | <a class=\"id\" href=\"#HT_IRQ_LOW_DEST_ID\">HT_IRQ_LOW_DEST_ID</a>(<a class=\"id\" href=\"#dest\">dest</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>.<a class=\"id\" href=\"#address_hi\">address_hi</a> |= <a class=\"id\" href=\"#HT_IRQ_HIGH_DEST_ID\">HT_IRQ_HIGH_DEST_ID</a>(<a class=\"id\" href=\"#dest\">dest</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_ht_irq_msg\">write_ht_irq_msg</a>(<a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#msg\">msg</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#set_ht_irq_affinity\">set_ht_irq_affinity</a>(unsigned int <a class=\"id\" href=\"#irq\">irq</a>, const struct <a class=\"id\" href=\"#cpumask\">cpumask</a> *<a class=\"id\" href=\"#mask\">mask</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_desc\">irq_desc</a> *<a class=\"id\" href=\"#desc\">desc</a> = <a class=\"id\" href=\"#irq_to_desc\">irq_to_desc</a>(<a class=\"id\" href=\"#irq\">irq</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_cfg\">irq_cfg</a> *<a class=\"id\" href=\"#cfg\">cfg</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#dest\">dest</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#set_desc_affinity\">set_desc_affinity</a>(<a class=\"id\" href=\"#desc\">desc</a>, <a class=\"id\" href=\"#mask\">mask</a>, &amp;<a class=\"id\" href=\"#dest\">dest</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a> = <a class=\"id\" href=\"#desc\">desc</a>-><a class=\"id\" href=\"#chip_data\">chip_data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target_ht_irq\">target_ht_irq</a>(<a class=\"id\" href=\"#irq\">irq</a>, <a class=\"id\" href=\"#dest\">dest</a>, <a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#vector\">vector</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static struct <a class=\"id\" href=\"#irq_chip\">irq_chip</a> <a class=\"id\" href=\"#ht_irq_chip\">ht_irq_chip</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a><span class=\"ts\"/><span class=\"ts\"/>= \"PCI-HT\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#mask\">mask</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#mask_ht_irq\">mask_ht_irq</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#unmask\">unmask</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#unmask_ht_irq\">unmask_ht_irq</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#ack\">ack</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#ack_apic_edge\">ack_apic_edge</a>,", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#set_affinity\">set_affinity</a><span class=\"ts\"/>= <a class=\"id\" href=\"#set_ht_irq_affinity\">set_ht_irq_affinity</a>,", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#retrigger\">retrigger</a><span class=\"ts\"/>= <a class=\"id\" href=\"#ioapic_retrigger_irq\">ioapic_retrigger_irq</a>,", 
"};", 
"", 
"int <a class=\"id\" href=\"#arch_setup_ht_irq\">arch_setup_ht_irq</a>(unsigned int <a class=\"id\" href=\"#irq\">irq</a>, struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_cfg\">irq_cfg</a> *<a class=\"id\" href=\"#cfg\">cfg</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#disable_apic\">disable_apic</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENXIO\">ENXIO</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a> = <a class=\"id\" href=\"#irq_cfg\">irq_cfg</a>(<a class=\"id\" href=\"#irq\">irq</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#assign_irq_vector\">assign_irq_vector</a>(<a class=\"id\" href=\"#irq\">irq</a>, <a class=\"id\" href=\"#cfg\">cfg</a>, <a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#target_cpus\">target_cpus</a>());", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ht_irq_msg\">ht_irq_msg</a> <a class=\"id\" href=\"#msg\">msg</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned <a class=\"id\" href=\"#dest\">dest</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dest\">dest</a> = <a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#cpu_mask_to_apicid_and\">cpu_mask_to_apicid_and</a>(<a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#target_cpus\">target_cpus</a>());", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>.<a class=\"id\" href=\"#address_hi\">address_hi</a> = <a class=\"id\" href=\"#HT_IRQ_HIGH_DEST_ID\">HT_IRQ_HIGH_DEST_ID</a>(<a class=\"id\" href=\"#dest\">dest</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>.<a class=\"id\" href=\"#address_lo\">address_lo</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_BASE\">HT_IRQ_LOW_BASE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_DEST_ID\">HT_IRQ_LOW_DEST_ID</a>(<a class=\"id\" href=\"#dest\">dest</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_VECTOR\">HT_IRQ_LOW_VECTOR</a>(<a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#vector\">vector</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>((<a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#irq_dest_mode\">irq_dest_mode</a> == 0) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_DM_PHYSICAL\">HT_IRQ_LOW_DM_PHYSICAL</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_DM_LOGICAL\">HT_IRQ_LOW_DM_LOGICAL</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_RQEOI_EDGE\">HT_IRQ_LOW_RQEOI_EDGE</a> |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>((<a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#irq_delivery_mode\">irq_delivery_mode</a> != <a class=\"id\" href=\"#dest_LowestPrio\">dest_LowestPrio</a>) ?", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_MT_FIXED\">HT_IRQ_LOW_MT_FIXED</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_MT_ARBITRATED\">HT_IRQ_LOW_MT_ARBITRATED</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#HT_IRQ_LOW_IRQ_MASKED\">HT_IRQ_LOW_IRQ_MASKED</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_ht_irq_msg\">write_ht_irq_msg</a>(<a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#msg\">msg</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_irq_chip_and_handler_name\">set_irq_chip_and_handler_name</a>(<a class=\"id\" href=\"#irq\">irq</a>, &amp;<a class=\"id\" href=\"#ht_irq_chip\">ht_irq_chip</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#handle_edge_irq\">handle_edge_irq</a>, \"edge\");", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_printk\">dev_printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a>, &amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, \"irq %d for HT\\n\", <a class=\"id\" href=\"#irq\">irq</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_HT_IRQ */</span>", 
"", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#io_apic_get_redir_entries\">io_apic_get_redir_entries</a> (int <a class=\"id\" href=\"#ioapic\">ioapic</a>)", 
"{", 
"<span class=\"ts\"/>union <a class=\"id\" href=\"#IO_APIC_reg_01\">IO_APIC_reg_01</a><span class=\"ts\"/><a class=\"id\" href=\"#reg_01\">reg_01</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_lock_irqsave\">raw_spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reg_01\">reg_01</a>.<a class=\"id\" href=\"#raw\">raw</a> = <a class=\"id\" href=\"#io_apic_read\">io_apic_read</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_unlock_irqrestore\">raw_spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* The register returns the maximum index redir index</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * supported, which is one less than the total number of redir</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * entries.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#reg_01\">reg_01</a>.<a class=\"id\" href=\"#bits\">bits</a>.<a class=\"id\" href=\"#entries\">entries</a> + 1;", 
"}", 
"", 
"void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#probe_nr_irqs_gsi\">probe_nr_irqs_gsi</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nr\">nr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nr\">nr</a> = <a class=\"id\" href=\"#gsi_top\">gsi_top</a> + <a class=\"id\" href=\"#NR_IRQS_LEGACY\">NR_IRQS_LEGACY</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nr\">nr</a> &gt; <a class=\"id\" href=\"#nr_irqs_gsi\">nr_irqs_gsi</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr_irqs_gsi\">nr_irqs_gsi</a> = <a class=\"id\" href=\"#nr\">nr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"nr_irqs_gsi: %d\\n\", <a class=\"id\" href=\"#nr_irqs_gsi\">nr_irqs_gsi</a>);", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SPARSE_IRQ\">CONFIG_SPARSE_IRQ</a>", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#arch_probe_nr_irqs\">arch_probe_nr_irqs</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#nr\">nr</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nr_irqs\">nr_irqs</a> &gt; (<a class=\"id\" href=\"#NR_VECTORS\">NR_VECTORS</a> * <a class=\"id\" href=\"#nr_cpu_ids\">nr_cpu_ids</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr_irqs\">nr_irqs</a> = <a class=\"id\" href=\"#NR_VECTORS\">NR_VECTORS</a> * <a class=\"id\" href=\"#nr_cpu_ids\">nr_cpu_ids</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nr\">nr</a> = <a class=\"id\" href=\"#nr_irqs_gsi\">nr_irqs_gsi</a> + 8 * <a class=\"id\" href=\"#nr_cpu_ids\">nr_cpu_ids</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_PCI_MSI\">CONFIG_PCI_MSI</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_HT_IRQ\">CONFIG_HT_IRQ</a>)", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * for MSI and HT dyn irq</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nr\">nr</a> += <a class=\"id\" href=\"#nr_irqs_gsi\">nr_irqs_gsi</a> * 16;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nr\">nr</a> &lt; <a class=\"id\" href=\"#nr_irqs\">nr_irqs</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr_irqs\">nr_irqs</a> = <a class=\"id\" href=\"#nr\">nr</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static int <a class=\"id\" href=\"#__io_apic_set_pci_routing\">__io_apic_set_pci_routing</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, int <a class=\"id\" href=\"#irq\">irq</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#io_apic_irq_attr\">io_apic_irq_attr</a> *<a class=\"id\" href=\"#irq_attr\">irq_attr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_desc\">irq_desc</a> *<a class=\"id\" href=\"#desc\">desc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_cfg\">irq_cfg</a> *<a class=\"id\" href=\"#cfg\">cfg</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#trigger\">trigger</a>, <a class=\"id\" href=\"#polarity\">polarity</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ioapic\">ioapic</a> = <a class=\"id\" href=\"#irq_attr\">irq_attr</a>-><a class=\"id\" href=\"#ioapic\">ioapic</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#IO_APIC_IRQ\">IO_APIC_IRQ</a>(<a class=\"id\" href=\"#irq\">irq</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#apic_printk\">apic_printk</a>(<a class=\"id\" href=\"#APIC_QUIET\">APIC_QUIET</a>,<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"IOAPIC[%d]: Invalid reference to IRQ 0\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic\">ioapic</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#node\">node</a> = <a class=\"id\" href=\"#dev_to_node\">dev_to_node</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#node\">node</a> = <a class=\"id\" href=\"#cpu_to_node\">cpu_to_node</a>(<a class=\"id\" href=\"#boot_cpu_id\">boot_cpu_id</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#desc\">desc</a> = <a class=\"id\" href=\"#irq_to_desc_alloc_node\">irq_to_desc_alloc_node</a>(<a class=\"id\" href=\"#irq\">irq</a>, <a class=\"id\" href=\"#node\">node</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#desc\">desc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"can not get irq_desc %d\\n\", <a class=\"id\" href=\"#irq\">irq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pin\">pin</a> = <a class=\"id\" href=\"#irq_attr\">irq_attr</a>-><a class=\"id\" href=\"#ioapic_pin\">ioapic_pin</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#trigger\">trigger</a> = <a class=\"id\" href=\"#irq_attr\">irq_attr</a>-><a class=\"id\" href=\"#trigger\">trigger</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#polarity\">polarity</a> = <a class=\"id\" href=\"#irq_attr\">irq_attr</a>-><a class=\"id\" href=\"#polarity\">polarity</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * IRQs &lt; 16 are already in the irq_2_pin[] map</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#irq\">irq</a> >= <a class=\"id\" href=\"#legacy_pic\">legacy_pic</a>-><a class=\"id\" href=\"#nr_legacy_irqs\">nr_legacy_irqs</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a> = <a class=\"id\" href=\"#desc\">desc</a>-><a class=\"id\" href=\"#chip_data\">chip_data</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#add_pin_to_irq_node_nopanic\">add_pin_to_irq_node_nopanic</a>(<a class=\"id\" href=\"#cfg\">cfg</a>, <a class=\"id\" href=\"#node\">node</a>, <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"can not add pin %d for irq %d\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#irq\">irq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setup_IO_APIC_irq\">setup_IO_APIC_irq</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#irq\">irq</a>, <a class=\"id\" href=\"#desc\">desc</a>, <a class=\"id\" href=\"#trigger\">trigger</a>, <a class=\"id\" href=\"#polarity\">polarity</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#io_apic_set_pci_routing\">io_apic_set_pci_routing</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, int <a class=\"id\" href=\"#irq\">irq</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#io_apic_irq_attr\">io_apic_irq_attr</a> *<a class=\"id\" href=\"#irq_attr\">irq_attr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Avoid pin reprogramming.  PRTs typically include entries</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * with redundant pin-&gt;gsi mappings (but unique PCI devices);</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * we only program the IOAPIC on the first.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ioapic\">ioapic</a> = <a class=\"id\" href=\"#irq_attr\">irq_attr</a>-><a class=\"id\" href=\"#ioapic\">ioapic</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pin\">pin</a> = <a class=\"id\" href=\"#irq_attr\">irq_attr</a>-><a class=\"id\" href=\"#ioapic_pin\">ioapic_pin</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#mp_ioapic_routing\">mp_ioapic_routing</a>[<a class=\"id\" href=\"#ioapic\">ioapic</a>].<a class=\"id\" href=\"#pin_programmed\">pin_programmed</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pr_debug\">pr_debug</a>(\"Pin %d-%d already programmed\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#ioapic\">ioapic</a>].<a class=\"id\" href=\"#apicid\">apicid</a>, <a class=\"id\" href=\"#pin\">pin</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_bit\">set_bit</a>(<a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#mp_ioapic_routing\">mp_ioapic_routing</a>[<a class=\"id\" href=\"#ioapic\">ioapic</a>].<a class=\"id\" href=\"#pin_programmed\">pin_programmed</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#__io_apic_set_pci_routing\">__io_apic_set_pci_routing</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#irq\">irq</a>, <a class=\"id\" href=\"#irq_attr\">irq_attr</a>);", 
"}", 
"", 
"<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#io_apic_unique_id\">io_apic_unique_id</a>(<a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#id\">id</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86_32\">CONFIG_X86_32</a>", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#boot_cpu_data\">boot_cpu_data</a>.<a class=\"id\" href=\"#x86_vendor\">x86_vendor</a> == <a class=\"id\" href=\"#X86_VENDOR_INTEL\">X86_VENDOR_INTEL</a>) &&", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#APIC_XAPIC\">APIC_XAPIC</a>(<a class=\"id\" href=\"#apic_version\">apic_version</a>[<a class=\"id\" href=\"#boot_cpu_physical_apicid\">boot_cpu_physical_apicid</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#io_apic_get_unique_id\">io_apic_get_unique_id</a>(<a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>, <a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#id\">id</a>;", 
"#else", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#DECLARE_BITMAP\">DECLARE_BITMAP</a>(<a class=\"id\" href=\"#used\">used</a>, 256);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bitmap_zero\">bitmap_zero</a>(<a class=\"id\" href=\"#used\">used</a>, 256);", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#mpc_ioapic\">mpc_ioapic</a> *<a class=\"id\" href=\"#ia\">ia</a> = &amp;<a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__set_bit\">__set_bit</a>(<a class=\"id\" href=\"#ia\">ia</a>-><a class=\"id\" href=\"#apicid\">apicid</a>, <a class=\"id\" href=\"#used\">used</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#id\">id</a>, <a class=\"id\" href=\"#used\">used</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#id\">id</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#find_first_zero_bit\">find_first_zero_bit</a>(<a class=\"id\" href=\"#used\">used</a>, 256);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86_32\">CONFIG_X86_32</a>", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#io_apic_get_unique_id\">io_apic_get_unique_id</a>(int <a class=\"id\" href=\"#ioapic\">ioapic</a>, int <a class=\"id\" href=\"#apic_id\">apic_id</a>)", 
"{", 
"<span class=\"ts\"/>union <a class=\"id\" href=\"#IO_APIC_reg_00\">IO_APIC_reg_00</a> <a class=\"id\" href=\"#reg_00\">reg_00</a>;", 
"<span class=\"ts\"/>static <a class=\"id\" href=\"#physid_mask_t\">physid_mask_t</a> <a class=\"id\" href=\"#apic_id_map\">apic_id_map</a> = <a class=\"id\" href=\"#PHYSID_MASK_NONE\">PHYSID_MASK_NONE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#physid_mask_t\">physid_mask_t</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * The P4 platform supports up to 256 APIC IDs on two separate APIC</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * buses (one for LAPICs, one for IOAPICs), where predecessors only</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * supports up to 16 on one shared APIC bus.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * TBD: Expand LAPIC/IOAPIC support on P4-class systems to take full</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *      advantage of new APIC bus architecture.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#physids_empty\">physids_empty</a>(<a class=\"id\" href=\"#apic_id_map\">apic_id_map</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#ioapic_phys_id_map\">ioapic_phys_id_map</a>(&amp;<a class=\"id\" href=\"#phys_cpu_present_map\">phys_cpu_present_map</a>, &amp;<a class=\"id\" href=\"#apic_id_map\">apic_id_map</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_lock_irqsave\">raw_spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#raw\">raw</a> = <a class=\"id\" href=\"#io_apic_read\">io_apic_read</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_unlock_irqrestore\">raw_spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#apic_id\">apic_id</a> >= <a class=\"id\" href=\"#get_physical_broadcast\">get_physical_broadcast</a>()) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"IOAPIC[%d]: Invalid apic_id %d, trying \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"%d\\n\", <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#apic_id\">apic_id</a>, <a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#bits\">bits</a>.<a class=\"id\" href=\"#ID\">ID</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#apic_id\">apic_id</a> = <a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#bits\">bits</a>.<a class=\"id\" href=\"#ID\">ID</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Every APIC in a system must have a unique ID or we get lots of nice</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * 'stuck on smp_invalidate_needed IPI wait' messages.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#check_apicid_used\">check_apicid_used</a>(&amp;<a class=\"id\" href=\"#apic_id_map\">apic_id_map</a>, <a class=\"id\" href=\"#apic_id\">apic_id</a>)) {", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#get_physical_broadcast\">get_physical_broadcast</a>(); <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#check_apicid_used\">check_apicid_used</a>(&amp;<a class=\"id\" href=\"#apic_id_map\">apic_id_map</a>, <a class=\"id\" href=\"#i\">i</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> == <a class=\"id\" href=\"#get_physical_broadcast\">get_physical_broadcast</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#panic\">panic</a>(\"Max apic_id exceeded!\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"IOAPIC[%d]: apic_id %d already used, \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"trying %d\\n\", <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#apic_id\">apic_id</a>, <a class=\"id\" href=\"#i\">i</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#apic_id\">apic_id</a> = <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#apicid_to_cpu_present\">apicid_to_cpu_present</a>(<a class=\"id\" href=\"#apic_id\">apic_id</a>, &amp;<a class=\"id\" href=\"#tmp\">tmp</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#physids_or\">physids_or</a>(<a class=\"id\" href=\"#apic_id_map\">apic_id_map</a>, <a class=\"id\" href=\"#apic_id_map\">apic_id_map</a>, <a class=\"id\" href=\"#tmp\">tmp</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#bits\">bits</a>.<a class=\"id\" href=\"#ID\">ID</a> != <a class=\"id\" href=\"#apic_id\">apic_id</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#bits\">bits</a>.<a class=\"id\" href=\"#ID\">ID</a> = <a class=\"id\" href=\"#apic_id\">apic_id</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_lock_irqsave\">raw_spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#io_apic_write\">io_apic_write</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, 0, <a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#raw\">raw</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#raw\">raw</a> = <a class=\"id\" href=\"#io_apic_read\">io_apic_read</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_unlock_irqrestore\">raw_spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Sanity check */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#reg_00\">reg_00</a>.<a class=\"id\" href=\"#bits\">bits</a>.<a class=\"id\" href=\"#ID\">ID</a> != <a class=\"id\" href=\"#apic_id\">apic_id</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"IOAPIC[%d]: Unable to change apic_id!\\n\", <a class=\"id\" href=\"#ioapic\">ioapic</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#apic_printk\">apic_printk</a>(<a class=\"id\" href=\"#APIC_VERBOSE\">APIC_VERBOSE</a>, <a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"IOAPIC[%d]: Assigned apic_id %d\\n\", <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#apic_id\">apic_id</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#apic_id\">apic_id</a>;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#io_apic_get_version\">io_apic_get_version</a>(int <a class=\"id\" href=\"#ioapic\">ioapic</a>)", 
"{", 
"<span class=\"ts\"/>union <a class=\"id\" href=\"#IO_APIC_reg_01\">IO_APIC_reg_01</a><span class=\"ts\"/><a class=\"id\" href=\"#reg_01\">reg_01</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_lock_irqsave\">raw_spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reg_01\">reg_01</a>.<a class=\"id\" href=\"#raw\">raw</a> = <a class=\"id\" href=\"#io_apic_read\">io_apic_read</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#raw_spin_unlock_irqrestore\">raw_spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#ioapic_lock\">ioapic_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#reg_01\">reg_01</a>.<a class=\"id\" href=\"#bits\">bits</a>.<a class=\"id\" href=\"#version\">version</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#acpi_get_override_irq\">acpi_get_override_irq</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#gsi\">gsi</a>, int *<a class=\"id\" href=\"#trigger\">trigger</a>, int *<a class=\"id\" href=\"#polarity\">polarity</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skip_ioapic_setup\">skip_ioapic_setup</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ioapic\">ioapic</a> = <a class=\"id\" href=\"#mp_find_ioapic\">mp_find_ioapic</a>(<a class=\"id\" href=\"#gsi\">gsi</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ioapic\">ioapic</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pin\">pin</a> = <a class=\"id\" href=\"#mp_find_ioapic_pin\">mp_find_ioapic_pin</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#gsi\">gsi</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pin\">pin</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#find_irq_entry\">find_irq_entry</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#mp_INT\">mp_INT</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#idx\">idx</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#trigger\">trigger</a> = <a class=\"id\" href=\"#irq_trigger\">irq_trigger</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#polarity\">polarity</a> = <a class=\"id\" href=\"#irq_polarity\">irq_polarity</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * This function currently is only a helper for the i386 smp boot process where</span>", 
"<span class=\"comment\"> * we need to reprogram the ioredtbls to cater for the cpus which have come online</span>", 
"<span class=\"comment\"> * so mask in all cases should simply be apic-&gt;target_cpus()</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#setup_ioapic_dest\">setup_ioapic_dest</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#irq\">irq</a>, <a class=\"id\" href=\"#irq_entry\">irq_entry</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_desc\">irq_desc</a> *<a class=\"id\" href=\"#desc\">desc</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#cpumask\">cpumask</a> *<a class=\"id\" href=\"#mask\">mask</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skip_ioapic_setup\">skip_ioapic_setup</a> == 1)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#ioapic\">ioapic</a> = 0; <a class=\"id\" href=\"#ioapic\">ioapic</a> &lt; <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>; <a class=\"id\" href=\"#ioapic\">ioapic</a>++)", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pin\">pin</a> = 0; <a class=\"id\" href=\"#pin\">pin</a> &lt; <a class=\"id\" href=\"#nr_ioapic_registers\">nr_ioapic_registers</a>[<a class=\"id\" href=\"#ioapic\">ioapic</a>]; <a class=\"id\" href=\"#pin\">pin</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#irq_entry\">irq_entry</a> = <a class=\"id\" href=\"#find_irq_entry\">find_irq_entry</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>, <a class=\"id\" href=\"#mp_INT\">mp_INT</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#irq_entry\">irq_entry</a> == -1)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#irq\">irq</a> = <a class=\"id\" href=\"#pin_2_irq\">pin_2_irq</a>(<a class=\"id\" href=\"#irq_entry\">irq_entry</a>, <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#pin\">pin</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#ioapic\">ioapic</a> &gt; 0) && (<a class=\"id\" href=\"#irq\">irq</a> &gt; 16))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#desc\">desc</a> = <a class=\"id\" href=\"#irq_to_desc\">irq_to_desc</a>(<a class=\"id\" href=\"#irq\">irq</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Honour affinities which have been set in early boot</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#desc\">desc</a>-><a class=\"id\" href=\"#status\">status</a> &amp;", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#IRQ_NO_BALANCING\">IRQ_NO_BALANCING</a> | <a class=\"id\" href=\"#IRQ_AFFINITY_SET\">IRQ_AFFINITY_SET</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#desc\">desc</a>-><a class=\"id\" href=\"#affinity\">affinity</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#apic\">apic</a>-><a class=\"id\" href=\"#target_cpus\">target_cpus</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#intr_remapping_enabled\">intr_remapping_enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_ir_ioapic_affinity_irq_desc\">set_ir_ioapic_affinity_irq_desc</a>(<a class=\"id\" href=\"#desc\">desc</a>, <a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_ioapic_affinity_irq_desc\">set_ioapic_affinity_irq_desc</a>(<a class=\"id\" href=\"#desc\">desc</a>, <a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/>}", 
"", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IOAPIC_RESOURCE_NAME_SIZE\">IOAPIC_RESOURCE_NAME_SIZE</a> 11", 
"", 
"static struct <a class=\"id\" href=\"#resource\">resource</a> *<a class=\"id\" href=\"#ioapic_resources\">ioapic_resources</a>;", 
"", 
"static struct <a class=\"id\" href=\"#resource\">resource</a> * <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#ioapic_setup_resources\">ioapic_setup_resources</a>(int <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#n\">n</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#resource\">resource</a> *<a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#mem\">mem</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#n\">n</a> = <a class=\"id\" href=\"#IOAPIC_RESOURCE_NAME_SIZE\">IOAPIC_RESOURCE_NAME_SIZE</a> + sizeof(struct <a class=\"id\" href=\"#resource\">resource</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#n\">n</a> *= <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mem\">mem</a> = <a class=\"id\" href=\"#alloc_bootmem\">alloc_bootmem</a>(<a class=\"id\" href=\"#n\">n</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a> = (void *)<a class=\"id\" href=\"#mem\">mem</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mem\">mem</a> += sizeof(struct <a class=\"id\" href=\"#resource\">resource</a>) * <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#mem\">mem</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#IORESOURCE_MEM\">IORESOURCE_MEM</a> | <a class=\"id\" href=\"#IORESOURCE_BUSY\">IORESOURCE_BUSY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#snprintf\">snprintf</a>(<a class=\"id\" href=\"#mem\">mem</a>, <a class=\"id\" href=\"#IOAPIC_RESOURCE_NAME_SIZE\">IOAPIC_RESOURCE_NAME_SIZE</a>, \"IOAPIC %u\", <a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mem\">mem</a> += <a class=\"id\" href=\"#IOAPIC_RESOURCE_NAME_SIZE\">IOAPIC_RESOURCE_NAME_SIZE</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ioapic_resources\">ioapic_resources</a> = <a class=\"id\" href=\"#res\">res</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#ioapic_init_mappings\">ioapic_init_mappings</a>(void)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a>, <a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#FIX_IO_APIC_BASE_0\">FIX_IO_APIC_BASE_0</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#resource\">resource</a> *<a class=\"id\" href=\"#ioapic_res\">ioapic_res</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ioapic_res\">ioapic_res</a> = <a class=\"id\" href=\"#ioapic_setup_resources\">ioapic_setup_resources</a>(<a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>);", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#smp_found_config\">smp_found_config</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a> = <a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#apicaddr\">apicaddr</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86_32\">CONFIG_X86_32</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       \"WARNING: bogus zero IO-APIC \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       \"address found in MPTABLE, \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       \"disabling IO/APIC support!\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#smp_found_config\">smp_found_config</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skip_ioapic_setup\">skip_ioapic_setup</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fake_ioapic_page\">fake_ioapic_page</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_X86_32\">CONFIG_X86_32</a>", 
"<a class=\"id\" href=\"#fake_ioapic_page\">fake_ioapic_page</a>:", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a> = (unsigned long)<a class=\"id\" href=\"#alloc_bootmem_pages\">alloc_bootmem_pages</a>(<a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a> = <a class=\"id\" href=\"#__pa\">__pa</a>(<a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_fixmap_nocache\">set_fixmap_nocache</a>(<a class=\"id\" href=\"#idx\">idx</a>, <a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#apic_printk\">apic_printk</a>(<a class=\"id\" href=\"#APIC_VERBOSE\">APIC_VERBOSE</a>, \"mapped IOAPIC to %08lx (%08lx)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__fix_to_virt\">__fix_to_virt</a>(<a class=\"id\" href=\"#idx\">idx</a>) + (<a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a> &amp; ~<a class=\"id\" href=\"#PAGE_MASK\">PAGE_MASK</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a>++;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic_res\">ioapic_res</a>-><a class=\"id\" href=\"#start\">start</a> = <a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic_res\">ioapic_res</a>-><a class=\"id\" href=\"#end\">end</a> = <a class=\"id\" href=\"#ioapic_phys\">ioapic_phys</a> + <a class=\"id\" href=\"#IO_APIC_SLOT_SIZE\">IO_APIC_SLOT_SIZE</a> - 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ioapic_res\">ioapic_res</a>++;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#ioapic_insert_resources\">ioapic_insert_resources</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#resource\">resource</a> *<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#ioapic_resources\">ioapic_resources</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#r\">r</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"IO APIC resources couldn't be allocated.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#insert_resource\">insert_resource</a>(&amp;<a class=\"id\" href=\"#iomem_resource\">iomem_resource</a>, <a class=\"id\" href=\"#r\">r</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>++;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"int <a class=\"id\" href=\"#mp_find_ioapic\">mp_find_ioapic</a>(<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#gsi\">gsi</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Find the IOAPIC that manages this GSI. */</span>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#gsi\">gsi</a> >= <a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#gsi_base\">gsi_base</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>    && (<a class=\"id\" href=\"#gsi\">gsi</a> <= <a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#i\">i</a>].<a class=\"id\" href=\"#gsi_end\">gsi_end</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"ERROR: Unable to locate IOAPIC for GSI %d\\n\", <a class=\"id\" href=\"#gsi\">gsi</a>);", 
"<span class=\"ts\"/>return -1;", 
"}", 
"", 
"int <a class=\"id\" href=\"#mp_find_ioapic_pin\">mp_find_ioapic_pin</a>(int <a class=\"id\" href=\"#ioapic\">ioapic</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#gsi\">gsi</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(<a class=\"id\" href=\"#ioapic\">ioapic</a> == -1))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(<a class=\"id\" href=\"#gsi\">gsi</a> &gt; <a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#ioapic\">ioapic</a>].<a class=\"id\" href=\"#gsi_end\">gsi_end</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#gsi\">gsi</a> - <a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#ioapic\">ioapic</a>].<a class=\"id\" href=\"#gsi_base\">gsi_base</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#bad_ioapic\">bad_ioapic</a>(unsigned long <a class=\"id\" href=\"#address\">address</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a> >= <a class=\"id\" href=\"#MAX_IO_APICS\">MAX_IO_APICS</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"WARING: Max # of I/O APICs (%d) exceeded \"", 
"<span class=\"ts\"/><span class=\"ts\"/>       \"(found %d), skipping\\n\", <a class=\"id\" href=\"#MAX_IO_APICS\">MAX_IO_APICS</a>, <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#address\">address</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"WARNING: Bogus (zero) I/O APIC address\"", 
"<span class=\"ts\"/><span class=\"ts\"/>       \" found in table, skipping!\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#mp_register_ioapic\">mp_register_ioapic</a>(int <a class=\"id\" href=\"#id\">id</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#address\">address</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#gsi_base\">gsi_base</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#entries\">entries</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#bad_ioapic\">bad_ioapic</a>(<a class=\"id\" href=\"#address\">address</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#MP_IOAPIC\">MP_IOAPIC</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#flags\">flags</a> = <a class=\"id\" href=\"#MPC_APIC_USABLE\">MPC_APIC_USABLE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#apicaddr\">apicaddr</a> = <a class=\"id\" href=\"#address\">address</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_fixmap_nocache\">set_fixmap_nocache</a>(<a class=\"id\" href=\"#FIX_IO_APIC_BASE_0\">FIX_IO_APIC_BASE_0</a> + <a class=\"id\" href=\"#idx\">idx</a>, <a class=\"id\" href=\"#address\">address</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#apicid\">apicid</a> = <a class=\"id\" href=\"#io_apic_unique_id\">io_apic_unique_id</a>(<a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#apicver\">apicver</a> = <a class=\"id\" href=\"#io_apic_get_version\">io_apic_get_version</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Build basic GSI lookup table to facilitate gsi-&gt;io_apic lookups</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * and to prevent reprogramming of IOAPIC pins (PCI GSIs).</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entries\">entries</a> = <a class=\"id\" href=\"#io_apic_get_redir_entries\">io_apic_get_redir_entries</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#gsi_base\">gsi_base</a> = <a class=\"id\" href=\"#gsi_base\">gsi_base</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#gsi_end\">gsi_end</a> = <a class=\"id\" href=\"#gsi_base\">gsi_base</a> + <a class=\"id\" href=\"#entries\">entries</a> - 1;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * The number of IO-APIC IRQ registers (== #pins):</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nr_ioapic_registers\">nr_ioapic_registers</a>[<a class=\"id\" href=\"#idx\">idx</a>] = <a class=\"id\" href=\"#entries\">entries</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#gsi_end\">gsi_end</a> >= <a class=\"id\" href=\"#gsi_top\">gsi_top</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#gsi_top\">gsi_top</a> = <a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#gsi_end\">gsi_end</a> + 1;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"IOAPIC[%d]: apic_id %d, version %d, address 0x%x, \"", 
"<span class=\"ts\"/>       \"GSI %d-%d\\n\", <a class=\"id\" href=\"#idx\">idx</a>, <a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#apicid\">apicid</a>,", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#apicver\">apicver</a>, <a class=\"id\" href=\"#mp_ioapics\">mp_ioapics</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#apicaddr\">apicaddr</a>,", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#gsi_base\">gsi_base</a>, <a class=\"id\" href=\"#mp_gsi_routing\">mp_gsi_routing</a>[<a class=\"id\" href=\"#idx\">idx</a>].<a class=\"id\" href=\"#gsi_end\">gsi_end</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nr_ioapics\">nr_ioapics</a>++;", 
"}", 
"", 
"<span class=\"comment\">/* Enable IOAPIC early just for system timer */</span>", 
"void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#pre_init_apic_IRQ0\">pre_init_apic_IRQ0</a>(void)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_cfg\">irq_cfg</a> *<a class=\"id\" href=\"#cfg\">cfg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#irq_desc\">irq_desc</a> *<a class=\"id\" href=\"#desc\">desc</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"Early APIC setup for system timer0\\n\");", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#CONFIG_SMP\">CONFIG_SMP</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#phys_cpu_present_map\">phys_cpu_present_map</a> = <a class=\"id\" href=\"#physid_mask_of_physid\">physid_mask_of_physid</a>(<a class=\"id\" href=\"#boot_cpu_physical_apicid\">boot_cpu_physical_apicid</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#desc\">desc</a> = <a class=\"id\" href=\"#irq_to_desc_alloc_node\">irq_to_desc_alloc_node</a>(0, 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setup_local_APIC\">setup_local_APIC</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a> = <a class=\"id\" href=\"#irq_cfg\">irq_cfg</a>(0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#add_pin_to_irq_node\">add_pin_to_irq_node</a>(<a class=\"id\" href=\"#cfg\">cfg</a>, 0, 0, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_irq_chip_and_handler_name\">set_irq_chip_and_handler_name</a>(0, &amp;<a class=\"id\" href=\"#ioapic_chip\">ioapic_chip</a>, <a class=\"id\" href=\"#handle_edge_irq\">handle_edge_irq</a>, \"edge\");", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setup_IO_APIC_irq\">setup_IO_APIC_irq</a>(0, 0, 0, <a class=\"id\" href=\"#desc\">desc</a>, 0, 0);", 
"}", 
];
xr_frag_insert('l/ad/2c97adb521cf8b59675c714b2a452852355951.xr', __xr_tmp);
