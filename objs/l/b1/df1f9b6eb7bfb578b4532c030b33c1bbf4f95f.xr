var __xr_tmp = [
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_CPU_SUP_INTEL\">CONFIG_CPU_SUP_INTEL</a>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Not sure about some of these</span>", 
"<span class=\"comment\"> */</span>", 
"static const <a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#p6_perfmon_event_map\">p6_perfmon_event_map</a>[] =", 
"{", 
"  [<a class=\"id\" href=\"#PERF_COUNT_HW_CPU_CYCLES\">PERF_COUNT_HW_CPU_CYCLES</a>]<span class=\"ts\"/><span class=\"ts\"/>= 0x0079,", 
"  [<a class=\"id\" href=\"#PERF_COUNT_HW_INSTRUCTIONS\">PERF_COUNT_HW_INSTRUCTIONS</a>]<span class=\"ts\"/><span class=\"ts\"/>= 0x00c0,", 
"  [<a class=\"id\" href=\"#PERF_COUNT_HW_CACHE_REFERENCES\">PERF_COUNT_HW_CACHE_REFERENCES</a>]<span class=\"ts\"/>= 0x0f2e,", 
"  [<a class=\"id\" href=\"#PERF_COUNT_HW_CACHE_MISSES\">PERF_COUNT_HW_CACHE_MISSES</a>]<span class=\"ts\"/><span class=\"ts\"/>= 0x012e,", 
"  [<a class=\"id\" href=\"#PERF_COUNT_HW_BRANCH_INSTRUCTIONS\">PERF_COUNT_HW_BRANCH_INSTRUCTIONS</a>]<span class=\"ts\"/>= 0x00c4,", 
"  [<a class=\"id\" href=\"#PERF_COUNT_HW_BRANCH_MISSES\">PERF_COUNT_HW_BRANCH_MISSES</a>]<span class=\"ts\"/><span class=\"ts\"/>= 0x00c5,", 
"  [<a class=\"id\" href=\"#PERF_COUNT_HW_BUS_CYCLES\">PERF_COUNT_HW_BUS_CYCLES</a>]<span class=\"ts\"/><span class=\"ts\"/>= 0x0062,", 
"};", 
"", 
"static <a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#p6_pmu_event_map\">p6_pmu_event_map</a>(int <a class=\"id\" href=\"#hw_event\">hw_event</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#p6_perfmon_event_map\">p6_perfmon_event_map</a>[<a class=\"id\" href=\"#hw_event\">hw_event</a>];", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Event setting that is specified not to count anything.</span>", 
"<span class=\"comment\"> * We use this to effectively disable a counter.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * L2_RQSTS with 0 MESI unit mask.</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#P6_NOP_EVENT\">P6_NOP_EVENT</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>0x0000002EULL", 
"", 
"static struct <a class=\"id\" href=\"#event_constraint\">event_constraint</a> <a class=\"id\" href=\"#p6_event_constraints\">p6_event_constraints</a>[] =", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INTEL_EVENT_CONSTRAINT\">INTEL_EVENT_CONSTRAINT</a>(0xc1, 0x1),<span class=\"ts\"/><span class=\"comment\">/* FLOPS */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INTEL_EVENT_CONSTRAINT\">INTEL_EVENT_CONSTRAINT</a>(0x10, 0x1),<span class=\"ts\"/><span class=\"comment\">/* FP_COMP_OPS_EXE */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INTEL_EVENT_CONSTRAINT\">INTEL_EVENT_CONSTRAINT</a>(0x11, 0x1),<span class=\"ts\"/><span class=\"comment\">/* FP_ASSIST */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INTEL_EVENT_CONSTRAINT\">INTEL_EVENT_CONSTRAINT</a>(0x12, 0x2),<span class=\"ts\"/><span class=\"comment\">/* MUL */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INTEL_EVENT_CONSTRAINT\">INTEL_EVENT_CONSTRAINT</a>(0x13, 0x2),<span class=\"ts\"/><span class=\"comment\">/* DIV */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INTEL_EVENT_CONSTRAINT\">INTEL_EVENT_CONSTRAINT</a>(0x14, 0x1),<span class=\"ts\"/><span class=\"comment\">/* CYCLES_DIV_BUSY */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#EVENT_CONSTRAINT_END\">EVENT_CONSTRAINT_END</a>", 
"};", 
"", 
"static void <a class=\"id\" href=\"#p6_pmu_disable_all\">p6_pmu_disable_all</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* p6 only has one enable register */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdmsrl\">rdmsrl</a>(<a class=\"id\" href=\"#MSR_P6_EVNTSEL0\">MSR_P6_EVNTSEL0</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> &= ~<a class=\"id\" href=\"#ARCH_PERFMON_EVENTSEL_ENABLE\">ARCH_PERFMON_EVENTSEL_ENABLE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wrmsrl\">wrmsrl</a>(<a class=\"id\" href=\"#MSR_P6_EVNTSEL0\">MSR_P6_EVNTSEL0</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#p6_pmu_enable_all\">p6_pmu_enable_all</a>(int <a class=\"id\" href=\"#added\">added</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* p6 only has one enable register */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rdmsrl\">rdmsrl</a>(<a class=\"id\" href=\"#MSR_P6_EVNTSEL0\">MSR_P6_EVNTSEL0</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> |= <a class=\"id\" href=\"#ARCH_PERFMON_EVENTSEL_ENABLE\">ARCH_PERFMON_EVENTSEL_ENABLE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#wrmsrl\">wrmsrl</a>(<a class=\"id\" href=\"#MSR_P6_EVNTSEL0\">MSR_P6_EVNTSEL0</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void", 
"<a class=\"id\" href=\"#p6_pmu_disable_event\">p6_pmu_disable_event</a>(struct <a class=\"id\" href=\"#perf_event\">perf_event</a> *<a class=\"id\" href=\"#event\">event</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cpu_hw_events\">cpu_hw_events</a> *<a class=\"id\" href=\"#cpuc\">cpuc</a> = &amp;<a class=\"id\" href=\"#__get_cpu_var\">__get_cpu_var</a>(<a class=\"id\" href=\"#cpu_hw_events\">cpu_hw_events</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hw_perf_event\">hw_perf_event</a> *<a class=\"id\" href=\"#hwc\">hwc</a> = &amp;<a class=\"id\" href=\"#event\">event</a>-><a class=\"id\" href=\"#hw\">hw</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#P6_NOP_EVENT\">P6_NOP_EVENT</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cpuc\">cpuc</a>-><a class=\"id\" href=\"#enabled\">enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> |= <a class=\"id\" href=\"#ARCH_PERFMON_EVENTSEL_ENABLE\">ARCH_PERFMON_EVENTSEL_ENABLE</a>;", 
"", 
"<span class=\"ts\"/>(void)<a class=\"id\" href=\"#checking_wrmsrl\">checking_wrmsrl</a>(<a class=\"id\" href=\"#hwc\">hwc</a>-><a class=\"id\" href=\"#config_base\">config_base</a> + <a class=\"id\" href=\"#hwc\">hwc</a>-><a class=\"id\" href=\"#idx\">idx</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#p6_pmu_enable_event\">p6_pmu_enable_event</a>(struct <a class=\"id\" href=\"#perf_event\">perf_event</a> *<a class=\"id\" href=\"#event\">event</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cpu_hw_events\">cpu_hw_events</a> *<a class=\"id\" href=\"#cpuc\">cpuc</a> = &amp;<a class=\"id\" href=\"#__get_cpu_var\">__get_cpu_var</a>(<a class=\"id\" href=\"#cpu_hw_events\">cpu_hw_events</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hw_perf_event\">hw_perf_event</a> *<a class=\"id\" href=\"#hwc\">hwc</a> = &amp;<a class=\"id\" href=\"#event\">event</a>-><a class=\"id\" href=\"#hw\">hw</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#hwc\">hwc</a>-><a class=\"id\" href=\"#config\">config</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cpuc\">cpuc</a>-><a class=\"id\" href=\"#enabled\">enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> |= <a class=\"id\" href=\"#ARCH_PERFMON_EVENTSEL_ENABLE\">ARCH_PERFMON_EVENTSEL_ENABLE</a>;", 
"", 
"<span class=\"ts\"/>(void)<a class=\"id\" href=\"#checking_wrmsrl\">checking_wrmsrl</a>(<a class=\"id\" href=\"#hwc\">hwc</a>-><a class=\"id\" href=\"#config_base\">config_base</a> + <a class=\"id\" href=\"#hwc\">hwc</a>-><a class=\"id\" href=\"#idx\">idx</a>, <a class=\"id\" href=\"#val\">val</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#__initconst\">__initconst</a> const struct <a class=\"id\" href=\"#x86_pmu\">x86_pmu</a> <a class=\"id\" href=\"#p6_pmu\">p6_pmu</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>= \"p6\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#handle_irq\">handle_irq</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#x86_pmu_handle_irq\">x86_pmu_handle_irq</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#disable_all\">disable_all</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#p6_pmu_disable_all\">p6_pmu_disable_all</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#enable_all\">enable_all</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#p6_pmu_enable_all\">p6_pmu_enable_all</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#enable\">enable</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#p6_pmu_enable_event\">p6_pmu_enable_event</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#disable\">disable</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#p6_pmu_disable_event\">p6_pmu_disable_event</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#hw_config\">hw_config</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#x86_pmu_hw_config\">x86_pmu_hw_config</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#schedule_events\">schedule_events</a><span class=\"ts\"/>= <a class=\"id\" href=\"#x86_schedule_events\">x86_schedule_events</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#eventsel\">eventsel</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#MSR_P6_EVNTSEL0\">MSR_P6_EVNTSEL0</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#perfctr\">perfctr</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#MSR_P6_PERFCTR0\">MSR_P6_PERFCTR0</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#event_map\">event_map</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#p6_pmu_event_map\">p6_pmu_event_map</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#max_events\">max_events</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#p6_perfmon_event_map\">p6_perfmon_event_map</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#apic\">apic</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>= 1,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#max_period\">max_period</a><span class=\"ts\"/><span class=\"ts\"/>= (1ULL << 31) - 1,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#version\">version</a><span class=\"ts\"/><span class=\"ts\"/>= 0,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#num_counters\">num_counters</a><span class=\"ts\"/><span class=\"ts\"/>= 2,", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Events have 40 bits implemented. However they are designed such</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * that bits [32-39] are sign extensions of bit 31. As such the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * effective width of a event for P6-like PMU is 32 bits only.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * See IA-32 Intel Architecture Software developer manual Vol 3B</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cntval_bits\">cntval_bits</a><span class=\"ts\"/><span class=\"ts\"/>= 32,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#cntval_mask\">cntval_mask</a><span class=\"ts\"/><span class=\"ts\"/>= (1ULL << 32) - 1,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#get_event_constraints\">get_event_constraints</a><span class=\"ts\"/>= <a class=\"id\" href=\"#x86_get_event_constraints\">x86_get_event_constraints</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#event_constraints\">event_constraints</a><span class=\"ts\"/>= <a class=\"id\" href=\"#p6_event_constraints\">p6_event_constraints</a>,", 
"};", 
"", 
"static <a class=\"id\" href=\"#__init\">__init</a> int <a class=\"id\" href=\"#p6_pmu_init\">p6_pmu_init</a>(void)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#boot_cpu_data\">boot_cpu_data</a>.<a class=\"id\" href=\"#x86_model\">x86_model</a>) {", 
"<span class=\"ts\"/>case 1:", 
"<span class=\"ts\"/>case 3:  <span class=\"comment\">/* Pentium Pro */</span>", 
"<span class=\"ts\"/>case 5:", 
"<span class=\"ts\"/>case 6:  <span class=\"comment\">/* Pentium II */</span>", 
"<span class=\"ts\"/>case 7:", 
"<span class=\"ts\"/>case 8:", 
"<span class=\"ts\"/>case 11: <span class=\"comment\">/* Pentium III */</span>", 
"<span class=\"ts\"/>case 9:", 
"<span class=\"ts\"/>case 13:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Pentium M */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pr_cont\">pr_cont</a>(\"unsupported p6 CPU model %d \",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#boot_cpu_data\">boot_cpu_data</a>.<a class=\"id\" href=\"#x86_model\">x86_model</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#x86_pmu\">x86_pmu</a> = <a class=\"id\" href=\"#p6_pmu\">p6_pmu</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_CPU_SUP_INTEL */</span>", 
];
xr_frag_insert('l/b1/df1f9b6eb7bfb578b4532c030b33c1bbf4f95f.xr', __xr_tmp);
