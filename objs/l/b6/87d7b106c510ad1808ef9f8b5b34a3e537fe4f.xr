var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Linux Socket Filter - Kernel level socket filtering</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author:</span>", 
"<span class=\"comment\"> *     Jay Schulist &lt;jschlst@samba.org&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Based on the design of:</span>", 
"<span class=\"comment\"> *     - The Berkeley Packet Filter</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or</span>", 
"<span class=\"comment\"> * modify it under the terms of the GNU General Public License</span>", 
"<span class=\"comment\"> * as published by the Free Software Foundation; either version</span>", 
"<span class=\"comment\"> * 2 of the License, or (at your option) any later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Andi Kleen - Fix a few bad bugs and races.</span>", 
"<span class=\"comment\"> * Kris Katterjohn - Added many additional checks in sk_chk_filter()</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#fcntl\">fcntl</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#in\">in</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inet\">inet</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#if_packet\">if_packet</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#gfp\">gfp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#protocol\">protocol</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#netlink\">netlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#skbuff\">skbuff</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#sock\">sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#timer\">timer</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#system\">system</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#unaligned\">unaligned</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#filter\">filter</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"<span class=\"comment\">/* No hurry in this branch */</span>", 
"static void *<a class=\"id\" href=\"#__load_pointer\">__load_pointer</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, int <a class=\"id\" href=\"#k\">k</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#k\">k</a> >= <a class=\"id\" href=\"#SKF_NET_OFF\">SKF_NET_OFF</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#skb_network_header\">skb_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>) + <a class=\"id\" href=\"#k\">k</a> - <a class=\"id\" href=\"#SKF_NET_OFF\">SKF_NET_OFF</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#k\">k</a> >= <a class=\"id\" href=\"#SKF_LL_OFF\">SKF_LL_OFF</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#skb_mac_header\">skb_mac_header</a>(<a class=\"id\" href=\"#skb\">skb</a>) + <a class=\"id\" href=\"#k\">k</a> - <a class=\"id\" href=\"#SKF_LL_OFF\">SKF_LL_OFF</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a> >= <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#head\">head</a> && <a class=\"id\" href=\"#ptr\">ptr</a> &lt; <a class=\"id\" href=\"#skb_tail_pointer\">skb_tail_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void *<a class=\"id\" href=\"#load_pointer\">load_pointer</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, int <a class=\"id\" href=\"#k\">k</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> unsigned int <a class=\"id\" href=\"#size\">size</a>, void *<a class=\"id\" href=\"#buffer\">buffer</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#k\">k</a> >= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#skb_header_pointer\">skb_header_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#k\">k</a>, <a class=\"id\" href=\"#size\">size</a>, <a class=\"id\" href=\"#buffer\">buffer</a>);", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#k\">k</a> >= <a class=\"id\" href=\"#SKF_AD_OFF\">SKF_AD_OFF</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#__load_pointer\">__load_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#k\">k</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>sk_filter - run a packet through a socket filter</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@sk: sock associated with &amp;sk_buff</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@skb: buffer to filter</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Run the filter code and then cut skb-&gt;data to correct size returned by</span>", 
"<span class=\"comment\"> * sk_run_filter. If pkt_len is 0 we toss packet. If skb-&gt;len is smaller</span>", 
"<span class=\"comment\"> * than pkt_len we keep whole skb-&gt;data. This is the socket level</span>", 
"<span class=\"comment\"> * wrapper to sk_run_filter. It returns 0 if the packet should</span>", 
"<span class=\"comment\"> * be accepted or -EPERM if the packet should be tossed.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#sk_filter\">sk_filter</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_filter\">sk_filter</a> *<a class=\"id\" href=\"#filter\">filter</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_sock_rcv_skb\">security_sock_rcv_skb</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock_bh\">rcu_read_lock_bh</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#filter\">filter</a> = <a class=\"id\" href=\"#rcu_dereference_bh\">rcu_dereference_bh</a>(<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_filter\">sk_filter</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#filter\">filter</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#pkt_len\">pkt_len</a> = <a class=\"id\" href=\"#sk_run_filter\">sk_run_filter</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#filter\">filter</a>-><a class=\"id\" href=\"#insns\">insns</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#filter\">filter</a>-><a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#pkt_len\">pkt_len</a> ? <a class=\"id\" href=\"#pskb_trim\">pskb_trim</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pkt_len\">pkt_len</a>) : -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock_bh\">rcu_read_unlock_bh</a>();", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#sk_filter\">sk_filter</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>sk_run_filter - run a filter on a socket</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@skb: buffer to run the filter on</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@filter: filter to apply</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@flen: length of filter</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Decode and apply filter instructions to the skb-&gt;data.</span>", 
"<span class=\"comment\"> * Return length to keep, 0 for none. skb is the data we are</span>", 
"<span class=\"comment\"> * filtering, filter is the array of filter instructions, and</span>", 
"<span class=\"comment\"> * len is the number of filter blocks in the array.</span>", 
"<span class=\"comment\"> */</span>", 
"unsigned int <a class=\"id\" href=\"#sk_run_filter\">sk_run_filter</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#sock_filter\">sock_filter</a> *<a class=\"id\" href=\"#filter\">filter</a>, int <a class=\"id\" href=\"#flen\">flen</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock_filter\">sock_filter</a> *<a class=\"id\" href=\"#fentry\">fentry</a>;<span class=\"ts\"/><span class=\"comment\">/* We walk down these */</span>", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#A\">A</a> = 0;<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Accumulator */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#X\">X</a> = 0;<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Index Register */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mem\">mem</a>[<a class=\"id\" href=\"#BPF_MEMWORDS\">BPF_MEMWORDS</a>];<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Scratch Memory Store */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#pc\">pc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Process array of filter instructions.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pc\">pc</a> = 0; <a class=\"id\" href=\"#pc\">pc</a> &lt; <a class=\"id\" href=\"#flen\">flen</a>; <a class=\"id\" href=\"#pc\">pc</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fentry\">fentry</a> = &amp;<a class=\"id\" href=\"#filter\">filter</a>[<a class=\"id\" href=\"#pc\">pc</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#code\">code</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_ADD_X\">BPF_S_ALU_ADD_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> += <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_ADD_K\">BPF_S_ALU_ADD_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> += <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_SUB_X\">BPF_S_ALU_SUB_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> -= <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_SUB_K\">BPF_S_ALU_SUB_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> -= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_MUL_X\">BPF_S_ALU_MUL_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> *= <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_MUL_K\">BPF_S_ALU_MUL_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> *= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_DIV_X\">BPF_S_ALU_DIV_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#X\">X</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> /= <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_DIV_K\">BPF_S_ALU_DIV_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> /= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_AND_X\">BPF_S_ALU_AND_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> &= <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_AND_K\">BPF_S_ALU_AND_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> &= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_OR_X\">BPF_S_ALU_OR_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> |= <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_OR_K\">BPF_S_ALU_OR_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> |= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_LSH_X\">BPF_S_ALU_LSH_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> <<= <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_LSH_K\">BPF_S_ALU_LSH_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> <<= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_RSH_X\">BPF_S_ALU_RSH_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> >>= <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_RSH_K\">BPF_S_ALU_RSH_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> >>= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ALU_NEG\">BPF_S_ALU_NEG</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = -<a class=\"id\" href=\"#A\">A</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JA\">BPF_S_JMP_JA</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGT_K\">BPF_S_JMP_JGT_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> &gt; <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGE_K\">BPF_S_JMP_JGE_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> >= <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JEQ_K\">BPF_S_JMP_JEQ_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> == <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JSET_K\">BPF_S_JMP_JSET_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> &amp; <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGT_X\">BPF_S_JMP_JGT_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> &gt; <a class=\"id\" href=\"#X\">X</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGE_X\">BPF_S_JMP_JGE_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> >= <a class=\"id\" href=\"#X\">X</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JEQ_X\">BPF_S_JMP_JEQ_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> == <a class=\"id\" href=\"#X\">X</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JSET_X\">BPF_S_JMP_JSET_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pc\">pc</a> += (<a class=\"id\" href=\"#A\">A</a> &amp; <a class=\"id\" href=\"#X\">X</a>) ? <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jt\">jt</a> : <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#jf\">jf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_W_ABS\">BPF_S_LD_W_ABS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<a class=\"id\" href=\"#load_w\">load_w</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#load_pointer\">load_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#k\">k</a>, 4, &amp;<a class=\"id\" href=\"#tmp\">tmp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#get_unaligned_be32\">get_unaligned_be32</a>(<a class=\"id\" href=\"#ptr\">ptr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_H_ABS\">BPF_S_LD_H_ABS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<a class=\"id\" href=\"#load_h\">load_h</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#load_pointer\">load_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#k\">k</a>, 2, &amp;<a class=\"id\" href=\"#tmp\">tmp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#get_unaligned_be16\">get_unaligned_be16</a>(<a class=\"id\" href=\"#ptr\">ptr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_B_ABS\">BPF_S_LD_B_ABS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<a class=\"id\" href=\"#load_b\">load_b</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#load_pointer\">load_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#k\">k</a>, 1, &amp;<a class=\"id\" href=\"#tmp\">tmp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = *(<a class=\"id\" href=\"#u8\">u8</a> *)<a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_W_LEN\">BPF_S_LD_W_LEN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LDX_W_LEN\">BPF_S_LDX_W_LEN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#X\">X</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_W_IND\">BPF_S_LD_W_IND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#X\">X</a> + <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#load_w\">load_w</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_H_IND\">BPF_S_LD_H_IND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#X\">X</a> + <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#load_h\">load_h</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_B_IND\">BPF_S_LD_B_IND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#k\">k</a> = <a class=\"id\" href=\"#X\">X</a> + <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#load_b\">load_b</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LDX_B_MSH\">BPF_S_LDX_B_MSH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#load_pointer\">load_pointer</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>, 1, &amp;<a class=\"id\" href=\"#tmp\">tmp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ptr\">ptr</a> != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#X\">X</a> = (*(<a class=\"id\" href=\"#u8\">u8</a> *)<a class=\"id\" href=\"#ptr\">ptr</a> &amp; 0xf) << 2;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_IMM\">BPF_S_LD_IMM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LDX_IMM\">BPF_S_LDX_IMM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#X\">X</a> = <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LD_MEM\">BPF_S_LD_MEM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#mem\">mem</a>[<a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_LDX_MEM\">BPF_S_LDX_MEM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#X\">X</a> = <a class=\"id\" href=\"#mem\">mem</a>[<a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_MISC_TAX\">BPF_S_MISC_TAX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#X\">X</a> = <a class=\"id\" href=\"#A\">A</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_MISC_TXA\">BPF_S_MISC_TXA</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_RET_K\">BPF_S_RET_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_RET_A\">BPF_S_RET_A</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#A\">A</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_ST\">BPF_S_ST</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mem\">mem</a>[<a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>] = <a class=\"id\" href=\"#A\">A</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_STX\">BPF_S_STX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mem\">mem</a>[<a class=\"id\" href=\"#fentry\">fentry</a>-><a class=\"id\" href=\"#k\">k</a>] = <a class=\"id\" href=\"#X\">X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN_ON\">WARN_ON</a>(1);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Handle ancillary data, which are impossible</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * (or very difficult) to get parsing packet contents.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#k\">k</a>-<a class=\"id\" href=\"#SKF_AD_OFF\">SKF_AD_OFF</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_PROTOCOL\">SKF_AD_PROTOCOL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#protocol\">protocol</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_PKTTYPE\">SKF_AD_PKTTYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#pkt_type\">pkt_type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_IFINDEX\">SKF_AD_IFINDEX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_MARK\">SKF_AD_MARK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#mark\">mark</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_QUEUE\">SKF_AD_QUEUE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#queue_mapping\">queue_mapping</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_HATYPE\">SKF_AD_HATYPE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_NLATTR\">SKF_AD_NLATTR</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla\">nla</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_is_nonlinear\">skb_is_nonlinear</a>(<a class=\"id\" href=\"#skb\">skb</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#A\">A</a> &gt; <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> - sizeof(struct <a class=\"id\" href=\"#nlattr\">nlattr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla\">nla</a> = <a class=\"id\" href=\"#nla_find\">nla_find</a>((struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *)&amp;<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>[<a class=\"id\" href=\"#A\">A</a>],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> - <a class=\"id\" href=\"#A\">A</a>, <a class=\"id\" href=\"#X\">X</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla\">nla</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = (void *)<a class=\"id\" href=\"#nla\">nla</a> - (void *)<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SKF_AD_NLATTR_NEST\">SKF_AD_NLATTR_NEST</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla\">nla</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb_is_nonlinear\">skb_is_nonlinear</a>(<a class=\"id\" href=\"#skb\">skb</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#A\">A</a> &gt; <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> - sizeof(struct <a class=\"id\" href=\"#nlattr\">nlattr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla\">nla</a> = (struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *)&amp;<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>[<a class=\"id\" href=\"#A\">A</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla\">nla</a>-><a class=\"id\" href=\"#nla_len\">nla_len</a> &gt; <a class=\"id\" href=\"#A\">A</a> - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla\">nla</a> = <a class=\"id\" href=\"#nla_find_nested\">nla_find_nested</a>(<a class=\"id\" href=\"#nla\">nla</a>, <a class=\"id\" href=\"#X\">X</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla\">nla</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = (void *)<a class=\"id\" href=\"#nla\">nla</a> - (void *)<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#A\">A</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#sk_run_filter\">sk_run_filter</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>sk_chk_filter - verify socket filter code</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@filter: filter to verify</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@flen: length of filter</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Check the user's filter code. If we let some ugly</span>", 
"<span class=\"comment\"> * filter code slip through kaboom! The filter must contain</span>", 
"<span class=\"comment\"> * no references or jumps that are out of range, no illegal</span>", 
"<span class=\"comment\"> * instructions, and must end with a RET instruction.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * All jumps are forward as they are not signed.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 if the rule set is legal or -EINVAL if not.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#sk_chk_filter\">sk_chk_filter</a>(struct <a class=\"id\" href=\"#sock_filter\">sock_filter</a> *<a class=\"id\" href=\"#filter\">filter</a>, int <a class=\"id\" href=\"#flen\">flen</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock_filter\">sock_filter</a> *<a class=\"id\" href=\"#ftest\">ftest</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#pc\">pc</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flen\">flen</a> == 0 || <a class=\"id\" href=\"#flen\">flen</a> &gt; <a class=\"id\" href=\"#BPF_MAXINSNS\">BPF_MAXINSNS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* check the filter code now */</span>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pc\">pc</a> = 0; <a class=\"id\" href=\"#pc\">pc</a> &lt; <a class=\"id\" href=\"#flen\">flen</a>; <a class=\"id\" href=\"#pc\">pc</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a> = &amp;<a class=\"id\" href=\"#filter\">filter</a>[<a class=\"id\" href=\"#pc\">pc</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Only allow valid instructions */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_ADD\">BPF_ADD</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_ADD_K\">BPF_S_ALU_ADD_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_ADD\">BPF_ADD</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_ADD_X\">BPF_S_ALU_ADD_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_SUB\">BPF_SUB</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_SUB_K\">BPF_S_ALU_SUB_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_SUB\">BPF_SUB</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_SUB_X\">BPF_S_ALU_SUB_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_MUL\">BPF_MUL</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_MUL_K\">BPF_S_ALU_MUL_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_MUL\">BPF_MUL</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_MUL_X\">BPF_S_ALU_MUL_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_DIV\">BPF_DIV</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_DIV_X\">BPF_S_ALU_DIV_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_AND\">BPF_AND</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_AND_K\">BPF_S_ALU_AND_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_AND\">BPF_AND</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_AND_X\">BPF_S_ALU_AND_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_OR\">BPF_OR</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_OR_K\">BPF_S_ALU_OR_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_OR\">BPF_OR</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_OR_X\">BPF_S_ALU_OR_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_LSH\">BPF_LSH</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_LSH_K\">BPF_S_ALU_LSH_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_LSH\">BPF_LSH</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_LSH_X\">BPF_S_ALU_LSH_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_RSH\">BPF_RSH</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_RSH_K\">BPF_S_ALU_RSH_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_RSH\">BPF_RSH</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_RSH_X\">BPF_S_ALU_RSH_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_NEG\">BPF_NEG</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_NEG\">BPF_S_ALU_NEG</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_W\">BPF_W</a>|<a class=\"id\" href=\"#BPF_ABS\">BPF_ABS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_W_ABS\">BPF_S_LD_W_ABS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_H\">BPF_H</a>|<a class=\"id\" href=\"#BPF_ABS\">BPF_ABS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_H_ABS\">BPF_S_LD_H_ABS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_B\">BPF_B</a>|<a class=\"id\" href=\"#BPF_ABS\">BPF_ABS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_B_ABS\">BPF_S_LD_B_ABS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_W\">BPF_W</a>|<a class=\"id\" href=\"#BPF_LEN\">BPF_LEN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_W_LEN\">BPF_S_LD_W_LEN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_W\">BPF_W</a>|<a class=\"id\" href=\"#BPF_IND\">BPF_IND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_W_IND\">BPF_S_LD_W_IND</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_H\">BPF_H</a>|<a class=\"id\" href=\"#BPF_IND\">BPF_IND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_H_IND\">BPF_S_LD_H_IND</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_B\">BPF_B</a>|<a class=\"id\" href=\"#BPF_IND\">BPF_IND</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_B_IND\">BPF_S_LD_B_IND</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_IMM\">BPF_IMM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_IMM\">BPF_S_LD_IMM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LDX\">BPF_LDX</a>|<a class=\"id\" href=\"#BPF_W\">BPF_W</a>|<a class=\"id\" href=\"#BPF_LEN\">BPF_LEN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LDX_W_LEN\">BPF_S_LDX_W_LEN</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LDX\">BPF_LDX</a>|<a class=\"id\" href=\"#BPF_B\">BPF_B</a>|<a class=\"id\" href=\"#BPF_MSH\">BPF_MSH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LDX_B_MSH\">BPF_S_LDX_B_MSH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LDX\">BPF_LDX</a>|<a class=\"id\" href=\"#BPF_IMM\">BPF_IMM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LDX_IMM\">BPF_S_LDX_IMM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_MISC\">BPF_MISC</a>|<a class=\"id\" href=\"#BPF_TAX\">BPF_TAX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_MISC_TAX\">BPF_S_MISC_TAX</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_MISC\">BPF_MISC</a>|<a class=\"id\" href=\"#BPF_TXA\">BPF_TXA</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_MISC_TXA\">BPF_S_MISC_TXA</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_RET\">BPF_RET</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_RET_K\">BPF_S_RET_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_RET\">BPF_RET</a>|<a class=\"id\" href=\"#BPF_A\">BPF_A</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_RET_A\">BPF_S_RET_A</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Some instructions need special checks */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* check for division by zero */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ALU\">BPF_ALU</a>|<a class=\"id\" href=\"#BPF_DIV\">BPF_DIV</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#k\">k</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ALU_DIV_K\">BPF_S_ALU_DIV_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* check for invalid memory addresses */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LD\">BPF_LD</a>|<a class=\"id\" href=\"#BPF_MEM\">BPF_MEM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#k\">k</a> >= <a class=\"id\" href=\"#BPF_MEMWORDS\">BPF_MEMWORDS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LD_MEM\">BPF_S_LD_MEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_LDX\">BPF_LDX</a>|<a class=\"id\" href=\"#BPF_MEM\">BPF_MEM</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#k\">k</a> >= <a class=\"id\" href=\"#BPF_MEMWORDS\">BPF_MEMWORDS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_LDX_MEM\">BPF_S_LDX_MEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_ST\">BPF_ST</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#k\">k</a> >= <a class=\"id\" href=\"#BPF_MEMWORDS\">BPF_MEMWORDS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_ST\">BPF_S_ST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_STX\">BPF_STX</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#k\">k</a> >= <a class=\"id\" href=\"#BPF_MEMWORDS\">BPF_MEMWORDS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_STX\">BPF_S_STX</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JA\">BPF_JA</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Note, the large ftest-&gt;k might cause loops.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Compare this with conditional jumps below,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * where offsets are limited. --ANK (981016)</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#k\">k</a> >= (unsigned)(<a class=\"id\" href=\"#flen\">flen</a>-<a class=\"id\" href=\"#pc\">pc</a>-1))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JA\">BPF_S_JMP_JA</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JEQ\">BPF_JEQ</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JEQ_K\">BPF_S_JMP_JEQ_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JEQ\">BPF_JEQ</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JEQ_X\">BPF_S_JMP_JEQ_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JGE\">BPF_JGE</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JGE_K\">BPF_S_JMP_JGE_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JGE\">BPF_JGE</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JGE_X\">BPF_S_JMP_JGE_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JGT\">BPF_JGT</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JGT_K\">BPF_S_JMP_JGT_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JGT\">BPF_JGT</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JGT_X\">BPF_S_JMP_JGT_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JSET\">BPF_JSET</a>|<a class=\"id\" href=\"#BPF_K\">BPF_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JSET_K\">BPF_S_JMP_JSET_K</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_JMP\">BPF_JMP</a>|<a class=\"id\" href=\"#BPF_JSET\">BPF_JSET</a>|<a class=\"id\" href=\"#BPF_X\">BPF_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a> = <a class=\"id\" href=\"#BPF_S_JMP_JSET_X\">BPF_S_JMP_JSET_X</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* for conditionals both must be safe */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#code\">code</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JEQ_K\">BPF_S_JMP_JEQ_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JEQ_X\">BPF_S_JMP_JEQ_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGE_K\">BPF_S_JMP_JGE_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGE_X\">BPF_S_JMP_JGE_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGT_K\">BPF_S_JMP_JGT_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JGT_X\">BPF_S_JMP_JGT_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JSET_X\">BPF_S_JMP_JSET_X</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_JMP_JSET_K\">BPF_S_JMP_JSET_K</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pc\">pc</a> + <a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#jt\">jt</a> + 1 >= <a class=\"id\" href=\"#flen\">flen</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#pc\">pc</a> + <a class=\"id\" href=\"#ftest\">ftest</a>-><a class=\"id\" href=\"#jf\">jf</a> + 1 >= <a class=\"id\" href=\"#flen\">flen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* last instruction must be a RET code */</span>", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#filter\">filter</a>[<a class=\"id\" href=\"#flen\">flen</a> - 1].<a class=\"id\" href=\"#code\">code</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_RET_K\">BPF_S_RET_K</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#BPF_S_RET_A\">BPF_S_RET_A</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#sk_chk_filter\">sk_chk_filter</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>sk_filter_rcu_release: Release a socket filter by rcu_head</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@rcu: rcu_head that contains the sk_filter to free</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#sk_filter_rcu_release\">sk_filter_rcu_release</a>(struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> *<a class=\"id\" href=\"#rcu\">rcu</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_filter\">sk_filter</a> *<a class=\"id\" href=\"#fp\">fp</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#rcu\">rcu</a>, struct <a class=\"id\" href=\"#sk_filter\">sk_filter</a>, <a class=\"id\" href=\"#rcu\">rcu</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_filter_release\">sk_filter_release</a>(<a class=\"id\" href=\"#fp\">fp</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#sk_filter_delayed_uncharge\">sk_filter_delayed_uncharge</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#sk_filter\">sk_filter</a> *<a class=\"id\" href=\"#fp\">fp</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#size\">size</a> = <a class=\"id\" href=\"#sk_filter_len\">sk_filter_len</a>(<a class=\"id\" href=\"#fp\">fp</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_sub\">atomic_sub</a>(<a class=\"id\" href=\"#size\">size</a>, &amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_omem_alloc\">sk_omem_alloc</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#call_rcu_bh\">call_rcu_bh</a>(&amp;<a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#sk_filter_rcu_release\">sk_filter_rcu_release</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>sk_attach_filter - attach a socket filter</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@fprog: the filter program</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@sk: the socket to use</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Attach the user's filter code. We first run some sanity checks on</span>", 
"<span class=\"comment\"> * it to make sure it does not explode on us later. If an error</span>", 
"<span class=\"comment\"> * occurs or there is insufficient memory for the filter a negative</span>", 
"<span class=\"comment\"> * errno code is returned. On success the return is zero.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#sk_attach_filter\">sk_attach_filter</a>(struct <a class=\"id\" href=\"#sock_fprog\">sock_fprog</a> *<a class=\"id\" href=\"#fprog\">fprog</a>, struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_filter\">sk_filter</a> *<a class=\"id\" href=\"#fp\">fp</a>, *<a class=\"id\" href=\"#old_fp\">old_fp</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#fsize\">fsize</a> = sizeof(struct <a class=\"id\" href=\"#sock_filter\">sock_filter</a>) * <a class=\"id\" href=\"#fprog\">fprog</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Make sure new filter is there and in the right amounts. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fprog\">fprog</a>-><a class=\"id\" href=\"#filter\">filter</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fp\">fp</a> = <a class=\"id\" href=\"#sock_kmalloc\">sock_kmalloc</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#fsize\">fsize</a>+sizeof(*<a class=\"id\" href=\"#fp\">fp</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#fp\">fp</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#insns\">insns</a>, <a class=\"id\" href=\"#fprog\">fprog</a>-><a class=\"id\" href=\"#filter\">filter</a>, <a class=\"id\" href=\"#fsize\">fsize</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_kfree_s\">sock_kfree_s</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#fp\">fp</a>, <a class=\"id\" href=\"#fsize\">fsize</a>+sizeof(*<a class=\"id\" href=\"#fp\">fp</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_set\">atomic_set</a>(&amp;<a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>, 1);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#fprog\">fprog</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#sk_chk_filter\">sk_chk_filter</a>(<a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#insns\">insns</a>, <a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk_filter_uncharge\">sk_filter_uncharge</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#fp\">fp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock_bh\">rcu_read_lock_bh</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old_fp\">old_fp</a> = <a class=\"id\" href=\"#rcu_dereference_bh\">rcu_dereference_bh</a>(<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_filter\">sk_filter</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_filter\">sk_filter</a>, <a class=\"id\" href=\"#fp\">fp</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock_bh\">rcu_read_unlock_bh</a>();", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#old_fp\">old_fp</a>)", 
];
xr_frag_insert('l/b6/87d7b106c510ad1808ef9f8b5b34a3e537fe4f.xr', __xr_tmp);
