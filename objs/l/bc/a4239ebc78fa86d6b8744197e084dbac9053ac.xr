var __xr_tmp = [
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#pid\">pid</a> == <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#pid\">pid</a> || <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#group\">group</a> - 1 >= <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#ngroups\">ngroups</a> ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#group\">group</a> - 1, <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#groups\">groups</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#code\">code</a> == <a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a> && <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLINK_RECV_NO_ENOBUFS\">NETLINK_RECV_NO_ENOBUFS</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_err\">sk_err</a> = <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#code\">code</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_report\">sk_error_report</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlink_set_err - report error to broadcast listeners</span>", 
"<span class=\"comment\"> * @ssk: the kernel netlink socket, as returned by netlink_kernel_create()</span>", 
"<span class=\"comment\"> * @pid: the PID of a process that we want to skip (if any)</span>", 
"<span class=\"comment\"> * @groups: the broadcast group that will notice the error</span>", 
"<span class=\"comment\"> * @code: error code, must be negative (as usual in kernelspace)</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function returns the number of broadcast listeners that have set the</span>", 
"<span class=\"comment\"> * NETLINK_RECV_NO_ENOBUFS socket option.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlink_set_err\">netlink_set_err</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#ssk\">ssk</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#group\">group</a>, int <a class=\"id\" href=\"#code\">code</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_set_err_data\">netlink_set_err_data</a> <a class=\"id\" href=\"#info\">info</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>.<a class=\"id\" href=\"#exclude_sk\">exclude_sk</a> = <a class=\"id\" href=\"#ssk\">ssk</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>.<a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>.<a class=\"id\" href=\"#group\">group</a> = <a class=\"id\" href=\"#group\">group</a>;", 
"<span class=\"ts\"/><span class=\"comment\">/* sk-&gt;sk_err wants a positive error value */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>.<a class=\"id\" href=\"#code\">code</a> = -<a class=\"id\" href=\"#code\">code</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#nl_table_lock\">nl_table_lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_for_each_bound\">sk_for_each_bound</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#node\">node</a>, &amp;<a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#ssk\">ssk</a>-><a class=\"id\" href=\"#sk_protocol\">sk_protocol</a>].<a class=\"id\" href=\"#mc_list\">mc_list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> += <a class=\"id\" href=\"#do_one_set_err\">do_one_set_err</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#info\">info</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#nl_table_lock\">nl_table_lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#netlink_set_err\">netlink_set_err</a>);", 
"", 
"<span class=\"comment\">/* must be called with netlink table grabbed */</span>", 
"static void <a class=\"id\" href=\"#netlink_update_socket_mc\">netlink_update_socket_mc</a>(struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     unsigned int <a class=\"id\" href=\"#group\">group</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     int <a class=\"id\" href=\"#is_new\">is_new</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#old\">old</a>, <a class=\"id\" href=\"#new\">new</a> = !!<a class=\"id\" href=\"#is_new\">is_new</a>, <a class=\"id\" href=\"#subscriptions\">subscriptions</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#old\">old</a> = <a class=\"id\" href=\"#test_bit\">test_bit</a>(<a class=\"id\" href=\"#group\">group</a> - 1, <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#groups\">groups</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#subscriptions\">subscriptions</a> = <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#subscriptions\">subscriptions</a> - <a class=\"id\" href=\"#old\">old</a> + <a class=\"id\" href=\"#new\">new</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new\">new</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__set_bit\">__set_bit</a>(<a class=\"id\" href=\"#group\">group</a> - 1, <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#groups\">groups</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__clear_bit\">__clear_bit</a>(<a class=\"id\" href=\"#group\">group</a> - 1, <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#groups\">groups</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_update_subscriptions\">netlink_update_subscriptions</a>(&amp;<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#subscriptions\">subscriptions</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_update_listeners\">netlink_update_listeners</a>(&amp;<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#sk\">sk</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#netlink_setsockopt\">netlink_setsockopt</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, int <a class=\"id\" href=\"#level\">level</a>, int <a class=\"id\" href=\"#optname\">optname</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      char <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#optval\">optval</a>, unsigned int <a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a> = <a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#val\">val</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#level\">level</a> != <a class=\"id\" href=\"#SOL_NETLINK\">SOL_NETLINK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOPROTOOPT\">ENOPROTOOPT</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#optlen\">optlen</a> >= sizeof(int) &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#get_user\">get_user</a>(<a class=\"id\" href=\"#val\">val</a>, (unsigned int <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#optval\">optval</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#optname\">optname</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_PKTINFO\">NETLINK_PKTINFO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#val\">val</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLINK_RECV_PKTINFO\">NETLINK_RECV_PKTINFO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#NETLINK_RECV_PKTINFO\">NETLINK_RECV_PKTINFO</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_ADD_MEMBERSHIP\">NETLINK_ADD_MEMBERSHIP</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_DROP_MEMBERSHIP\">NETLINK_DROP_MEMBERSHIP</a>: {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#netlink_capable\">netlink_capable</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#NL_NONROOT_RECV\">NL_NONROOT_RECV</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#netlink_realloc_groups\">netlink_realloc_groups</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#val\">val</a> || <a class=\"id\" href=\"#val\">val</a> - 1 >= <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#ngroups\">ngroups</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_grab\">netlink_table_grab</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_update_socket_mc\">netlink_update_socket_mc</a>(<a class=\"id\" href=\"#nlk\">nlk</a>, <a class=\"id\" href=\"#val\">val</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#optname\">optname</a> == <a class=\"id\" href=\"#NETLINK_ADD_MEMBERSHIP\">NETLINK_ADD_MEMBERSHIP</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_ungrab\">netlink_table_ungrab</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_BROADCAST_ERROR\">NETLINK_BROADCAST_ERROR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#val\">val</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLINK_BROADCAST_SEND_ERROR\">NETLINK_BROADCAST_SEND_ERROR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#NETLINK_BROADCAST_SEND_ERROR\">NETLINK_BROADCAST_SEND_ERROR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_NO_ENOBUFS\">NETLINK_NO_ENOBUFS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#val\">val</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLINK_RECV_NO_ENOBUFS\">NETLINK_RECV_NO_ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clear_bit\">clear_bit</a>(0, &amp;<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#state\">state</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wake_up_interruptible\">wake_up_interruptible</a>(&amp;<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#wait\">wait</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &= ~<a class=\"id\" href=\"#NETLINK_RECV_NO_ENOBUFS\">NETLINK_RECV_NO_ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOPROTOOPT\">ENOPROTOOPT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#netlink_getsockopt\">netlink_getsockopt</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, int <a class=\"id\" href=\"#level\">level</a>, int <a class=\"id\" href=\"#optname\">optname</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      char <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#optval\">optval</a>, int <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a> = <a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#level\">level</a> != <a class=\"id\" href=\"#SOL_NETLINK\">SOL_NETLINK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOPROTOOPT\">ENOPROTOOPT</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#get_user\">get_user</a>(<a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#optlen\">optlen</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#optname\">optname</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_PKTINFO\">NETLINK_PKTINFO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; sizeof(int))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = sizeof(int);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLINK_RECV_PKTINFO\">NETLINK_RECV_PKTINFO</a> ? 1 : 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#optlen\">optlen</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#optval\">optval</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_BROADCAST_ERROR\">NETLINK_BROADCAST_ERROR</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; sizeof(int))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = sizeof(int);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLINK_BROADCAST_SEND_ERROR\">NETLINK_BROADCAST_SEND_ERROR</a> ? 1 : 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#optlen\">optlen</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#optval\">optval</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLINK_NO_ENOBUFS\">NETLINK_NO_ENOBUFS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; sizeof(int))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = sizeof(int);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLINK_RECV_NO_ENOBUFS\">NETLINK_RECV_NO_ENOBUFS</a> ? 1 : 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#optlen\">optlen</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#optval\">optval</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOPROTOOPT\">ENOPROTOOPT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#netlink_cmsg_recv_pktinfo\">netlink_cmsg_recv_pktinfo</a>(struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nl_pktinfo\">nl_pktinfo</a> <a class=\"id\" href=\"#info\">info</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>.<a class=\"id\" href=\"#group\">group</a> = <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#dst_group\">dst_group</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_cmsg\">put_cmsg</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#SOL_NETLINK\">SOL_NETLINK</a>, <a class=\"id\" href=\"#NETLINK_PKTINFO\">NETLINK_PKTINFO</a>, sizeof(<a class=\"id\" href=\"#info\">info</a>), &amp;<a class=\"id\" href=\"#info\">info</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#netlink_sendmsg\">netlink_sendmsg</a>(struct <a class=\"id\" href=\"#kiocb\">kiocb</a> *<a class=\"id\" href=\"#kiocb\">kiocb</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock_iocb\">sock_iocb</a> *<a class=\"id\" href=\"#siocb\">siocb</a> = <a class=\"id\" href=\"#kiocb_to_siocb\">kiocb_to_siocb</a>(<a class=\"id\" href=\"#kiocb\">kiocb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a> = <a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_nl\">sockaddr_nl</a> *<a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#dst_pid\">dst_pid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#dst_group\">dst_group</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> <a class=\"id\" href=\"#scm\">scm</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a>&amp;<a class=\"id\" href=\"#MSG_OOB\">MSG_OOB</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EOPNOTSUPP\">EOPNOTSUPP</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#NULL\">NULL</a> == <a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a> = &amp;<a class=\"id\" href=\"#scm\">scm</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#scm\">scm</a>, 0, sizeof(<a class=\"id\" href=\"#scm\">scm</a>));", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#scm_send\">scm_send</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#nl_family\">nl_family</a> != <a class=\"id\" href=\"#AF_NETLINK\">AF_NETLINK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_pid\">dst_pid</a> = <a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#nl_pid\">nl_pid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_group\">dst_group</a> = <a class=\"id\" href=\"#ffs\">ffs</a>(<a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#nl_groups\">nl_groups</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> =  -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_group\">dst_group</a> && !<a class=\"id\" href=\"#netlink_capable\">netlink_capable</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#NL_NONROOT_SEND\">NL_NONROOT_SEND</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_pid\">dst_pid</a> = <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#dst_pid\">dst_pid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_group\">dst_group</a> = <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#dst_group\">dst_group</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#pid\">pid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#netlink_autobind\">netlink_autobind</a>(<a class=\"id\" href=\"#sock\">sock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EMSGSIZE\">EMSGSIZE</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &gt; <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_sndbuf\">sk_sndbuf</a> - 32)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#alloc_skb\">alloc_skb</a>(<a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a><span class=\"ts\"/>= <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#dst_group\">dst_group</a> = <a class=\"id\" href=\"#dst_group\">dst_group</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#loginuid\">loginuid</a> = <a class=\"id\" href=\"#audit_get_loginuid\">audit_get_loginuid</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#sessionid\">sessionid</a> = <a class=\"id\" href=\"#audit_get_sessionid\">audit_get_sessionid</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#security_task_getsecid\">security_task_getsecid</a>(<a class=\"id\" href=\"#current\">current</a>, &amp;(<a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#sid\">sid</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#NETLINK_CREDS\">NETLINK_CREDS</a>(<a class=\"id\" href=\"#skb\">skb</a>), &amp;<a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#creds\">creds</a>, sizeof(struct <a class=\"id\" href=\"#ucred\">ucred</a>));", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* What can I do? Netlink is asynchronous, so that</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   we will have to save current capabilities to</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   check them, when this message will be delivered</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   to corresponding kernel module.   --ANK (980802)</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#memcpy_fromiovec\">memcpy_fromiovec</a>(<a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#len\">len</a>), <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>, <a class=\"id\" href=\"#len\">len</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_netlink_send\">security_netlink_send</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dst_group\">dst_group</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#users\">users</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_broadcast\">netlink_broadcast</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#dst_pid\">dst_pid</a>, <a class=\"id\" href=\"#dst_group\">dst_group</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#netlink_unicast\">netlink_unicast</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#dst_pid\">dst_pid</a>, <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a>&amp;<a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_destroy\">scm_destroy</a>(<a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#netlink_recvmsg\">netlink_recvmsg</a>(struct <a class=\"id\" href=\"#kiocb\">kiocb</a> *<a class=\"id\" href=\"#kiocb\">kiocb</a>, struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#len\">len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   int <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock_iocb\">sock_iocb</a> *<a class=\"id\" href=\"#siocb\">siocb</a> = <a class=\"id\" href=\"#kiocb_to_siocb\">kiocb_to_siocb</a>(<a class=\"id\" href=\"#kiocb\">kiocb</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> <a class=\"id\" href=\"#scm\">scm</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a> = <a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#noblock\">noblock</a> = <a class=\"id\" href=\"#flags\">flags</a>&amp;<a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#copied\">copied</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, *<a class=\"id\" href=\"#data_skb\">data_skb</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a>&amp;<a class=\"id\" href=\"#MSG_OOB\">MSG_OOB</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EOPNOTSUPP\">EOPNOTSUPP</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb_recv_datagram\">skb_recv_datagram</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#flags\">flags</a>, <a class=\"id\" href=\"#noblock\">noblock</a>, &amp;<a class=\"id\" href=\"#err\">err</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data_skb\">data_skb</a> = <a class=\"id\" href=\"#skb\">skb</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_COMPAT_NETLINK_MESSAGES\">CONFIG_COMPAT_NETLINK_MESSAGES</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#frag_list\">frag_list</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * If this skb has a frag_list, then here that means that we</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * will have to use the frag_list skb's data for compat tasks</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * and the regular skb's data for normal (non-compat) tasks.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> *</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * If we need to send the compat skb, assign it to the</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * 'data_skb' variable so that it will be used below for data</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * copying. We keep 'skb' for everything else, including</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * freeing both later.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MSG_CMSG_COMPAT\">MSG_CMSG_COMPAT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#data_skb\">data_skb</a> = <a class=\"id\" href=\"#skb_shinfo\">skb_shinfo</a>(<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#frag_list\">frag_list</a>;", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = <a class=\"id\" href=\"#data_skb\">data_skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &lt; <a class=\"id\" href=\"#copied\">copied</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_TRUNC\">MSG_TRUNC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reset_transport_header\">skb_reset_transport_header</a>(<a class=\"id\" href=\"#data_skb\">data_skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#skb_copy_datagram_iovec\">skb_copy_datagram_iovec</a>(<a class=\"id\" href=\"#data_skb\">data_skb</a>, 0, <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_iov\">msg_iov</a>, <a class=\"id\" href=\"#copied\">copied</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sockaddr_nl\">sockaddr_nl</a> *<a class=\"id\" href=\"#addr\">addr</a> = (struct <a class=\"id\" href=\"#sockaddr_nl\">sockaddr_nl</a> *)<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_name\">msg_name</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#nl_family\">nl_family</a> = <a class=\"id\" href=\"#AF_NETLINK\">AF_NETLINK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#nl_pad\">nl_pad</a>    = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#nl_pid\">nl_pid</a><span class=\"ts\"/>= <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#nl_groups\">nl_groups</a><span class=\"ts\"/>= <a class=\"id\" href=\"#netlink_group_mask\">netlink_group_mask</a>(<a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#dst_group\">dst_group</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_namelen\">msg_namelen</a> = sizeof(*<a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#NETLINK_RECV_PKTINFO\">NETLINK_RECV_PKTINFO</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_cmsg_recv_pktinfo\">netlink_cmsg_recv_pktinfo</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#NULL\">NULL</a> == <a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#scm\">scm</a>, 0, sizeof(<a class=\"id\" href=\"#scm\">scm</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a> = &amp;<a class=\"id\" href=\"#scm\">scm</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#creds\">creds</a> = *<a class=\"id\" href=\"#NETLINK_CREDS\">NETLINK_CREDS</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#MSG_TRUNC\">MSG_TRUNC</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#copied\">copied</a> = <a class=\"id\" href=\"#data_skb\">data_skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_free_datagram\">skb_free_datagram</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb\">cb</a> && <a class=\"id\" href=\"#atomic_read\">atomic_read</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_rmem_alloc\">sk_rmem_alloc</a>) <= <a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_rcvbuf\">sk_rcvbuf</a> / 2)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_dump\">netlink_dump</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_recv\">scm_recv</a>(<a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#siocb\">siocb</a>-><a class=\"id\" href=\"#scm\">scm</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_rcv_wake\">netlink_rcv_wake</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a> ? : <a class=\"id\" href=\"#copied\">copied</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#netlink_data_ready\">netlink_data_ready</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, int <a class=\"id\" href=\"#len\">len</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>We export these functions to other modules. They provide a</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>complete set of kernel non-blocking support for message</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>queueing.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"struct <a class=\"id\" href=\"#sock\">sock</a> *", 
"<a class=\"id\" href=\"#netlink_kernel_create\">netlink_kernel_create</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#unit\">unit</a>, unsigned int <a class=\"id\" href=\"#groups\">groups</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      void (*<a class=\"id\" href=\"#input\">input</a>)(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#mutex\">mutex</a> *<a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>, struct <a class=\"id\" href=\"#module\">module</a> *<a class=\"id\" href=\"#module\">module</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a>;", 
"<span class=\"ts\"/>unsigned long *<a class=\"id\" href=\"#listeners\">listeners</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(!<a class=\"id\" href=\"#nl_table\">nl_table</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unit\">unit</a> &lt; 0 || <a class=\"id\" href=\"#unit\">unit</a> >= <a class=\"id\" href=\"#MAX_LINKS\">MAX_LINKS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sock_create_lite\">sock_create_lite</a>(<a class=\"id\" href=\"#PF_NETLINK\">PF_NETLINK</a>, <a class=\"id\" href=\"#SOCK_DGRAM\">SOCK_DGRAM</a>, <a class=\"id\" href=\"#unit\">unit</a>, &amp;<a class=\"id\" href=\"#sock\">sock</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * We have to just have a reference on the net from sk, but don't</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * get_net it. Besides, we cannot get and then put the net here.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * So we create one inside init_net and the move it to net.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#__netlink_create\">__netlink_create</a>(&amp;<a class=\"id\" href=\"#init_net\">init_net</a>, <a class=\"id\" href=\"#sock\">sock</a>, <a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>, <a class=\"id\" href=\"#unit\">unit</a>) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_sock_release_nosk\">out_sock_release_nosk</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_change_net\">sk_change_net</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#net\">net</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#groups\">groups</a> &lt; 32)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#groups\">groups</a> = 32;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#listeners\">listeners</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(<a class=\"id\" href=\"#NLGRPSZ\">NLGRPSZ</a>(<a class=\"id\" href=\"#groups\">groups</a>) + sizeof(struct <a class=\"id\" href=\"#listeners_rcu_head\">listeners_rcu_head</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#listeners\">listeners</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_sock_release\">out_sock_release</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_data_ready\">sk_data_ready</a> = <a class=\"id\" href=\"#netlink_data_ready\">netlink_data_ready</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#input\">input</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>)-><a class=\"id\" href=\"#netlink_rcv\">netlink_rcv</a> = <a class=\"id\" href=\"#input\">input</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#netlink_insert\">netlink_insert</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#net\">net</a>, 0))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_sock_release\">out_sock_release</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a> = <a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#flags\">flags</a> |= <a class=\"id\" href=\"#NETLINK_KERNEL_SOCKET\">NETLINK_KERNEL_SOCKET</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_grab\">netlink_table_grab</a>();", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#unit\">unit</a>].<a class=\"id\" href=\"#registered\">registered</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#unit\">unit</a>].<a class=\"id\" href=\"#groups\">groups</a> = <a class=\"id\" href=\"#groups\">groups</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#unit\">unit</a>].<a class=\"id\" href=\"#listeners\">listeners</a> = <a class=\"id\" href=\"#listeners\">listeners</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#unit\">unit</a>].<a class=\"id\" href=\"#cb_mutex\">cb_mutex</a> = <a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#unit\">unit</a>].<a class=\"id\" href=\"#module\">module</a> = <a class=\"id\" href=\"#module\">module</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#unit\">unit</a>].<a class=\"id\" href=\"#registered\">registered</a> = 1;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#listeners\">listeners</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#unit\">unit</a>].<a class=\"id\" href=\"#registered\">registered</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_ungrab\">netlink_table_ungrab</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<a class=\"id\" href=\"#out_sock_release\">out_sock_release</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#listeners\">listeners</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_kernel_release\">netlink_kernel_release</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<a class=\"id\" href=\"#out_sock_release_nosk\">out_sock_release_nosk</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_release\">sock_release</a>(<a class=\"id\" href=\"#sock\">sock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#netlink_kernel_create\">netlink_kernel_create</a>);", 
"", 
"", 
"void", 
"<a class=\"id\" href=\"#netlink_kernel_release\">netlink_kernel_release</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_release_kernel\">sk_release_kernel</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#netlink_kernel_release\">netlink_kernel_release</a>);", 
"", 
"", 
"static void <a class=\"id\" href=\"#netlink_free_old_listeners\">netlink_free_old_listeners</a>(struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> *<a class=\"id\" href=\"#rcu_head\">rcu_head</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#listeners_rcu_head\">listeners_rcu_head</a> *<a class=\"id\" href=\"#lrh\">lrh</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#lrh\">lrh</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#rcu_head\">rcu_head</a>, struct <a class=\"id\" href=\"#listeners_rcu_head\">listeners_rcu_head</a>, <a class=\"id\" href=\"#rcu_head\">rcu_head</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#lrh\">lrh</a>-><a class=\"id\" href=\"#ptr\">ptr</a>);", 
"}", 
"", 
"int <a class=\"id\" href=\"#__netlink_change_ngroups\">__netlink_change_ngroups</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, unsigned int <a class=\"id\" href=\"#groups\">groups</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long *<a class=\"id\" href=\"#listeners\">listeners</a>, *<a class=\"id\" href=\"#old\">old</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#listeners_rcu_head\">listeners_rcu_head</a> *<a class=\"id\" href=\"#old_rcu_head\">old_rcu_head</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_table\">netlink_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = &amp;<a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_protocol\">sk_protocol</a>];", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#groups\">groups</a> &lt; 32)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#groups\">groups</a> = 32;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#NLGRPSZ\">NLGRPSZ</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#groups\">groups</a>) &lt; <a class=\"id\" href=\"#NLGRPSZ\">NLGRPSZ</a>(<a class=\"id\" href=\"#groups\">groups</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#listeners\">listeners</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(<a class=\"id\" href=\"#NLGRPSZ\">NLGRPSZ</a>(<a class=\"id\" href=\"#groups\">groups</a>) +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    sizeof(struct <a class=\"id\" href=\"#listeners_rcu_head\">listeners_rcu_head</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#listeners\">listeners</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old\">old</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#listeners\">listeners</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#listeners\">listeners</a>, <a class=\"id\" href=\"#old\">old</a>, <a class=\"id\" href=\"#NLGRPSZ\">NLGRPSZ</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#groups\">groups</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#listeners\">listeners</a>, <a class=\"id\" href=\"#listeners\">listeners</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Free the old memory after an RCU grace period so we</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * don't leak it. We use call_rcu() here in order to be</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * able to call this function from atomic contexts. The</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * allocation of this memory will have reserved enough</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * space for struct listeners_rcu_head at the end.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_rcu_head\">old_rcu_head</a> = (void *)(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#listeners\">listeners</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NLGRPLONGS\">NLGRPLONGS</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#groups\">groups</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#old_rcu_head\">old_rcu_head</a>-><a class=\"id\" href=\"#ptr\">ptr</a> = <a class=\"id\" href=\"#old\">old</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#old_rcu_head\">old_rcu_head</a>-><a class=\"id\" href=\"#rcu_head\">rcu_head</a>, <a class=\"id\" href=\"#netlink_free_old_listeners\">netlink_free_old_listeners</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#groups\">groups</a> = <a class=\"id\" href=\"#groups\">groups</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlink_change_ngroups - change number of multicast groups</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This changes the number of multicast groups that are available</span>", 
"<span class=\"comment\"> * on a certain netlink family. Note that it is not possible to</span>", 
"<span class=\"comment\"> * change the number of groups to below 32. Also note that it does</span>", 
"<span class=\"comment\"> * not implicitly call netlink_clear_multicast_users() when the</span>", 
"<span class=\"comment\"> * number of groups is reduced.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @sk: The kernel netlink socket, as returned by netlink_kernel_create().</span>", 
"<span class=\"comment\"> * @groups: The new number of groups.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#netlink_change_ngroups\">netlink_change_ngroups</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, unsigned int <a class=\"id\" href=\"#groups\">groups</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_grab\">netlink_table_grab</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#__netlink_change_ngroups\">__netlink_change_ngroups</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#groups\">groups</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_ungrab\">netlink_table_ungrab</a>();", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#__netlink_clear_multicast_users\">__netlink_clear_multicast_users</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#ksk\">ksk</a>, unsigned int <a class=\"id\" href=\"#group\">group</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_table\">netlink_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = &amp;<a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#ksk\">ksk</a>-><a class=\"id\" href=\"#sk_protocol\">sk_protocol</a>];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk_for_each_bound\">sk_for_each_bound</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#node\">node</a>, &amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_update_socket_mc\">netlink_update_socket_mc</a>(<a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>), <a class=\"id\" href=\"#group\">group</a>, 0);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlink_clear_multicast_users - kick off multicast listeners</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function removes all listeners from the given group.</span>", 
"<span class=\"comment\"> * @ksk: The kernel netlink socket, as returned by</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>netlink_kernel_create().</span>", 
"<span class=\"comment\"> * @group: The multicast group to clear.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#netlink_clear_multicast_users\">netlink_clear_multicast_users</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#ksk\">ksk</a>, unsigned int <a class=\"id\" href=\"#group\">group</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_grab\">netlink_table_grab</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__netlink_clear_multicast_users\">__netlink_clear_multicast_users</a>(<a class=\"id\" href=\"#ksk\">ksk</a>, <a class=\"id\" href=\"#group\">group</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_table_ungrab\">netlink_table_ungrab</a>();", 
"}", 
"", 
"void <a class=\"id\" href=\"#netlink_set_nonroot\">netlink_set_nonroot</a>(int <a class=\"id\" href=\"#protocol\">protocol</a>, unsigned int <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>if ((unsigned int)<a class=\"id\" href=\"#protocol\">protocol</a> &lt; <a class=\"id\" href=\"#MAX_LINKS\">MAX_LINKS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nl_table\">nl_table</a>[<a class=\"id\" href=\"#protocol\">protocol</a>].<a class=\"id\" href=\"#nl_nonroot\">nl_nonroot</a> = <a class=\"id\" href=\"#flags\">flags</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#netlink_set_nonroot\">netlink_set_nonroot</a>);", 
"", 
"static void <a class=\"id\" href=\"#netlink_destroy_callback\">netlink_destroy_callback</a>(struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#cb\">cb</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * It looks a bit ugly.</span>", 
"<span class=\"comment\"> * It would be better to create kernel thread.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static int <a class=\"id\" href=\"#netlink_dump\">netlink_dump</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a> = <a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#sock_rmalloc\">sock_rmalloc</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#NLMSG_GOODSIZE\">NLMSG_GOODSIZE</a>, 0, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a> = <a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb\">cb</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cb\">cb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout_skb\">errout_skb</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#dump\">dump</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cb\">cb</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#len\">len</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sk_filter\">sk_filter</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_queue_tail\">skb_queue_tail</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_data_ready\">sk_data_ready</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#nlmsg_put_answer\">nlmsg_put_answer</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cb\">cb</a>, <a class=\"id\" href=\"#NLMSG_DONE\">NLMSG_DONE</a>, sizeof(<a class=\"id\" href=\"#len\">len</a>), <a class=\"id\" href=\"#NLM_F_MULTI\">NLM_F_MULTI</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#nlh\">nlh</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout_skb\">errout_skb</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#nlmsg_data\">nlmsg_data</a>(<a class=\"id\" href=\"#nlh\">nlh</a>), &amp;<a class=\"id\" href=\"#len\">len</a>, sizeof(<a class=\"id\" href=\"#len\">len</a>));", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk_filter\">sk_filter</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb_queue_tail\">skb_queue_tail</a>(&amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_receive_queue\">sk_receive_queue</a>, <a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_data_ready\">sk_data_ready</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#done\">done</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#done\">done</a>(<a class=\"id\" href=\"#cb\">cb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb\">cb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_destroy_callback\">netlink_destroy_callback</a>(<a class=\"id\" href=\"#cb\">cb</a>);", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#errout_skb\">errout_skb</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<a class=\"id\" href=\"#errout\">errout</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#netlink_dump_start\">netlink_dump_start</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#ssk\">ssk</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       int (*<a class=\"id\" href=\"#dump\">dump</a>)(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *),", 
"<span class=\"ts\"/><span class=\"ts\"/>       int (*<a class=\"id\" href=\"#done\">done</a>)(struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *))", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_sock\">netlink_sock</a> *<a class=\"id\" href=\"#nlk\">nlk</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#cb\">cb</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cb\">cb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#dump\">dump</a> = <a class=\"id\" href=\"#dump\">dump</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#done\">done</a> = <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#nlh\">nlh</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#users\">users</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb\">skb</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#netlink_lookup\">netlink_lookup</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#ssk\">ssk</a>), <a class=\"id\" href=\"#ssk\">ssk</a>-><a class=\"id\" href=\"#sk_protocol\">sk_protocol</a>, <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_destroy_callback\">netlink_destroy_callback</a>(<a class=\"id\" href=\"#cb\">cb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ECONNREFUSED\">ECONNREFUSED</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a> = <a class=\"id\" href=\"#nlk_sk\">nlk_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* A dump is in progress... */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb\">cb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#netlink_destroy_callback\">netlink_destroy_callback</a>(<a class=\"id\" href=\"#cb\">cb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_put\">sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EBUSY\">EBUSY</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb\">cb</a> = <a class=\"id\" href=\"#cb\">cb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(<a class=\"id\" href=\"#nlk\">nlk</a>-><a class=\"id\" href=\"#cb_mutex\">cb_mutex</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_dump\">netlink_dump</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sock_put\">sock_put</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* We successfully started a dump, by returning -EINTR we</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * signal not to send ACK even if it was requested.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINTR\">EINTR</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#netlink_dump_start\">netlink_dump_start</a>);", 
"", 
"void <a class=\"id\" href=\"#netlink_ack\">netlink_ack</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#in_skb\">in_skb</a>, struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>, int <a class=\"id\" href=\"#err\">err</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#rep\">rep</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsgerr\">nlmsgerr</a> *<a class=\"id\" href=\"#errmsg\">errmsg</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#payload\">payload</a> = sizeof(*<a class=\"id\" href=\"#errmsg\">errmsg</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* error messages get the original request appened */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#payload\">payload</a> += <a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#nlmsg_new\">nlmsg_new</a>(<a class=\"id\" href=\"#payload\">payload</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#netlink_lookup\">netlink_lookup</a>(<a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#in_skb\">in_skb</a>-><a class=\"id\" href=\"#sk\">sk</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#in_skb\">in_skb</a>-><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_protocol\">sk_protocol</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#in_skb\">in_skb</a>).<a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_err\">sk_err</a> = <a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_error_report\">sk_error_report</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
];
xr_frag_insert('l/bc/a4239ebc78fa86d6b8744197e084dbac9053ac.xr', __xr_tmp);
