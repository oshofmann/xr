var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * File:<span class=\"ts\"/>pci-acpi.c</span>", 
"<span class=\"comment\"> * Purpose:<span class=\"ts\"/>Provide PCI support in ACPI</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (C) 2005 David Shaohua Li &lt;shaohua.li@intel.com&gt;</span>", 
"<span class=\"comment\"> * Copyright (C) 2004 Tom Long Nguyen &lt;tom.l.nguyen@intel.com&gt;</span>", 
"<span class=\"comment\"> * Copyright (C) 2004 Intel Corp.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#delay\">delay</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci\">pci</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci\">pci</a>-<a class=\"id\" href=\"#aspm\">aspm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#acpi\">acpi</a>/<a class=\"id\" href=\"#acpi\">acpi</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#acpi\">acpi</a>/<a class=\"id\" href=\"#acpi_bus\">acpi_bus</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci\">pci</a>-<a class=\"id\" href=\"#acpi\">acpi</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pm_runtime\">pm_runtime</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> \"pci.h\"", 
"", 
"static <a class=\"id\" href=\"#DEFINE_MUTEX\">DEFINE_MUTEX</a>(<a class=\"id\" href=\"#pci_acpi_pm_notify_mtx\">pci_acpi_pm_notify_mtx</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pci_acpi_wake_bus - Wake-up notification handler for root buses.</span>", 
"<span class=\"comment\"> * @handle: ACPI handle of a device the notification is for.</span>", 
"<span class=\"comment\"> * @event: Type of the signaled event.</span>", 
"<span class=\"comment\"> * @context: PCI root bus to wake up devices on.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#pci_acpi_wake_bus\">pci_acpi_wake_bus</a>(<a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> <a class=\"id\" href=\"#handle\">handle</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event\">event</a>, void *<a class=\"id\" href=\"#context\">context</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_bus\">pci_bus</a> *<a class=\"id\" href=\"#pci_bus\">pci_bus</a> = <a class=\"id\" href=\"#context\">context</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#event\">event</a> == <a class=\"id\" href=\"#ACPI_NOTIFY_DEVICE_WAKE\">ACPI_NOTIFY_DEVICE_WAKE</a> && <a class=\"id\" href=\"#pci_bus\">pci_bus</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pci_pme_wakeup_bus\">pci_pme_wakeup_bus</a>(<a class=\"id\" href=\"#pci_bus\">pci_bus</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pci_acpi_wake_dev - Wake-up notification handler for PCI devices.</span>", 
"<span class=\"comment\"> * @handle: ACPI handle of a device the notification is for.</span>", 
"<span class=\"comment\"> * @event: Type of the signaled event.</span>", 
"<span class=\"comment\"> * @context: PCI device object to wake up.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#pci_acpi_wake_dev\">pci_acpi_wake_dev</a>(<a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> <a class=\"id\" href=\"#handle\">handle</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#event\">event</a>, void *<a class=\"id\" href=\"#context\">context</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#pci_dev\">pci_dev</a> = <a class=\"id\" href=\"#context\">context</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#event\">event</a> == <a class=\"id\" href=\"#ACPI_NOTIFY_DEVICE_WAKE\">ACPI_NOTIFY_DEVICE_WAKE</a> && <a class=\"id\" href=\"#pci_dev\">pci_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pci_check_pme_status\">pci_check_pme_status</a>(<a class=\"id\" href=\"#pci_dev\">pci_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pm_runtime_resume\">pm_runtime_resume</a>(&amp;<a class=\"id\" href=\"#pci_dev\">pci_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pci_wakeup_event\">pci_wakeup_event</a>(<a class=\"id\" href=\"#pci_dev\">pci_dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pci_dev\">pci_dev</a>-><a class=\"id\" href=\"#subordinate\">subordinate</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pci_pme_wakeup_bus\">pci_pme_wakeup_bus</a>(<a class=\"id\" href=\"#pci_dev\">pci_dev</a>-><a class=\"id\" href=\"#subordinate\">subordinate</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * add_pm_notifier - Register PM notifier for given ACPI device.</span>", 
"<span class=\"comment\"> * @dev: ACPI device to add the notifier for.</span>", 
"<span class=\"comment\"> * @context: PCI device or bus to check for PME status if an event is signaled.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * NOTE: @dev need not be a run-wake or wake-up device to be a valid source of</span>", 
"<span class=\"comment\"> * PM wake-up events.  For example, wake-up events may be generated for bridges</span>", 
"<span class=\"comment\"> * if one of the devices below the bridge is signaling PME, even if the bridge</span>", 
"<span class=\"comment\"> * itself doesn't have a wake-up GPE associated with it.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#add_pm_notifier\">add_pm_notifier</a>(struct <a class=\"id\" href=\"#acpi_device\">acpi_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#acpi_notify_handler\">acpi_notify_handler</a> <a class=\"id\" href=\"#handler\">handler</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   void *<a class=\"id\" href=\"#context\">context</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#AE_ALREADY_EXISTS\">AE_ALREADY_EXISTS</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#pci_acpi_pm_notify_mtx\">pci_acpi_pm_notify_mtx</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#flags\">flags</a>.<a class=\"id\" href=\"#notifier_present\">notifier_present</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#acpi_install_notify_handler\">acpi_install_notify_handler</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#handle\">handle</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#ACPI_SYSTEM_NOTIFY\">ACPI_SYSTEM_NOTIFY</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#handler\">handler</a>, <a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ACPI_FAILURE\">ACPI_FAILURE</a>(<a class=\"id\" href=\"#status\">status</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#flags\">flags</a>.<a class=\"id\" href=\"#notifier_present\">notifier_present</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#pci_acpi_pm_notify_mtx\">pci_acpi_pm_notify_mtx</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#status\">status</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * remove_pm_notifier - Unregister PM notifier from given ACPI device.</span>", 
"<span class=\"comment\"> * @dev: ACPI device to remove the notifier from.</span>", 
"<span class=\"comment\"> */</span>", 
"static <a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#remove_pm_notifier\">remove_pm_notifier</a>(struct <a class=\"id\" href=\"#acpi_device\">acpi_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#acpi_notify_handler\">acpi_notify_handler</a> <a class=\"id\" href=\"#handler\">handler</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#AE_BAD_PARAMETER\">AE_BAD_PARAMETER</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#pci_acpi_pm_notify_mtx\">pci_acpi_pm_notify_mtx</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#flags\">flags</a>.<a class=\"id\" href=\"#notifier_present\">notifier_present</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#acpi_remove_notify_handler\">acpi_remove_notify_handler</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#handle\">handle</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#ACPI_SYSTEM_NOTIFY\">ACPI_SYSTEM_NOTIFY</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#handler\">handler</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ACPI_FAILURE\">ACPI_FAILURE</a>(<a class=\"id\" href=\"#status\">status</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#flags\">flags</a>.<a class=\"id\" href=\"#notifier_present\">notifier_present</a> = <a class=\"id\" href=\"#false\">false</a>;", 
"", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#pci_acpi_pm_notify_mtx\">pci_acpi_pm_notify_mtx</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#status\">status</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pci_acpi_add_bus_pm_notifier - Register PM notifier for given PCI bus.</span>", 
"<span class=\"comment\"> * @dev: ACPI device to add the notifier for.</span>", 
"<span class=\"comment\"> * @pci_bus: PCI bus to walk checking for PME status if an event is signaled.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#pci_acpi_add_bus_pm_notifier\">pci_acpi_add_bus_pm_notifier</a>(struct <a class=\"id\" href=\"#acpi_device\">acpi_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#pci_bus\">pci_bus</a> *<a class=\"id\" href=\"#pci_bus\">pci_bus</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#add_pm_notifier\">add_pm_notifier</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pci_acpi_wake_bus\">pci_acpi_wake_bus</a>, <a class=\"id\" href=\"#pci_bus\">pci_bus</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pci_acpi_remove_bus_pm_notifier - Unregister PCI bus PM notifier.</span>", 
"<span class=\"comment\"> * @dev: ACPI device to remove the notifier from.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#pci_acpi_remove_bus_pm_notifier\">pci_acpi_remove_bus_pm_notifier</a>(struct <a class=\"id\" href=\"#acpi_device\">acpi_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#remove_pm_notifier\">remove_pm_notifier</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pci_acpi_wake_bus\">pci_acpi_wake_bus</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pci_acpi_add_pm_notifier - Register PM notifier for given PCI device.</span>", 
"<span class=\"comment\"> * @dev: ACPI device to add the notifier for.</span>", 
"<span class=\"comment\"> * @pci_dev: PCI device to check for the PME status if an event is signaled.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#pci_acpi_add_pm_notifier\">pci_acpi_add_pm_notifier</a>(struct <a class=\"id\" href=\"#acpi_device\">acpi_device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#pci_dev\">pci_dev</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#add_pm_notifier\">add_pm_notifier</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pci_acpi_wake_dev\">pci_acpi_wake_dev</a>, <a class=\"id\" href=\"#pci_dev\">pci_dev</a>);", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * pci_acpi_remove_pm_notifier - Unregister PCI device PM notifier.</span>", 
"<span class=\"comment\"> * @dev: ACPI device to remove the notifier from.</span>", 
"<span class=\"comment\"> */</span>", 
"<a class=\"id\" href=\"#acpi_status\">acpi_status</a> <a class=\"id\" href=\"#pci_acpi_remove_pm_notifier\">pci_acpi_remove_pm_notifier</a>(struct <a class=\"id\" href=\"#acpi_device\">acpi_device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#remove_pm_notifier\">remove_pm_notifier</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pci_acpi_wake_dev\">pci_acpi_wake_dev</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * _SxD returns the D-state with the highest power</span>", 
"<span class=\"comment\"> * (lowest D-state number) supported in the S-state \"x\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * If the devices does not have a _PRW</span>", 
"<span class=\"comment\"> * (Power Resources for Wake) supporting system wakeup from \"x\"</span>", 
"<span class=\"comment\"> * then the OS is free to choose a lower power (higher number</span>", 
"<span class=\"comment\"> * D-state) than the return value from _SxD.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * But if _PRW is enabled at S-state \"x\", the OS</span>", 
"<span class=\"comment\"> * must not choose a power lower than _SxD --</span>", 
"<span class=\"comment\"> * unless the device has an _SxW method specifying</span>", 
"<span class=\"comment\"> * the lowest power (highest D-state number) the device</span>", 
"<span class=\"comment\"> * may enter while still able to wake the system.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * ie. depending on global OS policy:</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * if (_PRW at S-state x)</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>choose from highest power _SxD to lowest power _SxW</span>", 
"<span class=\"comment\"> * else // no _PRW at S-state x</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/>choose highest power _SxD or any lower power</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#pci_power_t\">pci_power_t</a> <a class=\"id\" href=\"#acpi_pci_choose_state\">acpi_pci_choose_state</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#pdev\">pdev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#acpi_state\">acpi_state</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_state\">acpi_state</a> = <a class=\"id\" href=\"#acpi_pm_device_sleep_state\">acpi_pm_device_sleep_state</a>(&amp;<a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#acpi_state\">acpi_state</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PCI_POWER_ERROR\">PCI_POWER_ERROR</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#acpi_state\">acpi_state</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#ACPI_STATE_D0\">ACPI_STATE_D0</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PCI_D0\">PCI_D0</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#ACPI_STATE_D1\">ACPI_STATE_D1</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PCI_D1\">PCI_D1</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#ACPI_STATE_D2\">ACPI_STATE_D2</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PCI_D2\">PCI_D2</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#ACPI_STATE_D3\">ACPI_STATE_D3</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PCI_D3hot\">PCI_D3hot</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#PCI_POWER_ERROR\">PCI_POWER_ERROR</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#acpi_pci_power_manageable\">acpi_pci_power_manageable</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> <a class=\"id\" href=\"#handle\">handle</a> = <a class=\"id\" href=\"#DEVICE_ACPI_HANDLE\">DEVICE_ACPI_HANDLE</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#handle\">handle</a> ? <a class=\"id\" href=\"#acpi_bus_power_manageable\">acpi_bus_power_manageable</a>(<a class=\"id\" href=\"#handle\">handle</a>) : <a class=\"id\" href=\"#false\">false</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#acpi_pci_set_power_state\">acpi_pci_set_power_state</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#pci_power_t\">pci_power_t</a> <a class=\"id\" href=\"#state\">state</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> <a class=\"id\" href=\"#handle\">handle</a> = <a class=\"id\" href=\"#DEVICE_ACPI_HANDLE\">DEVICE_ACPI_HANDLE</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>static const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#state_conv\">state_conv</a>[] = {", 
"<span class=\"ts\"/><span class=\"ts\"/>[<a class=\"id\" href=\"#PCI_D0\">PCI_D0</a>] = <a class=\"id\" href=\"#ACPI_STATE_D0\">ACPI_STATE_D0</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>[<a class=\"id\" href=\"#PCI_D1\">PCI_D1</a>] = <a class=\"id\" href=\"#ACPI_STATE_D1\">ACPI_STATE_D1</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>[<a class=\"id\" href=\"#PCI_D2\">PCI_D2</a>] = <a class=\"id\" href=\"#ACPI_STATE_D2\">ACPI_STATE_D2</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>[<a class=\"id\" href=\"#PCI_D3hot\">PCI_D3hot</a>] = <a class=\"id\" href=\"#ACPI_STATE_D3\">ACPI_STATE_D3</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>[<a class=\"id\" href=\"#PCI_D3cold\">PCI_D3cold</a>] = <a class=\"id\" href=\"#ACPI_STATE_D3\">ACPI_STATE_D3</a>", 
"<span class=\"ts\"/>};", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* If the ACPI device has _EJ0, ignore the device */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#handle\">handle</a> || <a class=\"id\" href=\"#ACPI_SUCCESS\">ACPI_SUCCESS</a>(<a class=\"id\" href=\"#acpi_get_handle\">acpi_get_handle</a>(<a class=\"id\" href=\"#handle\">handle</a>, \"_EJ0\", &amp;<a class=\"id\" href=\"#tmp\">tmp</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#state\">state</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PCI_D0\">PCI_D0</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PCI_D1\">PCI_D1</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PCI_D2\">PCI_D2</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PCI_D3hot\">PCI_D3hot</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#PCI_D3cold\">PCI_D3cold</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#acpi_bus_set_power\">acpi_bus_set_power</a>(<a class=\"id\" href=\"#handle\">handle</a>, <a class=\"id\" href=\"#state_conv\">state_conv</a>[<a class=\"id\" href=\"#state\">state</a>]);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#error\">error</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_printk\">dev_printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a>, &amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>\"power state changed by ACPI to D%d\\n\", <a class=\"id\" href=\"#state\">state</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#acpi_pci_can_wakeup\">acpi_pci_can_wakeup</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> <a class=\"id\" href=\"#handle\">handle</a> = <a class=\"id\" href=\"#DEVICE_ACPI_HANDLE\">DEVICE_ACPI_HANDLE</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#handle\">handle</a> ? <a class=\"id\" href=\"#acpi_bus_can_wakeup\">acpi_bus_can_wakeup</a>(<a class=\"id\" href=\"#handle\">handle</a>) : <a class=\"id\" href=\"#false\">false</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#acpi_pci_propagate_wakeup_enable\">acpi_pci_propagate_wakeup_enable</a>(struct <a class=\"id\" href=\"#pci_bus\">pci_bus</a> *<a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#enable\">enable</a>)", 
"{", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#acpi_pm_device_sleep_wake\">acpi_pm_device_sleep_wake</a>(&amp;<a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#self\">self</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#enable\">enable</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus\">bus</a> = <a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* We have reached the root bus. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#bridge\">bridge</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acpi_pm_device_sleep_wake\">acpi_pm_device_sleep_wake</a>(<a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#bridge\">bridge</a>, <a class=\"id\" href=\"#enable\">enable</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#acpi_pci_sleep_wake\">acpi_pci_sleep_wake</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#enable\">enable</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#acpi_pci_can_wakeup\">acpi_pci_can_wakeup</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#acpi_pm_device_sleep_wake\">acpi_pm_device_sleep_wake</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#enable\">enable</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_pci_propagate_wakeup_enable\">acpi_pci_propagate_wakeup_enable</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#enable\">enable</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * acpi_dev_run_wake - Enable/disable wake-up for given device.</span>", 
"<span class=\"comment\"> * @phys_dev: Device to enable/disable the platform to wake-up the system for.</span>", 
"<span class=\"comment\"> * @enable: Whether enable or disable the wake-up functionality.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Find the ACPI device object corresponding to @pci_dev and try to</span>", 
"<span class=\"comment\"> * enable/disable the GPE associated with it.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#acpi_dev_run_wake\">acpi_dev_run_wake</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#phys_dev\">phys_dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#enable\">enable</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#acpi_device\">acpi_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> <a class=\"id\" href=\"#handle\">handle</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#device_run_wake\">device_run_wake</a>(<a class=\"id\" href=\"#phys_dev\">phys_dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#handle\">handle</a> = <a class=\"id\" href=\"#DEVICE_ACPI_HANDLE\">DEVICE_ACPI_HANDLE</a>(<a class=\"id\" href=\"#phys_dev\">phys_dev</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#handle\">handle</a> || <a class=\"id\" href=\"#ACPI_FAILURE\">ACPI_FAILURE</a>(<a class=\"id\" href=\"#acpi_bus_get_device\">acpi_bus_get_device</a>(<a class=\"id\" href=\"#handle\">handle</a>, &amp;<a class=\"id\" href=\"#dev\">dev</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_dbg\">dev_dbg</a>(<a class=\"id\" href=\"#phys_dev\">phys_dev</a>, \"ACPI handle has no context in %s!\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__func__\">__func__</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#enable\">enable</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#run_wake_count\">run_wake_count</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acpi_enable_wakeup_device_power\">acpi_enable_wakeup_device_power</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#ACPI_STATE_S0\">ACPI_STATE_S0</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acpi_enable_gpe\">acpi_enable_gpe</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#gpe_device\">gpe_device</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#gpe_number\">gpe_number</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#run_wake_count\">run_wake_count</a> &gt; 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!--<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#run_wake_count\">run_wake_count</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acpi_disable_gpe\">acpi_disable_gpe</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#gpe_device\">gpe_device</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#wakeup\">wakeup</a>.<a class=\"id\" href=\"#gpe_number\">gpe_number</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acpi_disable_wakeup_device_power\">acpi_disable_wakeup_device_power</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#EALREADY\">EALREADY</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#acpi_pci_propagate_run_wake\">acpi_pci_propagate_run_wake</a>(struct <a class=\"id\" href=\"#pci_bus\">pci_bus</a> *<a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#enable\">enable</a>)", 
"{", 
"<span class=\"ts\"/>while (<a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#bridge\">bridge</a> = <a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#self\">self</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bridge\">bridge</a>-><a class=\"id\" href=\"#pme_interrupt\">pme_interrupt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#acpi_dev_run_wake\">acpi_dev_run_wake</a>(&amp;<a class=\"id\" href=\"#bridge\">bridge</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#enable\">enable</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus\">bus</a> = <a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* We have reached the root bus. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#bridge\">bridge</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acpi_dev_run_wake\">acpi_dev_run_wake</a>(<a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#bridge\">bridge</a>, <a class=\"id\" href=\"#enable\">enable</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#acpi_pci_run_wake\">acpi_pci_run_wake</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#enable\">enable</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#pme_interrupt\">pme_interrupt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#acpi_dev_run_wake\">acpi_dev_run_wake</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#enable\">enable</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#acpi_pci_propagate_run_wake\">acpi_pci_propagate_run_wake</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#enable\">enable</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#pci_platform_pm_ops\">pci_platform_pm_ops</a> <a class=\"id\" href=\"#acpi_pci_platform_pm\">acpi_pci_platform_pm</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#is_manageable\">is_manageable</a> = <a class=\"id\" href=\"#acpi_pci_power_manageable\">acpi_pci_power_manageable</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#set_state\">set_state</a> = <a class=\"id\" href=\"#acpi_pci_set_power_state\">acpi_pci_set_power_state</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#choose_state\">choose_state</a> = <a class=\"id\" href=\"#acpi_pci_choose_state\">acpi_pci_choose_state</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#can_wakeup\">can_wakeup</a> = <a class=\"id\" href=\"#acpi_pci_can_wakeup\">acpi_pci_can_wakeup</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#sleep_wake\">sleep_wake</a> = <a class=\"id\" href=\"#acpi_pci_sleep_wake\">acpi_pci_sleep_wake</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#run_wake\">run_wake</a> = <a class=\"id\" href=\"#acpi_pci_run_wake\">acpi_pci_run_wake</a>,", 
"};", 
"", 
"<span class=\"comment\">/* ACPI bus type */</span>", 
"static int <a class=\"id\" href=\"#acpi_pci_find_device\">acpi_pci_find_device</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> *<a class=\"id\" href=\"#handle\">handle</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> * <a class=\"id\" href=\"#pci_dev\">pci_dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pci_dev\">pci_dev</a> = <a class=\"id\" href=\"#to_pci_dev\">to_pci_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* Please ref to ACPI spec for the syntax of _ADR */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> = (<a class=\"id\" href=\"#PCI_SLOT\">PCI_SLOT</a>(<a class=\"id\" href=\"#pci_dev\">pci_dev</a>-><a class=\"id\" href=\"#devfn\">devfn</a>) << 16) | <a class=\"id\" href=\"#PCI_FUNC\">PCI_FUNC</a>(<a class=\"id\" href=\"#pci_dev\">pci_dev</a>-><a class=\"id\" href=\"#devfn\">devfn</a>);", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#handle\">handle</a> = <a class=\"id\" href=\"#acpi_get_child\">acpi_get_child</a>(<a class=\"id\" href=\"#DEVICE_ACPI_HANDLE\">DEVICE_ACPI_HANDLE</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#parent\">parent</a>), <a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/>if (!*<a class=\"id\" href=\"#handle\">handle</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#acpi_pci_find_root_bridge\">acpi_pci_find_root_bridge</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#acpi_handle\">acpi_handle</a> *<a class=\"id\" href=\"#handle\">handle</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#num\">num</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#seg\">seg</a>, <a class=\"id\" href=\"#bus\">bus</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * The string should be the same as root bridge's name</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Please look at 'pci_scan_bus_parented'</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#num\">num</a> = <a class=\"id\" href=\"#sscanf\">sscanf</a>(<a class=\"id\" href=\"#dev_name\">dev_name</a>(<a class=\"id\" href=\"#dev\">dev</a>), \"pci%04x:%02x\", &amp;<a class=\"id\" href=\"#seg\">seg</a>, &amp;<a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#num\">num</a> != 2)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#handle\">handle</a> = <a class=\"id\" href=\"#acpi_get_pci_rootbridge_handle\">acpi_get_pci_rootbridge_handle</a>(<a class=\"id\" href=\"#seg\">seg</a>, <a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/>if (!*<a class=\"id\" href=\"#handle\">handle</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#acpi_bus_type\">acpi_bus_type</a> <a class=\"id\" href=\"#acpi_pci_bus\">acpi_pci_bus</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#bus\">bus</a> = &amp;<a class=\"id\" href=\"#pci_bus_type\">pci_bus_type</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#find_device\">find_device</a> = <a class=\"id\" href=\"#acpi_pci_find_device\">acpi_pci_find_device</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#find_bridge\">find_bridge</a> = <a class=\"id\" href=\"#acpi_pci_find_root_bridge\">acpi_pci_find_root_bridge</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#acpi_pci_init\">acpi_pci_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#acpi_gbl_FADT\">acpi_gbl_FADT</a>.<a class=\"id\" href=\"#boot_flags\">boot_flags</a> &amp; <a class=\"id\" href=\"#ACPI_FADT_NO_MSI\">ACPI_FADT_NO_MSI</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a>\"ACPI FADT declares the system doesn't support MSI, so disable it\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pci_no_msi\">pci_no_msi</a>();", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#acpi_gbl_FADT\">acpi_gbl_FADT</a>.<a class=\"id\" href=\"#boot_flags\">boot_flags</a> &amp; <a class=\"id\" href=\"#ACPI_FADT_NO_ASPM\">ACPI_FADT_NO_ASPM</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a>\"ACPI FADT declares the system doesn't support PCIe ASPM, so disable it\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pcie_no_aspm\">pcie_no_aspm</a>();", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#register_acpi_bus_type\">register_acpi_bus_type</a>(&amp;<a class=\"id\" href=\"#acpi_pci_bus\">acpi_pci_bus</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pci_set_platform_pm\">pci_set_platform_pm</a>(&amp;<a class=\"id\" href=\"#acpi_pci_platform_pm\">acpi_pci_platform_pm</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"<a class=\"id\" href=\"#arch_initcall\">arch_initcall</a>(<a class=\"id\" href=\"#acpi_pci_init\">acpi_pci_init</a>);", 
];
xr_frag_insert('l/be/736cc2917f88add7f3c4176e5e0f3206d76bbd.xr', __xr_tmp);
