var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * device_cgroup.c - device cgroup subsystem</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright 2007 IBM Corp</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#device_cgroup\">device_cgroup</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#cgroup\">cgroup</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ctype\">ctype</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#seq_file\">seq_file</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#rcupdate\">rcupdate</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mutex\">mutex</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#ACC_MKNOD\">ACC_MKNOD</a> 1", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#ACC_READ\">ACC_READ</a>  2", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#ACC_WRITE\">ACC_WRITE</a> 4", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#ACC_MASK\">ACC_MASK</a> (<a class=\"id\" href=\"#ACC_MKNOD\">ACC_MKNOD</a> | <a class=\"id\" href=\"#ACC_READ\">ACC_READ</a> | <a class=\"id\" href=\"#ACC_WRITE\">ACC_WRITE</a>)", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEV_BLOCK\">DEV_BLOCK</a> 1", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEV_CHAR\">DEV_CHAR</a>  2", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>   4  <span class=\"comment\">/* this represents all devices */</span>", 
"", 
"static <a class=\"id\" href=\"#DEFINE_MUTEX\">DEFINE_MUTEX</a>(<a class=\"id\" href=\"#devcgroup_mutex\">devcgroup_mutex</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * whitelist locking rules:</span>", 
"<span class=\"comment\"> * hold devcgroup_mutex for update/read.</span>", 
"<span class=\"comment\"> * hold rcu_read_lock() for read.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#major\">major</a>, <a class=\"id\" href=\"#minor\">minor</a>;", 
"<span class=\"ts\"/>short <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/>short <a class=\"id\" href=\"#access\">access</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> <a class=\"id\" href=\"#list\">list</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> <a class=\"id\" href=\"#rcu\">rcu</a>;", 
"};", 
"", 
"struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cgroup_subsys_state\">cgroup_subsys_state</a> <a class=\"id\" href=\"#css\">css</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#list_head\">list_head</a> <a class=\"id\" href=\"#whitelist\">whitelist</a>;", 
"};", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#css_to_devcgroup\">css_to_devcgroup</a>(struct <a class=\"id\" href=\"#cgroup_subsys_state\">cgroup_subsys_state</a> *<a class=\"id\" href=\"#s\">s</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#s\">s</a>, struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>, <a class=\"id\" href=\"#css\">css</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#cgroup_to_devcgroup\">cgroup_to_devcgroup</a>(struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#cgroup\">cgroup</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#css_to_devcgroup\">css_to_devcgroup</a>(<a class=\"id\" href=\"#cgroup_subsys_state\">cgroup_subsys_state</a>(<a class=\"id\" href=\"#cgroup\">cgroup</a>, <a class=\"id\" href=\"#devices_subsys_id\">devices_subsys_id</a>));", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#task_devcgroup\">task_devcgroup</a>(struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#task\">task</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#css_to_devcgroup\">css_to_devcgroup</a>(<a class=\"id\" href=\"#task_subsys_state\">task_subsys_state</a>(<a class=\"id\" href=\"#task\">task</a>, <a class=\"id\" href=\"#devices_subsys_id\">devices_subsys_id</a>));", 
"}", 
"", 
"struct <a class=\"id\" href=\"#cgroup_subsys\">cgroup_subsys</a> <a class=\"id\" href=\"#devices_subsys\">devices_subsys</a>;", 
"", 
"static int <a class=\"id\" href=\"#devcgroup_can_attach\">devcgroup_can_attach</a>(struct <a class=\"id\" href=\"#cgroup_subsys\">cgroup_subsys</a> *<a class=\"id\" href=\"#ss\">ss</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#new_cgroup\">new_cgroup</a>, struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#task\">task</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#threadgroup\">threadgroup</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#current\">current</a> != <a class=\"id\" href=\"#task\">task</a> && !<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_ADMIN\">CAP_SYS_ADMIN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * called under devcgroup_mutex</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#dev_whitelist_copy\">dev_whitelist_copy</a>(struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#dest\">dest</a>, struct <a class=\"id\" href=\"#list_head\">list_head</a> *<a class=\"id\" href=\"#orig\">orig</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>, *<a class=\"id\" href=\"#new\">new</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#wh\">wh</a>, <a class=\"id\" href=\"#orig\">orig</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new\">new</a> = <a class=\"id\" href=\"#kmemdup\">kmemdup</a>(<a class=\"id\" href=\"#wh\">wh</a>, sizeof(*<a class=\"id\" href=\"#wh\">wh</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#new\">new</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#free_and_exit\">free_and_exit</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail\">list_add_tail</a>(&amp;<a class=\"id\" href=\"#new\">new</a>-><a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#dest\">dest</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#free_and_exit\">free_and_exit</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_safe\">list_for_each_entry_safe</a>(<a class=\"id\" href=\"#wh\">wh</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#dest\">dest</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#wh\">wh</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Stupid prototype - don't bother combining existing entries */</span>", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * called under devcgroup_mutex</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#dev_whitelist_add\">dev_whitelist_add</a>(struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#whcopy\">whcopy</a>, *<a class=\"id\" href=\"#walk\">walk</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#whcopy\">whcopy</a> = <a class=\"id\" href=\"#kmemdup\">kmemdup</a>(<a class=\"id\" href=\"#wh\">wh</a>, sizeof(*<a class=\"id\" href=\"#wh\">wh</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#whcopy\">whcopy</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#walk\">walk</a>, &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#major\">major</a> != <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#minor\">minor</a> != <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#access\">access</a> |= <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#access\">access</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#whcopy\">whcopy</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#whcopy\">whcopy</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#whcopy\">whcopy</a> != <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail_rcu\">list_add_tail_rcu</a>(&amp;<a class=\"id\" href=\"#whcopy\">whcopy</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>);", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#whitelist_item_free\">whitelist_item_free</a>(struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> *<a class=\"id\" href=\"#rcu\">rcu</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#item\">item</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#item\">item</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#rcu\">rcu</a>, struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a>, <a class=\"id\" href=\"#rcu\">rcu</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#item\">item</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * called under devcgroup_mutex</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#dev_whitelist_rm\">dev_whitelist_rm</a>(struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#walk\">walk</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_safe\">list_for_each_entry_safe</a>(<a class=\"id\" href=\"#walk\">walk</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#remove\">remove</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#major\">major</a> != ~0 && <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#major\">major</a> != <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#minor\">minor</a> != ~0 && <a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#minor\">minor</a> != <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<a class=\"id\" href=\"#remove\">remove</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#access\">access</a> &= ~<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#access\">access</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#access\">access</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del_rcu\">list_del_rcu</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#walk\">walk</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#whitelist_item_free\">whitelist_item_free</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * called from kernel/cgroup.c with cgroup_lock() held.</span>", 
"<span class=\"comment\"> */</span>", 
"static struct <a class=\"id\" href=\"#cgroup_subsys_state\">cgroup_subsys_state</a> *<a class=\"id\" href=\"#devcgroup_create\">devcgroup_create</a>(struct <a class=\"id\" href=\"#cgroup_subsys\">cgroup_subsys</a> *<a class=\"id\" href=\"#ss\">ss</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#cgroup\">cgroup</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>, *<a class=\"id\" href=\"#parent_dev_cgroup\">parent_dev_cgroup</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#parent_cgroup\">parent_cgroup</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#parent_cgroup\">parent_cgroup</a> = <a class=\"id\" href=\"#cgroup\">cgroup</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#parent_cgroup\">parent_cgroup</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#wh\">wh</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#wh\">wh</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(-<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a> = <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a> = ~0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#access\">access</a> = <a class=\"id\" href=\"#ACC_MASK\">ACC_MASK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#parent_dev_cgroup\">parent_dev_cgroup</a> = <a class=\"id\" href=\"#cgroup_to_devcgroup\">cgroup_to_devcgroup</a>(<a class=\"id\" href=\"#parent_cgroup\">parent_cgroup</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#devcgroup_mutex\">devcgroup_mutex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#dev_whitelist_copy\">dev_whitelist_copy</a>(&amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#parent_dev_cgroup\">parent_dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#devcgroup_mutex\">devcgroup_mutex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#ret\">ret</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#css\">css</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#devcgroup_destroy\">devcgroup_destroy</a>(struct <a class=\"id\" href=\"#cgroup_subsys\">cgroup_subsys</a> *<a class=\"id\" href=\"#ss\">ss</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#cgroup\">cgroup</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> = <a class=\"id\" href=\"#cgroup_to_devcgroup\">cgroup_to_devcgroup</a>(<a class=\"id\" href=\"#cgroup\">cgroup</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_safe\">list_for_each_entry_safe</a>(<a class=\"id\" href=\"#wh\">wh</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#wh\">wh</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>);", 
"}", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEVCG_ALLOW\">DEVCG_ALLOW</a> 1", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEVCG_DENY\">DEVCG_DENY</a> 2", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#DEVCG_LIST\">DEVCG_LIST</a> 3", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MAJMINLEN\">MAJMINLEN</a> 13", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#ACCLEN\">ACCLEN</a> 4", 
"", 
"static void <a class=\"id\" href=\"#set_access\">set_access</a>(char *<a class=\"id\" href=\"#acc\">acc</a>, short <a class=\"id\" href=\"#access\">access</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#acc\">acc</a>, 0, <a class=\"id\" href=\"#ACCLEN\">ACCLEN</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#access\">access</a> &amp; <a class=\"id\" href=\"#ACC_READ\">ACC_READ</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acc\">acc</a>[<a class=\"id\" href=\"#idx\">idx</a>++] = 'r';", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#access\">access</a> &amp; <a class=\"id\" href=\"#ACC_WRITE\">ACC_WRITE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acc\">acc</a>[<a class=\"id\" href=\"#idx\">idx</a>++] = 'w';", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#access\">access</a> &amp; <a class=\"id\" href=\"#ACC_MKNOD\">ACC_MKNOD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#acc\">acc</a>[<a class=\"id\" href=\"#idx\">idx</a>++] = 'm';", 
"}", 
"", 
"static char <a class=\"id\" href=\"#type_to_char\">type_to_char</a>(short <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 'a';", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#DEV_CHAR\">DEV_CHAR</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 'c';", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#DEV_BLOCK\">DEV_BLOCK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 'b';", 
"<span class=\"ts\"/>return 'X';", 
"}", 
"", 
"static void <a class=\"id\" href=\"#set_majmin\">set_majmin</a>(char *<a class=\"id\" href=\"#str\">str</a>, unsigned <a class=\"id\" href=\"#m\">m</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#m\">m</a> == ~0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#str\">str</a>, \"*\");", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sprintf\">sprintf</a>(<a class=\"id\" href=\"#str\">str</a>, \"%u\", <a class=\"id\" href=\"#m\">m</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#devcgroup_seq_read\">devcgroup_seq_read</a>(struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#cgroup\">cgroup</a>, struct <a class=\"id\" href=\"#cftype\">cftype</a> *<a class=\"id\" href=\"#cft\">cft</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#seq_file\">seq_file</a> *<a class=\"id\" href=\"#m\">m</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#devcgroup\">devcgroup</a> = <a class=\"id\" href=\"#cgroup_to_devcgroup\">cgroup_to_devcgroup</a>(<a class=\"id\" href=\"#cgroup\">cgroup</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>;", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#maj\">maj</a>[<a class=\"id\" href=\"#MAJMINLEN\">MAJMINLEN</a>], <a class=\"id\" href=\"#min\">min</a>[<a class=\"id\" href=\"#MAJMINLEN\">MAJMINLEN</a>], <a class=\"id\" href=\"#acc\">acc</a>[<a class=\"id\" href=\"#ACCLEN\">ACCLEN</a>];", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#wh\">wh</a>, &amp;<a class=\"id\" href=\"#devcgroup\">devcgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_access\">set_access</a>(<a class=\"id\" href=\"#acc\">acc</a>, <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#access\">access</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_majmin\">set_majmin</a>(<a class=\"id\" href=\"#maj\">maj</a>, <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#set_majmin\">set_majmin</a>(<a class=\"id\" href=\"#min\">min</a>, <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#seq_printf\">seq_printf</a>(<a class=\"id\" href=\"#m\">m</a>, \"%c %s:%s %s\\n\", <a class=\"id\" href=\"#type_to_char\">type_to_char</a>(<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#maj\">maj</a>, <a class=\"id\" href=\"#min\">min</a>, <a class=\"id\" href=\"#acc\">acc</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * may_access_whitelist:</span>", 
"<span class=\"comment\"> * does the access granted to dev_cgroup c contain the access</span>", 
"<span class=\"comment\"> * requested in whitelist item refwh.</span>", 
"<span class=\"comment\"> * return 1 if yes, 0 if no.</span>", 
"<span class=\"comment\"> * call with devcgroup_mutex held</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#may_access_whitelist\">may_access_whitelist</a>(struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#c\">c</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#refwh\">refwh</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#whitem\">whitem</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry\">list_for_each_entry</a>(<a class=\"id\" href=\"#whitem\">whitem</a>, &amp;<a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#refwh\">refwh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_BLOCK\">DEV_BLOCK</a>) && !(<a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_BLOCK\">DEV_BLOCK</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#refwh\">refwh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_CHAR\">DEV_CHAR</a>) && !(<a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_CHAR\">DEV_CHAR</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#major\">major</a> != ~0 && <a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#major\">major</a> != <a class=\"id\" href=\"#refwh\">refwh</a>-><a class=\"id\" href=\"#major\">major</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#minor\">minor</a> != ~0 && <a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#minor\">minor</a> != <a class=\"id\" href=\"#refwh\">refwh</a>-><a class=\"id\" href=\"#minor\">minor</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#refwh\">refwh</a>-><a class=\"id\" href=\"#access\">access</a> &amp; (~<a class=\"id\" href=\"#whitem\">whitem</a>-><a class=\"id\" href=\"#access\">access</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * parent_has_perm:</span>", 
"<span class=\"comment\"> * when adding a new allow rule to a device whitelist, the rule</span>", 
"<span class=\"comment\"> * must be allowed in the parent device</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#parent_has_perm\">parent_has_perm</a>(struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#childcg\">childcg</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#pcg\">pcg</a> = <a class=\"id\" href=\"#childcg\">childcg</a>-><a class=\"id\" href=\"#css\">css</a>.<a class=\"id\" href=\"#cgroup\">cgroup</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#parent\">parent</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pcg\">pcg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#cgroup_to_devcgroup\">cgroup_to_devcgroup</a>(<a class=\"id\" href=\"#pcg\">pcg</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#may_access_whitelist\">may_access_whitelist</a>(<a class=\"id\" href=\"#parent\">parent</a>, <a class=\"id\" href=\"#wh\">wh</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Modify the whitelist using allow/deny rules.</span>", 
"<span class=\"comment\"> * CAP_SYS_ADMIN is needed for this.  It's at least separate from CAP_MKNOD</span>", 
"<span class=\"comment\"> * so we can give a container CAP_MKNOD to let it create devices but not</span>", 
"<span class=\"comment\"> * modify the whitelist.</span>", 
"<span class=\"comment\"> * It seems likely we'll want to add a CAP_CONTAINER capability to allow</span>", 
"<span class=\"comment\"> * us to also grant CAP_SYS_ADMIN to containers without giving away the</span>", 
"<span class=\"comment\"> * device whitelist controls, but for now we'll stick with CAP_SYS_ADMIN</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Taking rules away is always allowed (given CAP_SYS_ADMIN).  Granting</span>", 
"<span class=\"comment\"> * new access is only allowed if you're in the top-level cgroup, or your</span>", 
"<span class=\"comment\"> * parent cgroup has the access you're asking for.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#devcgroup_update_access\">devcgroup_update_access</a>(struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#devcgroup\">devcgroup</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   int <a class=\"id\" href=\"#filetype\">filetype</a>, const char *<a class=\"id\" href=\"#buffer\">buffer</a>)", 
"{", 
"<span class=\"ts\"/>const char *<a class=\"id\" href=\"#b\">b</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#endp\">endp</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> <a class=\"id\" href=\"#wh\">wh</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_ADMIN\">CAP_SYS_ADMIN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#wh\">wh</a>, 0, sizeof(<a class=\"id\" href=\"#wh\">wh</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#buffer\">buffer</a>;", 
"", 
"<span class=\"ts\"/>switch (*<a class=\"id\" href=\"#b\">b</a>) {", 
"<span class=\"ts\"/>case 'a':", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#access\">access</a> = <a class=\"id\" href=\"#ACC_MASK\">ACC_MASK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#major\">major</a> = ~0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#minor\">minor</a> = ~0;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#handle\">handle</a>;", 
"<span class=\"ts\"/>case 'b':", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#DEV_BLOCK\">DEV_BLOCK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 'c':", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#DEV_CHAR\">DEV_CHAR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>++;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#isspace\">isspace</a>(*<a class=\"id\" href=\"#b\">b</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>++;", 
"<span class=\"ts\"/>if (*<a class=\"id\" href=\"#b\">b</a> == '*') {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#major\">major</a> = ~0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>++;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#isdigit\">isdigit</a>(*<a class=\"id\" href=\"#b\">b</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#major\">major</a> = <a class=\"id\" href=\"#simple_strtoul\">simple_strtoul</a>(<a class=\"id\" href=\"#b\">b</a>, &amp;<a class=\"id\" href=\"#endp\">endp</a>, 10);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#endp\">endp</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (*<a class=\"id\" href=\"#b\">b</a> != ':')", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>++;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* read minor */</span>", 
"<span class=\"ts\"/>if (*<a class=\"id\" href=\"#b\">b</a> == '*') {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#minor\">minor</a> = ~0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a>++;", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#isdigit\">isdigit</a>(*<a class=\"id\" href=\"#b\">b</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#minor\">minor</a> = <a class=\"id\" href=\"#simple_strtoul\">simple_strtoul</a>(<a class=\"id\" href=\"#b\">b</a>, &amp;<a class=\"id\" href=\"#endp\">endp</a>, 10);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#b\">b</a> = <a class=\"id\" href=\"#endp\">endp</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#isspace\">isspace</a>(*<a class=\"id\" href=\"#b\">b</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#b\">b</a>++, <a class=\"id\" href=\"#count\">count</a> = 0; <a class=\"id\" href=\"#count\">count</a> &lt; 3; <a class=\"id\" href=\"#count\">count</a>++, <a class=\"id\" href=\"#b\">b</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (*<a class=\"id\" href=\"#b\">b</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case 'r':", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#access\">access</a> |= <a class=\"id\" href=\"#ACC_READ\">ACC_READ</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case 'w':", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#access\">access</a> |= <a class=\"id\" href=\"#ACC_WRITE\">ACC_WRITE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case 'm':", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#wh\">wh</a>.<a class=\"id\" href=\"#access\">access</a> |= <a class=\"id\" href=\"#ACC_MKNOD\">ACC_MKNOD</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case '\\n':", 
"<span class=\"ts\"/><span class=\"ts\"/>case '\\0':", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a> = 3;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#handle\">handle</a>:", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#filetype\">filetype</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#DEVCG_ALLOW\">DEVCG_ALLOW</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#parent_has_perm\">parent_has_perm</a>(<a class=\"id\" href=\"#devcgroup\">devcgroup</a>, &amp;<a class=\"id\" href=\"#wh\">wh</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#dev_whitelist_add\">dev_whitelist_add</a>(<a class=\"id\" href=\"#devcgroup\">devcgroup</a>, &amp;<a class=\"id\" href=\"#wh\">wh</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#DEVCG_DENY\">DEVCG_DENY</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_whitelist_rm\">dev_whitelist_rm</a>(<a class=\"id\" href=\"#devcgroup\">devcgroup</a>, &amp;<a class=\"id\" href=\"#wh\">wh</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#devcgroup_access_write\">devcgroup_access_write</a>(struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#cgrp\">cgrp</a>, struct <a class=\"id\" href=\"#cftype\">cftype</a> *<a class=\"id\" href=\"#cft\">cft</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  const char *<a class=\"id\" href=\"#buffer\">buffer</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#retval\">retval</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#devcgroup_mutex\">devcgroup_mutex</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#retval\">retval</a> = <a class=\"id\" href=\"#devcgroup_update_access\">devcgroup_update_access</a>(<a class=\"id\" href=\"#cgroup_to_devcgroup\">cgroup_to_devcgroup</a>(<a class=\"id\" href=\"#cgrp\">cgrp</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#cft\">cft</a>-><a class=\"id\" href=\"#private\">private</a>, <a class=\"id\" href=\"#buffer\">buffer</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#devcgroup_mutex\">devcgroup_mutex</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#retval\">retval</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#cftype\">cftype</a> <a class=\"id\" href=\"#dev_cgroup_files\">dev_cgroup_files</a>[] = {", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = \"allow\",", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#write_string\">write_string</a>  = <a class=\"id\" href=\"#devcgroup_access_write\">devcgroup_access_write</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#private\">private</a> = <a class=\"id\" href=\"#DEVCG_ALLOW\">DEVCG_ALLOW</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = \"deny\",", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#write_string\">write_string</a> = <a class=\"id\" href=\"#devcgroup_access_write\">devcgroup_access_write</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#private\">private</a> = <a class=\"id\" href=\"#DEVCG_DENY\">DEVCG_DENY</a>,", 
"<span class=\"ts\"/>},", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = \"list\",", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#read_seq_string\">read_seq_string</a> = <a class=\"id\" href=\"#devcgroup_seq_read\">devcgroup_seq_read</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#private\">private</a> = <a class=\"id\" href=\"#DEVCG_LIST\">DEVCG_LIST</a>,", 
"<span class=\"ts\"/>},", 
"};", 
"", 
"static int <a class=\"id\" href=\"#devcgroup_populate\">devcgroup_populate</a>(struct <a class=\"id\" href=\"#cgroup_subsys\">cgroup_subsys</a> *<a class=\"id\" href=\"#ss\">ss</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#cgroup\">cgroup</a> *<a class=\"id\" href=\"#cgroup\">cgroup</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#cgroup_add_files\">cgroup_add_files</a>(<a class=\"id\" href=\"#cgroup\">cgroup</a>, <a class=\"id\" href=\"#ss\">ss</a>, <a class=\"id\" href=\"#dev_cgroup_files\">dev_cgroup_files</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#dev_cgroup_files\">dev_cgroup_files</a>));", 
"}", 
"", 
"struct <a class=\"id\" href=\"#cgroup_subsys\">cgroup_subsys</a> <a class=\"id\" href=\"#devices_subsys\">devices_subsys</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = \"devices\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#can_attach\">can_attach</a> = <a class=\"id\" href=\"#devcgroup_can_attach\">devcgroup_can_attach</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#create\">create</a> = <a class=\"id\" href=\"#devcgroup_create\">devcgroup_create</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#destroy\">destroy</a> = <a class=\"id\" href=\"#devcgroup_destroy\">devcgroup_destroy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#populate\">populate</a> = <a class=\"id\" href=\"#devcgroup_populate\">devcgroup_populate</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#subsys_id\">subsys_id</a> = <a class=\"id\" href=\"#devices_subsys_id\">devices_subsys_id</a>,", 
"};", 
"", 
"int <a class=\"id\" href=\"#devcgroup_inode_permission\">devcgroup_inode_permission</a>(struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>, int <a class=\"id\" href=\"#mask\">mask</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_t\">dev_t</a> <a class=\"id\" href=\"#device\">device</a> = <a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_rdev\">i_rdev</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#device\">device</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#S_ISBLK\">S_ISBLK</a>(<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a>) && !<a class=\"id\" href=\"#S_ISCHR\">S_ISCHR</a>(<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> = <a class=\"id\" href=\"#task_devcgroup\">task_devcgroup</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#wh\">wh</a>, &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#found\">found</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_BLOCK\">DEV_BLOCK</a>) && !<a class=\"id\" href=\"#S_ISBLK\">S_ISBLK</a>(<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_CHAR\">DEV_CHAR</a>) && !<a class=\"id\" href=\"#S_ISCHR\">S_ISCHR</a>(<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a> != ~0 && <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a> != <a class=\"id\" href=\"#imajor\">imajor</a>(<a class=\"id\" href=\"#inode\">inode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a> != ~0 && <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a> != <a class=\"id\" href=\"#iminor\">iminor</a>(<a class=\"id\" href=\"#inode\">inode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#mask\">mask</a> &amp; <a class=\"id\" href=\"#MAY_WRITE\">MAY_WRITE</a>) && !(<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#access\">access</a> &amp; <a class=\"id\" href=\"#ACC_WRITE\">ACC_WRITE</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#mask\">mask</a> &amp; <a class=\"id\" href=\"#MAY_READ\">MAY_READ</a>) && !(<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#access\">access</a> &amp; <a class=\"id\" href=\"#ACC_READ\">ACC_READ</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<a class=\"id\" href=\"#found\">found</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#devcgroup_inode_mknod\">devcgroup_inode_mknod</a>(int <a class=\"id\" href=\"#mode\">mode</a>, <a class=\"id\" href=\"#dev_t\">dev_t</a> <a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> *<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#dev_whitelist_item\">dev_whitelist_item</a> *<a class=\"id\" href=\"#wh\">wh</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#S_ISBLK\">S_ISBLK</a>(<a class=\"id\" href=\"#mode\">mode</a>) && !<a class=\"id\" href=\"#S_ISCHR\">S_ISCHR</a>(<a class=\"id\" href=\"#mode\">mode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a> = <a class=\"id\" href=\"#task_devcgroup\">task_devcgroup</a>(<a class=\"id\" href=\"#current\">current</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#list_for_each_entry_rcu\">list_for_each_entry_rcu</a>(<a class=\"id\" href=\"#wh\">wh</a>, &amp;<a class=\"id\" href=\"#dev_cgroup\">dev_cgroup</a>-><a class=\"id\" href=\"#whitelist\">whitelist</a>, <a class=\"id\" href=\"#list\">list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_ALL\">DEV_ALL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#found\">found</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_BLOCK\">DEV_BLOCK</a>) && !<a class=\"id\" href=\"#S_ISBLK\">S_ISBLK</a>(<a class=\"id\" href=\"#mode\">mode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#type\">type</a> &amp; <a class=\"id\" href=\"#DEV_CHAR\">DEV_CHAR</a>) && !<a class=\"id\" href=\"#S_ISCHR\">S_ISCHR</a>(<a class=\"id\" href=\"#mode\">mode</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a> != ~0 && <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#major\">major</a> != <a class=\"id\" href=\"#MAJOR\">MAJOR</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a> != ~0 && <a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#minor\">minor</a> != <a class=\"id\" href=\"#MINOR\">MINOR</a>(<a class=\"id\" href=\"#dev\">dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#wh\">wh</a>-><a class=\"id\" href=\"#access\">access</a> &amp; <a class=\"id\" href=\"#ACC_MKNOD\">ACC_MKNOD</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<a class=\"id\" href=\"#found\">found</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"}", 
];
xr_frag_insert('l/cc/bf3757994fbfd05317eb0204190808247c9de5.xr', __xr_tmp);
