var __xr_tmp = [
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netlink\">netlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inetdevice\">inetdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#rcupdate\">rcupdate</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#route\">route</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#tcp\">tcp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip_fib\">ip_fib</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#fib_rules\">fib_rules</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a>", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_rule\">fib_rule</a><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#common\">common</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst_len\">dst_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#src_len\">src_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tos\">tos</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#src\">src</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#srcmask\">srcmask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dstmask\">dstmask</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tclassid\">tclassid</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"};", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#fib_rules_tclass\">fib_rules_tclass</a>(struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#r\">r</a> ? ((struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *) <a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#r\">r</a>)-><a class=\"id\" href=\"#tclassid\">tclassid</a> : 0;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"int <a class=\"id\" href=\"#fib_lookup\">fib_lookup</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#flp\">flp</a>, struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *<a class=\"id\" href=\"#res\">res</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_lookup_arg\">fib_lookup_arg</a> <a class=\"id\" href=\"#arg\">arg</a> = {", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#result\">result</a> = <a class=\"id\" href=\"#res\">res</a>,", 
"<span class=\"ts\"/>};", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_rules_lookup\">fib_rules_lookup</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#rules_ops\">rules_ops</a>, <a class=\"id\" href=\"#flp\">flp</a>, 0, &amp;<a class=\"id\" href=\"#arg\">arg</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>-><a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#arg\">arg</a>.<a class=\"id\" href=\"#rule\">rule</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#fib4_rule_action\">fib4_rule_action</a>(struct <a class=\"id\" href=\"#fib_rule\">fib_rule</a> *<a class=\"id\" href=\"#rule\">rule</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#flp\">flp</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    int <a class=\"id\" href=\"#flags\">flags</a>, struct <a class=\"id\" href=\"#fib_lookup_arg\">fib_lookup_arg</a> *<a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#action\">action</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#FR_ACT_TO_TBL\">FR_ACT_TO_TBL</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#FR_ACT_UNREACHABLE\">FR_ACT_UNREACHABLE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENETUNREACH\">ENETUNREACH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#FR_ACT_PROHIBIT\">FR_ACT_PROHIBIT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EACCES\">EACCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#FR_ACT_BLACKHOLE\">FR_ACT_BLACKHOLE</a>:", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#fr_net\">fr_net</a>, <a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#table\">table</a>)) == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_table_lookup\">fib_table_lookup</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#flp\">flp</a>, (struct <a class=\"id\" href=\"#fib_result\">fib_result</a> *) <a class=\"id\" href=\"#arg\">arg</a>-><a class=\"id\" href=\"#result\">result</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &gt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EAGAIN\">EAGAIN</a>;", 
"<a class=\"id\" href=\"#errout\">errout</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"", 
"static int <a class=\"id\" href=\"#fib4_rule_match\">fib4_rule_match</a>(struct <a class=\"id\" href=\"#fib_rule\">fib_rule</a> *<a class=\"id\" href=\"#rule\">rule</a>, struct <a class=\"id\" href=\"#flowi\">flowi</a> *<a class=\"id\" href=\"#fl\">fl</a>, int <a class=\"id\" href=\"#flags\">flags</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *<a class=\"id\" href=\"#r\">r</a> = (struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *) <a class=\"id\" href=\"#rule\">rule</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_dst\">fl4_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#saddr\">saddr</a> = <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_src\">fl4_src</a>;", 
"", 
"<span class=\"ts\"/>if (((<a class=\"id\" href=\"#saddr\">saddr</a> ^ <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#src\">src</a>) &amp; <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#srcmask\">srcmask</a>) ||", 
"<span class=\"ts\"/>    ((<a class=\"id\" href=\"#daddr\">daddr</a> ^ <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#dst\">dst</a>) &amp; <a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#dstmask\">dstmask</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#tos\">tos</a> && (<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#tos\">tos</a> != <a class=\"id\" href=\"#fl\">fl</a>-><a class=\"id\" href=\"#fl4_tos\">fl4_tos</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#fib_empty_table\">fib_empty_table</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#id\">id</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#id\">id</a> = 1; <a class=\"id\" href=\"#id\">id</a> <= <a class=\"id\" href=\"#RT_TABLE_MAX\">RT_TABLE_MAX</a>; <a class=\"id\" href=\"#id\">id</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#id\">id</a>) == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#fib_new_table\">fib_new_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#id\">id</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#nla_policy\">nla_policy</a> <a class=\"id\" href=\"#fib4_rule_policy\">fib4_rule_policy</a>[<a class=\"id\" href=\"#FRA_MAX\">FRA_MAX</a>+1] = {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#FRA_GENERIC_POLICY\">FRA_GENERIC_POLICY</a>,", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#FRA_FLOW\">FRA_FLOW</a>]<span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"};", 
"", 
"static int <a class=\"id\" href=\"#fib4_rule_configure\">fib4_rule_configure</a>(struct <a class=\"id\" href=\"#fib_rule\">fib_rule</a> *<a class=\"id\" href=\"#rule\">rule</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#fib_rule_hdr\">fib_rule_hdr</a> *<a class=\"id\" href=\"#frh\">frh</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#nlattr\">nlattr</a> **<a class=\"id\" href=\"#tb\">tb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *<a class=\"id\" href=\"#rule4\">rule4</a> = (struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *) <a class=\"id\" href=\"#rule\">rule</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#tos\">tos</a> &amp; ~<a class=\"id\" href=\"#IPTOS_TOS_MASK\">IPTOS_TOS_MASK</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#table\">table</a> == <a class=\"id\" href=\"#RT_TABLE_UNSPEC\">RT_TABLE_UNSPEC</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#action\">action</a> == <a class=\"id\" href=\"#FR_ACT_TO_TBL\">FR_ACT_TO_TBL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#table\">table</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#table\">table</a> = <a class=\"id\" href=\"#fib_empty_table\">fib_empty_table</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#table\">table</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rule\">rule</a>-><a class=\"id\" href=\"#table\">table</a> = <a class=\"id\" href=\"#table\">table</a>-><a class=\"id\" href=\"#tb_id\">tb_id</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#src_len\">src_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src\">src</a> = <a class=\"id\" href=\"#nla_get_be32\">nla_get_be32</a>(<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_SRC\">FRA_SRC</a>]);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#nla_get_be32\">nla_get_be32</a>(<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_DST\">FRA_DST</a>]);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_FLOW\">FRA_FLOW</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#tclassid\">tclassid</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_FLOW\">FRA_FLOW</a>]);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src_len\">src_len</a> = <a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#src_len\">src_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#srcmask\">srcmask</a> = <a class=\"id\" href=\"#inet_make_mask\">inet_make_mask</a>(<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src_len\">src_len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a> = <a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dstmask\">dstmask</a> = <a class=\"id\" href=\"#inet_make_mask\">inet_make_mask</a>(<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#tos\">tos</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<a class=\"id\" href=\"#errout\">errout</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#fib4_rule_compare\">fib4_rule_compare</a>(struct <a class=\"id\" href=\"#fib_rule\">fib_rule</a> *<a class=\"id\" href=\"#rule\">rule</a>, struct <a class=\"id\" href=\"#fib_rule_hdr\">fib_rule_hdr</a> *<a class=\"id\" href=\"#frh\">frh</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#nlattr\">nlattr</a> **<a class=\"id\" href=\"#tb\">tb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *<a class=\"id\" href=\"#rule4\">rule4</a> = (struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *) <a class=\"id\" href=\"#rule\">rule</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#src_len\">src_len</a> && (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src_len\">src_len</a> != <a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#src_len\">src_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a> && (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a> != <a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#tos\">tos</a> && (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#tos\">tos</a> != <a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#tos\">tos</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_FLOW\">FRA_FLOW</a>] && (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#tclassid\">tclassid</a> != <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_FLOW\">FRA_FLOW</a>])))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#src_len\">src_len</a> && (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src\">src</a> != <a class=\"id\" href=\"#nla_get_be32\">nla_get_be32</a>(<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_SRC\">FRA_SRC</a>])))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a> && (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst\">dst</a> != <a class=\"id\" href=\"#nla_get_be32\">nla_get_be32</a>(<a class=\"id\" href=\"#tb\">tb</a>[<a class=\"id\" href=\"#FRA_DST\">FRA_DST</a>])))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#fib4_rule_fill\">fib4_rule_fill</a>(struct <a class=\"id\" href=\"#fib_rule\">fib_rule</a> *<a class=\"id\" href=\"#rule\">rule</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#fib_rule_hdr\">fib_rule_hdr</a> *<a class=\"id\" href=\"#frh\">frh</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *<a class=\"id\" href=\"#rule4\">rule4</a> = (struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a> *) <a class=\"id\" href=\"#rule\">rule</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a> = <a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#src_len\">src_len</a> = <a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src_len\">src_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#frh\">frh</a>-><a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#tos\">tos</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst_len\">dst_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NLA_PUT_BE32\">NLA_PUT_BE32</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#FRA_DST\">FRA_DST</a>, <a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src_len\">src_len</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NLA_PUT_BE32\">NLA_PUT_BE32</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#FRA_SRC\">FRA_SRC</a>, <a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#src\">src</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_NET_CLS_ROUTE\">CONFIG_NET_CLS_ROUTE</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#tclassid\">tclassid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NLA_PUT_U32\">NLA_PUT_U32</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#FRA_FLOW\">FRA_FLOW</a>, <a class=\"id\" href=\"#rule4\">rule4</a>-><a class=\"id\" href=\"#tclassid\">tclassid</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#nla_put_failure\">nla_put_failure</a>:", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#fib4_rule_nlmsg_payload\">fib4_rule_nlmsg_payload</a>(struct <a class=\"id\" href=\"#fib_rule\">fib_rule</a> *<a class=\"id\" href=\"#rule\">rule</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#nla_total_size\">nla_total_size</a>(4) <span class=\"comment\">/* dst */</span>", 
"<span class=\"ts\"/>       + <a class=\"id\" href=\"#nla_total_size\">nla_total_size</a>(4) <span class=\"comment\">/* src */</span>", 
"<span class=\"ts\"/>       + <a class=\"id\" href=\"#nla_total_size\">nla_total_size</a>(4); <span class=\"comment\">/* flow */</span>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#fib4_rule_flush_cache\">fib4_rule_flush_cache</a>(struct <a class=\"id\" href=\"#fib_rules_ops\">fib_rules_ops</a> *<a class=\"id\" href=\"#ops\">ops</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush\">rt_cache_flush</a>(<a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#fro_net\">fro_net</a>, -1);", 
"}", 
"", 
"static const struct <a class=\"id\" href=\"#fib_rules_ops\">fib_rules_ops</a> <a class=\"id\" href=\"#__net_initdata\">__net_initdata</a> <a class=\"id\" href=\"#fib4_rules_ops_template\">fib4_rules_ops_template</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#family\">family</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#AF_INET\">AF_INET</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#rule_size\">rule_size</a><span class=\"ts\"/>= sizeof(struct <a class=\"id\" href=\"#fib4_rule\">fib4_rule</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#addr_size\">addr_size</a><span class=\"ts\"/>= sizeof(<a class=\"id\" href=\"#u32\">u32</a>),", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#action\">action</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_action\">fib4_rule_action</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#match\">match</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_match\">fib4_rule_match</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#configure\">configure</a><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_configure\">fib4_rule_configure</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#compare\">compare</a><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_compare\">fib4_rule_compare</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#fill\">fill</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_fill\">fib4_rule_fill</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#default_pref\">default_pref</a><span class=\"ts\"/>= <a class=\"id\" href=\"#fib_default_rule_pref\">fib_default_rule_pref</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#nlmsg_payload\">nlmsg_payload</a><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_nlmsg_payload\">fib4_rule_nlmsg_payload</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#flush_cache\">flush_cache</a><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_flush_cache\">fib4_rule_flush_cache</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#nlgroup\">nlgroup</a><span class=\"ts\"/>= <a class=\"id\" href=\"#RTNLGRP_IPV4_RULE\">RTNLGRP_IPV4_RULE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#policy\">policy</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#fib4_rule_policy\">fib4_rule_policy</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#owner\">owner</a><span class=\"ts\"/><span class=\"ts\"/>= <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#fib_default_rules_init\">fib_default_rules_init</a>(struct <a class=\"id\" href=\"#fib_rules_ops\">fib_rules_ops</a> *<a class=\"id\" href=\"#ops\">ops</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_default_rule_add\">fib_default_rule_add</a>(<a class=\"id\" href=\"#ops\">ops</a>, 0, <a class=\"id\" href=\"#RT_TABLE_LOCAL\">RT_TABLE_LOCAL</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_default_rule_add\">fib_default_rule_add</a>(<a class=\"id\" href=\"#ops\">ops</a>, 0x7FFE, <a class=\"id\" href=\"#RT_TABLE_MAIN\">RT_TABLE_MAIN</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_default_rule_add\">fib_default_rule_add</a>(<a class=\"id\" href=\"#ops\">ops</a>, 0x7FFF, <a class=\"id\" href=\"#RT_TABLE_DEFAULT\">RT_TABLE_DEFAULT</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#fib4_rules_init\">fib4_rules_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_rules_ops\">fib_rules_ops</a> *<a class=\"id\" href=\"#ops\">ops</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ops\">ops</a> = <a class=\"id\" href=\"#fib_rules_register\">fib_rules_register</a>(&amp;<a class=\"id\" href=\"#fib4_rules_ops_template\">fib4_rules_ops_template</a>, <a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#ops\">ops</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#PTR_ERR\">PTR_ERR</a>(<a class=\"id\" href=\"#ops\">ops</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_default_rules_init\">fib_default_rules_init</a>(<a class=\"id\" href=\"#ops\">ops</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#rules_ops\">rules_ops</a> = <a class=\"id\" href=\"#ops\">ops</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#fail\">fail</a>:", 
"<span class=\"ts\"/><span class=\"comment\">/* also cleans all rules already added */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_rules_unregister\">fib_rules_unregister</a>(<a class=\"id\" href=\"#ops\">ops</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#__net_exit\">__net_exit</a> <a class=\"id\" href=\"#fib4_rules_exit\">fib4_rules_exit</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_rules_unregister\">fib_rules_unregister</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#rules_ops\">rules_ops</a>);", 
"}", 
];
xr_frag_insert('l/ce/69caaffc10acb5a94783c6313baa310698b493.xr', __xr_tmp);
