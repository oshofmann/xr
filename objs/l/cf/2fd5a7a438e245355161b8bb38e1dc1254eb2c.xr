var __xr_tmp = [
"<span class=\"comment\"> * free the names stored from getname().</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#audit_syscall_exit\">audit_syscall_exit</a>(int <a class=\"id\" href=\"#valid\">valid</a>, long <a class=\"id\" href=\"#return_code\">return_code</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#task_struct\">task_struct</a> *<a class=\"id\" href=\"#tsk\">tsk</a> = <a class=\"id\" href=\"#current\">current</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_context\">audit_context</a> *<a class=\"id\" href=\"#context\">context</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a> = <a class=\"id\" href=\"#audit_get_context\">audit_get_context</a>(<a class=\"id\" href=\"#tsk\">tsk</a>, <a class=\"id\" href=\"#valid\">valid</a>, <a class=\"id\" href=\"#return_code\">return_code</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(!<a class=\"id\" href=\"#context\">context</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#in_syscall\">in_syscall</a> && <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#current_state\">current_state</a> == <a class=\"id\" href=\"#AUDIT_RECORD_CONTEXT\">AUDIT_RECORD_CONTEXT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_log_exit\">audit_log_exit</a>(<a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#tsk\">tsk</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#in_syscall\">in_syscall</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#prio\">prio</a> = <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#state\">state</a> == <a class=\"id\" href=\"#AUDIT_RECORD_CONTEXT\">AUDIT_RECORD_CONTEXT</a> ? ~0ULL : 0;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#killed_trees\">killed_trees</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_kill_trees\">audit_kill_trees</a>(&amp;<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#killed_trees\">killed_trees</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#previous\">previous</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_context\">audit_context</a> *<a class=\"id\" href=\"#new_context\">new_context</a> = <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#previous\">previous</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#previous\">previous</a>  = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_free_context\">audit_free_context</a>(<a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#audit_context\">audit_context</a> = <a class=\"id\" href=\"#new_context\">new_context</a>;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_free_names\">audit_free_names</a>(<a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#unroll_tree_refs\">unroll_tree_refs</a>(<a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_free_aux\">audit_free_aux</a>(<a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#aux\">aux</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#aux_pids\">aux_pids</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#target_pid\">target_pid</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#target_sid\">target_sid</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#sockaddr_len\">sockaddr_len</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#type\">type</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#fds\">fds</a>[0] = -1;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#state\">state</a> != <a class=\"id\" href=\"#AUDIT_RECORD_CONTEXT\">AUDIT_RECORD_CONTEXT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#filterkey\">filterkey</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#filterkey\">filterkey</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tsk\">tsk</a>-><a class=\"id\" href=\"#audit_context\">audit_context</a> = <a class=\"id\" href=\"#context\">context</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#handle_one\">handle_one</a>(const struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_AUDIT_TREE\">CONFIG_AUDIT_TREE</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_context\">audit_context</a> *<a class=\"id\" href=\"#context\">context</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_tree_refs\">audit_tree_refs</a> *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_chunk\">audit_chunk</a> *<a class=\"id\" href=\"#chunk\">chunk</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#hlist_empty\">hlist_empty</a>(&amp;<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_fsnotify_marks\">i_fsnotify_marks</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#audit_context\">audit_context</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#trees\">trees</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a> = <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#tree_count\">tree_count</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#chunk\">chunk</a> = <a class=\"id\" href=\"#audit_tree_lookup\">audit_tree_lookup</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#chunk\">chunk</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#likely\">likely</a>(<a class=\"id\" href=\"#put_tree_ref\">put_tree_ref</a>(<a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#chunk\">chunk</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#grow_tree_refs\">grow_tree_refs</a>(<a class=\"id\" href=\"#context\">context</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"out of memory, audit has lost a tree reference\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_set_auditable\">audit_set_auditable</a>(<a class=\"id\" href=\"#context\">context</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#audit_put_chunk\">audit_put_chunk</a>(<a class=\"id\" href=\"#chunk\">chunk</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#unroll_tree_refs\">unroll_tree_refs</a>(<a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#p\">p</a>, <a class=\"id\" href=\"#count\">count</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#put_tree_ref\">put_tree_ref</a>(<a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#chunk\">chunk</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#handle_path\">handle_path</a>(const struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_AUDIT_TREE\">CONFIG_AUDIT_TREE</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_context\">audit_context</a> *<a class=\"id\" href=\"#context\">context</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_tree_refs\">audit_tree_refs</a> *<a class=\"id\" href=\"#p\">p</a>;", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#d\">d</a>, *<a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_chunk\">audit_chunk</a> *<a class=\"id\" href=\"#drop\">drop</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#seq\">seq</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#context\">context</a> = <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#audit_context\">audit_context</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a> = <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#trees\">trees</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a> = <a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#tree_count\">tree_count</a>;", 
"<a class=\"id\" href=\"#retry\">retry</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#drop\">drop</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#d\">d</a> = <a class=\"id\" href=\"#dentry\">dentry</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_lock\">rcu_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#read_seqbegin\">read_seqbegin</a>(&amp;<a class=\"id\" href=\"#rename_lock\">rename_lock</a>);", 
"<span class=\"ts\"/>for(;;) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#inode\">inode</a> *<a class=\"id\" href=\"#inode\">inode</a> = <a class=\"id\" href=\"#d\">d</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inode\">inode</a> && <a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#hlist_empty\">hlist_empty</a>(&amp;<a class=\"id\" href=\"#inode\">inode</a>-><a class=\"id\" href=\"#i_fsnotify_marks\">i_fsnotify_marks</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#audit_chunk\">audit_chunk</a> *<a class=\"id\" href=\"#chunk\">chunk</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#chunk\">chunk</a> = <a class=\"id\" href=\"#audit_tree_lookup\">audit_tree_lookup</a>(<a class=\"id\" href=\"#inode\">inode</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#chunk\">chunk</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(!<a class=\"id\" href=\"#put_tree_ref\">put_tree_ref</a>(<a class=\"id\" href=\"#context\">context</a>, <a class=\"id\" href=\"#chunk\">chunk</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drop\">drop</a> = <a class=\"id\" href=\"#chunk\">chunk</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#parent\">parent</a> = <a class=\"id\" href=\"#d\">d</a>-><a class=\"id\" href=\"#d_parent\">d_parent</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#parent\">parent</a> == <a class=\"id\" href=\"#d\">d</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#d\">d</a> = <a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#read_seqretry\">read_seqretry</a>(&amp;<a class=\"id\" href=\"#rename_lock\">rename_lock</a>, <a class=\"id\" href=\"#seq\">seq</a>) || <a class=\"id\" href=\"#drop\">drop</a>)) {  <span class=\"comment\">/* in this order */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_read_unlock\">rcu_read_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#drop\">drop</a>) {", 
];
xr_frag_insert('l/cf/2fd5a7a438e245355161b8bb38e1dc1254eb2c.xr', __xr_tmp);
