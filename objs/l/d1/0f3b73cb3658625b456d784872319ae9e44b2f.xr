var __xr_tmp = [
"<span class=\"comment\">/* scm.c - Socket level control messages processing.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author:<span class=\"ts\"/>Alexey Kuznetsov, &lt;kuznet@ms2.inr.ac.ru&gt;</span>", 
"<span class=\"comment\"> *              Alignment and value checking mods by Craig Metz</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>This program is free software; you can redistribute it and/or</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>modify it under the terms of the GNU General Public License</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>as published by the Free Software Foundation; either version</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>2 of the License, or (at your option) any later version.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#signal\">signal</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#capability\">capability</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sched\">sched</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#stat\">stat</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#file\">file</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#fcntl\">fcntl</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#net\">net</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#interrupt\">interrupt</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#security\">security</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pid\">pid</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#nsproxy\">nsproxy</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#system\">system</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#protocol\">protocol</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#skbuff\">skbuff</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#sock\">sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#compat\">compat</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#scm\">scm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Only allow a user to send credentials, that they could set with</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>setu(g)id.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> int <a class=\"id\" href=\"#scm_check_creds\">scm_check_creds</a>(struct <a class=\"id\" href=\"#ucred\">ucred</a> *<a class=\"id\" href=\"#creds\">creds</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#current_cred\">current_cred</a>();", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#creds\">creds</a>-><a class=\"id\" href=\"#pid\">pid</a> == <a class=\"id\" href=\"#task_tgid_vnr\">task_tgid_vnr</a>(<a class=\"id\" href=\"#current\">current</a>) || <a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SYS_ADMIN\">CAP_SYS_ADMIN</a>)) &&", 
"<span class=\"ts\"/>    ((<a class=\"id\" href=\"#creds\">creds</a>-><a class=\"id\" href=\"#uid\">uid</a> == <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#uid\">uid</a>   || <a class=\"id\" href=\"#creds\">creds</a>-><a class=\"id\" href=\"#uid\">uid</a> == <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#euid\">euid</a> ||", 
"<span class=\"ts\"/>      <a class=\"id\" href=\"#creds\">creds</a>-><a class=\"id\" href=\"#uid\">uid</a> == <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#suid\">suid</a>) || <a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SETUID\">CAP_SETUID</a>)) &&", 
"<span class=\"ts\"/>    ((<a class=\"id\" href=\"#creds\">creds</a>-><a class=\"id\" href=\"#gid\">gid</a> == <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#gid\">gid</a>   || <a class=\"id\" href=\"#creds\">creds</a>-><a class=\"id\" href=\"#gid\">gid</a> == <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#egid\">egid</a> ||", 
"<span class=\"ts\"/>      <a class=\"id\" href=\"#creds\">creds</a>-><a class=\"id\" href=\"#gid\">gid</a> == <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#sgid\">sgid</a>) || <a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_SETGID\">CAP_SETGID</a>))) {", 
"<span class=\"ts\"/>       return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#scm_fp_copy\">scm_fp_copy</a>(struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a> *<a class=\"id\" href=\"#cmsg\">cmsg</a>, struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> **<a class=\"id\" href=\"#fplp\">fplp</a>)", 
"{", 
"<span class=\"ts\"/>int *<a class=\"id\" href=\"#fdp\">fdp</a> = (int*)<a class=\"id\" href=\"#CMSG_DATA\">CMSG_DATA</a>(<a class=\"id\" href=\"#cmsg\">cmsg</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> *<a class=\"id\" href=\"#fpl\">fpl</a> = *<a class=\"id\" href=\"#fplp\">fplp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> **<a class=\"id\" href=\"#fpp\">fpp</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#num\">num</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#num\">num</a> = (<a class=\"id\" href=\"#cmsg\">cmsg</a>-><a class=\"id\" href=\"#cmsg_len\">cmsg_len</a> - <a class=\"id\" href=\"#CMSG_ALIGN\">CMSG_ALIGN</a>(sizeof(struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a>)))/sizeof(int);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#num\">num</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#num\">num</a> &gt; <a class=\"id\" href=\"#SCM_MAX_FD\">SCM_MAX_FD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#fpl\">fpl</a>)", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fpl\">fpl</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#fpl\">fpl</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#fplp\">fplp</a> = <a class=\"id\" href=\"#fpl\">fpl</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#count\">count</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fpp\">fpp</a> = &amp;<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#fp\">fp</a>[<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#count\">count</a>];", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#count\">count</a> + <a class=\"id\" href=\"#num\">num</a> &gt; <a class=\"id\" href=\"#SCM_MAX_FD\">SCM_MAX_FD</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *<span class=\"ts\"/>Verify the descriptors and increment the usage count.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=0; <a class=\"id\" href=\"#i\">i</a>&lt; <a class=\"id\" href=\"#num\">num</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#fd\">fd</a> = <a class=\"id\" href=\"#fdp\">fdp</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> *<a class=\"id\" href=\"#file\">file</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fd\">fd</a> &lt; 0 || !(<a class=\"id\" href=\"#file\">file</a> = <a class=\"id\" href=\"#fget\">fget</a>(<a class=\"id\" href=\"#fd\">fd</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EBADF\">EBADF</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#fpp\">fpp</a>++ = <a class=\"id\" href=\"#file\">file</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#count\">count</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#num\">num</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#__scm_destroy\">__scm_destroy</a>(struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> *<a class=\"id\" href=\"#fpl\">fpl</a> = <a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fpl\">fpl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#scm_work_list\">scm_work_list</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add_tail\">list_add_tail</a>(&amp;<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#list\">list</a>, <a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#scm_work_list\">scm_work_list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#LIST_HEAD\">LIST_HEAD</a>(<a class=\"id\" href=\"#work_list\">work_list</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#scm_work_list\">scm_work_list</a> = &amp;<a class=\"id\" href=\"#work_list\">work_list</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_add\">list_add</a>(&amp;<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#work_list\">work_list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>while (!<a class=\"id\" href=\"#list_empty\">list_empty</a>(&amp;<a class=\"id\" href=\"#work_list\">work_list</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fpl\">fpl</a> = <a class=\"id\" href=\"#list_first_entry\">list_first_entry</a>(&amp;<a class=\"id\" href=\"#work_list\">work_list</a>, struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a>, <a class=\"id\" href=\"#list\">list</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#list_del\">list_del</a>(&amp;<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#list\">list</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#count\">count</a>-1; <a class=\"id\" href=\"#i\">i</a>>=0; <a class=\"id\" href=\"#i\">i</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fput\">fput</a>(<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#fp\">fp</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#fpl\">fpl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#current\">current</a>-><a class=\"id\" href=\"#scm_work_list\">scm_work_list</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#__scm_destroy\">__scm_destroy</a>);", 
"", 
"int <a class=\"id\" href=\"#__scm_send\">__scm_send</a>(struct <a class=\"id\" href=\"#socket\">socket</a> *<a class=\"id\" href=\"#sock\">sock</a>, struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#p\">p</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a> *<a class=\"id\" href=\"#cmsg\">cmsg</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#cmsg\">cmsg</a> = <a class=\"id\" href=\"#CMSG_FIRSTHDR\">CMSG_FIRSTHDR</a>(<a class=\"id\" href=\"#msg\">msg</a>); <a class=\"id\" href=\"#cmsg\">cmsg</a>; <a class=\"id\" href=\"#cmsg\">cmsg</a> = <a class=\"id\" href=\"#CMSG_NXTHDR\">CMSG_NXTHDR</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#cmsg\">cmsg</a>))", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Verify that cmsg_len is at least sizeof(struct cmsghdr) */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* The first check was omitted in &lt;= 2.2.5. The reasoning was</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   that parser checks cmsg_len in any case, so that</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   additional check would be work duplication.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   But if cmsg_level is not SOL_SOCKET, we do not check</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   for too short ancillary data object at all! Oops.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/>   OK, let's add it...</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#CMSG_OK\">CMSG_OK</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#cmsg\">cmsg</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cmsg\">cmsg</a>-><a class=\"id\" href=\"#cmsg_level\">cmsg_level</a> != <a class=\"id\" href=\"#SOL_SOCKET\">SOL_SOCKET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmsg\">cmsg</a>-><a class=\"id\" href=\"#cmsg_type\">cmsg_type</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SCM_RIGHTS\">SCM_RIGHTS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#ops\">ops</a> || <a class=\"id\" href=\"#sock\">sock</a>-><a class=\"id\" href=\"#ops\">ops</a>-><a class=\"id\" href=\"#family\">family</a> != <a class=\"id\" href=\"#PF_UNIX\">PF_UNIX</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a>=<a class=\"id\" href=\"#scm_fp_copy\">scm_fp_copy</a>(<a class=\"id\" href=\"#cmsg\">cmsg</a>, &amp;<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#fp\">fp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>&lt;0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#SCM_CREDENTIALS\">SCM_CREDENTIALS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cmsg\">cmsg</a>-><a class=\"id\" href=\"#cmsg_len\">cmsg_len</a> != <a class=\"id\" href=\"#CMSG_LEN\">CMSG_LEN</a>(sizeof(struct <a class=\"id\" href=\"#ucred\">ucred</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>, <a class=\"id\" href=\"#CMSG_DATA\">CMSG_DATA</a>(<a class=\"id\" href=\"#cmsg\">cmsg</a>), sizeof(struct <a class=\"id\" href=\"#ucred\">ucred</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#scm_check_creds\">scm_check_creds</a>(&amp;<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pid_vnr\">pid_vnr</a>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#pid\">pid</a>) != <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#pid\">pid</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#pid\">pid</a> *<a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#find_get_pid\">find_get_pid</a>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#pid\">pid</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_pid\">put_pid</a>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#pid\">pid</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#euid\">euid</a> != <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#uid\">uid</a>) ||", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#egid\">egid</a> != <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#gid\">gid</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#cred\">cred</a> *<a class=\"id\" href=\"#cred\">cred</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#prepare_creds\">prepare_creds</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#cred\">cred</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#uid\">uid</a> = <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#euid\">euid</a> = <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#uid\">uid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#gid\">gid</a> = <a class=\"id\" href=\"#cred\">cred</a>-><a class=\"id\" href=\"#egid\">egid</a> = <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#creds\">creds</a>.<a class=\"id\" href=\"#uid\">uid</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_cred\">put_cred</a>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#cred\">cred</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#cred\">cred</a> = <a class=\"id\" href=\"#cred\">cred</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#fp\">fp</a> && !<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#count\">count</a>)", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#fp\">fp</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#fp\">fp</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#scm_destroy\">scm_destroy</a>(<a class=\"id\" href=\"#p\">p</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#__scm_send\">__scm_send</a>);", 
"", 
"int <a class=\"id\" href=\"#put_cmsg\">put_cmsg</a>(struct <a class=\"id\" href=\"#msghdr\">msghdr</a> * <a class=\"id\" href=\"#msg\">msg</a>, int <a class=\"id\" href=\"#level\">level</a>, int <a class=\"id\" href=\"#type\">type</a>, int <a class=\"id\" href=\"#len\">len</a>, void *<a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#cm\">cm</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>= (<a class=\"id\" href=\"#__force\">__force</a> struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a> <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_control\">msg_control</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a> <a class=\"id\" href=\"#cmhdr\">cmhdr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#cmlen\">cmlen</a> = <a class=\"id\" href=\"#CMSG_LEN\">CMSG_LEN</a>(<a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#MSG_CMSG_COMPAT\">MSG_CMSG_COMPAT</a> &amp; <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#put_cmsg_compat\">put_cmsg_compat</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#level\">level</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#data\">data</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cm\">cm</a>==<a class=\"id\" href=\"#NULL\">NULL</a> || <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> &lt; sizeof(*<a class=\"id\" href=\"#cm\">cm</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_CTRUNC\">MSG_CTRUNC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0; <span class=\"comment\">/* XXX: return error? check spec. */</span>", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> &lt; <a class=\"id\" href=\"#cmlen\">cmlen</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_CTRUNC\">MSG_CTRUNC</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmlen\">cmlen</a> = <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmhdr\">cmhdr</a>.<a class=\"id\" href=\"#cmsg_level\">cmsg_level</a> = <a class=\"id\" href=\"#level\">level</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmhdr\">cmhdr</a>.<a class=\"id\" href=\"#cmsg_type\">cmsg_type</a> = <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmhdr\">cmhdr</a>.<a class=\"id\" href=\"#cmsg_len\">cmsg_len</a> = <a class=\"id\" href=\"#cmlen\">cmlen</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#cm\">cm</a>, &amp;<a class=\"id\" href=\"#cmhdr\">cmhdr</a>, sizeof <a class=\"id\" href=\"#cmhdr\">cmhdr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_to_user\">copy_to_user</a>(<a class=\"id\" href=\"#CMSG_DATA\">CMSG_DATA</a>(<a class=\"id\" href=\"#cm\">cm</a>), <a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#cmlen\">cmlen</a> - sizeof(struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmlen\">cmlen</a> = <a class=\"id\" href=\"#CMSG_SPACE\">CMSG_SPACE</a>(<a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> &lt; <a class=\"id\" href=\"#cmlen\">cmlen</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmlen\">cmlen</a> = <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_control\">msg_control</a> += <a class=\"id\" href=\"#cmlen\">cmlen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> -= <a class=\"id\" href=\"#cmlen\">cmlen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#put_cmsg\">put_cmsg</a>);", 
"", 
"void <a class=\"id\" href=\"#scm_detach_fds\">scm_detach_fds</a>(struct <a class=\"id\" href=\"#msghdr\">msghdr</a> *<a class=\"id\" href=\"#msg\">msg</a>, struct <a class=\"id\" href=\"#scm_cookie\">scm_cookie</a> *<a class=\"id\" href=\"#scm\">scm</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#cm\">cm</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>= (<a class=\"id\" href=\"#__force\">__force</a> struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a> <a class=\"id\" href=\"#__user\">__user</a>*)<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_control\">msg_control</a>;", 
"", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#fdmax\">fdmax</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#fdnum\">fdnum</a> = <a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#file\">file</a> **<a class=\"id\" href=\"#fp\">fp</a> = <a class=\"id\" href=\"#scm\">scm</a>-><a class=\"id\" href=\"#fp\">fp</a>-><a class=\"id\" href=\"#fp\">fp</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#cmfptr\">cmfptr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0, <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#MSG_CMSG_COMPAT\">MSG_CMSG_COMPAT</a> &amp; <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scm_detach_fds_compat\">scm_detach_fds_compat</a>(<a class=\"id\" href=\"#msg\">msg</a>, <a class=\"id\" href=\"#scm\">scm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> &gt; sizeof(struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fdmax\">fdmax</a> = ((<a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> - sizeof(struct <a class=\"id\" href=\"#cmsghdr\">cmsghdr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> / sizeof(int));", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fdnum\">fdnum</a> &lt; <a class=\"id\" href=\"#fdmax\">fdmax</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fdmax\">fdmax</a> = <a class=\"id\" href=\"#fdnum\">fdnum</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=0, <a class=\"id\" href=\"#cmfptr\">cmfptr</a>=(<a class=\"id\" href=\"#__force\">__force</a> int <a class=\"id\" href=\"#__user\">__user</a> *)<a class=\"id\" href=\"#CMSG_DATA\">CMSG_DATA</a>(<a class=\"id\" href=\"#cm\">cm</a>); <a class=\"id\" href=\"#i\">i</a>&lt;<a class=\"id\" href=\"#fdmax\">fdmax</a>;", 
"<span class=\"ts\"/>     <a class=\"id\" href=\"#i\">i</a>++, <a class=\"id\" href=\"#cmfptr\">cmfptr</a>++)", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#new_fd\">new_fd</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#security_file_receive\">security_file_receive</a>(<a class=\"id\" href=\"#fp\">fp</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#get_unused_fd_flags\">get_unused_fd_flags</a>(<a class=\"id\" href=\"#MSG_CMSG_CLOEXEC\">MSG_CMSG_CLOEXEC</a> &amp; <a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  ? <a class=\"id\" href=\"#O_CLOEXEC\">O_CLOEXEC</a> : 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new_fd\">new_fd</a> = <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#new_fd\">new_fd</a>, <a class=\"id\" href=\"#cmfptr\">cmfptr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#put_unused_fd\">put_unused_fd</a>(<a class=\"id\" href=\"#new_fd\">new_fd</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Bump the usage count and install the file. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#get_file\">get_file</a>(<a class=\"id\" href=\"#fp\">fp</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fd_install\">fd_install</a>(<a class=\"id\" href=\"#new_fd\">new_fd</a>, <a class=\"id\" href=\"#fp\">fp</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> &gt; 0)", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#cmlen\">cmlen</a> = <a class=\"id\" href=\"#CMSG_LEN\">CMSG_LEN</a>(<a class=\"id\" href=\"#i\">i</a>*sizeof(int));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#SOL_SOCKET\">SOL_SOCKET</a>, &amp;<a class=\"id\" href=\"#cm\">cm</a>-><a class=\"id\" href=\"#cmsg_level\">cmsg_level</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#SCM_RIGHTS\">SCM_RIGHTS</a>, &amp;<a class=\"id\" href=\"#cm\">cm</a>-><a class=\"id\" href=\"#cmsg_type\">cmsg_type</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#put_user\">put_user</a>(<a class=\"id\" href=\"#cmlen\">cmlen</a>, &amp;<a class=\"id\" href=\"#cm\">cm</a>-><a class=\"id\" href=\"#cmsg_len\">cmsg_len</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmlen\">cmlen</a> = <a class=\"id\" href=\"#CMSG_SPACE\">CMSG_SPACE</a>(<a class=\"id\" href=\"#i\">i</a>*sizeof(int));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_control\">msg_control</a> += <a class=\"id\" href=\"#cmlen\">cmlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_controllen\">msg_controllen</a> -= <a class=\"id\" href=\"#cmlen\">cmlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#fdnum\">fdnum</a> || (<a class=\"id\" href=\"#fdnum\">fdnum</a> && <a class=\"id\" href=\"#fdmax\">fdmax</a> <= 0))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msg\">msg</a>-><a class=\"id\" href=\"#msg_flags\">msg_flags</a> |= <a class=\"id\" href=\"#MSG_CTRUNC\">MSG_CTRUNC</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * All of the files that fit in the message have had their</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * usage counts incremented, so we just free the list.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__scm_destroy\">__scm_destroy</a>(<a class=\"id\" href=\"#scm\">scm</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#scm_detach_fds\">scm_detach_fds</a>);", 
"", 
"struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> *<a class=\"id\" href=\"#scm_fp_dup\">scm_fp_dup</a>(struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> *<a class=\"id\" href=\"#fpl\">fpl</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scm_fp_list\">scm_fp_list</a> *<a class=\"id\" href=\"#new_fpl\">new_fpl</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#fpl\">fpl</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#new_fpl\">new_fpl</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#fpl\">fpl</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#new_fpl\">new_fpl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#count\">count</a>-1; <a class=\"id\" href=\"#i\">i</a>>=0; <a class=\"id\" href=\"#i\">i</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#get_file\">get_file</a>(<a class=\"id\" href=\"#fpl\">fpl</a>-><a class=\"id\" href=\"#fp\">fp</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#new_fpl\">new_fpl</a>, <a class=\"id\" href=\"#fpl\">fpl</a>, sizeof(*<a class=\"id\" href=\"#fpl\">fpl</a>));", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#new_fpl\">new_fpl</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#scm_fp_dup\">scm_fp_dup</a>);", 
];
xr_frag_insert('l/d1/0f3b73cb3658625b456d784872319ae9e44b2f.xr', __xr_tmp);
