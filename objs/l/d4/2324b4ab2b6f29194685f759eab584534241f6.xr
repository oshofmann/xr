var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * eseqiv: Encrypted Sequence Number IV Generator</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This generator generates an IV based on a sequence number by xoring it</span>", 
"<span class=\"comment\"> * with a salt and then encrypting it with the same key as used to encrypt</span>", 
"<span class=\"comment\"> * the plain text.  This algorithm requires that the block size be equal</span>", 
"<span class=\"comment\"> * to the IV size.  It is mainly useful for CBC.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright (c) 2007 Herbert Xu &lt;herbert@gondor.apana.org.au&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify it</span>", 
"<span class=\"comment\"> * under the terms of the GNU General Public License as published by the Free</span>", 
"<span class=\"comment\"> * Software Foundation; either version 2 of the License, or (at your option)</span>", 
"<span class=\"comment\"> * any later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#crypto\">crypto</a>/<a class=\"id\" href=\"#internal\">internal</a>/<a class=\"id\" href=\"#skcipher\">skcipher</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#crypto\">crypto</a>/<a class=\"id\" href=\"#rng\">rng</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#crypto\">crypto</a>/<a class=\"id\" href=\"#scatterwalk\">scatterwalk</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#err\">err</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#scatterlist\">scatterlist</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#spinlock\">spinlock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"struct <a class=\"id\" href=\"#eseqiv_request_ctx\">eseqiv_request_ctx</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> <a class=\"id\" href=\"#src\">src</a>[2];", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> <a class=\"id\" href=\"#dst\">dst</a>[2];", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#tail\">tail</a>[];", 
"};", 
"", 
"struct <a class=\"id\" href=\"#eseqiv_ctx\">eseqiv_ctx</a> {", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spinlock_t\">spinlock_t</a> <a class=\"id\" href=\"#lock\">lock</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#reqoff\">reqoff</a>;", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#salt\">salt</a>[];", 
"};", 
"", 
"static void <a class=\"id\" href=\"#eseqiv_complete2\">eseqiv_complete2</a>(struct <a class=\"id\" href=\"#skcipher_givcrypt_request\">skcipher_givcrypt_request</a> *<a class=\"id\" href=\"#req\">req</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#crypto_ablkcipher\">crypto_ablkcipher</a> *<a class=\"id\" href=\"#geniv\">geniv</a> = <a class=\"id\" href=\"#skcipher_givcrypt_reqtfm\">skcipher_givcrypt_reqtfm</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#eseqiv_request_ctx\">eseqiv_request_ctx</a> *<a class=\"id\" href=\"#reqctx\">reqctx</a> = <a class=\"id\" href=\"#skcipher_givcrypt_reqctx\">skcipher_givcrypt_reqctx</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#giv\">giv</a>, <a class=\"id\" href=\"#PTR_ALIGN\">PTR_ALIGN</a>((<a class=\"id\" href=\"#u8\">u8</a> *)<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#tail\">tail</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#crypto_ablkcipher_alignmask\">crypto_ablkcipher_alignmask</a>(<a class=\"id\" href=\"#geniv\">geniv</a>) + 1),", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#crypto_ablkcipher_ivsize\">crypto_ablkcipher_ivsize</a>(<a class=\"id\" href=\"#geniv\">geniv</a>));", 
"}", 
"", 
"static void <a class=\"id\" href=\"#eseqiv_complete\">eseqiv_complete</a>(struct <a class=\"id\" href=\"#crypto_async_request\">crypto_async_request</a> *<a class=\"id\" href=\"#base\">base</a>, int <a class=\"id\" href=\"#err\">err</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#skcipher_givcrypt_request\">skcipher_givcrypt_request</a> *<a class=\"id\" href=\"#req\">req</a> = <a class=\"id\" href=\"#base\">base</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#eseqiv_complete2\">eseqiv_complete2</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skcipher_givcrypt_complete\">skcipher_givcrypt_complete</a>(<a class=\"id\" href=\"#req\">req</a>, <a class=\"id\" href=\"#err\">err</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#eseqiv_chain\">eseqiv_chain</a>(struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#head\">head</a>, struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#sg\">sg</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> int <a class=\"id\" href=\"#chain\">chain</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#chain\">chain</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a>-><a class=\"id\" href=\"#length\">length</a> += <a class=\"id\" href=\"#sg\">sg</a>-><a class=\"id\" href=\"#length\">length</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sg\">sg</a> = <a class=\"id\" href=\"#scatterwalk_sg_next\">scatterwalk_sg_next</a>(<a class=\"id\" href=\"#sg\">sg</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sg\">sg</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scatterwalk_sg_chain\">scatterwalk_sg_chain</a>(<a class=\"id\" href=\"#head\">head</a>, 2, <a class=\"id\" href=\"#sg\">sg</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sg_mark_end\">sg_mark_end</a>(<a class=\"id\" href=\"#head\">head</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#eseqiv_givencrypt\">eseqiv_givencrypt</a>(struct <a class=\"id\" href=\"#skcipher_givcrypt_request\">skcipher_givcrypt_request</a> *<a class=\"id\" href=\"#req\">req</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#crypto_ablkcipher\">crypto_ablkcipher</a> *<a class=\"id\" href=\"#geniv\">geniv</a> = <a class=\"id\" href=\"#skcipher_givcrypt_reqtfm\">skcipher_givcrypt_reqtfm</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#eseqiv_ctx\">eseqiv_ctx</a> *<a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#crypto_ablkcipher_ctx\">crypto_ablkcipher_ctx</a>(<a class=\"id\" href=\"#geniv\">geniv</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#eseqiv_request_ctx\">eseqiv_request_ctx</a> *<a class=\"id\" href=\"#reqctx\">reqctx</a> = <a class=\"id\" href=\"#skcipher_givcrypt_reqctx\">skcipher_givcrypt_reqctx</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ablkcipher_request\">ablkcipher_request</a> *<a class=\"id\" href=\"#subreq\">subreq</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#crypto_completion_t\">crypto_completion_t</a> <a class=\"id\" href=\"#complete\">complete</a>;", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#osrc\">osrc</a>, *<a class=\"id\" href=\"#odst\">odst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#page\">page</a> *<a class=\"id\" href=\"#srcp\">srcp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#page\">page</a> *<a class=\"id\" href=\"#dstp\">dstp</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#giv\">giv</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#vsrc\">vsrc</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#vdst\">vdst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be64\">__be64</a> <a class=\"id\" href=\"#seq\">seq</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#ivsize\">ivsize</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#subreq\">subreq</a> = (void *)(<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#tail\">tail</a> + <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#reqoff\">reqoff</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ablkcipher_request_set_tfm\">ablkcipher_request_set_tfm</a>(<a class=\"id\" href=\"#subreq\">subreq</a>, <a class=\"id\" href=\"#skcipher_geniv_cipher\">skcipher_geniv_cipher</a>(<a class=\"id\" href=\"#geniv\">geniv</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#giv\">giv</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#giv\">giv</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#complete\">complete</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#base\">base</a>.<a class=\"id\" href=\"#complete\">complete</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#base\">base</a>.<a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#osrc\">osrc</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#src\">src</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#odst\">odst</a> = <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#srcp\">srcp</a> = <a class=\"id\" href=\"#sg_page\">sg_page</a>(<a class=\"id\" href=\"#osrc\">osrc</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dstp\">dstp</a> = <a class=\"id\" href=\"#sg_page\">sg_page</a>(<a class=\"id\" href=\"#odst\">odst</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vsrc\">vsrc</a> = <a class=\"id\" href=\"#PageHighMem\">PageHighMem</a>(<a class=\"id\" href=\"#srcp\">srcp</a>) ? <a class=\"id\" href=\"#NULL\">NULL</a> : <a class=\"id\" href=\"#page_address\">page_address</a>(<a class=\"id\" href=\"#srcp\">srcp</a>) + <a class=\"id\" href=\"#osrc\">osrc</a>-><a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#vdst\">vdst</a> = <a class=\"id\" href=\"#PageHighMem\">PageHighMem</a>(<a class=\"id\" href=\"#dstp\">dstp</a>) ? <a class=\"id\" href=\"#NULL\">NULL</a> : <a class=\"id\" href=\"#page_address\">page_address</a>(<a class=\"id\" href=\"#dstp\">dstp</a>) + <a class=\"id\" href=\"#odst\">odst</a>-><a class=\"id\" href=\"#offset\">offset</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ivsize\">ivsize</a> = <a class=\"id\" href=\"#crypto_ablkcipher_ivsize\">crypto_ablkcipher_ivsize</a>(<a class=\"id\" href=\"#geniv\">geniv</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#vsrc\">vsrc</a> != <a class=\"id\" href=\"#giv\">giv</a> + <a class=\"id\" href=\"#ivsize\">ivsize</a> && <a class=\"id\" href=\"#vdst\">vdst</a> != <a class=\"id\" href=\"#giv\">giv</a> + <a class=\"id\" href=\"#ivsize\">ivsize</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#giv\">giv</a> = <a class=\"id\" href=\"#PTR_ALIGN\">PTR_ALIGN</a>((<a class=\"id\" href=\"#u8\">u8</a> *)<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#tail\">tail</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#crypto_ablkcipher_alignmask\">crypto_ablkcipher_alignmask</a>(<a class=\"id\" href=\"#geniv\">geniv</a>) + 1);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#complete\">complete</a> = <a class=\"id\" href=\"#eseqiv_complete\">eseqiv_complete</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#req\">req</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ablkcipher_request_set_callback\">ablkcipher_request_set_callback</a>(<a class=\"id\" href=\"#subreq\">subreq</a>, <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#base\">base</a>.<a class=\"id\" href=\"#flags\">flags</a>, <a class=\"id\" href=\"#complete\">complete</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#data\">data</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sg_init_table\">sg_init_table</a>(<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#src\">src</a>, 2);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sg_set_buf\">sg_set_buf</a>(<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#giv\">giv</a>, <a class=\"id\" href=\"#ivsize\">ivsize</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#eseqiv_chain\">eseqiv_chain</a>(<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#osrc\">osrc</a>, <a class=\"id\" href=\"#vsrc\">vsrc</a> == <a class=\"id\" href=\"#giv\">giv</a> + <a class=\"id\" href=\"#ivsize\">ivsize</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#src\">src</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#osrc\">osrc</a> != <a class=\"id\" href=\"#odst\">odst</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sg_init_table\">sg_init_table</a>(<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#dst\">dst</a>, 2);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sg_set_buf\">sg_set_buf</a>(<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#giv\">giv</a>, <a class=\"id\" href=\"#ivsize\">ivsize</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#eseqiv_chain\">eseqiv_chain</a>(<a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#odst\">odst</a>, <a class=\"id\" href=\"#vdst\">vdst</a> == <a class=\"id\" href=\"#giv\">giv</a> + <a class=\"id\" href=\"#ivsize\">ivsize</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ablkcipher_request_set_crypt\">ablkcipher_request_set_crypt</a>(<a class=\"id\" href=\"#subreq\">subreq</a>, <a class=\"id\" href=\"#reqctx\">reqctx</a>-><a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#dst\">dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#nbytes\">nbytes</a> + <a class=\"id\" href=\"#ivsize\">ivsize</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#info\">info</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#creq\">creq</a>.<a class=\"id\" href=\"#info\">info</a>, <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#salt\">salt</a>, <a class=\"id\" href=\"#ivsize\">ivsize</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#ivsize\">ivsize</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ivsize\">ivsize</a> &gt; sizeof(<a class=\"id\" href=\"#u64\">u64</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#giv\">giv</a>, 0, <a class=\"id\" href=\"#ivsize\">ivsize</a> - sizeof(<a class=\"id\" href=\"#u64\">u64</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = sizeof(<a class=\"id\" href=\"#u64\">u64</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#seq\">seq</a> = <a class=\"id\" href=\"#cpu_to_be64\">cpu_to_be64</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#seq\">seq</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#giv\">giv</a> + <a class=\"id\" href=\"#ivsize\">ivsize</a> - <a class=\"id\" href=\"#len\">len</a>, &amp;<a class=\"id\" href=\"#seq\">seq</a>, <a class=\"id\" href=\"#len\">len</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#crypto_ablkcipher_encrypt\">crypto_ablkcipher_encrypt</a>(<a class=\"id\" href=\"#subreq\">subreq</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#giv\">giv</a> != <a class=\"id\" href=\"#req\">req</a>-><a class=\"id\" href=\"#giv\">giv</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#eseqiv_complete2\">eseqiv_complete2</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#eseqiv_givencrypt_first\">eseqiv_givencrypt_first</a>(struct <a class=\"id\" href=\"#skcipher_givcrypt_request\">skcipher_givcrypt_request</a> *<a class=\"id\" href=\"#req\">req</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#crypto_ablkcipher\">crypto_ablkcipher</a> *<a class=\"id\" href=\"#geniv\">geniv</a> = <a class=\"id\" href=\"#skcipher_givcrypt_reqtfm\">skcipher_givcrypt_reqtfm</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#eseqiv_ctx\">eseqiv_ctx</a> *<a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#crypto_ablkcipher_ctx\">crypto_ablkcipher_ctx</a>(<a class=\"id\" href=\"#geniv\">geniv</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#crypto_ablkcipher_crt\">crypto_ablkcipher_crt</a>(<a class=\"id\" href=\"#geniv\">geniv</a>)-><a class=\"id\" href=\"#givencrypt\">givencrypt</a> != <a class=\"id\" href=\"#eseqiv_givencrypt_first\">eseqiv_givencrypt_first</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#unlock\">unlock</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#crypto_ablkcipher_crt\">crypto_ablkcipher_crt</a>(<a class=\"id\" href=\"#geniv\">geniv</a>)-><a class=\"id\" href=\"#givencrypt\">givencrypt</a> = <a class=\"id\" href=\"#eseqiv_givencrypt\">eseqiv_givencrypt</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#crypto_rng_get_bytes\">crypto_rng_get_bytes</a>(<a class=\"id\" href=\"#crypto_default_rng\">crypto_default_rng</a>, <a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#salt\">salt</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#crypto_ablkcipher_ivsize\">crypto_ablkcipher_ivsize</a>(<a class=\"id\" href=\"#geniv\">geniv</a>));", 
"", 
"<a class=\"id\" href=\"#unlock\">unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#eseqiv_givencrypt\">eseqiv_givencrypt</a>(<a class=\"id\" href=\"#req\">req</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#eseqiv_init\">eseqiv_init</a>(struct <a class=\"id\" href=\"#crypto_tfm\">crypto_tfm</a> *<a class=\"id\" href=\"#tfm\">tfm</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#crypto_ablkcipher\">crypto_ablkcipher</a> *<a class=\"id\" href=\"#geniv\">geniv</a> = <a class=\"id\" href=\"#__crypto_ablkcipher_cast\">__crypto_ablkcipher_cast</a>(<a class=\"id\" href=\"#tfm\">tfm</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#eseqiv_ctx\">eseqiv_ctx</a> *<a class=\"id\" href=\"#ctx\">ctx</a> = <a class=\"id\" href=\"#crypto_ablkcipher_ctx\">crypto_ablkcipher_ctx</a>(<a class=\"id\" href=\"#geniv\">geniv</a>);", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#alignmask\">alignmask</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#reqsize\">reqsize</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#alignmask\">alignmask</a> = <a class=\"id\" href=\"#crypto_tfm_ctx_alignment\">crypto_tfm_ctx_alignment</a>() - 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reqsize\">reqsize</a> = sizeof(struct <a class=\"id\" href=\"#eseqiv_request_ctx\">eseqiv_request_ctx</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#alignmask\">alignmask</a> &amp; <a class=\"id\" href=\"#reqsize\">reqsize</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#alignmask\">alignmask</a> &= <a class=\"id\" href=\"#reqsize\">reqsize</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#alignmask\">alignmask</a>--;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#alignmask\">alignmask</a> = ~<a class=\"id\" href=\"#alignmask\">alignmask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#alignmask\">alignmask</a> &= <a class=\"id\" href=\"#crypto_ablkcipher_alignmask\">crypto_ablkcipher_alignmask</a>(<a class=\"id\" href=\"#geniv\">geniv</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reqsize\">reqsize</a> += <a class=\"id\" href=\"#alignmask\">alignmask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reqsize\">reqsize</a> += <a class=\"id\" href=\"#crypto_ablkcipher_ivsize\">crypto_ablkcipher_ivsize</a>(<a class=\"id\" href=\"#geniv\">geniv</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#reqsize\">reqsize</a> = <a class=\"id\" href=\"#ALIGN\">ALIGN</a>(<a class=\"id\" href=\"#reqsize\">reqsize</a>, <a class=\"id\" href=\"#crypto_tfm_ctx_alignment\">crypto_tfm_ctx_alignment</a>());", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ctx\">ctx</a>-><a class=\"id\" href=\"#reqoff\">reqoff</a> = <a class=\"id\" href=\"#reqsize\">reqsize</a> - sizeof(struct <a class=\"id\" href=\"#eseqiv_request_ctx\">eseqiv_request_ctx</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tfm\">tfm</a>-><a class=\"id\" href=\"#crt_ablkcipher\">crt_ablkcipher</a>.<a class=\"id\" href=\"#reqsize\">reqsize</a> = <a class=\"id\" href=\"#reqsize\">reqsize</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      sizeof(struct <a class=\"id\" href=\"#ablkcipher_request\">ablkcipher_request</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skcipher_geniv_init\">skcipher_geniv_init</a>(<a class=\"id\" href=\"#tfm\">tfm</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#crypto_template\">crypto_template</a> <a class=\"id\" href=\"#eseqiv_tmpl\">eseqiv_tmpl</a>;", 
"", 
"static struct <a class=\"id\" href=\"#crypto_instance\">crypto_instance</a> *<a class=\"id\" href=\"#eseqiv_alloc\">eseqiv_alloc</a>(struct <a class=\"id\" href=\"#rtattr\">rtattr</a> **<a class=\"id\" href=\"#tb\">tb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#crypto_instance\">crypto_instance</a> *<a class=\"id\" href=\"#inst\">inst</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#crypto_get_default_rng\">crypto_get_default_rng</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#err\">err</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inst\">inst</a> = <a class=\"id\" href=\"#skcipher_geniv_alloc\">skcipher_geniv_alloc</a>(&amp;<a class=\"id\" href=\"#eseqiv_tmpl\">eseqiv_tmpl</a>, <a class=\"id\" href=\"#tb\">tb</a>, 0, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IS_ERR\">IS_ERR</a>(<a class=\"id\" href=\"#inst\">inst</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#put_rng\">put_rng</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_ablkcipher\">cra_ablkcipher</a>.<a class=\"id\" href=\"#ivsize\">ivsize</a> != <a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_blocksize\">cra_blocksize</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#free_inst\">free_inst</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_ablkcipher\">cra_ablkcipher</a>.<a class=\"id\" href=\"#givencrypt\">givencrypt</a> = <a class=\"id\" href=\"#eseqiv_givencrypt_first\">eseqiv_givencrypt_first</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_init\">cra_init</a> = <a class=\"id\" href=\"#eseqiv_init\">eseqiv_init</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_exit\">cra_exit</a> = <a class=\"id\" href=\"#skcipher_geniv_exit\">skcipher_geniv_exit</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_ctxsize\">cra_ctxsize</a> = sizeof(struct <a class=\"id\" href=\"#eseqiv_ctx\">eseqiv_ctx</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_ctxsize\">cra_ctxsize</a> += <a class=\"id\" href=\"#inst\">inst</a>-><a class=\"id\" href=\"#alg\">alg</a>.<a class=\"id\" href=\"#cra_ablkcipher\">cra_ablkcipher</a>.<a class=\"id\" href=\"#ivsize\">ivsize</a>;", 
"", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#inst\">inst</a>;", 
"", 
"<a class=\"id\" href=\"#free_inst\">free_inst</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skcipher_geniv_free\">skcipher_geniv_free</a>(<a class=\"id\" href=\"#inst\">inst</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#inst\">inst</a> = <a class=\"id\" href=\"#ERR_PTR\">ERR_PTR</a>(<a class=\"id\" href=\"#err\">err</a>);", 
"<a class=\"id\" href=\"#put_rng\">put_rng</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#crypto_put_default_rng\">crypto_put_default_rng</a>();", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#eseqiv_free\">eseqiv_free</a>(struct <a class=\"id\" href=\"#crypto_instance\">crypto_instance</a> *<a class=\"id\" href=\"#inst\">inst</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skcipher_geniv_free\">skcipher_geniv_free</a>(<a class=\"id\" href=\"#inst\">inst</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#crypto_put_default_rng\">crypto_put_default_rng</a>();", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#crypto_template\">crypto_template</a> <a class=\"id\" href=\"#eseqiv_tmpl\">eseqiv_tmpl</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = \"eseqiv\",", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#alloc\">alloc</a> = <a class=\"id\" href=\"#eseqiv_alloc\">eseqiv_alloc</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#free\">free</a> = <a class=\"id\" href=\"#eseqiv_free\">eseqiv_free</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#module\">module</a> = <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#eseqiv_module_init\">eseqiv_module_init</a>(void)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#crypto_register_template\">crypto_register_template</a>(&amp;<a class=\"id\" href=\"#eseqiv_tmpl\">eseqiv_tmpl</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__exit\">__exit</a> <a class=\"id\" href=\"#eseqiv_module_exit\">eseqiv_module_exit</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#crypto_unregister_template\">crypto_unregister_template</a>(&amp;<a class=\"id\" href=\"#eseqiv_tmpl\">eseqiv_tmpl</a>);", 
"}", 
"", 
"<a class=\"id\" href=\"#module_init\">module_init</a>(<a class=\"id\" href=\"#eseqiv_module_init\">eseqiv_module_init</a>);", 
"<a class=\"id\" href=\"#module_exit\">module_exit</a>(<a class=\"id\" href=\"#eseqiv_module_exit\">eseqiv_module_exit</a>);", 
"", 
"<a class=\"id\" href=\"#MODULE_LICENSE\">MODULE_LICENSE</a>(\"GPL\");", 
"<a class=\"id\" href=\"#MODULE_DESCRIPTION\">MODULE_DESCRIPTION</a>(\"Encrypted Sequence Number IV Generator\");", 
];
xr_frag_insert('l/d4/2324b4ab2b6f29194685f759eab584534241f6.xr', __xr_tmp);
