var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * NetLabel Management Support</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This file defines the management functions for the NetLabel system.  The</span>", 
"<span class=\"comment\"> * NetLabel system manages static and dynamic label mappings for network</span>", 
"<span class=\"comment\"> * protocols such as CIPSO and RIPSO.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author: Paul Moore &lt;paul.moore@hp.com&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * (c) Copyright Hewlett-Packard Development Company, L.P., 2006, 2008</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software;  you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of the GNU General Public License as published by</span>", 
"<span class=\"comment\"> * the Free Software Foundation; either version 2 of the License, or</span>", 
"<span class=\"comment\"> * (at your option) any later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is distributed in the hope that it will be useful,</span>", 
"<span class=\"comment\"> * but WITHOUT ANY WARRANTY;  without even the implied warranty of</span>", 
"<span class=\"comment\"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See</span>", 
"<span class=\"comment\"> * the GNU General Public License for more details.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * You should have received a copy of the GNU General Public License</span>", 
"<span class=\"comment\"> * along with this program;  if not, write to the Free Software</span>", 
"<span class=\"comment\"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#skbuff\">skbuff</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#in\">in</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#in6\">in6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#sock\">sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#netlink\">netlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#genetlink\">genetlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ipv6\">ipv6</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#netlabel\">netlabel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#cipso_ipv4\">cipso_ipv4</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#atomic\">atomic</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> \"netlabel_domainhash.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"netlabel_user.h\"", 
"#<a class=\"id\" href=\"#include\">include</a> \"netlabel_mgmt.h\"", 
"", 
"<span class=\"comment\">/* NetLabel configured protocol counter */</span>", 
"<a class=\"id\" href=\"#atomic_t\">atomic_t</a> <a class=\"id\" href=\"#netlabel_mgmt_protocount\">netlabel_mgmt_protocount</a> = <a class=\"id\" href=\"#ATOMIC_INIT\">ATOMIC_INIT</a>(0);", 
"", 
"<span class=\"comment\">/* Argument struct for netlbl_domhsh_walk() */</span>", 
"struct <a class=\"id\" href=\"#netlbl_domhsh_walk_arg\">netlbl_domhsh_walk_arg</a> {", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#nl_cb\">nl_cb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#seq\">seq</a>;", 
"};", 
"", 
"<span class=\"comment\">/* NetLabel Generic NETLINK CIPSOv4 family */</span>", 
"static struct <a class=\"id\" href=\"#genl_family\">genl_family</a> <a class=\"id\" href=\"#netlbl_mgmt_gnl_family\">netlbl_mgmt_gnl_family</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#id\">id</a> = <a class=\"id\" href=\"#GENL_ID_GENERATE\">GENL_ID_GENERATE</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#hdrsize\">hdrsize</a> = 0,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_MGMT_NAME\">NETLBL_NLTYPE_MGMT_NAME</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#version\">version</a> = <a class=\"id\" href=\"#NETLBL_PROTO_VERSION\">NETLBL_PROTO_VERSION</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#maxattr\">maxattr</a> = <a class=\"id\" href=\"#NLBL_MGMT_A_MAX\">NLBL_MGMT_A_MAX</a>,", 
"};", 
"", 
"<span class=\"comment\">/* NetLabel Netlink attribute policy */</span>", 
"static const struct <a class=\"id\" href=\"#nla_policy\">nla_policy</a> <a class=\"id\" href=\"#netlbl_mgmt_genl_policy\">netlbl_mgmt_genl_policy</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_MAX\">NLBL_MGMT_A_MAX</a> + 1] = {", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_MGMT_A_DOMAIN\">NLBL_MGMT_A_DOMAIN</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_NUL_STRING\">NLA_NUL_STRING</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_MGMT_A_PROTOCOL\">NLBL_MGMT_A_PROTOCOL</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_MGMT_A_VERSION\">NLBL_MGMT_A_VERSION</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#NLBL_MGMT_A_CV4DOI\">NLBL_MGMT_A_CV4DOI</a>] = { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"};", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Helper Functions</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_mgmt_add - Handle an ADD message</span>", 
"<span class=\"comment\"> * @info: the Generic NETLINK info block</span>", 
"<span class=\"comment\"> * @audit_info: NetLabel audit information</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Description:</span>", 
"<span class=\"comment\"> * Helper function for the ADD and ADDDEF messages to add the domain mappings</span>", 
"<span class=\"comment\"> * from the message to the hash table.  See netlabel.h for a description of the</span>", 
"<span class=\"comment\"> * message format.  Returns zero on success, negative values on failure.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#netlbl_mgmt_add_common\">netlbl_mgmt_add_common</a>(struct <a class=\"id\" href=\"#genl_info\">genl_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#netlbl_audit\">netlbl_audit</a> *<a class=\"id\" href=\"#audit_info\">audit_info</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_dom_map\">netlbl_dom_map</a> *<a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domaddr_map\">netlbl_domaddr_map</a> *<a class=\"id\" href=\"#addrmap\">addrmap</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cipso_v4_doi\">cipso_v4_doi</a> *<a class=\"id\" href=\"#cipsov4\">cipsov4</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#tmp_val\">tmp_val</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#entry\">entry</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_PROTOCOL\">NLBL_MGMT_A_PROTOCOL</a>]);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_DOMAIN\">NLBL_MGMT_A_DOMAIN</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#tmp_size\">tmp_size</a> = <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_DOMAIN\">NLBL_MGMT_A_DOMAIN</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(<a class=\"id\" href=\"#tmp_size\">tmp_size</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nla_strlcpy\">nla_strlcpy</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_DOMAIN\">NLBL_MGMT_A_DOMAIN</a>], <a class=\"id\" href=\"#tmp_size\">tmp_size</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* NOTE: internally we allow/use a entry-&gt;type value of</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *       NETLBL_NLTYPE_ADDRSELECT but we don't currently allow users</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *       to pass that as a protocol value because we need to know the</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *       \"real\" protocol */</span>", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLBL_NLTYPE_UNLABELED\">NETLBL_NLTYPE_UNLABELED</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETLBL_NLTYPE_CIPSOV4\">NETLBL_NLTYPE_CIPSOV4</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_CV4DOI\">NLBL_MGMT_A_CV4DOI</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp_val\">tmp_val</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_CV4DOI\">NLBL_MGMT_A_CV4DOI</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipsov4\">cipsov4</a> = <a class=\"id\" href=\"#cipso_v4_doi_getdef\">cipso_v4_doi_getdef</a>(<a class=\"id\" href=\"#tmp_val\">tmp_val</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cipsov4\">cipsov4</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a> = <a class=\"id\" href=\"#cipsov4\">cipsov4</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV4ADDR\">NLBL_MGMT_A_IPV4ADDR</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_addr\">in_addr</a> *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_addr\">in_addr</a> *<a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domaddr4_map\">netlbl_domaddr4_map</a> *<a class=\"id\" href=\"#map\">map</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addrmap\">addrmap</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#addrmap\">addrmap</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addrmap\">addrmap</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#addrmap\">addrmap</a>-><a class=\"id\" href=\"#list4\">list4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#addrmap\">addrmap</a>-><a class=\"id\" href=\"#list6\">list6</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV4ADDR\">NLBL_MGMT_A_IPV4ADDR</a>]) !=", 
"<span class=\"ts\"/><span class=\"ts\"/>    sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV4MASK\">NLBL_MGMT_A_IPV4MASK</a>]) !=", 
"<span class=\"ts\"/><span class=\"ts\"/>    sizeof(struct <a class=\"id\" href=\"#in_addr\">in_addr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV4ADDR\">NLBL_MGMT_A_IPV4ADDR</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV4MASK\">NLBL_MGMT_A_IPV4MASK</a>]);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#map\">map</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#map\">map</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#addr\">addr</a>-><a class=\"id\" href=\"#s_addr\">s_addr</a> &amp; <a class=\"id\" href=\"#mask\">mask</a>-><a class=\"id\" href=\"#s_addr\">s_addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#mask\">mask</a>-><a class=\"id\" href=\"#s_addr\">s_addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#valid\">valid</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cipsov4\">cipsov4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#cipsov4\">cipsov4</a> = <a class=\"id\" href=\"#cipsov4\">cipsov4</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_af4list_add\">netlbl_af4list_add</a>(&amp;<a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#addrmap\">addrmap</a>-><a class=\"id\" href=\"#list4\">list4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#map\">map</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a> = <a class=\"id\" href=\"#addrmap\">addrmap</a>;", 
"#if <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6\">CONFIG_IPV6</a>) || <a class=\"id\" href=\"#defined\">defined</a>(<a class=\"id\" href=\"#CONFIG_IPV6_MODULE\">CONFIG_IPV6_MODULE</a>)", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV6ADDR\">NLBL_MGMT_A_IPV6ADDR</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a> *<a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#netlbl_domaddr6_map\">netlbl_domaddr6_map</a> *<a class=\"id\" href=\"#map\">map</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addrmap\">addrmap</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#addrmap\">addrmap</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#addrmap\">addrmap</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#addrmap\">addrmap</a>-><a class=\"id\" href=\"#list4\">list4</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_LIST_HEAD\">INIT_LIST_HEAD</a>(&amp;<a class=\"id\" href=\"#addrmap\">addrmap</a>-><a class=\"id\" href=\"#list6\">list6</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV6ADDR\">NLBL_MGMT_A_IPV6ADDR</a>]) !=", 
"<span class=\"ts\"/><span class=\"ts\"/>    sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV6MASK\">NLBL_MGMT_A_IPV6MASK</a>]) !=", 
"<span class=\"ts\"/><span class=\"ts\"/>    sizeof(struct <a class=\"id\" href=\"#in6_addr\">in6_addr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV6ADDR\">NLBL_MGMT_A_IPV6ADDR</a>]);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#attrs\">attrs</a>[<a class=\"id\" href=\"#NLBL_MGMT_A_IPV6MASK\">NLBL_MGMT_A_IPV6MASK</a>]);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#map\">map</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#map\">map</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>(&amp;<a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a>, <a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[0] &= <a class=\"id\" href=\"#mask\">mask</a>-><a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[0];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[1] &= <a class=\"id\" href=\"#mask\">mask</a>-><a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[2] &= <a class=\"id\" href=\"#mask\">mask</a>-><a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[2];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#addr\">addr</a>.<a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[3] &= <a class=\"id\" href=\"#mask\">mask</a>-><a class=\"id\" href=\"#s6_addr32\">s6_addr32</a>[3];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipv6_addr_copy\">ipv6_addr_copy</a>(&amp;<a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#mask\">mask</a>, <a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>.<a class=\"id\" href=\"#valid\">valid</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_af6list_add\">netlbl_af6list_add</a>(&amp;<a class=\"id\" href=\"#map\">map</a>-><a class=\"id\" href=\"#list\">list</a>, &amp;<a class=\"id\" href=\"#addrmap\">addrmap</a>-><a class=\"id\" href=\"#list6\">list6</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#map\">map</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NETLBL_NLTYPE_ADDRSELECT\">NETLBL_NLTYPE_ADDRSELECT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#type_def\">type_def</a>.<a class=\"id\" href=\"#addrsel\">addrsel</a> = <a class=\"id\" href=\"#addrmap\">addrmap</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* IPv6 */</span>", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret_val\">ret_val</a> = <a class=\"id\" href=\"#netlbl_domhsh_add\">netlbl_domhsh_add</a>(<a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#audit_info\">audit_info</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret_val\">ret_val</a> != 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#add_failure\">add_failure</a>;", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#add_failure\">add_failure</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cipsov4\">cipsov4</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cipso_v4_doi_putdef\">cipso_v4_doi_putdef</a>(<a class=\"id\" href=\"#cipsov4\">cipsov4</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#entry\">entry</a>-><a class=\"id\" href=\"#domain\">domain</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#addrmap\">addrmap</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#entry\">entry</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret_val\">ret_val</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * netlbl_mgmt_listentry - List a NetLabel/LSM domain map entry</span>", 
];
xr_frag_insert('l/d7/6242262eeeb2a941e1037ba7ca4b52421a4da5.xr', __xr_tmp);
