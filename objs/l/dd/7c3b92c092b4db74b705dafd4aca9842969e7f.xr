var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#domain\">domain</a>-><a class=\"id\" href=\"#ignore_global_allow_read\">ignore_global_allow_read</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#tomoyo_globally_readable_file\">tomoyo_globally_readable_file</a>(<a class=\"id\" href=\"#filename\">filename</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#granted\">granted</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_audit_path_log\">tomoyo_audit_path_log</a>(<a class=\"id\" href=\"#r\">r</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Do not retry for execute request, for alias may have</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * changed.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#error\">error</a> == <a class=\"id\" href=\"#TOMOYO_RETRY_REQUEST\">TOMOYO_RETRY_REQUEST</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#operation\">operation</a> != <a class=\"id\" href=\"#TOMOYO_TYPE_EXECUTE\">TOMOYO_TYPE_EXECUTE</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Since \"allow_truncate\" doesn't imply \"allow_rewrite\" permission,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * we need to check \"allow_rewrite\" permission if the filename is</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * specified by \"deny_rewrite\" keyword.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#error\">error</a> && <a class=\"id\" href=\"#operation\">operation</a> == <a class=\"id\" href=\"#TOMOYO_TYPE_TRUNCATE\">TOMOYO_TYPE_TRUNCATE</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#tomoyo_no_rewrite_file\">tomoyo_no_rewrite_file</a>(<a class=\"id\" href=\"#filename\">filename</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#operation\">operation</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_REWRITE\">TOMOYO_TYPE_REWRITE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_same_path_number_acl\">tomoyo_same_path_number_acl</a>(const struct <a class=\"id\" href=\"#tomoyo_acl_info\">tomoyo_acl_info</a> *<a class=\"id\" href=\"#a\">a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_acl_info\">tomoyo_acl_info</a> *<a class=\"id\" href=\"#b\">b</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_path_number_acl\">tomoyo_path_number_acl</a> *<a class=\"id\" href=\"#p1\">p1</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#a\">a</a>, <a class=\"id\" href=\"#typeof\">typeof</a>(*<a class=\"id\" href=\"#p1\">p1</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#tomoyo_path_number_acl\">tomoyo_path_number_acl</a> *<a class=\"id\" href=\"#p2\">p2</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#b\">b</a>, <a class=\"id\" href=\"#typeof\">typeof</a>(*<a class=\"id\" href=\"#p2\">p2</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#head\">head</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_same_acl_head\">tomoyo_same_acl_head</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#head\">head</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#head\">head</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>&& <a class=\"id\" href=\"#tomoyo_same_name_union\">tomoyo_same_name_union</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#name\">name</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#name\">name</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>&& <a class=\"id\" href=\"#tomoyo_same_number_union\">tomoyo_same_number_union</a>(&amp;<a class=\"id\" href=\"#p1\">p1</a>-><a class=\"id\" href=\"#number\">number</a>, &amp;<a class=\"id\" href=\"#p2\">p2</a>-><a class=\"id\" href=\"#number\">number</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#tomoyo_merge_path_number_acl\">tomoyo_merge_path_number_acl</a>(struct <a class=\"id\" href=\"#tomoyo_acl_info\">tomoyo_acl_info</a> *<a class=\"id\" href=\"#a\">a</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#tomoyo_acl_info\">tomoyo_acl_info</a> *<a class=\"id\" href=\"#b\">b</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#is_delete\">is_delete</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> * const <a class=\"id\" href=\"#a_perm\">a_perm</a> = &amp;<a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#a\">a</a>, struct <a class=\"id\" href=\"#tomoyo_path_number_acl\">tomoyo_path_number_acl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#head\">head</a>)-><a class=\"id\" href=\"#perm\">perm</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#perm\">perm</a> = *<a class=\"id\" href=\"#a_perm\">a_perm</a>;", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#b_perm\">b_perm</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#b\">b</a>, struct <a class=\"id\" href=\"#tomoyo_path_number_acl\">tomoyo_path_number_acl</a>, <a class=\"id\" href=\"#head\">head</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>-><a class=\"id\" href=\"#perm\">perm</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_delete\">is_delete</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perm\">perm</a> &= ~<a class=\"id\" href=\"#b_perm\">b_perm</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perm\">perm</a> |= <a class=\"id\" href=\"#b_perm\">b_perm</a>;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#a_perm\">a_perm</a> = <a class=\"id\" href=\"#perm\">perm</a>;", 
"<span class=\"ts\"/>return !<a class=\"id\" href=\"#perm\">perm</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_update_path_number_acl - Update ioctl/chmod/chown/chgrp ACL.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @type:      Type of operation.</span>", 
"<span class=\"comment\"> * @filename:  Filename.</span>", 
"<span class=\"comment\"> * @number:    Number.</span>", 
"<span class=\"comment\"> * @domain:    Pointer to \"struct tomoyo_domain_info\".</span>", 
"<span class=\"comment\"> * @is_delete: True if it is a delete request.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#tomoyo_update_path_number_acl\">tomoyo_update_path_number_acl</a>(const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>, const char *<a class=\"id\" href=\"#filename\">filename</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> char *<a class=\"id\" href=\"#number\">number</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#tomoyo_domain_info\">tomoyo_domain_info</a> * const", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> const <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#is_delete\">is_delete</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_number_acl\">tomoyo_path_number_acl</a> <a class=\"id\" href=\"#e\">e</a> = {", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#head\">head</a>.<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_PATH_NUMBER_ACL\">TOMOYO_TYPE_PATH_NUMBER_ACL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#perm\">perm</a> = 1 << <a class=\"id\" href=\"#type\">type</a>", 
"<span class=\"ts\"/>};", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#is_delete\">is_delete</a> ? -<a class=\"id\" href=\"#ENOENT\">ENOENT</a> : -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_parse_name_union\">tomoyo_parse_name_union</a>(<a class=\"id\" href=\"#filename\">filename</a>, &amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#name\">name</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_parse_number_union\">tomoyo_parse_number_union</a>(<a class=\"id\" href=\"#number\">number</a>, &amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#number\">number</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_update_domain\">tomoyo_update_domain</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#head\">head</a>, sizeof(<a class=\"id\" href=\"#e\">e</a>), <a class=\"id\" href=\"#is_delete\">is_delete</a>, <a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#tomoyo_same_path_number_acl\">tomoyo_same_path_number_acl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#tomoyo_merge_path_number_acl\">tomoyo_merge_path_number_acl</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_name_union\">tomoyo_put_name_union</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_put_number_union\">tomoyo_put_number_union</a>(&amp;<a class=\"id\" href=\"#e\">e</a>.<a class=\"id\" href=\"#number\">number</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_path_number_perm - Check permission for \"create\", \"mkdir\", \"mkfifo\", \"mksock\", \"ioctl\", \"chmod\", \"chown\", \"chgrp\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @type:   Type of operation.</span>", 
"<span class=\"comment\"> * @path:   Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> * @number: Number.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_path_number_perm\">tomoyo_path_number_perm</a>(const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>, struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#path\">path</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    unsigned long <a class=\"id\" href=\"#number\">number</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> <a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_init_request_info\">tomoyo_init_request_info</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#tomoyo_pn2mac\">tomoyo_pn2mac</a>[<a class=\"id\" href=\"#type\">type</a>])", 
"<span class=\"ts\"/>    == <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a> || !<a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#mnt\">mnt</a> || !<a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#dentry\">dentry</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#tomoyo_read_lock\">tomoyo_read_lock</a>();", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#path\">path</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#TOMOYO_TYPE_MKDIR\">TOMOYO_TYPE_MKDIR</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_add_slash\">tomoyo_add_slash</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param_type\">param_type</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_PATH_NUMBER_ACL\">TOMOYO_TYPE_PATH_NUMBER_ACL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#path_number\">path_number</a>.<a class=\"id\" href=\"#operation\">operation</a> = <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#path_number\">path_number</a>.<a class=\"id\" href=\"#filename\">filename</a> = &amp;<a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#path_number\">path_number</a>.<a class=\"id\" href=\"#number\">number</a> = <a class=\"id\" href=\"#number\">number</a>;", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_check_acl\">tomoyo_check_acl</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#tomoyo_check_path_number_acl\">tomoyo_check_path_number_acl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_audit_path_number_log\">tomoyo_audit_path_number_log</a>(&amp;<a class=\"id\" href=\"#r\">r</a>);", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#error\">error</a> == <a class=\"id\" href=\"#TOMOYO_RETRY_REQUEST\">TOMOYO_RETRY_REQUEST</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#buf\">buf</a>.<a class=\"id\" href=\"#name\">name</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_read_unlock\">tomoyo_read_unlock</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#TOMOYO_CONFIG_ENFORCING\">TOMOYO_CONFIG_ENFORCING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_check_open_permission - Check permission for \"read\" and \"write\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @domain: Pointer to \"struct tomoyo_domain_info\".</span>", 
"<span class=\"comment\"> * @path:   Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> * @flag:   Flags for open().</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_check_open_permission\">tomoyo_check_open_permission</a>(struct <a class=\"id\" href=\"#tomoyo_domain_info\">tomoyo_domain_info</a> *<a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#path\">path</a>, const int <a class=\"id\" href=\"#flag\">flag</a>)", 
"{", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#acc_mode\">acc_mode</a> = <a class=\"id\" href=\"#ACC_MODE\">ACC_MODE</a>(<a class=\"id\" href=\"#flag\">flag</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> <a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#mnt\">mnt</a> ||", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a> && <a class=\"id\" href=\"#S_ISDIR\">S_ISDIR</a>(<a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buf\">buf</a>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#tomoyo_read_lock\">tomoyo_read_lock</a>();", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#path\">path</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * If the filename is specified by \"deny_rewrite\" keyword,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * we need to check \"allow_rewrite\" permission when the filename is not</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * opened for append mode or the filename is truncated at open time.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#acc_mode\">acc_mode</a> &amp; <a class=\"id\" href=\"#MAY_WRITE\">MAY_WRITE</a>) && !(<a class=\"id\" href=\"#flag\">flag</a> &amp; <a class=\"id\" href=\"#O_APPEND\">O_APPEND</a>)", 
"<span class=\"ts\"/>    && <a class=\"id\" href=\"#tomoyo_init_request_info\">tomoyo_init_request_info</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#domain\">domain</a>, <a class=\"id\" href=\"#TOMOYO_MAC_FILE_REWRITE\">TOMOYO_MAC_FILE_REWRITE</a>)", 
"<span class=\"ts\"/>    != <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#path\">path</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_no_rewrite_file\">tomoyo_no_rewrite_file</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_path_permission\">tomoyo_path_permission</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#TOMOYO_TYPE_REWRITE\">TOMOYO_TYPE_REWRITE</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       &amp;<a class=\"id\" href=\"#buf\">buf</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#error\">error</a> && <a class=\"id\" href=\"#acc_mode\">acc_mode</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#tomoyo_init_request_info\">tomoyo_init_request_info</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#domain\">domain</a>, <a class=\"id\" href=\"#TOMOYO_MAC_FILE_OPEN\">TOMOYO_MAC_FILE_OPEN</a>)", 
"<span class=\"ts\"/>    != <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#operation\">operation</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#buf\">buf</a>.<a class=\"id\" href=\"#name\">name</a> && !<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#path\">path</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#acc_mode\">acc_mode</a> == (<a class=\"id\" href=\"#MAY_READ\">MAY_READ</a> | <a class=\"id\" href=\"#MAY_WRITE\">MAY_WRITE</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#operation\">operation</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_READ_WRITE\">TOMOYO_TYPE_READ_WRITE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#acc_mode\">acc_mode</a> == <a class=\"id\" href=\"#MAY_READ\">MAY_READ</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#operation\">operation</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_READ\">TOMOYO_TYPE_READ</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#operation\">operation</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_WRITE\">TOMOYO_TYPE_WRITE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_path_permission\">tomoyo_path_permission</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#operation\">operation</a>, &amp;<a class=\"id\" href=\"#buf\">buf</a>);", 
"<span class=\"ts\"/>}", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#buf\">buf</a>.<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_read_unlock\">tomoyo_read_unlock</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#TOMOYO_CONFIG_ENFORCING\">TOMOYO_CONFIG_ENFORCING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_path_perm - Check permission for \"unlink\", \"rmdir\", \"truncate\", \"symlink\", \"rewrite\", \"chroot\" and \"unmount\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @operation: Type of operation.</span>", 
"<span class=\"comment\"> * @path:      Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_path_perm\">tomoyo_path_perm</a>(const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#operation\">operation</a>, struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#path\">path</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> <a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#mnt\">mnt</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_init_request_info\">tomoyo_init_request_info</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#tomoyo_p2mac\">tomoyo_p2mac</a>[<a class=\"id\" href=\"#operation\">operation</a>])", 
"<span class=\"ts\"/>    == <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buf\">buf</a>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#tomoyo_read_lock\">tomoyo_read_lock</a>();", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#path\">path</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#operation\">operation</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TOMOYO_TYPE_REWRITE\">TOMOYO_TYPE_REWRITE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_no_rewrite_file\">tomoyo_no_rewrite_file</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TOMOYO_TYPE_RMDIR\">TOMOYO_TYPE_RMDIR</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TOMOYO_TYPE_CHROOT\">TOMOYO_TYPE_CHROOT</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TOMOYO_TYPE_UMOUNT\">TOMOYO_TYPE_UMOUNT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_add_slash\">tomoyo_add_slash</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_path_permission\">tomoyo_path_permission</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#operation\">operation</a>, &amp;<a class=\"id\" href=\"#buf\">buf</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#buf\">buf</a>.<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_read_unlock\">tomoyo_read_unlock</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#TOMOYO_CONFIG_ENFORCING\">TOMOYO_CONFIG_ENFORCING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_mkdev_perm - Check permission for \"mkblock\" and \"mkchar\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @operation: Type of operation. (TOMOYO_TYPE_MKCHAR or TOMOYO_TYPE_MKBLOCK)</span>", 
"<span class=\"comment\"> * @path:      Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> * @mode:      Create mode.</span>", 
"<span class=\"comment\"> * @dev:       Device number.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_mkdev_perm\">tomoyo_mkdev_perm</a>(const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#operation\">operation</a>, struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#path\">path</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const unsigned int <a class=\"id\" href=\"#mode\">mode</a>, unsigned int <a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> <a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#path\">path</a>-><a class=\"id\" href=\"#mnt\">mnt</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#tomoyo_init_request_info\">tomoyo_init_request_info</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#tomoyo_pnnn2mac\">tomoyo_pnnn2mac</a>[<a class=\"id\" href=\"#operation\">operation</a>])", 
"<span class=\"ts\"/>    == <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#tomoyo_read_lock\">tomoyo_read_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#path\">path</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#new_decode_dev\">new_decode_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param_type\">param_type</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_MKDEV_ACL\">TOMOYO_TYPE_MKDEV_ACL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mkdev\">mkdev</a>.<a class=\"id\" href=\"#filename\">filename</a> = &amp;<a class=\"id\" href=\"#buf\">buf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mkdev\">mkdev</a>.<a class=\"id\" href=\"#operation\">operation</a> = <a class=\"id\" href=\"#operation\">operation</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mkdev\">mkdev</a>.<a class=\"id\" href=\"#mode\">mode</a> = <a class=\"id\" href=\"#mode\">mode</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mkdev\">mkdev</a>.<a class=\"id\" href=\"#major\">major</a> = <a class=\"id\" href=\"#MAJOR\">MAJOR</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#mkdev\">mkdev</a>.<a class=\"id\" href=\"#minor\">minor</a> = <a class=\"id\" href=\"#MINOR\">MINOR</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_check_acl\">tomoyo_check_acl</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#tomoyo_check_mkdev_acl\">tomoyo_check_mkdev_acl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_audit_mkdev_log\">tomoyo_audit_mkdev_log</a>(&amp;<a class=\"id\" href=\"#r\">r</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#buf\">buf</a>.<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_read_unlock\">tomoyo_read_unlock</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#TOMOYO_CONFIG_ENFORCING\">TOMOYO_CONFIG_ENFORCING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_path2_perm - Check permission for \"rename\", \"link\" and \"pivot_root\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @operation: Type of operation.</span>", 
"<span class=\"comment\"> * @path1:      Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> * @path2:      Pointer to \"struct path\".</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_path2_perm\">tomoyo_path2_perm</a>(const <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#operation\">operation</a>, struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#path1\">path1</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      struct <a class=\"id\" href=\"#path\">path</a> *<a class=\"id\" href=\"#path2\">path2</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a> = -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#buf1\">buf1</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_path_info\">tomoyo_path_info</a> <a class=\"id\" href=\"#buf2\">buf2</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#tomoyo_request_info\">tomoyo_request_info</a> <a class=\"id\" href=\"#r\">r</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#idx\">idx</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#path1\">path1</a>-><a class=\"id\" href=\"#mnt\">mnt</a> || !<a class=\"id\" href=\"#path2\">path2</a>-><a class=\"id\" href=\"#mnt\">mnt</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#tomoyo_init_request_info\">tomoyo_init_request_info</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#tomoyo_pp2mac\">tomoyo_pp2mac</a>[<a class=\"id\" href=\"#operation\">operation</a>])", 
"<span class=\"ts\"/>    == <a class=\"id\" href=\"#TOMOYO_CONFIG_DISABLED\">TOMOYO_CONFIG_DISABLED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buf1\">buf1</a>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buf2\">buf2</a>.<a class=\"id\" href=\"#name\">name</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#tomoyo_read_lock\">tomoyo_read_lock</a>();", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf1\">buf1</a>, <a class=\"id\" href=\"#path1\">path1</a>) ||", 
"<span class=\"ts\"/>    !<a class=\"id\" href=\"#tomoyo_get_realpath\">tomoyo_get_realpath</a>(&amp;<a class=\"id\" href=\"#buf2\">buf2</a>, <a class=\"id\" href=\"#path2\">path2</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#operation\">operation</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#dentry\">dentry</a> *<a class=\"id\" href=\"#dentry\">dentry</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#TOMOYO_TYPE_RENAME\">TOMOYO_TYPE_RENAME</a>:", 
"        case <a class=\"id\" href=\"#TOMOYO_TYPE_LINK\">TOMOYO_TYPE_LINK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dentry\">dentry</a> = <a class=\"id\" href=\"#path1\">path1</a>-><a class=\"id\" href=\"#dentry\">dentry</a>;", 
"<span class=\"ts\"/>        if (!<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a> || !<a class=\"id\" href=\"#S_ISDIR\">S_ISDIR</a>(<a class=\"id\" href=\"#dentry\">dentry</a>-><a class=\"id\" href=\"#d_inode\">d_inode</a>-><a class=\"id\" href=\"#i_mode\">i_mode</a>))", 
"                        break;", 
"                <span class=\"comment\">/* fall through */</span>", 
"        case <a class=\"id\" href=\"#TOMOYO_TYPE_PIVOT_ROOT\">TOMOYO_TYPE_PIVOT_ROOT</a>:", 
"                <a class=\"id\" href=\"#tomoyo_add_slash\">tomoyo_add_slash</a>(&amp;<a class=\"id\" href=\"#buf1\">buf1</a>);", 
"                <a class=\"id\" href=\"#tomoyo_add_slash\">tomoyo_add_slash</a>(&amp;<a class=\"id\" href=\"#buf2\">buf2</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"        }", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param_type\">param_type</a> = <a class=\"id\" href=\"#TOMOYO_TYPE_PATH2_ACL\">TOMOYO_TYPE_PATH2_ACL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#path2\">path2</a>.<a class=\"id\" href=\"#operation\">operation</a> = <a class=\"id\" href=\"#operation\">operation</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#path2\">path2</a>.<a class=\"id\" href=\"#filename1\">filename1</a> = &amp;<a class=\"id\" href=\"#buf1\">buf1</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#param\">param</a>.<a class=\"id\" href=\"#path2\">path2</a>.<a class=\"id\" href=\"#filename2\">filename2</a> = &amp;<a class=\"id\" href=\"#buf2\">buf2</a>;", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_check_acl\">tomoyo_check_acl</a>(&amp;<a class=\"id\" href=\"#r\">r</a>, <a class=\"id\" href=\"#tomoyo_check_path2_acl\">tomoyo_check_path2_acl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#tomoyo_audit_path2_log\">tomoyo_audit_path2_log</a>(&amp;<a class=\"id\" href=\"#r\">r</a>);", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#error\">error</a> == <a class=\"id\" href=\"#TOMOYO_RETRY_REQUEST\">TOMOYO_RETRY_REQUEST</a>);", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#buf1\">buf1</a>.<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#buf2\">buf2</a>.<a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tomoyo_read_unlock\">tomoyo_read_unlock</a>(<a class=\"id\" href=\"#idx\">idx</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#r\">r</a>.<a class=\"id\" href=\"#mode\">mode</a> != <a class=\"id\" href=\"#TOMOYO_CONFIG_ENFORCING\">TOMOYO_CONFIG_ENFORCING</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> * tomoyo_write_file - Update file related list.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * @data:      String to parse.</span>", 
"<span class=\"comment\"> * @domain:    Pointer to \"struct tomoyo_domain_info\".</span>", 
"<span class=\"comment\"> * @is_delete: True if it is a delete request.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Returns 0 on success, negative value otherwise.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Caller holds tomoyo_read_lock().</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#tomoyo_write_file\">tomoyo_write_file</a>(char *<a class=\"id\" href=\"#data\">data</a>, struct <a class=\"id\" href=\"#tomoyo_domain_info\">tomoyo_domain_info</a> *<a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>      const <a class=\"id\" href=\"#bool\">bool</a> <a class=\"id\" href=\"#is_delete\">is_delete</a>)", 
"{", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#w\">w</a>[5];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#tomoyo_tokenize\">tomoyo_tokenize</a>(<a class=\"id\" href=\"#data\">data</a>, <a class=\"id\" href=\"#w\">w</a>, sizeof(<a class=\"id\" href=\"#w\">w</a>)) || !<a class=\"id\" href=\"#w\">w</a>[1][0])", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#strncmp\">strncmp</a>(<a class=\"id\" href=\"#w\">w</a>[0], \"allow_\", 6))", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#w\">w</a>[0] += 6;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#type\">type</a> = 0; <a class=\"id\" href=\"#type\">type</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_PATH_OPERATION\">TOMOYO_MAX_PATH_OPERATION</a>; <a class=\"id\" href=\"#type\">type</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#w\">w</a>[0], <a class=\"id\" href=\"#tomoyo_path_keyword\">tomoyo_path_keyword</a>[<a class=\"id\" href=\"#type\">type</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_update_path_acl\">tomoyo_update_path_acl</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#w\">w</a>[1], <a class=\"id\" href=\"#domain\">domain</a>, <a class=\"id\" href=\"#is_delete\">is_delete</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#w\">w</a>[2][0])", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#type\">type</a> = 0; <a class=\"id\" href=\"#type\">type</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_PATH2_OPERATION\">TOMOYO_MAX_PATH2_OPERATION</a>; <a class=\"id\" href=\"#type\">type</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#w\">w</a>[0], <a class=\"id\" href=\"#tomoyo_path2_keyword\">tomoyo_path2_keyword</a>[<a class=\"id\" href=\"#type\">type</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_update_path2_acl\">tomoyo_update_path2_acl</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#w\">w</a>[1], <a class=\"id\" href=\"#w\">w</a>[2], <a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#is_delete\">is_delete</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#type\">type</a> = 0; <a class=\"id\" href=\"#type\">type</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_PATH_NUMBER_OPERATION\">TOMOYO_MAX_PATH_NUMBER_OPERATION</a>; <a class=\"id\" href=\"#type\">type</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#w\">w</a>[0], <a class=\"id\" href=\"#tomoyo_path_number_keyword\">tomoyo_path_number_keyword</a>[<a class=\"id\" href=\"#type\">type</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_update_path_number_acl\">tomoyo_update_path_number_acl</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#w\">w</a>[1], <a class=\"id\" href=\"#w\">w</a>[2], <a class=\"id\" href=\"#domain\">domain</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#is_delete\">is_delete</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#w\">w</a>[3][0] || !<a class=\"id\" href=\"#w\">w</a>[4][0])", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#type\">type</a> = 0; <a class=\"id\" href=\"#type\">type</a> &lt; <a class=\"id\" href=\"#TOMOYO_MAX_MKDEV_OPERATION\">TOMOYO_MAX_MKDEV_OPERATION</a>; <a class=\"id\" href=\"#type\">type</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#w\">w</a>[0], <a class=\"id\" href=\"#tomoyo_mkdev_keyword\">tomoyo_mkdev_keyword</a>[<a class=\"id\" href=\"#type\">type</a>]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#tomoyo_update_mkdev_acl\">tomoyo_update_mkdev_acl</a>(<a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#w\">w</a>[1], <a class=\"id\" href=\"#w\">w</a>[2], <a class=\"id\" href=\"#w\">w</a>[3],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#w\">w</a>[4], <a class=\"id\" href=\"#domain\">domain</a>, <a class=\"id\" href=\"#is_delete\">is_delete</a>);", 
"<span class=\"ts\"/>}", 
" <a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
];
xr_frag_insert('l/dd/7c3b92c092b4db74b705dafd4aca9842969e7f.xr', __xr_tmp);
