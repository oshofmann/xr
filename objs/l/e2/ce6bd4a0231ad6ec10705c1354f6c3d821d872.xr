var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_match\">dev_match</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#else", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#FIB_RES_DEV\">FIB_RES_DEV</a>(<a class=\"id\" href=\"#res\">res</a>) == <a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_match\">dev_match</a> = <a class=\"id\" href=\"#true\">true</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev_match\">dev_match</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#FIB_RES_NH\">FIB_RES_NH</a>(<a class=\"id\" href=\"#res\">res</a>).<a class=\"id\" href=\"#nh_scope\">nh_scope</a> >= <a class=\"id\" href=\"#RT_SCOPE_HOST\">RT_SCOPE_HOST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#no_addr\">no_addr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#last_resort\">last_resort</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rpf\">rpf</a> == 1)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_rpf\">e_rpf</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fl\">fl</a>.<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fib_lookup\">fib_lookup</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>) == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#spec_dst\">spec_dst</a> = <a class=\"id\" href=\"#FIB_RES_PREFSRC\">FIB_RES_PREFSRC</a>(<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#FIB_RES_NH\">FIB_RES_NH</a>(<a class=\"id\" href=\"#res\">res</a>).<a class=\"id\" href=\"#nh_scope\">nh_scope</a> >= <a class=\"id\" href=\"#RT_SCOPE_HOST\">RT_SCOPE_HOST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<a class=\"id\" href=\"#last_resort\">last_resort</a>:", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rpf\">rpf</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#e_rpf\">e_rpf</a>;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#spec_dst\">spec_dst</a> = <a class=\"id\" href=\"#inet_select_addr\">inet_select_addr</a>(<a class=\"id\" href=\"#dev\">dev</a>, 0, <a class=\"id\" href=\"#RT_SCOPE_UNIVERSE\">RT_SCOPE_UNIVERSE</a>);", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#itag\">itag</a> = 0;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#e_inval_res\">e_inval_res</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<a class=\"id\" href=\"#e_inval\">e_inval</a>:", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<a class=\"id\" href=\"#e_rpf\">e_rpf</a>:", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EXDEV\">EXDEV</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#sk_extract_addr\">sk_extract_addr</a>(struct <a class=\"id\" href=\"#sockaddr\">sockaddr</a> *<a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>return ((struct <a class=\"id\" href=\"#sockaddr_in\">sockaddr_in</a> *) <a class=\"id\" href=\"#addr\">addr</a>)-><a class=\"id\" href=\"#sin_addr\">sin_addr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#put_rtax\">put_rtax</a>(struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#mx\">mx</a>, int <a class=\"id\" href=\"#len\">len</a>, int <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#value\">value</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#nla\">nla</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla\">nla</a> = (struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *) ((char *) <a class=\"id\" href=\"#mx\">mx</a> + <a class=\"id\" href=\"#len\">len</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla\">nla</a>-><a class=\"id\" href=\"#nla_type\">nla_type</a> = <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nla\">nla</a>-><a class=\"id\" href=\"#nla_len\">nla_len</a> = <a class=\"id\" href=\"#nla_attr_size\">nla_attr_size</a>(4);", 
"<span class=\"ts\"/>*(<a class=\"id\" href=\"#u32\">u32</a> *) <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#nla\">nla</a>) = <a class=\"id\" href=\"#value\">value</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#len\">len</a> + <a class=\"id\" href=\"#nla_total_size\">nla_total_size</a>(4);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#rtentry_to_fib_config\">rtentry_to_fib_config</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, int <a class=\"id\" href=\"#cmd\">cmd</a>, struct <a class=\"id\" href=\"#rtentry\">rtentry</a> *<a class=\"id\" href=\"#rt\">rt</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> struct <a class=\"id\" href=\"#fib_config\">fib_config</a> *<a class=\"id\" href=\"#cfg\">cfg</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#plen\">plen</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#cfg\">cfg</a>, 0, sizeof(*<a class=\"id\" href=\"#cfg\">cfg</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_nlinfo\">fc_nlinfo</a>.<a class=\"id\" href=\"#nl_net\">nl_net</a> = <a class=\"id\" href=\"#net\">net</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>.<a class=\"id\" href=\"#sa_family\">sa_family</a> != <a class=\"id\" href=\"#AF_INET\">AF_INET</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Check mask for validity:</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * a) it must be contiguous.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * b) destination must have all host bits clear.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * c) if application forgot to set correct family (AF_INET),</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *    reject request unless it is absolutely clear i.e.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> *    both family and mask are zero.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#plen\">plen</a> = 32;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#sk_extract_addr\">sk_extract_addr</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>);", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTF_HOST\">RTF_HOST</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#sk_extract_addr\">sk_extract_addr</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_genmask\">rt_genmask</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_genmask\">rt_genmask</a>.<a class=\"id\" href=\"#sa_family\">sa_family</a> != <a class=\"id\" href=\"#AF_INET\">AF_INET</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mask\">mask</a> || <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_genmask\">rt_genmask</a>.<a class=\"id\" href=\"#sa_family\">sa_family</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bad_mask\">bad_mask</a>(<a class=\"id\" href=\"#mask\">mask</a>, <a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#plen\">plen</a> = <a class=\"id\" href=\"#inet_mask_len\">inet_mask_len</a>(<a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_dst_len\">fc_dst_len</a> = <a class=\"id\" href=\"#plen\">plen</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_dst\">fc_dst</a> = <a class=\"id\" href=\"#addr\">addr</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a> != <a class=\"id\" href=\"#SIOCDELRT\">SIOCDELRT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_nlflags\">fc_nlflags</a> = <a class=\"id\" href=\"#NLM_F_CREATE\">NLM_F_CREATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_protocol\">fc_protocol</a> = <a class=\"id\" href=\"#RTPROT_BOOT\">RTPROT_BOOT</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_metric\">rt_metric</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_priority\">fc_priority</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_metric\">rt_metric</a> - 1;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTF_REJECT\">RTF_REJECT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_scope\">fc_scope</a> = <a class=\"id\" href=\"#RT_SCOPE_HOST\">RT_SCOPE_HOST</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_type\">fc_type</a> = <a class=\"id\" href=\"#RTN_UNREACHABLE\">RTN_UNREACHABLE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_scope\">fc_scope</a> = <a class=\"id\" href=\"#RT_SCOPE_NOWHERE\">RT_SCOPE_NOWHERE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_type\">fc_type</a> = <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dev\">rt_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>char *<a class=\"id\" href=\"#colon\">colon</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>char <a class=\"id\" href=\"#devname\">devname</a>[<a class=\"id\" href=\"#IFNAMSIZ\">IFNAMSIZ</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(<a class=\"id\" href=\"#devname\">devname</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dev\">rt_dev</a>, <a class=\"id\" href=\"#IFNAMSIZ\">IFNAMSIZ</a>-1))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#devname\">devname</a>[<a class=\"id\" href=\"#IFNAMSIZ\">IFNAMSIZ</a>-1] = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#colon\">colon</a> = <a class=\"id\" href=\"#strchr\">strchr</a>(<a class=\"id\" href=\"#devname\">devname</a>, ':');", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#colon\">colon</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#colon\">colon</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#__dev_get_by_name\">__dev_get_by_name</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#devname\">devname</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_oif\">fc_oif</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#colon\">colon</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#ifa\">ifa</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rtnl\">__in_dev_get_rtnl</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#colon\">colon</a> = ':';", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#ifa\">ifa</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#ifa_list\">ifa_list</a>; <a class=\"id\" href=\"#ifa\">ifa</a>; <a class=\"id\" href=\"#ifa\">ifa</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_next\">ifa_next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#strcmp\">strcmp</a>(<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_label\">ifa_label</a>, <a class=\"id\" href=\"#devname\">devname</a>) == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifa\">ifa</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_prefsrc\">fc_prefsrc</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#sk_extract_addr\">sk_extract_addr</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_gateway\">rt_gateway</a>.<a class=\"id\" href=\"#sa_family\">sa_family</a> == <a class=\"id\" href=\"#AF_INET\">AF_INET</a> && <a class=\"id\" href=\"#addr\">addr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_gw\">fc_gw</a> = <a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTF_GATEWAY\">RTF_GATEWAY</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#inet_addr_type\">inet_addr_type</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#addr\">addr</a>) == <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_scope\">fc_scope</a> = <a class=\"id\" href=\"#RT_SCOPE_UNIVERSE\">RT_SCOPE_UNIVERSE</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#SIOCDELRT\">SIOCDELRT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTF_GATEWAY\">RTF_GATEWAY</a> && !<a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_gw\">fc_gw</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_scope\">fc_scope</a> == <a class=\"id\" href=\"#RT_SCOPE_NOWHERE\">RT_SCOPE_NOWHERE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_scope\">fc_scope</a> = <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; (<a class=\"id\" href=\"#RTF_MTU\">RTF_MTU</a> | <a class=\"id\" href=\"#RTF_WINDOW\">RTF_WINDOW</a> | <a class=\"id\" href=\"#RTF_IRTT\">RTF_IRTT</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#mx\">mx</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#len\">len</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mx\">mx</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(3 * <a class=\"id\" href=\"#nla_total_size\">nla_total_size</a>(4), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mx\">mx</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTF_MTU\">RTF_MTU</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#put_rtax\">put_rtax</a>(<a class=\"id\" href=\"#mx\">mx</a>, <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#RTAX_ADVMSS\">RTAX_ADVMSS</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_mtu\">rt_mtu</a> - 40);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTF_WINDOW\">RTF_WINDOW</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#put_rtax\">put_rtax</a>(<a class=\"id\" href=\"#mx\">mx</a>, <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#RTAX_WINDOW\">RTAX_WINDOW</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_window\">rt_window</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_flags\">rt_flags</a> &amp; <a class=\"id\" href=\"#RTF_IRTT\">RTF_IRTT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#put_rtax\">put_rtax</a>(<a class=\"id\" href=\"#mx\">mx</a>, <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#RTAX_RTT\">RTAX_RTT</a>, <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_irtt\">rt_irtt</a> << 3);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_mx\">fc_mx</a> = <a class=\"id\" href=\"#mx\">mx</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_mx_len\">fc_mx_len</a> = <a class=\"id\" href=\"#len\">len</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Handle IP routing ioctl calls. These are used to manipulate the routing tables</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ip_rt_ioctl\">ip_rt_ioctl</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, unsigned int <a class=\"id\" href=\"#cmd\">cmd</a>, void <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_config\">fib_config</a> <a class=\"id\" href=\"#cfg\">cfg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtentry\">rtentry</a> <a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCADDRT\">SIOCADDRT</a>:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Add a route */</span>", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SIOCDELRT\">SIOCDELRT</a>:<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Delete a route */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#capable\">capable</a>(<a class=\"id\" href=\"#CAP_NET_ADMIN\">CAP_NET_ADMIN</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EPERM\">EPERM</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#copy_from_user\">copy_from_user</a>(&amp;<a class=\"id\" href=\"#rt\">rt</a>, <a class=\"id\" href=\"#arg\">arg</a>, sizeof(<a class=\"id\" href=\"#rt\">rt</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EFAULT\">EFAULT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rtentry_to_fib_config\">rtentry_to_fib_config</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#cmd\">cmd</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#SIOCDELRT\">SIOCDELRT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_table\">fc_table</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_table_delete\">fib_table_delete</a>(<a class=\"id\" href=\"#tb\">tb</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_new_table\">fib_new_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_table\">fc_table</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_table_insert\">fib_table_insert</a>(<a class=\"id\" href=\"#tb\">tb</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* allocated by rtentry_to_fib_config() */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_mx\">fc_mx</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"}", 
"", 
"const struct <a class=\"id\" href=\"#nla_policy\">nla_policy</a> <a class=\"id\" href=\"#rtm_ipv4_policy\">rtm_ipv4_policy</a>[<a class=\"id\" href=\"#RTA_MAX\">RTA_MAX</a>+1] = {", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_DST\">RTA_DST</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_SRC\">RTA_SRC</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_IIF\">RTA_IIF</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_OIF\">RTA_OIF</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_GATEWAY\">RTA_GATEWAY</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_PRIORITY\">RTA_PRIORITY</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_PREFSRC\">RTA_PREFSRC</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_METRICS\">RTA_METRICS</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_NESTED\">NLA_NESTED</a> },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_MULTIPATH\">RTA_MULTIPATH</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#len\">len</a> = sizeof(struct <a class=\"id\" href=\"#rtnexthop\">rtnexthop</a>) },", 
"<span class=\"ts\"/>[<a class=\"id\" href=\"#RTA_FLOW\">RTA_FLOW</a>]<span class=\"ts\"/><span class=\"ts\"/>= { .<a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#NLA_U32\">NLA_U32</a> },", 
"};", 
"", 
"static int <a class=\"id\" href=\"#rtm_to_fib_config\">rtm_to_fib_config</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>, struct <a class=\"id\" href=\"#fib_config\">fib_config</a> *<a class=\"id\" href=\"#cfg\">cfg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlattr\">nlattr</a> *<a class=\"id\" href=\"#attr\">attr</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>, <a class=\"id\" href=\"#remaining\">remaining</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtmsg\">rtmsg</a> *<a class=\"id\" href=\"#rtm\">rtm</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#nlmsg_validate\">nlmsg_validate</a>(<a class=\"id\" href=\"#nlh\">nlh</a>, sizeof(*<a class=\"id\" href=\"#rtm\">rtm</a>), <a class=\"id\" href=\"#RTA_MAX\">RTA_MAX</a>, <a class=\"id\" href=\"#rtm_ipv4_policy\">rtm_ipv4_policy</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#cfg\">cfg</a>, 0, sizeof(*<a class=\"id\" href=\"#cfg\">cfg</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtm\">rtm</a> = <a class=\"id\" href=\"#nlmsg_data\">nlmsg_data</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_dst_len\">fc_dst_len</a> = <a class=\"id\" href=\"#rtm\">rtm</a>-><a class=\"id\" href=\"#rtm_dst_len\">rtm_dst_len</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_tos\">fc_tos</a> = <a class=\"id\" href=\"#rtm\">rtm</a>-><a class=\"id\" href=\"#rtm_tos\">rtm_tos</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_table\">fc_table</a> = <a class=\"id\" href=\"#rtm\">rtm</a>-><a class=\"id\" href=\"#rtm_table\">rtm_table</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_protocol\">fc_protocol</a> = <a class=\"id\" href=\"#rtm\">rtm</a>-><a class=\"id\" href=\"#rtm_protocol\">rtm_protocol</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_scope\">fc_scope</a> = <a class=\"id\" href=\"#rtm\">rtm</a>-><a class=\"id\" href=\"#rtm_scope\">rtm_scope</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_type\">fc_type</a> = <a class=\"id\" href=\"#rtm\">rtm</a>-><a class=\"id\" href=\"#rtm_type\">rtm_type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_flags\">fc_flags</a> = <a class=\"id\" href=\"#rtm\">rtm</a>-><a class=\"id\" href=\"#rtm_flags\">rtm_flags</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_nlflags\">fc_nlflags</a> = <a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_flags\">nlmsg_flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_nlinfo\">fc_nlinfo</a>.<a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_nlinfo\">fc_nlinfo</a>.<a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#nlh\">nlh</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_nlinfo\">fc_nlinfo</a>.<a class=\"id\" href=\"#nl_net\">nl_net</a> = <a class=\"id\" href=\"#net\">net</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_type\">fc_type</a> &gt; <a class=\"id\" href=\"#RTN_MAX\">RTN_MAX</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlmsg_for_each_attr\">nlmsg_for_each_attr</a>(<a class=\"id\" href=\"#attr\">attr</a>, <a class=\"id\" href=\"#nlh\">nlh</a>, sizeof(struct <a class=\"id\" href=\"#rtmsg\">rtmsg</a>), <a class=\"id\" href=\"#remaining\">remaining</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>switch (<a class=\"id\" href=\"#nla_type\">nla_type</a>(<a class=\"id\" href=\"#attr\">attr</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_DST\">RTA_DST</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_dst\">fc_dst</a> = <a class=\"id\" href=\"#nla_get_be32\">nla_get_be32</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_OIF\">RTA_OIF</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_oif\">fc_oif</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_GATEWAY\">RTA_GATEWAY</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_gw\">fc_gw</a> = <a class=\"id\" href=\"#nla_get_be32\">nla_get_be32</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_PRIORITY\">RTA_PRIORITY</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_priority\">fc_priority</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_PREFSRC\">RTA_PREFSRC</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_prefsrc\">fc_prefsrc</a> = <a class=\"id\" href=\"#nla_get_be32\">nla_get_be32</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_METRICS\">RTA_METRICS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_mx\">fc_mx</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_mx_len\">fc_mx_len</a> = <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_MULTIPATH\">RTA_MULTIPATH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_mp\">fc_mp</a> = <a class=\"id\" href=\"#nla_data\">nla_data</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_mp_len\">fc_mp_len</a> = <a class=\"id\" href=\"#nla_len\">nla_len</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_FLOW\">RTA_FLOW</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_flow\">fc_flow</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>case <a class=\"id\" href=\"#RTA_TABLE\">RTA_TABLE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>-><a class=\"id\" href=\"#fc_table\">fc_table</a> = <a class=\"id\" href=\"#nla_get_u32\">nla_get_u32</a>(<a class=\"id\" href=\"#attr\">attr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"<a class=\"id\" href=\"#errout\">errout</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_rtm_delroute\">inet_rtm_delroute</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>, void *<a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_config\">fib_config</a> <a class=\"id\" href=\"#cfg\">cfg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rtm_to_fib_config\">rtm_to_fib_config</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nlh\">nlh</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_table\">fc_table</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_table_delete\">fib_table_delete</a>(<a class=\"id\" href=\"#tb\">tb</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<a class=\"id\" href=\"#errout\">errout</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_rtm_newroute\">inet_rtm_newroute</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>, void *<a class=\"id\" href=\"#arg\">arg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_config\">fib_config</a> <a class=\"id\" href=\"#cfg\">cfg</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rtm_to_fib_config\">rtm_to_fib_config</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#nlh\">nlh</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_new_table\">fib_new_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_table\">fc_table</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#errout\">errout</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_table_insert\">fib_table_insert</a>(<a class=\"id\" href=\"#tb\">tb</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<a class=\"id\" href=\"#errout\">errout</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#inet_dump_fib\">inet_dump_fib</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#netlink_callback\">netlink_callback</a> *<a class=\"id\" href=\"#cb\">cb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#h\">h</a>, <a class=\"id\" href=\"#s_h\">s_h</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#e\">e</a> = 0, <a class=\"id\" href=\"#s_e\">s_e</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#head\">head</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#dumped\">dumped</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>) >= sizeof(struct <a class=\"id\" href=\"#rtmsg\">rtmsg</a>) &&", 
"<span class=\"ts\"/>    ((struct <a class=\"id\" href=\"#rtmsg\">rtmsg</a> *) <a class=\"id\" href=\"#nlmsg_data\">nlmsg_data</a>(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#nlh\">nlh</a>))-><a class=\"id\" href=\"#rtm_flags\">rtm_flags</a> &amp; <a class=\"id\" href=\"#RTM_F_CLONED\">RTM_F_CLONED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ip_rt_dump\">ip_rt_dump</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cb\">cb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s_h\">s_h</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#s_e\">s_e</a> = <a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1];", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#h\">h</a> = <a class=\"id\" href=\"#s_h\">s_h</a>; <a class=\"id\" href=\"#h\">h</a> &lt; <a class=\"id\" href=\"#FIB_TABLE_HASHSZ\">FIB_TABLE_HASHSZ</a>; <a class=\"id\" href=\"#h\">h</a>++, <a class=\"id\" href=\"#s_e\">s_e</a> = 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#e\">e</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a> = &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#h\">h</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry\">hlist_for_each_entry</a>(<a class=\"id\" href=\"#tb\">tb</a>, <a class=\"id\" href=\"#node\">node</a>, <a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#tb_hlist\">tb_hlist</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#e\">e</a> &lt; <a class=\"id\" href=\"#s_e\">s_e</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dumped\">dumped</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[2], 0, sizeof(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>) -", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> 2 * sizeof(<a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0]));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fib_table_dump\">fib_table_dump</a>(<a class=\"id\" href=\"#tb\">tb</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#cb\">cb</a>) &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dumped\">dumped</a> = 1;", 
"<a class=\"id\" href=\"#next\">next</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#e\">e</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[1] = <a class=\"id\" href=\"#e\">e</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cb\">cb</a>-><a class=\"id\" href=\"#args\">args</a>[0] = <a class=\"id\" href=\"#h\">h</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Prepare and feed intra-kernel routing request.</span>", 
"<span class=\"comment\">   Really, it should be netlink message, but :-( netlink</span>", 
"<span class=\"comment\">   can be not configured, so that we feed it directly</span>", 
"<span class=\"comment\">   to fib engine. It is legal, because all events occur</span>", 
"<span class=\"comment\">   only when netlink is already locked.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static void <a class=\"id\" href=\"#fib_magic\">fib_magic</a>(int <a class=\"id\" href=\"#cmd\">cmd</a>, int <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#dst\">dst</a>, int <a class=\"id\" href=\"#dst_len\">dst_len</a>, struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#ifa\">ifa</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_dev\">ifa_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_config\">fib_config</a> <a class=\"id\" href=\"#cfg\">cfg</a> = {", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_protocol\">fc_protocol</a> = <a class=\"id\" href=\"#RTPROT_KERNEL\">RTPROT_KERNEL</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_type\">fc_type</a> = <a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_dst\">fc_dst</a> = <a class=\"id\" href=\"#dst\">dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_dst_len\">fc_dst_len</a> = <a class=\"id\" href=\"#dst_len\">dst_len</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_prefsrc\">fc_prefsrc</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_oif\">fc_oif</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_dev\">ifa_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_nlflags\">fc_nlflags</a> = <a class=\"id\" href=\"#NLM_F_CREATE\">NLM_F_CREATE</a> | <a class=\"id\" href=\"#NLM_F_APPEND\">NLM_F_APPEND</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#fc_nlinfo\">fc_nlinfo</a> = {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>.<a class=\"id\" href=\"#nl_net\">nl_net</a> = <a class=\"id\" href=\"#net\">net</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>},", 
"<span class=\"ts\"/>};", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_new_table\">fib_new_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#RT_TABLE_MAIN\">RT_TABLE_MAIN</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_new_table\">fib_new_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#RT_TABLE_LOCAL\">RT_TABLE_LOCAL</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_table\">fc_table</a> = <a class=\"id\" href=\"#tb\">tb</a>-><a class=\"id\" href=\"#tb_id\">tb_id</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_scope\">fc_scope</a> = <a class=\"id\" href=\"#RT_SCOPE_LINK\">RT_SCOPE_LINK</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cfg\">cfg</a>.<a class=\"id\" href=\"#fc_scope\">fc_scope</a> = <a class=\"id\" href=\"#RT_SCOPE_HOST\">RT_SCOPE_HOST</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a> == <a class=\"id\" href=\"#RTM_NEWROUTE\">RTM_NEWROUTE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_table_insert\">fib_table_insert</a>(<a class=\"id\" href=\"#tb\">tb</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_table_delete\">fib_table_delete</a>(<a class=\"id\" href=\"#tb\">tb</a>, &amp;<a class=\"id\" href=\"#cfg\">cfg</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#fib_add_ifaddr\">fib_add_ifaddr</a>(struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#ifa\">ifa</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_dev\">ifa_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#prim\">prim</a> = <a class=\"id\" href=\"#ifa\">ifa</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#mask\">mask</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_mask\">ifa_mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#prefix\">prefix</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_address\">ifa_address</a>&amp;<a class=\"id\" href=\"#mask\">mask</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_flags\">ifa_flags</a>&amp;<a class=\"id\" href=\"#IFA_F_SECONDARY\">IFA_F_SECONDARY</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prim\">prim</a> = <a class=\"id\" href=\"#inet_ifa_byprefix\">inet_ifa_byprefix</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#prefix\">prefix</a>, <a class=\"id\" href=\"#mask\">mask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prim\">prim</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"fib_add_ifaddr: bug: prim == NULL\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_NEWROUTE\">RTM_NEWROUTE</a>, <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>, <a class=\"id\" href=\"#addr\">addr</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a>&amp;<a class=\"id\" href=\"#IFF_UP\">IFF_UP</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Add broadcast address, if it is explicitly assigned. */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a> && <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a> != <a class=\"id\" href=\"#htonl\">htonl</a>(0xFFFFFFFF))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_NEWROUTE\">RTM_NEWROUTE</a>, <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>, <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv4_is_zeronet\">ipv4_is_zeronet</a>(<a class=\"id\" href=\"#prefix\">prefix</a>) && !(<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_flags\">ifa_flags</a>&amp;<a class=\"id\" href=\"#IFA_F_SECONDARY\">IFA_F_SECONDARY</a>) &&", 
"<span class=\"ts\"/>    (<a class=\"id\" href=\"#prefix\">prefix</a> != <a class=\"id\" href=\"#addr\">addr</a> || <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_prefixlen\">ifa_prefixlen</a> &lt; 32)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_NEWROUTE\">RTM_NEWROUTE</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a>&amp;<a class=\"id\" href=\"#IFF_LOOPBACK\">IFF_LOOPBACK</a> ? <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>, <a class=\"id\" href=\"#prefix\">prefix</a>, <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_prefixlen\">ifa_prefixlen</a>, <a class=\"id\" href=\"#prim\">prim</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Add network specific broadcasts, when it takes a sense */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_prefixlen\">ifa_prefixlen</a> &lt; 31) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_NEWROUTE\">RTM_NEWROUTE</a>, <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>, <a class=\"id\" href=\"#prefix\">prefix</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_NEWROUTE\">RTM_NEWROUTE</a>, <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>, <a class=\"id\" href=\"#prefix\">prefix</a>|~<a class=\"id\" href=\"#mask\">mask</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#fib_del_ifaddr\">fib_del_ifaddr</a>(struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#ifa\">ifa</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_dev\">ifa_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#ifa1\">ifa1</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#prim\">prim</a> = <a class=\"id\" href=\"#ifa\">ifa</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#brd\">brd</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_address\">ifa_address</a>|~<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_mask\">ifa_mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#any\">any</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_address\">ifa_address</a>&amp;<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_mask\">ifa_mask</a>;", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#LOCAL_OK\">LOCAL_OK</a><span class=\"ts\"/>1", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#BRD_OK\">BRD_OK</a><span class=\"ts\"/><span class=\"ts\"/>2", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#BRD0_OK\">BRD0_OK</a><span class=\"ts\"/><span class=\"ts\"/>4", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#BRD1_OK\">BRD1_OK</a><span class=\"ts\"/><span class=\"ts\"/>8", 
"<span class=\"ts\"/>unsigned <a class=\"id\" href=\"#ok\">ok</a> = 0;", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_flags\">ifa_flags</a>&amp;<a class=\"id\" href=\"#IFA_F_SECONDARY\">IFA_F_SECONDARY</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_DELROUTE\">RTM_DELROUTE</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#flags\">flags</a>&amp;<a class=\"id\" href=\"#IFF_LOOPBACK\">IFF_LOOPBACK</a> ? <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#RTN_UNICAST\">RTN_UNICAST</a>, <a class=\"id\" href=\"#any\">any</a>, <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_prefixlen\">ifa_prefixlen</a>, <a class=\"id\" href=\"#prim\">prim</a>);", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prim\">prim</a> = <a class=\"id\" href=\"#inet_ifa_byprefix\">inet_ifa_byprefix</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#any\">any</a>, <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_mask\">ifa_mask</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prim\">prim</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"fib_del_ifaddr: bug: prim == NULL\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Deletion is more complicated than add.</span>", 
"<span class=\"comment\"><span class=\"ts\"/>   We should take care of not to delete too much :-)</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"><span class=\"ts\"/>   Scan address list to be sure that addresses are really gone.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#ifa1\">ifa1</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#ifa_list\">ifa_list</a>; <a class=\"id\" href=\"#ifa1\">ifa1</a>; <a class=\"id\" href=\"#ifa1\">ifa1</a> = <a class=\"id\" href=\"#ifa1\">ifa1</a>-><a class=\"id\" href=\"#ifa_next\">ifa_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a> == <a class=\"id\" href=\"#ifa1\">ifa1</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ok\">ok</a> |= <a class=\"id\" href=\"#LOCAL_OK\">LOCAL_OK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a> == <a class=\"id\" href=\"#ifa1\">ifa1</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ok\">ok</a> |= <a class=\"id\" href=\"#BRD_OK\">BRD_OK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#brd\">brd</a> == <a class=\"id\" href=\"#ifa1\">ifa1</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ok\">ok</a> |= <a class=\"id\" href=\"#BRD1_OK\">BRD1_OK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#any\">any</a> == <a class=\"id\" href=\"#ifa1\">ifa1</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ok\">ok</a> |= <a class=\"id\" href=\"#BRD0_OK\">BRD0_OK</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#ok\">ok</a>&amp;<a class=\"id\" href=\"#BRD_OK\">BRD_OK</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_DELROUTE\">RTM_DELROUTE</a>, <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>, <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_broadcast\">ifa_broadcast</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#ok\">ok</a>&amp;<a class=\"id\" href=\"#BRD1_OK\">BRD1_OK</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_DELROUTE\">RTM_DELROUTE</a>, <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>, <a class=\"id\" href=\"#brd\">brd</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#ok\">ok</a>&amp;<a class=\"id\" href=\"#BRD0_OK\">BRD0_OK</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_DELROUTE\">RTM_DELROUTE</a>, <a class=\"id\" href=\"#RTN_BROADCAST\">RTN_BROADCAST</a>, <a class=\"id\" href=\"#any\">any</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#ok\">ok</a>&amp;<a class=\"id\" href=\"#LOCAL_OK\">LOCAL_OK</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_magic\">fib_magic</a>(<a class=\"id\" href=\"#RTM_DELROUTE\">RTM_DELROUTE</a>, <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>, <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a>, 32, <a class=\"id\" href=\"#prim\">prim</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Check, that this local address finally disappeared. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#inet_addr_type\">inet_addr_type</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a>) != <a class=\"id\" href=\"#RTN_LOCAL\">RTN_LOCAL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* And the last, but not the least thing.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   We must flush stray FIB entries.</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   First of all, we scan fib_info list searching</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   for stray nexthop entries, then ignite fib_flush.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*/</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#fib_sync_down_addr\">fib_sync_down_addr</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_local\">ifa_local</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_flush\">fib_flush</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#LOCAL_OK\">LOCAL_OK</a>", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#BRD_OK\">BRD_OK</a>", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#BRD0_OK\">BRD0_OK</a>", 
"#<a class=\"id\" href=\"#undef\">undef</a> <a class=\"id\" href=\"#BRD1_OK\">BRD1_OK</a>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#nl_fib_lookup\">nl_fib_lookup</a>(struct <a class=\"id\" href=\"#fib_result_nl\">fib_result_nl</a> *<a class=\"id\" href=\"#frn\">frn</a>, struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a> )", 
"{", 
"", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result\">fib_result</a>       <a class=\"id\" href=\"#res\">res</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a>            <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#mark\">mark</a> = <a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#fl_mark\">fl_mark</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> = { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#fl_addr\">fl_addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#tos\">tos</a> = <a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#fl_tos\">fl_tos</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#scope\">scope</a> = <a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#fl_scope\">fl_scope</a> } } };", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#r\">r</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOENT\">ENOENT</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#tb\">tb</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#local_bh_disable\">local_bh_disable</a>();", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#tb_id\">tb_id</a> = <a class=\"id\" href=\"#tb\">tb</a>-><a class=\"id\" href=\"#tb_id\">tb_id</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib_table_lookup\">fib_table_lookup</a>(<a class=\"id\" href=\"#tb\">tb</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>, &amp;<a class=\"id\" href=\"#res\">res</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#prefixlen\">prefixlen</a> = <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#prefixlen\">prefixlen</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#nh_sel\">nh_sel</a> = <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#nh_sel\">nh_sel</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#scope\">scope</a> = <a class=\"id\" href=\"#res\">res</a>.<a class=\"id\" href=\"#scope\">scope</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_res_put\">fib_res_put</a>(&amp;<a class=\"id\" href=\"#res\">res</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#local_bh_enable\">local_bh_enable</a>();", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#nl_fib_input\">nl_fib_input</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_result_nl\">fib_result_nl</a> *<a class=\"id\" href=\"#frn\">frn</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#nlmsghdr\">nlmsghdr</a> *<a class=\"id\" href=\"#nlh\">nlh</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#pid\">pid</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#nlmsg_hdr\">nlmsg_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> &lt; <a class=\"id\" href=\"#NLMSG_SPACE\">NLMSG_SPACE</a>(0) || <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#len\">len</a> &lt; <a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#nlh\">nlh</a>-><a class=\"id\" href=\"#nlmsg_len\">nlmsg_len</a> &lt; <a class=\"id\" href=\"#NLMSG_LENGTH\">NLMSG_LENGTH</a>(sizeof(*<a class=\"id\" href=\"#frn\">frn</a>)))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#skb_clone\">skb_clone</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nlh\">nlh</a> = <a class=\"id\" href=\"#nlmsg_hdr\">nlmsg_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#frn\">frn</a> = (struct <a class=\"id\" href=\"#fib_result_nl\">fib_result_nl</a> *) <a class=\"id\" href=\"#NLMSG_DATA\">NLMSG_DATA</a>(<a class=\"id\" href=\"#nlh\">nlh</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tb\">tb</a> = <a class=\"id\" href=\"#fib_get_table\">fib_get_table</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#frn\">frn</a>-><a class=\"id\" href=\"#tb_id_in\">tb_id_in</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nl_fib_lookup\">nl_fib_lookup</a>(<a class=\"id\" href=\"#frn\">frn</a>, <a class=\"id\" href=\"#tb\">tb</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pid\">pid</a> = <a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a>;       <span class=\"comment\">/* pid of sending process */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#pid\">pid</a> = 0;         <span class=\"comment\">/* from kernel */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#NETLINK_CB\">NETLINK_CB</a>(<a class=\"id\" href=\"#skb\">skb</a>).<a class=\"id\" href=\"#dst_group\">dst_group</a> = 0;  <span class=\"comment\">/* unicast */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_unicast\">netlink_unicast</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fibnl\">fibnl</a>, <a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pid\">pid</a>, <a class=\"id\" href=\"#MSG_DONTWAIT\">MSG_DONTWAIT</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#nl_fib_lookup_init\">nl_fib_lookup_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sk\">sk</a> = <a class=\"id\" href=\"#netlink_kernel_create\">netlink_kernel_create</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#NETLINK_FIB_LOOKUP\">NETLINK_FIB_LOOKUP</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#nl_fib_input\">nl_fib_input</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#THIS_MODULE\">THIS_MODULE</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#sk\">sk</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EAFNOSUPPORT\">EAFNOSUPPORT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fibnl\">fibnl</a> = <a class=\"id\" href=\"#sk\">sk</a>;", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#nl_fib_lookup_exit\">nl_fib_lookup_exit</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#netlink_kernel_release\">netlink_kernel_release</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fibnl\">fibnl</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fibnl\">fibnl</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#fib_disable_ip\">fib_disable_ip</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, int <a class=\"id\" href=\"#force\">force</a>, int <a class=\"id\" href=\"#delay\">delay</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fib_sync_down_dev\">fib_sync_down_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#force\">force</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_flush\">fib_flush</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush\">rt_cache_flush</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#delay\">delay</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#arp_ifdown\">arp_ifdown</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#fib_inetaddr_event\">fib_inetaddr_event</a>(struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> *<a class=\"id\" href=\"#this\">this</a>, unsigned long <a class=\"id\" href=\"#event\">event</a>, void *<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *<a class=\"id\" href=\"#ifa\">ifa</a> = (struct <a class=\"id\" href=\"#in_ifaddr\">in_ifaddr</a> *)<a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_dev\">ifa_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#event\">event</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_UP\">NETDEV_UP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_add_ifaddr\">fib_add_ifaddr</a>(<a class=\"id\" href=\"#ifa\">ifa</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_MULTIPATH\">CONFIG_IP_ROUTE_MULTIPATH</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_sync_up\">fib_sync_up</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush\">rt_cache_flush</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), -1);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_DOWN\">NETDEV_DOWN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_del_ifaddr\">fib_del_ifaddr</a>(<a class=\"id\" href=\"#ifa\">ifa</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifa\">ifa</a>-><a class=\"id\" href=\"#ifa_dev\">ifa_dev</a>-><a class=\"id\" href=\"#ifa_list\">ifa_list</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Last address was deleted from this interface.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   Disable IP.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_disable_ip\">fib_disable_ip</a>(<a class=\"id\" href=\"#dev\">dev</a>, 1, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush\">rt_cache_flush</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), -1);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#fib_netdev_event\">fib_netdev_event</a>(struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> *<a class=\"id\" href=\"#this\">this</a>, unsigned long <a class=\"id\" href=\"#event\">event</a>, void *<a class=\"id\" href=\"#ptr\">ptr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ptr\">ptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#__in_dev_get_rtnl\">__in_dev_get_rtnl</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#event\">event</a> == <a class=\"id\" href=\"#NETDEV_UNREGISTER\">NETDEV_UNREGISTER</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_disable_ip\">fib_disable_ip</a>(<a class=\"id\" href=\"#dev\">dev</a>, 2, -1);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#event\">event</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_UP\">NETDEV_UP</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#for_ifa\">for_ifa</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_add_ifaddr\">fib_add_ifaddr</a>(<a class=\"id\" href=\"#ifa\">ifa</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} <a class=\"id\" href=\"#endfor_ifa\">endfor_ifa</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_ROUTE_MULTIPATH\">CONFIG_IP_ROUTE_MULTIPATH</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_sync_up\">fib_sync_up</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush\">rt_cache_flush</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), -1);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_DOWN\">NETDEV_DOWN</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_disable_ip\">fib_disable_ip</a>(<a class=\"id\" href=\"#dev\">dev</a>, 0, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_CHANGEMTU\">NETDEV_CHANGEMTU</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_CHANGE\">NETDEV_CHANGE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush\">rt_cache_flush</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>), 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#NETDEV_UNREGISTER_BATCH\">NETDEV_UNREGISTER_BATCH</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rt_cache_flush_batch\">rt_cache_flush_batch</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#NOTIFY_DONE\">NOTIFY_DONE</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> <a class=\"id\" href=\"#fib_inetaddr_notifier\">fib_inetaddr_notifier</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#notifier_call\">notifier_call</a> = <a class=\"id\" href=\"#fib_inetaddr_event\">fib_inetaddr_event</a>,", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#notifier_block\">notifier_block</a> <a class=\"id\" href=\"#fib_netdev_notifier\">fib_netdev_notifier</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#notifier_call\">notifier_call</a> = <a class=\"id\" href=\"#fib_netdev_event\">fib_netdev_event</a>,", 
"};", 
"", 
"static int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#ip_fib_net_init\">ip_fib_net_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a>)*<a class=\"id\" href=\"#FIB_TABLE_HASHSZ\">FIB_TABLE_HASHSZ</a>, <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOMEM\">ENOMEM</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#FIB_TABLE_HASHSZ\">FIB_TABLE_HASHSZ</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#INIT_HLIST_HEAD\">INIT_HLIST_HEAD</a>(&amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#fib4_rules_init\">fib4_rules_init</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#fail\">fail</a>;", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#fail\">fail</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ip_fib_net_exit\">ip_fib_net_exit</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTIPLE_TABLES\">CONFIG_IP_MULTIPLE_TABLES</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib4_rules_exit\">fib4_rules_exit</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#FIB_TABLE_HASHSZ\">FIB_TABLE_HASHSZ</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#fib_table\">fib_table</a> *<a class=\"id\" href=\"#tb\">tb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_head\">hlist_head</a> *<a class=\"id\" href=\"#head\">head</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#hlist_node\">hlist_node</a> *<a class=\"id\" href=\"#node\">node</a>, *<a class=\"id\" href=\"#tmp\">tmp</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a> = &amp;<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_for_each_entry_safe\">hlist_for_each_entry_safe</a>(<a class=\"id\" href=\"#tb\">tb</a>, <a class=\"id\" href=\"#node\">node</a>, <a class=\"id\" href=\"#tmp\">tmp</a>, <a class=\"id\" href=\"#head\">head</a>, <a class=\"id\" href=\"#tb_hlist\">tb_hlist</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hlist_del\">hlist_del</a>(<a class=\"id\" href=\"#node\">node</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fib_table_flush\">fib_table_flush</a>(<a class=\"id\" href=\"#tb\">tb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#tb\">tb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#net\">net</a>-><a class=\"id\" href=\"#ipv4\">ipv4</a>.<a class=\"id\" href=\"#fib_table_hash\">fib_table_hash</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__net_init\">__net_init</a> <a class=\"id\" href=\"#fib_net_init\">fib_net_init</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#ip_fib_net_init\">ip_fib_net_init</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#nl_fib_lookup_init\">nl_fib_lookup_init</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_nlfl\">out_nlfl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#fib_proc_init\">fib_proc_init</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#error\">error</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_proc\">out_proc</a>;", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<a class=\"id\" href=\"#out_proc\">out_proc</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nl_fib_lookup_exit\">nl_fib_lookup_exit</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<a class=\"id\" href=\"#out_nlfl\">out_nlfl</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_fib_net_exit\">ip_fib_net_exit</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__net_exit\">__net_exit</a> <a class=\"id\" href=\"#fib_net_exit\">fib_net_exit</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_proc_exit\">fib_proc_exit</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#nl_fib_lookup_exit\">nl_fib_lookup_exit</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_fib_net_exit\">ip_fib_net_exit</a>(<a class=\"id\" href=\"#net\">net</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#pernet_operations\">pernet_operations</a> <a class=\"id\" href=\"#fib_net_ops\">fib_net_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#init\">init</a> = <a class=\"id\" href=\"#fib_net_init\">fib_net_init</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#exit\">exit</a> = <a class=\"id\" href=\"#fib_net_exit\">fib_net_exit</a>,", 
"};", 
"", 
"void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#ip_fib_init\">ip_fib_init</a>(void)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_register\">rtnl_register</a>(<a class=\"id\" href=\"#PF_INET\">PF_INET</a>, <a class=\"id\" href=\"#RTM_NEWROUTE\">RTM_NEWROUTE</a>, <a class=\"id\" href=\"#inet_rtm_newroute\">inet_rtm_newroute</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_register\">rtnl_register</a>(<a class=\"id\" href=\"#PF_INET\">PF_INET</a>, <a class=\"id\" href=\"#RTM_DELROUTE\">RTM_DELROUTE</a>, <a class=\"id\" href=\"#inet_rtm_delroute\">inet_rtm_delroute</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_register\">rtnl_register</a>(<a class=\"id\" href=\"#PF_INET\">PF_INET</a>, <a class=\"id\" href=\"#RTM_GETROUTE\">RTM_GETROUTE</a>, <a class=\"id\" href=\"#NULL\">NULL</a>, <a class=\"id\" href=\"#inet_dump_fib\">inet_dump_fib</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#register_pernet_subsys\">register_pernet_subsys</a>(&amp;<a class=\"id\" href=\"#fib_net_ops\">fib_net_ops</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#register_netdevice_notifier\">register_netdevice_notifier</a>(&amp;<a class=\"id\" href=\"#fib_netdev_notifier\">fib_netdev_notifier</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#register_inetaddr_notifier\">register_inetaddr_notifier</a>(&amp;<a class=\"id\" href=\"#fib_inetaddr_notifier\">fib_inetaddr_notifier</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#fib_hash_init\">fib_hash_init</a>();", 
"}", 
];
xr_frag_insert('l/e2/ce6bd4a0231ad6ec10705c1354f6c3d821d872.xr', __xr_tmp);
