var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *  linux/drivers/video/fbmem.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *  Copyright (C) 1994 Martin Schaller</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>2001 - Documented with DocBook</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>- Brad Douglas &lt;brad@neruo.com&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This file is subject to the terms and conditions of the GNU General Public</span>", 
"<span class=\"comment\"> * License.  See the file COPYING in the main directory of this archive</span>", 
"<span class=\"comment\"> * for more details.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#compat\">compat</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#major\">major</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mman\">mman</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#vt\">vt</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#linux_logo\">linux_logo</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#proc_fs\">proc_fs</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#seq_file\">seq_file</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#console\">console</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kmod\">kmod</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#err\">err</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#device\">device</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#efi\">efi</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#fb\">fb</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#fb\">fb</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"", 
"    <span class=\"comment\">/*</span>", 
"<span class=\"comment\">     *  Frame buffer device initialization and setup routines</span>", 
"<span class=\"comment\">     */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#FBPIXMAPSIZE\">FBPIXMAPSIZE</a><span class=\"ts\"/>(1024 * 8)", 
"", 
"struct <a class=\"id\" href=\"#fb_info\">fb_info</a> *<a class=\"id\" href=\"#registered_fb\">registered_fb</a>[<a class=\"id\" href=\"#FB_MAX\">FB_MAX</a>] <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a>;", 
"int <a class=\"id\" href=\"#num_registered_fb\">num_registered_fb</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a>;", 
"", 
"int <a class=\"id\" href=\"#lock_fb_info\">lock_fb_info</a>(struct <a class=\"id\" href=\"#fb_info\">fb_info</a> *<a class=\"id\" href=\"#info\">info</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mutex_lock\">mutex_lock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fbops\">fbops</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mutex_unlock\">mutex_unlock</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 1;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#lock_fb_info\">lock_fb_info</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Helpers</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#fb_get_color_depth\">fb_get_color_depth</a>(struct <a class=\"id\" href=\"#fb_var_screeninfo\">fb_var_screeninfo</a> *<a class=\"id\" href=\"#var\">var</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#fb_fix_screeninfo\">fb_fix_screeninfo</a> *<a class=\"id\" href=\"#fix\">fix</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#depth\">depth</a> = 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#fix\">fix</a>-><a class=\"id\" href=\"#visual\">visual</a> == <a class=\"id\" href=\"#FB_VISUAL_MONO01\">FB_VISUAL_MONO01</a> ||", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#fix\">fix</a>-><a class=\"id\" href=\"#visual\">visual</a> == <a class=\"id\" href=\"#FB_VISUAL_MONO10\">FB_VISUAL_MONO10</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#depth\">depth</a> = 1;", 
"<span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#length\">length</a> == <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#length\">length</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#length\">length</a> == <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#length\">length</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#offset\">offset</a> == <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#offset\">offset</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#offset\">offset</a> == <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#offset\">offset</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#depth\">depth</a> = <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#length\">length</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#depth\">depth</a> = <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#length\">length</a> + <a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#length\">length</a> +", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#var\">var</a>-><a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#length\">length</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#depth\">depth</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#fb_get_color_depth\">fb_get_color_depth</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Data padding functions.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#fb_pad_aligned_buffer\">fb_pad_aligned_buffer</a>(<a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#d_pitch\">d_pitch</a>, <a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#s_pitch\">s_pitch</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#height\">height</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__fb_pad_aligned_buffer\">__fb_pad_aligned_buffer</a>(<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#d_pitch\">d_pitch</a>, <a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#s_pitch\">s_pitch</a>, <a class=\"id\" href=\"#height\">height</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#fb_pad_aligned_buffer\">fb_pad_aligned_buffer</a>);", 
"", 
"void <a class=\"id\" href=\"#fb_pad_unaligned_buffer\">fb_pad_unaligned_buffer</a>(<a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#d_pitch\">d_pitch</a>, <a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#src\">src</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#idx\">idx</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#height\">height</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#shift_high\">shift_high</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#shift_low\">shift_low</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#mod\">mod</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#mask\">mask</a> = (<a class=\"id\" href=\"#u8\">u8</a>) (0xfff << <a class=\"id\" href=\"#shift_high\">shift_high</a>), <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#j\">j</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#height\">height</a>; <a class=\"id\" href=\"#i\">i</a>--; ) {", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a> = 0; <a class=\"id\" href=\"#j\">j</a> &lt; <a class=\"id\" href=\"#idx\">idx</a>; <a class=\"id\" href=\"#j\">j</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> = <a class=\"id\" href=\"#dst\">dst</a>[<a class=\"id\" href=\"#j\">j</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> &= <a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> |= *<a class=\"id\" href=\"#src\">src</a> >> <a class=\"id\" href=\"#shift_low\">shift_low</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>[<a class=\"id\" href=\"#j\">j</a>] = <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> = *<a class=\"id\" href=\"#src\">src</a> << <a class=\"id\" href=\"#shift_high\">shift_high</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>[<a class=\"id\" href=\"#j\">j</a>+1] = <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#src\">src</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> = <a class=\"id\" href=\"#dst\">dst</a>[<a class=\"id\" href=\"#idx\">idx</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> &= <a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> |= *<a class=\"id\" href=\"#src\">src</a> >> <a class=\"id\" href=\"#shift_low\">shift_low</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>[<a class=\"id\" href=\"#idx\">idx</a>] = <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#shift_high\">shift_high</a> &lt; <a class=\"id\" href=\"#mod\">mod</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tmp\">tmp</a> = *<a class=\"id\" href=\"#src\">src</a> << <a class=\"id\" href=\"#shift_high\">shift_high</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>[<a class=\"id\" href=\"#idx\">idx</a>+1] = <a class=\"id\" href=\"#tmp\">tmp</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#src\">src</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> += <a class=\"id\" href=\"#d_pitch\">d_pitch</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#fb_pad_unaligned_buffer\">fb_pad_unaligned_buffer</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * we need to lock this section since fb_cursor</span>", 
"<span class=\"comment\"> * may use fb_imageblit()</span>", 
"<span class=\"comment\"> */</span>", 
"char* <a class=\"id\" href=\"#fb_get_buffer_offset\">fb_get_buffer_offset</a>(struct <a class=\"id\" href=\"#fb_info\">fb_info</a> *<a class=\"id\" href=\"#info\">info</a>, struct <a class=\"id\" href=\"#fb_pixmap\">fb_pixmap</a> *<a class=\"id\" href=\"#buf\">buf</a>, <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#size\">size</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#align\">align</a> = <a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#buf_align\">buf_align</a> - 1, <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#addr\">addr</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* If IO mapped, we need to sync before access, no sharing of</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * the pixmap is done</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#FB_PIXMAP_IO\">FB_PIXMAP_IO</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fbops\">fbops</a>-><a class=\"id\" href=\"#fb_sync\">fb_sync</a> && (<a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#FB_PIXMAP_SYNC\">FB_PIXMAP_SYNC</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fbops\">fbops</a>-><a class=\"id\" href=\"#fb_sync\">fb_sync</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#addr\">addr</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* See if we fit in the remaining pixmap space */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#offset\">offset</a> + <a class=\"id\" href=\"#align\">align</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> &= ~<a class=\"id\" href=\"#align\">align</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#offset\">offset</a> + <a class=\"id\" href=\"#size\">size</a> &gt; <a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#size\">size</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* We do not fit. In order to be able to re-use the buffer,</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * we must ensure no asynchronous DMA'ing or whatever operation</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * is in progress, we sync for that.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fbops\">fbops</a>-><a class=\"id\" href=\"#fb_sync\">fb_sync</a> && (<a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#flags\">flags</a> &amp; <a class=\"id\" href=\"#FB_PIXMAP_SYNC\">FB_PIXMAP_SYNC</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fbops\">fbops</a>-><a class=\"id\" href=\"#fb_sync\">fb_sync</a>(<a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#buf\">buf</a>-><a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#offset\">offset</a> + <a class=\"id\" href=\"#size\">size</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#addr\">addr</a> += <a class=\"id\" href=\"#offset\">offset</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#addr\">addr</a>;", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_LOGO\">CONFIG_LOGO</a>", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned <a class=\"id\" href=\"#safe_shift\">safe_shift</a>(unsigned <a class=\"id\" href=\"#d\">d</a>, int <a class=\"id\" href=\"#n\">n</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#n\">n</a> &lt; 0 ? <a class=\"id\" href=\"#d\">d</a> >> -<a class=\"id\" href=\"#n\">n</a> : <a class=\"id\" href=\"#d\">d</a> << <a class=\"id\" href=\"#n\">n</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#fb_set_logocmap\">fb_set_logocmap</a>(struct <a class=\"id\" href=\"#fb_info\">fb_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   const struct <a class=\"id\" href=\"#linux_logo\">linux_logo</a> *<a class=\"id\" href=\"#logo\">logo</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#fb_cmap\">fb_cmap</a> <a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#palette_green\">palette_green</a>[16];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#palette_blue\">palette_blue</a>[16];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u16\">u16</a> <a class=\"id\" href=\"#palette_red\">palette_red</a>[16];", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#j\">j</a>, <a class=\"id\" href=\"#n\">n</a>;", 
"<span class=\"ts\"/>const unsigned char *<a class=\"id\" href=\"#clut\">clut</a> = <a class=\"id\" href=\"#logo\">logo</a>-><a class=\"id\" href=\"#clut\">clut</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#start\">start</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#len\">len</a> = 16;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#red\">red</a> = <a class=\"id\" href=\"#palette_red\">palette_red</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#green\">green</a> = <a class=\"id\" href=\"#palette_green\">palette_green</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#blue\">blue</a> = <a class=\"id\" href=\"#palette_blue\">palette_blue</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#transp\">transp</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#logo\">logo</a>-><a class=\"id\" href=\"#clutsize\">clutsize</a>; <a class=\"id\" href=\"#i\">i</a> += <a class=\"id\" href=\"#n\">n</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#n\">n</a> = <a class=\"id\" href=\"#logo\">logo</a>-><a class=\"id\" href=\"#clutsize\">clutsize</a> - <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* palette_cmap provides space for only 16 colors at once */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#n\">n</a> &gt; 16)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#n\">n</a> = 16;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#start\">start</a> = 32 + <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#len\">len</a> = <a class=\"id\" href=\"#n\">n</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a> = 0; <a class=\"id\" href=\"#j\">j</a> &lt; <a class=\"id\" href=\"#n\">n</a>; ++<a class=\"id\" href=\"#j\">j</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#red\">red</a>[<a class=\"id\" href=\"#j\">j</a>] = <a class=\"id\" href=\"#clut\">clut</a>[0] << 8 | <a class=\"id\" href=\"#clut\">clut</a>[0];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#green\">green</a>[<a class=\"id\" href=\"#j\">j</a>] = <a class=\"id\" href=\"#clut\">clut</a>[1] << 8 | <a class=\"id\" href=\"#clut\">clut</a>[1];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>.<a class=\"id\" href=\"#blue\">blue</a>[<a class=\"id\" href=\"#j\">j</a>] = <a class=\"id\" href=\"#clut\">clut</a>[2] << 8 | <a class=\"id\" href=\"#clut\">clut</a>[2];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clut\">clut</a> += 3;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fb_set_cmap\">fb_set_cmap</a>(&amp;<a class=\"id\" href=\"#palette_cmap\">palette_cmap</a>, <a class=\"id\" href=\"#info\">info</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void  <a class=\"id\" href=\"#fb_set_logo_truepalette\">fb_set_logo_truepalette</a>(struct <a class=\"id\" href=\"#fb_info\">fb_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    const struct <a class=\"id\" href=\"#linux_logo\">linux_logo</a> *<a class=\"id\" href=\"#logo\">logo</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#palette\">palette</a>)", 
"{", 
"<span class=\"ts\"/>static const unsigned char <a class=\"id\" href=\"#mask\">mask</a>[] = { 0,0x80,0xc0,0xe0,0xf0,0xf8,0xfc,0xfe,0xff };", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#redmask\">redmask</a>, <a class=\"id\" href=\"#greenmask\">greenmask</a>, <a class=\"id\" href=\"#bluemask\">bluemask</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#redshift\">redshift</a>, <a class=\"id\" href=\"#greenshift\">greenshift</a>, <a class=\"id\" href=\"#blueshift\">blueshift</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>const unsigned char *<a class=\"id\" href=\"#clut\">clut</a> = <a class=\"id\" href=\"#logo\">logo</a>-><a class=\"id\" href=\"#clut\">clut</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * We have to create a temporary palette since console palette is only</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * 16 colors long.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* Bug: Doesn't obey msb_right ... (who needs that?) */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#redmask\">redmask</a>   = <a class=\"id\" href=\"#mask\">mask</a>[<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#length\">length</a>   &lt; 8 ? <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#length\">length</a>   : 8];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#greenmask\">greenmask</a> = <a class=\"id\" href=\"#mask\">mask</a>[<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#length\">length</a> &lt; 8 ? <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#length\">length</a> : 8];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bluemask\">bluemask</a>  = <a class=\"id\" href=\"#mask\">mask</a>[<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#length\">length</a>  &lt; 8 ? <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#length\">length</a>  : 8];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#redshift\">redshift</a>   = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#offset\">offset</a>   - (8 - <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#length\">length</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#greenshift\">greenshift</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#offset\">offset</a> - (8 - <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#length\">length</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#blueshift\">blueshift</a>  = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#offset\">offset</a>  - (8 - <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#length\">length</a>);", 
"", 
"<span class=\"ts\"/>for ( <a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#logo\">logo</a>-><a class=\"id\" href=\"#clutsize\">clutsize</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#palette\">palette</a>[<a class=\"id\" href=\"#i\">i</a>+32] = (<a class=\"id\" href=\"#safe_shift\">safe_shift</a>((<a class=\"id\" href=\"#clut\">clut</a>[0] &amp; <a class=\"id\" href=\"#redmask\">redmask</a>), <a class=\"id\" href=\"#redshift\">redshift</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#safe_shift\">safe_shift</a>((<a class=\"id\" href=\"#clut\">clut</a>[1] &amp; <a class=\"id\" href=\"#greenmask\">greenmask</a>), <a class=\"id\" href=\"#greenshift\">greenshift</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> <a class=\"id\" href=\"#safe_shift\">safe_shift</a>((<a class=\"id\" href=\"#clut\">clut</a>[2] &amp; <a class=\"id\" href=\"#bluemask\">bluemask</a>), <a class=\"id\" href=\"#blueshift\">blueshift</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#clut\">clut</a> += 3;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#fb_set_logo_directpalette\">fb_set_logo_directpalette</a>(struct <a class=\"id\" href=\"#fb_info\">fb_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     const struct <a class=\"id\" href=\"#linux_logo\">linux_logo</a> *<a class=\"id\" href=\"#logo\">logo</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#u32\">u32</a> *<a class=\"id\" href=\"#palette\">palette</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#redshift\">redshift</a>, <a class=\"id\" href=\"#greenshift\">greenshift</a>, <a class=\"id\" href=\"#blueshift\">blueshift</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#redshift\">redshift</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#red\">red</a>.<a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#greenshift\">greenshift</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#green\">green</a>.<a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#blueshift\">blueshift</a> = <a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>.<a class=\"id\" href=\"#blue\">blue</a>.<a class=\"id\" href=\"#offset\">offset</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 32; <a class=\"id\" href=\"#i\">i</a> &lt; 32 + <a class=\"id\" href=\"#logo\">logo</a>-><a class=\"id\" href=\"#clutsize\">clutsize</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#palette\">palette</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#i\">i</a> << <a class=\"id\" href=\"#redshift\">redshift</a> | <a class=\"id\" href=\"#i\">i</a> << <a class=\"id\" href=\"#greenshift\">greenshift</a> | <a class=\"id\" href=\"#i\">i</a> << <a class=\"id\" href=\"#blueshift\">blueshift</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#fb_set_logo\">fb_set_logo</a>(struct <a class=\"id\" href=\"#fb_info\">fb_info</a> *<a class=\"id\" href=\"#info\">info</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       const struct <a class=\"id\" href=\"#linux_logo\">linux_logo</a> *<a class=\"id\" href=\"#logo\">logo</a>, <a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#dst\">dst</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       int <a class=\"id\" href=\"#depth\">depth</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#j\">j</a>, <a class=\"id\" href=\"#k\">k</a>;", 
"<span class=\"ts\"/>const <a class=\"id\" href=\"#u8\">u8</a> *<a class=\"id\" href=\"#src\">src</a> = <a class=\"id\" href=\"#logo\">logo</a>-><a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#xor\">xor</a> = (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fix\">fix</a>.<a class=\"id\" href=\"#visual\">visual</a> == <a class=\"id\" href=\"#FB_VISUAL_MONO01\">FB_VISUAL_MONO01</a>) ? 0xff : 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#fg\">fg</a> = 1, <a class=\"id\" href=\"#d\">d</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#fb_get_color_depth\">fb_get_color_depth</a>(&amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#var\">var</a>, &amp;<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#fix\">fix</a>)) {", 
"<span class=\"ts\"/>case 1:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fg\">fg</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 2:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fg\">fg</a> = 3;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#fg\">fg</a> = 7;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
];
xr_frag_insert('l/ec/69d63378d0d5dcccafa5767ed6667773fef793.xr', __xr_tmp);
