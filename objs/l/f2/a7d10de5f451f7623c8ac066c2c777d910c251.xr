var __xr_tmp = [
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scontextp\">scontextp</a> += <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#nm\">nm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev\">prev</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#scontextp\">scontextp</a>++ = ':';", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#scontextp\">scontextp</a>++ = ',';", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nm\">nm</a> = <a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#p_cat_val_to_name\">p_cat_val_to_name</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#scontextp\">scontextp</a>, <a class=\"id\" href=\"#nm\">nm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scontextp\">scontextp</a> += <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#nm\">nm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#head\">head</a> = <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prev\">prev</a> = <a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev\">prev</a> != <a class=\"id\" href=\"#head\">head</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev\">prev</a> - <a class=\"id\" href=\"#head\">head</a> &gt; 1)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#scontextp\">scontextp</a>++ = '.';", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#scontextp\">scontextp</a>++ = ',';", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nm\">nm</a> = <a class=\"id\" href=\"#policydb\">policydb</a>.<a class=\"id\" href=\"#p_cat_val_to_name\">p_cat_val_to_name</a>[<a class=\"id\" href=\"#prev\">prev</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#strcpy\">strcpy</a>(<a class=\"id\" href=\"#scontextp\">scontextp</a>, <a class=\"id\" href=\"#nm\">nm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scontextp\">scontextp</a> += <a class=\"id\" href=\"#strlen\">strlen</a>(<a class=\"id\" href=\"#nm\">nm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#l\">l</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#mls_level_eq\">mls_level_eq</a>(&amp;<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[0],", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> &amp;<a class=\"id\" href=\"#context\">context</a>-><a class=\"id\" href=\"#range\">range</a>.<a class=\"id\" href=\"#level\">level</a>[1]))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#scontextp\">scontextp</a>++ = '-';", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#scontext\">scontext</a> = <a class=\"id\" href=\"#scontextp\">scontextp</a>;", 
"<span class=\"ts\"/>return;", 
"}", 
"", 
"int <a class=\"id\" href=\"#mls_level_isvalid\">mls_level_isvalid</a>(struct <a class=\"id\" href=\"#policydb\">policydb</a> *<a class=\"id\" href=\"#p\">p</a>, struct <a class=\"id\" href=\"#mls_level\">mls_level</a> *<a class=\"id\" href=\"#l\">l</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#level_datum\">level_datum</a> *<a class=\"id\" href=\"#levdatum\">levdatum</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ebitmap_node\">ebitmap_node</a> *<a class=\"id\" href=\"#node\">node</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#l\">l</a>-><a class=\"id\" href=\"#sens\">sens</a> || <a class=\"id\" href=\"#l\">l</a>-><a class=\"id\" href=\"#sens\">sens</a> &gt; <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#p_levels\">p_levels</a>.<a class=\"id\" href=\"#nprim\">nprim</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#levdatum\">levdatum</a> = <a class=\"id\" href=\"#hashtab_search\">hashtab_search</a>(<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#p_levels\">p_levels</a>.<a class=\"id\" href=\"#table\">table</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#p_sens_val_to_name\">p_sens_val_to_name</a>[<a class=\"id\" href=\"#l\">l</a>-><a class=\"id\" href=\"#sens\">sens</a> - 1]);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#levdatum\">levdatum</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ebitmap_for_each_positive_bit\">ebitmap_for_each_positive_bit</a>(&amp;<a class=\"id\" href=\"#l\">l</a>-><a class=\"id\" href=\"#cat\">cat</a>, <a class=\"id\" href=\"#node\">node</a>, <a class=\"id\" href=\"#i\">i</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> &gt; <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#p_cats\">p_cats</a>.<a class=\"id\" href=\"#nprim\">nprim</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#ebitmap_get_bit\">ebitmap_get_bit</a>(&amp;<a class=\"id\" href=\"#levdatum\">levdatum</a>-><a class=\"id\" href=\"#level\">level</a>-><a class=\"id\" href=\"#cat\">cat</a>, <a class=\"id\" href=\"#i\">i</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * Category may not be associated with</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * sensitivity.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"int <a class=\"id\" href=\"#mls_range_isvalid\">mls_range_isvalid</a>(struct <a class=\"id\" href=\"#policydb\">policydb</a> *<a class=\"id\" href=\"#p\">p</a>, struct <a class=\"id\" href=\"#mls_range\">mls_range</a> *<a class=\"id\" href=\"#r\">r</a>)", 
"{", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#mls_level_isvalid\">mls_level_isvalid</a>(<a class=\"id\" href=\"#p\">p</a>, &amp;<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#level\">level</a>[0]) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mls_level_isvalid\">mls_level_isvalid</a>(<a class=\"id\" href=\"#p\">p</a>, &amp;<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#level\">level</a>[1]) &&", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mls_level_dom\">mls_level_dom</a>(&amp;<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#level\">level</a>[1], &amp;<a class=\"id\" href=\"#r\">r</a>-><a class=\"id\" href=\"#level\">level</a>[0]));", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Return 1 if the MLS fields in the security context</span>", 
"<span class=\"comment\"> * structure `c' are valid.  Return 0 otherwise.</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#mls_context_isvalid\">mls_context_isvalid</a>(struct <a class=\"id\" href=\"#policydb\">policydb</a> *<a class=\"id\" href=\"#p\">p</a>, struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#c\">c</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#user_datum\">user_datum</a> *<a class=\"id\" href=\"#usrdatum\">usrdatum</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#mls_enabled\">mls_enabled</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#mls_range_isvalid\">mls_range_isvalid</a>(<a class=\"id\" href=\"#p\">p</a>, &amp;<a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#range\">range</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#role\">role</a> == <a class=\"id\" href=\"#OBJECT_R_VAL\">OBJECT_R_VAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * User must be authorized for the MLS range.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#user\">user</a> || <a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#user\">user</a> &gt; <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#p_users\">p_users</a>.<a class=\"id\" href=\"#nprim\">nprim</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#usrdatum\">usrdatum</a> = <a class=\"id\" href=\"#p\">p</a>-><a class=\"id\" href=\"#user_val_to_struct\">user_val_to_struct</a>[<a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#user\">user</a> - 1];", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#mls_range_contains\">mls_range_contains</a>(<a class=\"id\" href=\"#usrdatum\">usrdatum</a>-><a class=\"id\" href=\"#range\">range</a>, <a class=\"id\" href=\"#c\">c</a>-><a class=\"id\" href=\"#range\">range</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0; <span class=\"comment\">/* user may not be associated with range */</span>", 
"", 
"<span class=\"ts\"/>return 1;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Set the MLS fields in the security context structure</span>", 
"<span class=\"comment\"> * `context' based on the string representation in</span>", 
"<span class=\"comment\"> * the string `*scontext'.  Update `*scontext' to</span>", 
"<span class=\"comment\"> * point to the end of the string representation of</span>", 
"<span class=\"comment\"> * the MLS fields.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This function modifies the string in place, inserting</span>", 
"<span class=\"comment\"> * NULL characters to terminate the MLS fields.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * If a def_sid is provided and no MLS field is present,</span>", 
"<span class=\"comment\"> * copy the MLS field of the associated default context.</span>", 
"<span class=\"comment\"> * Used for upgraded to MLS systems where objects may lack</span>", 
"<span class=\"comment\"> * MLS fields.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Policy read-lock must be held for sidtab lookup.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#mls_context_to_sid\">mls_context_to_sid</a>(struct <a class=\"id\" href=\"#policydb\">policydb</a> *<a class=\"id\" href=\"#pol\">pol</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       char <a class=\"id\" href=\"#oldc\">oldc</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       char **<a class=\"id\" href=\"#scontext\">scontext</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#context\">context</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#sidtab\">sidtab</a> *<a class=\"id\" href=\"#s\">s</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#def_sid\">def_sid</a>)", 
"{", 
"", 
"<span class=\"ts\"/>char <a class=\"id\" href=\"#delim\">delim</a>;", 
"<span class=\"ts\"/>char *<a class=\"id\" href=\"#scontextp\">scontextp</a>, *<a class=\"id\" href=\"#p\">p</a>, *<a class=\"id\" href=\"#rngptr\">rngptr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#level_datum\">level_datum</a> *<a class=\"id\" href=\"#levdatum\">levdatum</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#cat_datum\">cat_datum</a> *<a class=\"id\" href=\"#catdatum\">catdatum</a>, *<a class=\"id\" href=\"#rngdatum\">rngdatum</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#l\">l</a>, <a class=\"id\" href=\"#rc\">rc</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pol\">pol</a>-><a class=\"id\" href=\"#mls_enabled\">mls_enabled</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#def_sid\">def_sid</a> != <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a> && <a class=\"id\" href=\"#oldc\">oldc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#scontext\">scontext</a> += <a class=\"id\" href=\"#strlen\">strlen</a>(*<a class=\"id\" href=\"#scontext\">scontext</a>) + 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * No MLS component to the security context, try and map to</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * default if provided.</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#oldc\">oldc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#context\">context</a> *<a class=\"id\" href=\"#defcon\">defcon</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#def_sid\">def_sid</a> == <a class=\"id\" href=\"#SECSID_NULL\">SECSID_NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out\">out</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#defcon\">defcon</a> = <a class=\"id\" href=\"#sidtab_search\">sidtab_search</a>(<a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#def_sid\">def_sid</a>);", 
];
xr_frag_insert('l/f2/a7d10de5f451f7623c8ac066c2c777d910c251.xr', __xr_tmp);
