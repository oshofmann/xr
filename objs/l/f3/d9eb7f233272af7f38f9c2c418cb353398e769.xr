var __xr_tmp = [
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a> = <a class=\"id\" href=\"#im\">im</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_count\">mc_count</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_del_delrec\">igmpv3_del_delrec</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmp_group_added\">igmp_group_added</a>(<a class=\"id\" href=\"#im\">im</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dead\">dead</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_multicast_event\">ip_rt_multicast_event</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<a class=\"id\" href=\"#out\">out</a>:", 
"<span class=\"ts\"/>return;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ip_mc_inc_group\">ip_mc_inc_group</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Resend IGMP JOIN report; used for bonding.</span>", 
"<span class=\"comment\"> */</span>", 
"void <a class=\"id\" href=\"#ip_mc_rejoin_group\">ip_mc_rejoin_group</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#im\">im</a>)", 
"{", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#interface\">interface</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a> == <a class=\"id\" href=\"#IGMP_ALL_HOSTS\">IGMP_ALL_HOSTS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IGMP_V1_SEEN\">IGMP_V1_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) || <a class=\"id\" href=\"#IGMP_V2_SEEN\">IGMP_V2_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_mod_timer\">igmp_mod_timer</a>(<a class=\"id\" href=\"#im\">im</a>, <a class=\"id\" href=\"#IGMP_Initial_Report_Delay\">IGMP_Initial_Report_Delay</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"comment\">/* else, v3 */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#crcount\">crcount</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> ? <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IGMP_Unsolicited_Report_Count\">IGMP_Unsolicited_Report_Count</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmp_ifc_event\">igmp_ifc_event</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ip_mc_rejoin_group\">ip_mc_rejoin_group</a>);", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>A socket has left a multicast group on device dev</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_mc_dec_group\">ip_mc_dec_group</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#i\">i</a>, **<a class=\"id\" href=\"#ip\">ip</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ASSERT_RTNL\">ASSERT_RTNL</a>();", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#ip\">ip</a>=&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; (<a class=\"id\" href=\"#i\">i</a>=*<a class=\"id\" href=\"#ip\">ip</a>)!=<a class=\"id\" href=\"#NULL\">NULL</a>; <a class=\"id\" href=\"#ip\">ip</a>=&amp;<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a> == <a class=\"id\" href=\"#addr\">addr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (--<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#users\">users</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#ip\">ip</a> = <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_count\">mc_count</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_group_dropped\">igmp_group_dropped</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dead\">dead</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_multicast_event\">ip_rt_multicast_event</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_ma_put\">ip_ma_put</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ip_mc_dec_group\">ip_mc_dec_group</a>);", 
"", 
"<span class=\"comment\">/* Device changing type */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_mc_unmap\">ip_mc_unmap</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ASSERT_RTNL\">ASSERT_RTNL</a>();", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_group_dropped\">igmp_group_dropped</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#ip_mc_remap\">ip_mc_remap</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ASSERT_RTNL\">ASSERT_RTNL</a>();", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_group_added\">igmp_group_added</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Device going down */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_mc_down\">ip_mc_down</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ASSERT_RTNL\">ASSERT_RTNL</a>();", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#i\">i</a>=<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_group_dropped\">igmp_group_dropped</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_count\">mr_ifc_count</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#del_timer\">del_timer</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_timer\">mr_ifc_timer</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__in_dev_put\">__in_dev_put</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_gq_running\">mr_gq_running</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#del_timer\">del_timer</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_gq_timer\">mr_gq_timer</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__in_dev_put\">__in_dev_put</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_clear_delrec\">igmpv3_clear_delrec</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_dec_group\">ip_mc_dec_group</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#IGMP_ALL_HOSTS\">IGMP_ALL_HOSTS</a>);", 
"}", 
"", 
"void <a class=\"id\" href=\"#ip_mc_init_dev\">ip_mc_init_dev</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ASSERT_RTNL\">ASSERT_RTNL</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_tomb\">mc_tomb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_gq_running\">mr_gq_running</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setup_timer\">setup_timer</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_gq_timer\">mr_gq_timer</a>, <a class=\"id\" href=\"#igmp_gq_timer_expire\">igmp_gq_timer_expire</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned long)<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_count\">mr_ifc_count</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_count\">mc_count</a>     = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#setup_timer\">setup_timer</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_timer\">mr_ifc_timer</a>, <a class=\"id\" href=\"#igmp_ifc_timer_expire\">igmp_ifc_timer_expire</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(unsigned long)<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> = <a class=\"id\" href=\"#IGMP_Unsolicited_Report_Count\">IGMP_Unsolicited_Report_Count</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rwlock_init\">rwlock_init</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_init\">spin_lock_init</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_tomb_lock\">mc_tomb_lock</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Device going up */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_mc_up\">ip_mc_up</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ASSERT_RTNL\">ASSERT_RTNL</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_inc_group\">ip_mc_inc_group</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#IGMP_ALL_HOSTS\">IGMP_ALL_HOSTS</a>);", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#i\">i</a>=<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_group_added\">igmp_group_added</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Device is about to be destroyed: clean up.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"void <a class=\"id\" href=\"#ip_mc_destroy_dev\">ip_mc_destroy_dev</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ASSERT_RTNL\">ASSERT_RTNL</a>();", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Deactivate timers */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_down\">ip_mc_down</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/>while ((<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>) != <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a> = <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_count\">mc_count</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_group_dropped\">igmp_group_dropped</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_ma_put\">ip_ma_put</a>(<a class=\"id\" href=\"#i\">i</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#write_lock_bh\">write_lock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#write_unlock_bh\">write_unlock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#ip_mc_find_dev\">ip_mc_find_dev</a>(struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a>, struct <a class=\"id\" href=\"#ip_mreqn\">ip_mreqn</a> *<a class=\"id\" href=\"#imr\">imr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> =", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> } } };", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#inetdev_by_index\">inetdev_by_index</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#idev\">idev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__in_dev_put\">__in_dev_put</a>(<a class=\"id\" href=\"#idev\">idev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#idev\">idev</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#ip_dev_find\">ip_dev_find</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev_put\">dev_put</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a> && !<a class=\"id\" href=\"#ip_route_output_key\">ip_route_output_key</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>.<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#idev\">idev</a> = <a class=\"id\" href=\"#__in_dev_get_rtnl\">__in_dev_get_rtnl</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#idev\">idev</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Join a socket to a group</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#sysctl_igmp_max_memberships\">sysctl_igmp_max_memberships</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = <a class=\"id\" href=\"#IP_MAX_MEMBERSHIPS\">IP_MAX_MEMBERSHIPS</a>;", 
"int <a class=\"id\" href=\"#sysctl_igmp_max_msf\">sysctl_igmp_max_msf</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = <a class=\"id\" href=\"#IP_MAX_MSF\">IP_MAX_MSF</a>;", 
"", 
"", 
"static int <a class=\"id\" href=\"#ip_mc_del1_src\">ip_mc_del1_src</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>, int <a class=\"id\" href=\"#sfmode\">sfmode</a>,", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>, *<a class=\"id\" href=\"#psf_prev\">psf_prev</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rv\">rv</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a> == *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#psf\">psf</a> || <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>] == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* source filter not found, or count wrong =&gt;  bug */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>]--;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>] == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_multicast_event\">ip_rt_multicast_event</a>(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>] && !<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>]) {", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* no more filters for this source */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf_prev\">psf_prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_oldin\">sf_oldin</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    !<a class=\"id\" href=\"#IGMP_V1_SEEN\">IGMP_V1_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) && !<a class=\"id\" href=\"#IGMP_V2_SEEN\">IGMP_V2_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> ? <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IGMP_Unsolicited_Report_Count\">IGMP_Unsolicited_Report_Count</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#psf\">psf</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rv\">rv</a>;", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifndef\">ifndef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#igmp_ifc_event\">igmp_ifc_event</a>(<a class=\"id\" href=\"#x\">x</a>)<span class=\"ts\"/>do { } while (0)", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"static int <a class=\"id\" href=\"#ip_mc_del_src\">ip_mc_del_src</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#pmca\">pmca</a>, int <a class=\"id\" href=\"#sfmode\">sfmode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> int <a class=\"id\" href=\"#sfcount\">sfcount</a>, <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>, int <a class=\"id\" href=\"#delta\">delta</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><a class=\"id\" href=\"#changerec\">changerec</a> = 0;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#pmca\">pmca</a> == <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pmc\">pmc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* MCA not found?? bug */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sf_markstate\">sf_markstate</a>(<a class=\"id\" href=\"#pmc\">pmc</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#delta\">delta</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#out_unlock\">out_unlock</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>]--;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=0; <a class=\"id\" href=\"#i\">i</a>&lt;<a class=\"id\" href=\"#sfcount\">sfcount</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#rv\">rv</a> = <a class=\"id\" href=\"#ip_mc_del1_src\">ip_mc_del1_src</a>(<a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#sfmode\">sfmode</a>, &amp;<a class=\"id\" href=\"#psfsrc\">psfsrc</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#changerec\">changerec</a> |= <a class=\"id\" href=\"#rv\">rv</a> &gt; 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#err\">err</a> && <a class=\"id\" href=\"#rv\">rv</a> &lt; 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#rv\">rv</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] == 0 &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>]) {", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* filter mode change */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> = <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> ? <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IGMP_Unsolicited_Report_Count\">IGMP_Unsolicited_Report_Count</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_count\">mr_ifc_count</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_ifc_event\">igmp_ifc_event</a>(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#sf_setstate\">sf_setstate</a>(<a class=\"id\" href=\"#pmc\">pmc</a>) || <a class=\"id\" href=\"#changerec\">changerec</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_ifc_event\">igmp_ifc_event</a>(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>}", 
"<a class=\"id\" href=\"#out_unlock\">out_unlock</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Add multicast single-source filter to the interface list</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#ip_mc_add1_src\">ip_mc_add1_src</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>, int <a class=\"id\" href=\"#sfmode\">sfmode</a>,", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>, int <a class=\"id\" href=\"#delta\">delta</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>, *<a class=\"id\" href=\"#psf_prev\">psf_prev</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a> == *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#psf\">psf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a> = <a class=\"id\" href=\"#kzalloc\">kzalloc</a>(sizeof(*<a class=\"id\" href=\"#psf\">psf</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#psf\">psf</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a> = *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf_prev\">psf_prev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>]++;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>] == 1) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_multicast_event\">ip_rt_multicast_event</a>(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"static void <a class=\"id\" href=\"#sf_markstate\">sf_markstate</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#mca_xcount\">mca_xcount</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>];", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_oldin\">sf_oldin</a> = <a class=\"id\" href=\"#mca_xcount\">mca_xcount</a> ==", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>!<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_oldin\">sf_oldin</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>] != 0;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#sf_setstate\">sf_setstate</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>, *<a class=\"id\" href=\"#dpsf\">dpsf</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#mca_xcount\">mca_xcount</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>];", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#qrv\">qrv</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#new_in\">new_in</a>, <a class=\"id\" href=\"#rv\">rv</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new_in\">new_in</a> = <a class=\"id\" href=\"#mca_xcount\">mca_xcount</a> == <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>!<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#new_in\">new_in</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>] != 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#new_in\">new_in</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_oldin\">sf_oldin</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#prev\">prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#dpsf\">dpsf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a>; <a class=\"id\" href=\"#dpsf\">dpsf</a>; <a class=\"id\" href=\"#dpsf\">dpsf</a>=<a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a> == <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prev\">prev</a> = <a class=\"id\" href=\"#dpsf\">dpsf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dpsf\">dpsf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#prev\">prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#prev\">prev</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a> = <a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a> = <a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#dpsf\">dpsf</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> = <a class=\"id\" href=\"#qrv\">qrv</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_oldin\">sf_oldin</a>) {", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * add or update \"delete\" records if an active filter</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * is now inactive</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#dpsf\">dpsf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a>; <a class=\"id\" href=\"#dpsf\">dpsf</a>; <a class=\"id\" href=\"#dpsf\">dpsf</a>=<a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a> == <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dpsf\">dpsf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dpsf\">dpsf</a> = <a class=\"id\" href=\"#kmalloc\">kmalloc</a>(sizeof(*<a class=\"id\" href=\"#dpsf\">dpsf</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dpsf\">dpsf</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#dpsf\">dpsf</a> = *<a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* pmc-&gt;lock held by callers */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a> = <a class=\"id\" href=\"#dpsf\">dpsf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dpsf\">dpsf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> = <a class=\"id\" href=\"#qrv\">qrv</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rv\">rv</a>;", 
"}", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Add multicast source filter list to the interface list</span>", 
"<span class=\"comment\"> */</span>", 
"static int <a class=\"id\" href=\"#ip_mc_add_src\">ip_mc_add_src</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#pmca\">pmca</a>, int <a class=\"id\" href=\"#sfmode\">sfmode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> int <a class=\"id\" href=\"#sfcount\">sfcount</a>, <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>, int <a class=\"id\" href=\"#delta\">delta</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><a class=\"id\" href=\"#isexclude\">isexclude</a>;", 
"<span class=\"ts\"/>int<span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (*<a class=\"id\" href=\"#pmca\">pmca</a> == <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pmc\">pmc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* MCA not found?? bug */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#ESRCH\">ESRCH</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sf_markstate\">sf_markstate</a>(<a class=\"id\" href=\"#pmc\">pmc</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#isexclude\">isexclude</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#delta\">delta</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>]++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=0; <a class=\"id\" href=\"#i\">i</a>&lt;<a class=\"id\" href=\"#sfcount\">sfcount</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ip_mc_add1_src\">ip_mc_add1_src</a>(<a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#sfmode\">sfmode</a>, &amp;<a class=\"id\" href=\"#psfsrc\">psfsrc</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#delta\">delta</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#j\">j</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#sfmode\">sfmode</a>]--;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a>=0; <a class=\"id\" href=\"#j\">j</a>&lt;<a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#j\">j</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>(void) <a class=\"id\" href=\"#ip_mc_del1_src\">ip_mc_del1_src</a>(<a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#sfmode\">sfmode</a>, &amp;<a class=\"id\" href=\"#psfsrc\">psfsrc</a>[<a class=\"id\" href=\"#i\">i</a>]);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#isexclude\">isexclude</a> != (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] != 0)) {", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* filter mode change */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> = <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> = <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* else no filters; keep old mode for reports */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> ? <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IGMP_Unsolicited_Report_Count\">IGMP_Unsolicited_Report_Count</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_count\">mr_ifc_count</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_ifc_event\">igmp_ifc_event</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#sf_setstate\">sf_setstate</a>(<a class=\"id\" href=\"#pmc\">pmc</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_ifc_event\">igmp_ifc_event</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ip_mc_clear_src\">ip_mc_clear_src</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>, *<a class=\"id\" href=\"#nextpsf\">nextpsf</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#nextpsf\">nextpsf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nextpsf\">nextpsf</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#psf\">psf</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#nextpsf\">nextpsf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nextpsf\">nextpsf</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#psf\">psf</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> = <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>] = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] = 1;", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Join a multicast group</span>", 
"<span class=\"comment\"> */</span>", 
"int <a class=\"id\" href=\"#ip_mc_join_group\">ip_mc_join_group</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a> , struct <a class=\"id\" href=\"#ip_mreqn\">ip_mreqn</a> *<a class=\"id\" href=\"#imr\">imr</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a> *<a class=\"id\" href=\"#iml\">iml</a> = <a class=\"id\" href=\"#NULL\">NULL</a>, *<a class=\"id\" href=\"#i\">i</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a> = 0;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#ip_mc_find_dev\">ip_mc_find_dev</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#imr\">imr</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EADDRINUSE\">EADDRINUSE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ifindex\">ifindex</a> = <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#i\">i</a> = <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> == <a class=\"id\" href=\"#addr\">addr</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#i\">i</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> == <a class=\"id\" href=\"#ifindex\">ifindex</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#count\">count</a> >= <a class=\"id\" href=\"#sysctl_igmp_max_memberships\">sysctl_igmp_max_memberships</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a> = <a class=\"id\" href=\"#sock_kmalloc\">sock_kmalloc</a>(<a class=\"id\" href=\"#sk\">sk</a>, sizeof(*<a class=\"id\" href=\"#iml\">iml</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#iml\">iml</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(&amp;<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#multi\">multi</a>, <a class=\"id\" href=\"#imr\">imr</a>, sizeof(*<a class=\"id\" href=\"#imr\">imr</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#sflist\">sflist</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> = <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>, <a class=\"id\" href=\"#iml\">iml</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_inc_group\">ip_mc_inc_group</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#addr\">addr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<a class=\"id\" href=\"#done\">done</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ip_mc_join_group\">ip_mc_join_group</a>);", 
"", 
"static void <a class=\"id\" href=\"#ip_sf_socklist_reclaim\">ip_sf_socklist_reclaim</a>(struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> *<a class=\"id\" href=\"#rp\">rp</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_socklist\">ip_sf_socklist</a> *<a class=\"id\" href=\"#psf\">psf</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#rp\">rp</a>, struct <a class=\"id\" href=\"#ip_sf_socklist\">ip_sf_socklist</a>, <a class=\"id\" href=\"#rcu\">rcu</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* sk_omem_alloc should have been decreased by the caller*/</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#psf\">psf</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#ip_mc_leave_src\">ip_mc_leave_src</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a> *<a class=\"id\" href=\"#iml\">iml</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_socklist\">ip_sf_socklist</a> *<a class=\"id\" href=\"#psf\">psf</a> = <a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#sflist\">sflist</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* any-source empty exclude case */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ip_mc_del_src\">ip_mc_del_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a>, 0, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ip_mc_del_src\">ip_mc_del_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a>, <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>, <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#sflist\">sflist</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* decrease mem now to avoid the memleak warning */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#atomic_sub\">atomic_sub</a>(<a class=\"id\" href=\"#IP_SFLSIZE\">IP_SFLSIZE</a>(<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a>), &amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_omem_alloc\">sk_omem_alloc</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#ip_sf_socklist_reclaim\">ip_sf_socklist_reclaim</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"", 
"static void <a class=\"id\" href=\"#ip_mc_socklist_reclaim\">ip_mc_socklist_reclaim</a>(struct <a class=\"id\" href=\"#rcu_head\">rcu_head</a> *<a class=\"id\" href=\"#rp\">rp</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a> *<a class=\"id\" href=\"#iml\">iml</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a> = <a class=\"id\" href=\"#container_of\">container_of</a>(<a class=\"id\" href=\"#rp\">rp</a>, struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a>, <a class=\"id\" href=\"#rcu\">rcu</a>);", 
"<span class=\"ts\"/><span class=\"comment\">/* sk_omem_alloc should have been decreased by the caller*/</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#iml\">iml</a>);", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Ask a socket to leave a group.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"int <a class=\"id\" href=\"#ip_mc_leave_group\">ip_mc_leave_group</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#ip_mreqn\">ip_mreqn</a> *<a class=\"id\" href=\"#imr\">imr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a> *<a class=\"id\" href=\"#iml\">iml</a>, **<a class=\"id\" href=\"#imlp\">imlp</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#group\">group</a> = <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#EADDRNOTAVAIL\">EADDRNOTAVAIL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#ip_mc_find_dev\">ip_mc_find_dev</a>(<a class=\"id\" href=\"#net\">net</a>, <a class=\"id\" href=\"#imr\">imr</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ifindex\">ifindex</a> = <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#imlp\">imlp</a> = &amp;<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; (<a class=\"id\" href=\"#iml\">iml</a> = *<a class=\"id\" href=\"#imlp\">imlp</a>) != <a class=\"id\" href=\"#NULL\">NULL</a>; <a class=\"id\" href=\"#imlp\">imlp</a> = &amp;<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> != <a class=\"id\" href=\"#group\">group</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ifindex\">ifindex</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> != <a class=\"id\" href=\"#ifindex\">ifindex</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (<a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> && <a class=\"id\" href=\"#imr\">imr</a>-><a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> !=", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>(void) <a class=\"id\" href=\"#ip_mc_leave_src\">ip_mc_leave_src</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#iml\">iml</a>, <a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(*<a class=\"id\" href=\"#imlp\">imlp</a>, <a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#next\">next</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_dec_group\">ip_mc_dec_group</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#group\">group</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* decrease mem now to avoid the memleak warning */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_sub\">atomic_sub</a>(sizeof(*<a class=\"id\" href=\"#iml\">iml</a>), &amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_omem_alloc\">sk_omem_alloc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#iml\">iml</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#ip_mc_socklist_reclaim\">ip_mc_socklist_reclaim</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_mc_source\">ip_mc_source</a>(int <a class=\"id\" href=\"#add\">add</a>, int <a class=\"id\" href=\"#omode\">omode</a>, struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_mreq_source\">ip_mreq_source</a> *<a class=\"id\" href=\"#mreqs\">mreqs</a>, int <a class=\"id\" href=\"#ifindex\">ifindex</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mreqn\">ip_mreqn</a> <a class=\"id\" href=\"#imr\">imr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a> *<a class=\"id\" href=\"#pmc\">pmc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_socklist\">ip_sf_socklist</a> *<a class=\"id\" href=\"#psl\">psl</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#leavegroup\">leavegroup</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>, <a class=\"id\" href=\"#j\">j</a>, <a class=\"id\" href=\"#rv\">rv</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_interface\">imr_interface</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> = <a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#ip_mc_find_dev\">ip_mc_find_dev</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#imr\">imr</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EADDRNOTAVAIL\">EADDRNOTAVAIL</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> ==", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a>) &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> == <a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pmc\">pmc</a>) {<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* must have a prior join */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"comment\">/* if a source filter was set, must be the same mode as before */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sflist\">sflist</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> != <a class=\"id\" href=\"#omode\">omode</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> != <a class=\"id\" href=\"#omode\">omode</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* allow mode switches for empty-set filters */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_add_src\">ip_mc_add_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>, <a class=\"id\" href=\"#omode\">omode</a>, 0, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_del_src\">ip_mc_del_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>, <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> = <a class=\"id\" href=\"#omode\">omode</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sflist\">sflist</a>;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#add\">add</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#psl\">psl</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;<span class=\"ts\"/><span class=\"comment\">/* err = -EADDRNOTAVAIL */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a> = !0;", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=0; <a class=\"id\" href=\"#i\">i</a>&lt;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a> = <a class=\"id\" href=\"#memcmp\">memcmp</a>(&amp;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#i\">i</a>], &amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_sourceaddr\">imr_sourceaddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(<a class=\"id\" href=\"#__be32\">__be32</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rv\">rv</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rv\">rv</a>)<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* source not found */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;<span class=\"ts\"/><span class=\"comment\">/* err = -EADDRNOTAVAIL */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* special case - (INCLUDE, empty) == LEAVE_GROUP */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a> == 1 && <a class=\"id\" href=\"#omode\">omode</a> == <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#leavegroup\">leavegroup</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* update the interface filter */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_del_src\">ip_mc_del_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>, <a class=\"id\" href=\"#omode\">omode</a>, 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_sourceaddr\">imr_sourceaddr</a>, 1);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a>=<a class=\"id\" href=\"#i\">i</a>+1; <a class=\"id\" href=\"#j\">j</a>&lt;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>; <a class=\"id\" href=\"#j\">j</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#j\">j</a>-1] = <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#j\">j</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"comment\">/* else, add a new source to the filter */</span>", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#psl\">psl</a> && <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a> >= <a class=\"id\" href=\"#sysctl_igmp_max_msf\">sysctl_igmp_max_msf</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#psl\">psl</a> || <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a> == <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_socklist\">ip_sf_socklist</a> *<a class=\"id\" href=\"#newpsl\">newpsl</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a> = <a class=\"id\" href=\"#IP_SFBLOCK\">IP_SFBLOCK</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psl\">psl</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#count\">count</a> += <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpsl\">newpsl</a> = <a class=\"id\" href=\"#sock_kmalloc\">sock_kmalloc</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#IP_SFLSIZE\">IP_SFLSIZE</a>(<a class=\"id\" href=\"#count\">count</a>), <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#newpsl\">newpsl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a> = <a class=\"id\" href=\"#count\">count</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a> = <a class=\"id\" href=\"#count\">count</a> - <a class=\"id\" href=\"#IP_SFBLOCK\">IP_SFBLOCK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psl\">psl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=0; <a class=\"id\" href=\"#i\">i</a>&lt;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>; <a class=\"id\" href=\"#i\">i</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#i\">i</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* decrease mem now to avoid the memleak warning */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_sub\">atomic_sub</a>(<a class=\"id\" href=\"#IP_SFLSIZE\">IP_SFLSIZE</a>(<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a>), &amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_omem_alloc\">sk_omem_alloc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#ip_sf_socklist_reclaim\">ip_sf_socklist_reclaim</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sflist\">sflist</a>, <a class=\"id\" href=\"#newpsl\">newpsl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a> = <a class=\"id\" href=\"#newpsl\">newpsl</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a> = 1;<span class=\"ts\"/><span class=\"comment\">/* &gt; 0 for insert logic below if sl_count is 0 */</span>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a>=0; <a class=\"id\" href=\"#i\">i</a>&lt;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>; <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rv\">rv</a> = <a class=\"id\" href=\"#memcmp\">memcmp</a>(&amp;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#i\">i</a>], &amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_sourceaddr\">imr_sourceaddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>sizeof(<a class=\"id\" href=\"#__be32\">__be32</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rv\">rv</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rv\">rv</a> == 0)<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* address already there is an error */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#j\">j</a>=<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>-1; <a class=\"id\" href=\"#j\">j</a>>=<a class=\"id\" href=\"#i\">i</a>; <a class=\"id\" href=\"#j\">j</a>--)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#j\">j</a>+1] = <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#j\">j</a>];", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_sourceaddr\">imr_sourceaddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>++;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/><span class=\"comment\">/* update the interface list */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_mc_add_src\">ip_mc_add_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>, <a class=\"id\" href=\"#omode\">omode</a>, 1,", 
"<span class=\"ts\"/><span class=\"ts\"/>&amp;<a class=\"id\" href=\"#mreqs\">mreqs</a>-><a class=\"id\" href=\"#imr_sourceaddr\">imr_sourceaddr</a>, 1);", 
"<a class=\"id\" href=\"#done\">done</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#leavegroup\">leavegroup</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ip_mc_leave_group\">ip_mc_leave_group</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#imr\">imr</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_mc_msfilter\">ip_mc_msfilter</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#ip_msfilter\">ip_msfilter</a> *<a class=\"id\" href=\"#msf\">msf</a>, int <a class=\"id\" href=\"#ifindex\">ifindex</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a> = 0;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mreqn\">ip_mreqn</a><span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a> *<a class=\"id\" href=\"#pmc\">pmc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_socklist\">ip_sf_socklist</a> *<a class=\"id\" href=\"#newpsl\">newpsl</a>, *<a class=\"id\" href=\"#psl\">psl</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#leavegroup\">leavegroup</a> = 0;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_fmode\">imsf_fmode</a> != <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a> &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_fmode\">imsf_fmode</a> != <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_interface\">imsf_interface</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> = <a class=\"id\" href=\"#ifindex\">ifindex</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#ip_mc_find_dev\">ip_mc_find_dev</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#imr\">imr</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* special case - (INCLUDE, empty) == LEAVE_GROUP */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_fmode\">imsf_fmode</a> == <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a> && <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_numsrc\">imsf_numsrc</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#leavegroup\">leavegroup</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> == <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> == <a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pmc\">pmc</a>) {<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* must have a prior join */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_numsrc\">imsf_numsrc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpsl\">newpsl</a> = <a class=\"id\" href=\"#sock_kmalloc\">sock_kmalloc</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#IP_SFLSIZE\">IP_SFLSIZE</a>(<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_numsrc\">imsf_numsrc</a>),", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   <a class=\"id\" href=\"#GFP_KERNEL\">GFP_KERNEL</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#newpsl\">newpsl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENOBUFS\">ENOBUFS</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a> = <a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_numsrc\">imsf_numsrc</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>, <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_slist\">imsf_slist</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_numsrc\">imsf_numsrc</a> * sizeof(<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_slist\">imsf_slist</a>[0]));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ip_mc_add_src\">ip_mc_add_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_fmode\">imsf_fmode</a>, <a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>, <a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#err\">err</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sock_kfree_s\">sock_kfree_s</a>(<a class=\"id\" href=\"#sk\">sk</a>, <a class=\"id\" href=\"#newpsl\">newpsl</a>, <a class=\"id\" href=\"#IP_SFLSIZE\">IP_SFLSIZE</a>(<a class=\"id\" href=\"#newpsl\">newpsl</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#newpsl\">newpsl</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>(void) <a class=\"id\" href=\"#ip_mc_add_src\">ip_mc_add_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_fmode\">imsf_fmode</a>, 0, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sflist\">sflist</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#psl\">psl</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>(void) <a class=\"id\" href=\"#ip_mc_del_src\">ip_mc_del_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>, <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_count\">sl_count</a>, <a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_addr\">sl_addr</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* decrease mem now to avoid the memleak warning */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_sub\">atomic_sub</a>(<a class=\"id\" href=\"#IP_SFLSIZE\">IP_SFLSIZE</a>(<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#sl_max\">sl_max</a>), &amp;<a class=\"id\" href=\"#sk\">sk</a>-><a class=\"id\" href=\"#sk_omem_alloc\">sk_omem_alloc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#call_rcu\">call_rcu</a>(&amp;<a class=\"id\" href=\"#psl\">psl</a>-><a class=\"id\" href=\"#rcu\">rcu</a>, <a class=\"id\" href=\"#ip_sf_socklist_reclaim\">ip_sf_socklist_reclaim</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/>(void) <a class=\"id\" href=\"#ip_mc_del_src\">ip_mc_del_src</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, &amp;<a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>, <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>0, <a class=\"id\" href=\"#NULL\">NULL</a>, 0);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcu_assign_pointer\">rcu_assign_pointer</a>(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sflist\">sflist</a>, <a class=\"id\" href=\"#newpsl\">newpsl</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_fmode\">imsf_fmode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = 0;", 
"<a class=\"id\" href=\"#done\">done</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#leavegroup\">leavegroup</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = <a class=\"id\" href=\"#ip_mc_leave_group\">ip_mc_leave_group</a>(<a class=\"id\" href=\"#sk\">sk</a>, &amp;<a class=\"id\" href=\"#imr\">imr</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#err\">err</a>;", 
"}", 
"", 
"int <a class=\"id\" href=\"#ip_mc_msfget\">ip_mc_msfget</a>(struct <a class=\"id\" href=\"#sock\">sock</a> *<a class=\"id\" href=\"#sk\">sk</a>, struct <a class=\"id\" href=\"#ip_msfilter\">ip_msfilter</a> *<a class=\"id\" href=\"#msf\">msf</a>,", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_msfilter\">ip_msfilter</a> <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#optval\">optval</a>, int <a class=\"id\" href=\"#__user\">__user</a> *<a class=\"id\" href=\"#optlen\">optlen</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>, <a class=\"id\" href=\"#len\">len</a>, <a class=\"id\" href=\"#count\">count</a>, <a class=\"id\" href=\"#copycount\">copycount</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mreqn\">ip_mreqn</a><span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#addr\">addr</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_socklist\">ip_mc_socklist</a> *<a class=\"id\" href=\"#pmc\">pmc</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#inet_sock\">inet_sock</a> *<a class=\"id\" href=\"#inet\">inet</a> = <a class=\"id\" href=\"#inet_sk\">inet_sk</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_socklist\">ip_sf_socklist</a> *<a class=\"id\" href=\"#psl\">psl</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#sock_net\">sock_net</a>(<a class=\"id\" href=\"#sk\">sk</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ipv4_is_multicast\">ipv4_is_multicast</a>(<a class=\"id\" href=\"#addr\">addr</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return -<a class=\"id\" href=\"#EINVAL\">EINVAL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_lock\">rtnl_lock</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_address\">imr_address</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> = <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_interface\">imsf_interface</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a> = <a class=\"id\" href=\"#ip_mc_find_dev\">ip_mc_find_dev</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#imr\">imr</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#in_dev\">in_dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#ENODEV\">ENODEV</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#err\">err</a> = -<a class=\"id\" href=\"#EADDRNOTAVAIL\">EADDRNOTAVAIL</a>;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#inet\">inet</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_multiaddr\">imr_multiaddr</a>.<a class=\"id\" href=\"#s_addr\">s_addr</a> == <a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_multiaddr\">imsf_multiaddr</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multi\">multi</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a> == <a class=\"id\" href=\"#imr\">imr</a>.<a class=\"id\" href=\"#imr_ifindex\">imr_ifindex</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pmc\">pmc</a>)<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* must have a prior join */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#msf\">msf</a>-><a class=\"id\" href=\"#imsf_fmode\">imsf_fmode</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psl\">psl</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sflist\">sflist</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rtnl_unlock\">rtnl_unlock</a>();", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#psl\">psl</a>) {", 
];
xr_frag_insert('l/f3/d9eb7f233272af7f38f9c2c418cb353398e769.xr', __xr_tmp);
