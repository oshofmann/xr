var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * Derived from arch/powerpc/kernel/iommu.c</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Copyright IBM Corporation, 2006-2007</span>", 
"<span class=\"comment\"> * Copyright (C) 2006  Jon Mason &lt;jdmason@kudzu.us&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * Author: Jon Mason &lt;jdmason@kudzu.us&gt;</span>", 
"<span class=\"comment\"> * Author: Muli Ben-Yehuda &lt;muli@il.ibm.com&gt;</span>", 
"<span class=\"comment\"></span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify</span>", 
"<span class=\"comment\"> * it under the terms of the GNU General Public License as published by</span>", 
"<span class=\"comment\"> * the Free Software Foundation; either version 2 of the License, or</span>", 
"<span class=\"comment\"> * (at your option) any later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is distributed in the hope that it will be useful,</span>", 
"<span class=\"comment\"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>", 
"<span class=\"comment\"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>", 
"<span class=\"comment\"> * GNU General Public License for more details.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * You should have received a copy of the GNU General Public License</span>", 
"<span class=\"comment\"> * along with this program; if not, write to the Free Software</span>", 
"<span class=\"comment\"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#spinlock\">spinlock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#crash_dump\">crash_dump</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#dma\">dma</a>-<a class=\"id\" href=\"#mapping\">mapping</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#bitmap\">bitmap</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci_ids\">pci_ids</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci\">pci</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#delay\">delay</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#scatterlist\">scatterlist</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#iommu\">iommu</a>-<a class=\"id\" href=\"#helper\">helper</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#iommu\">iommu</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#calgary\">calgary</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#tce\">tce</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#pci\">pci</a>-<a class=\"id\" href=\"#direct\">direct</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#system\">system</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#dma\">dma</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#rio\">rio</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#bios_ebda\">bios_ebda</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#x86_init\">x86_init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_CALGARY_IOMMU_ENABLED_BY_DEFAULT\">CONFIG_CALGARY_IOMMU_ENABLED_BY_DEFAULT</a>", 
"int <a class=\"id\" href=\"#use_calgary\">use_calgary</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = 1;", 
"#else", 
"int <a class=\"id\" href=\"#use_calgary\">use_calgary</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = 0;", 
"#<a class=\"id\" href=\"#endif\">endif</a> <span class=\"comment\">/* CONFIG_CALGARY_DEFAULT_ENABLED */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PCI_DEVICE_ID_IBM_CALGARY\">PCI_DEVICE_ID_IBM_CALGARY</a> 0x02a1", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PCI_DEVICE_ID_IBM_CALIOC2\">PCI_DEVICE_ID_IBM_CALIOC2</a> 0x0308", 
"", 
"<span class=\"comment\">/* register offsets inside the host bridge space */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CALGARY_CONFIG_REG\">CALGARY_CONFIG_REG</a><span class=\"ts\"/>0x0108", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_CSR_OFFSET\">PHB_CSR_OFFSET</a><span class=\"ts\"/><span class=\"ts\"/>0x0110 <span class=\"comment\">/* Channel Status */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_PLSSR_OFFSET\">PHB_PLSSR_OFFSET</a><span class=\"ts\"/>0x0120", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_CONFIG_RW_OFFSET\">PHB_CONFIG_RW_OFFSET</a><span class=\"ts\"/>0x0160", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_IOBASE_BAR_LOW\">PHB_IOBASE_BAR_LOW</a><span class=\"ts\"/>0x0170", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_IOBASE_BAR_HIGH\">PHB_IOBASE_BAR_HIGH</a><span class=\"ts\"/>0x0180", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_1_LOW\">PHB_MEM_1_LOW</a><span class=\"ts\"/><span class=\"ts\"/>0x0190", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_1_HIGH\">PHB_MEM_1_HIGH</a><span class=\"ts\"/><span class=\"ts\"/>0x01A0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_IO_ADDR_SIZE\">PHB_IO_ADDR_SIZE</a><span class=\"ts\"/>0x01B0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_1_SIZE\">PHB_MEM_1_SIZE</a><span class=\"ts\"/><span class=\"ts\"/>0x01C0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_ST_OFFSET\">PHB_MEM_ST_OFFSET</a><span class=\"ts\"/>0x01D0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_AER_OFFSET\">PHB_AER_OFFSET</a><span class=\"ts\"/><span class=\"ts\"/>0x0200", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_CONFIG_0_HIGH\">PHB_CONFIG_0_HIGH</a><span class=\"ts\"/>0x0220", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_CONFIG_0_LOW\">PHB_CONFIG_0_LOW</a><span class=\"ts\"/>0x0230", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_CONFIG_0_END\">PHB_CONFIG_0_END</a><span class=\"ts\"/>0x0240", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_2_LOW\">PHB_MEM_2_LOW</a><span class=\"ts\"/><span class=\"ts\"/>0x02B0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_2_HIGH\">PHB_MEM_2_HIGH</a><span class=\"ts\"/><span class=\"ts\"/>0x02C0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_2_SIZE_HIGH\">PHB_MEM_2_SIZE_HIGH</a><span class=\"ts\"/>0x02D0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM_2_SIZE_LOW\">PHB_MEM_2_SIZE_LOW</a><span class=\"ts\"/>0x02E0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_DOSHOLE_OFFSET\">PHB_DOSHOLE_OFFSET</a><span class=\"ts\"/>0x08E0", 
"", 
"<span class=\"comment\">/* CalIOC2 specific */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_SAVIOR_L2\">PHB_SAVIOR_L2</a><span class=\"ts\"/><span class=\"ts\"/>0x0DB0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_PAGE_MIG_CTRL\">PHB_PAGE_MIG_CTRL</a><span class=\"ts\"/>0x0DA8", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_PAGE_MIG_DEBUG\">PHB_PAGE_MIG_DEBUG</a><span class=\"ts\"/>0x0DA0", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_ROOT_COMPLEX_STATUS\">PHB_ROOT_COMPLEX_STATUS</a> 0x0CB0", 
"", 
"<span class=\"comment\">/* PHB_CONFIG_RW */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_TCE_ENABLE\">PHB_TCE_ENABLE</a><span class=\"ts\"/><span class=\"ts\"/>0x20000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_SLOT_DISABLE\">PHB_SLOT_DISABLE</a><span class=\"ts\"/>0x1C000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_DAC_DISABLE\">PHB_DAC_DISABLE</a><span class=\"ts\"/><span class=\"ts\"/>0x01000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MEM2_ENABLE\">PHB_MEM2_ENABLE</a><span class=\"ts\"/><span class=\"ts\"/>0x00400000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_MCSR_ENABLE\">PHB_MCSR_ENABLE</a><span class=\"ts\"/><span class=\"ts\"/>0x00100000", 
"<span class=\"comment\">/* TAR (Table Address Register) */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TAR_SW_BITS\">TAR_SW_BITS</a><span class=\"ts\"/><span class=\"ts\"/>0x0000ffffffff800fUL", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#TAR_VALID\">TAR_VALID</a><span class=\"ts\"/><span class=\"ts\"/>0x0000000000000008UL", 
"<span class=\"comment\">/* CSR (Channel/DMA Status Register) */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CSR_AGENT_MASK\">CSR_AGENT_MASK</a><span class=\"ts\"/><span class=\"ts\"/>0xffe0ffff", 
"<span class=\"comment\">/* CCR (Calgary Configuration Register) */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#CCR_2SEC_TIMEOUT\">CCR_2SEC_TIMEOUT</a><span class=\"ts\"/>0x000000000000000EUL", 
"<span class=\"comment\">/* PMCR/PMDR (Page Migration Control/Debug Registers */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PMR_SOFTSTOP\">PMR_SOFTSTOP</a><span class=\"ts\"/><span class=\"ts\"/>0x80000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PMR_SOFTSTOPFAULT\">PMR_SOFTSTOPFAULT</a><span class=\"ts\"/>0x40000000", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PMR_HARDSTOP\">PMR_HARDSTOP</a><span class=\"ts\"/><span class=\"ts\"/>0x20000000", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * The maximum PHB bus number.</span>", 
"<span class=\"comment\"> * x3950M2 (rare): 8 chassis, 48 PHBs per chassis = 384</span>", 
"<span class=\"comment\"> * x3950M2: 4 chassis, 48 PHBs per chassis        = 192</span>", 
"<span class=\"comment\"> * x3950 (PCIE): 8 chassis, 32 PHBs per chassis   = 256</span>", 
"<span class=\"comment\"> * x3950 (PCIX): 8 chassis, 16 PHBs per chassis   = 128</span>", 
"<span class=\"comment\"> */</span>", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#MAX_PHB_BUS_NUM\">MAX_PHB_BUS_NUM</a><span class=\"ts\"/><span class=\"ts\"/>256", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHBS_PER_CALGARY\">PHBS_PER_CALGARY</a><span class=\"ts\"/>  4", 
"", 
"<span class=\"comment\">/* register offsets in Calgary's internal register space */</span>", 
"static const unsigned long <a class=\"id\" href=\"#tar_offsets\">tar_offsets</a>[] = {", 
"<span class=\"ts\"/>0x0580 <span class=\"comment\">/* TAR0 */</span>,", 
"<span class=\"ts\"/>0x0588 <span class=\"comment\">/* TAR1 */</span>,", 
"<span class=\"ts\"/>0x0590 <span class=\"comment\">/* TAR2 */</span>,", 
"<span class=\"ts\"/>0x0598 <span class=\"comment\">/* TAR3 */</span>", 
"};", 
"", 
"static const unsigned long <a class=\"id\" href=\"#split_queue_offsets\">split_queue_offsets</a>[] = {", 
"<span class=\"ts\"/>0x4870 <span class=\"comment\">/* SPLIT QUEUE 0 */</span>,", 
"<span class=\"ts\"/>0x5870 <span class=\"comment\">/* SPLIT QUEUE 1 */</span>,", 
"<span class=\"ts\"/>0x6870 <span class=\"comment\">/* SPLIT QUEUE 2 */</span>,", 
"<span class=\"ts\"/>0x7870 <span class=\"comment\">/* SPLIT QUEUE 3 */</span>", 
"};", 
"", 
"static const unsigned long <a class=\"id\" href=\"#phb_offsets\">phb_offsets</a>[] = {", 
"<span class=\"ts\"/>0x8000 <span class=\"comment\">/* PHB0 */</span>,", 
"<span class=\"ts\"/>0x9000 <span class=\"comment\">/* PHB1 */</span>,", 
"<span class=\"ts\"/>0xA000 <span class=\"comment\">/* PHB2 */</span>,", 
"<span class=\"ts\"/>0xB000 <span class=\"comment\">/* PHB3 */</span>", 
"};", 
"", 
"<span class=\"comment\">/* PHB debug registers */</span>", 
"", 
"static const unsigned long <a class=\"id\" href=\"#phb_debug_offsets\">phb_debug_offsets</a>[] = {", 
"<span class=\"ts\"/>0x4000<span class=\"ts\"/><span class=\"comment\">/* PHB 0 DEBUG */</span>,", 
"<span class=\"ts\"/>0x5000<span class=\"ts\"/><span class=\"comment\">/* PHB 1 DEBUG */</span>,", 
"<span class=\"ts\"/>0x6000<span class=\"ts\"/><span class=\"comment\">/* PHB 2 DEBUG */</span>,", 
"<span class=\"ts\"/>0x7000<span class=\"ts\"/><span class=\"comment\">/* PHB 3 DEBUG */</span>", 
"};", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * STUFF register for each debug PHB,</span>", 
"<span class=\"comment\"> * byte 1 = start bus number, byte 2 = end bus number</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#PHB_DEBUG_STUFF_OFFSET\">PHB_DEBUG_STUFF_OFFSET</a><span class=\"ts\"/>0x0020", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#EMERGENCY_PAGES\">EMERGENCY_PAGES</a> 32 <span class=\"comment\">/* = 128KB */</span>", 
"", 
"unsigned int <a class=\"id\" href=\"#specified_table_size\">specified_table_size</a> = <a class=\"id\" href=\"#TCE_TABLE_SIZE_UNSPECIFIED\">TCE_TABLE_SIZE_UNSPECIFIED</a>;", 
"static int <a class=\"id\" href=\"#translate_empty_slots\">translate_empty_slots</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = 0;", 
"static int <a class=\"id\" href=\"#calgary_detected\">calgary_detected</a> <a class=\"id\" href=\"#__read_mostly\">__read_mostly</a> = 0;", 
"", 
"static struct <a class=\"id\" href=\"#rio_table_hdr\">rio_table_hdr</a><span class=\"ts\"/>*<a class=\"id\" href=\"#rio_table_hdr\">rio_table_hdr</a> <a class=\"id\" href=\"#__initdata\">__initdata</a>;", 
"static struct <a class=\"id\" href=\"#scal_detail\">scal_detail</a><span class=\"ts\"/>*<a class=\"id\" href=\"#scal_devs\">scal_devs</a>[<a class=\"id\" href=\"#MAX_NUMNODES\">MAX_NUMNODES</a>] <a class=\"id\" href=\"#__initdata\">__initdata</a>;", 
"static struct <a class=\"id\" href=\"#rio_detail\">rio_detail</a><span class=\"ts\"/>*<a class=\"id\" href=\"#rio_devs\">rio_devs</a>[<a class=\"id\" href=\"#MAX_NUMNODES\">MAX_NUMNODES</a> * 4] <a class=\"id\" href=\"#__initdata\">__initdata</a>;", 
"", 
"struct <a class=\"id\" href=\"#calgary_bus_info\">calgary_bus_info</a> {", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#tce_space\">tce_space</a>;", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#translation_disabled\">translation_disabled</a>;", 
"<span class=\"ts\"/>signed char <a class=\"id\" href=\"#phbid\">phbid</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a>;", 
"};", 
"", 
"static void <a class=\"id\" href=\"#calgary_handle_quirks\">calgary_handle_quirks</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>, struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>);", 
"static void <a class=\"id\" href=\"#calgary_tce_cache_blast\">calgary_tce_cache_blast</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"static void <a class=\"id\" href=\"#calgary_dump_error_regs\">calgary_dump_error_regs</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"static void <a class=\"id\" href=\"#calioc2_handle_quirks\">calioc2_handle_quirks</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>, struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>);", 
"static void <a class=\"id\" href=\"#calioc2_tce_cache_blast\">calioc2_tce_cache_blast</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"static void <a class=\"id\" href=\"#calioc2_dump_error_regs\">calioc2_dump_error_regs</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"static void <a class=\"id\" href=\"#calgary_init_bitmap_from_tce_table\">calgary_init_bitmap_from_tce_table</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"static void <a class=\"id\" href=\"#get_tce_space_from_tar\">get_tce_space_from_tar</a>(void);", 
"", 
"static struct <a class=\"id\" href=\"#cal_chipset_ops\">cal_chipset_ops</a> <a class=\"id\" href=\"#calgary_chip_ops\">calgary_chip_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#handle_quirks\">handle_quirks</a> = <a class=\"id\" href=\"#calgary_handle_quirks\">calgary_handle_quirks</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#tce_cache_blast\">tce_cache_blast</a> = <a class=\"id\" href=\"#calgary_tce_cache_blast\">calgary_tce_cache_blast</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dump_error_regs\">dump_error_regs</a> = <a class=\"id\" href=\"#calgary_dump_error_regs\">calgary_dump_error_regs</a>", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#cal_chipset_ops\">cal_chipset_ops</a> <a class=\"id\" href=\"#calioc2_chip_ops\">calioc2_chip_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#handle_quirks\">handle_quirks</a> = <a class=\"id\" href=\"#calioc2_handle_quirks\">calioc2_handle_quirks</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#tce_cache_blast\">tce_cache_blast</a> = <a class=\"id\" href=\"#calioc2_tce_cache_blast\">calioc2_tce_cache_blast</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#dump_error_regs\">dump_error_regs</a> = <a class=\"id\" href=\"#calioc2_dump_error_regs\">calioc2_dump_error_regs</a>", 
"};", 
"", 
"static struct <a class=\"id\" href=\"#calgary_bus_info\">calgary_bus_info</a> <a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#MAX_PHB_BUS_NUM\">MAX_PHB_BUS_NUM</a>] = { { <a class=\"id\" href=\"#NULL\">NULL</a>, 0, 0 }, };", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#translation_enabled\">translation_enabled</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/* only PHBs with translation enabled have an IOMMU table */</span>", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#tbl\">tbl</a> != <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#iommu_range_reserve\">iommu_range_reserve</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>,", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#start_addr\">start_addr</a>, unsigned int <a class=\"id\" href=\"#npages\">npages</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#index\">index</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#end\">end</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#index\">index</a> = <a class=\"id\" href=\"#start_addr\">start_addr</a> >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* bail out if we're asked to reserve a region we don't cover */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#index\">index</a> >= <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#end\">end</a> = <a class=\"id\" href=\"#index\">index</a> + <a class=\"id\" href=\"#npages\">npages</a>;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#end\">end</a> &gt; <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>) <span class=\"comment\">/* don't go off the table */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#end\">end</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_lock\">it_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bitmap_set\">bitmap_set</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_map\">it_map</a>, <a class=\"id\" href=\"#index\">index</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_lock\">it_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"", 
"static unsigned long <a class=\"id\" href=\"#iommu_range_alloc\">iommu_range_alloc</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       unsigned int <a class=\"id\" href=\"#npages\">npages</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#boundary_size\">boundary_size</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#boundary_size\">boundary_size</a> = <a class=\"id\" href=\"#ALIGN\">ALIGN</a>(<a class=\"id\" href=\"#dma_get_seg_boundary\">dma_get_seg_boundary</a>(<a class=\"id\" href=\"#dev\">dev</a>) + 1,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>) >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#npages\">npages</a> == 0);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_lock\">it_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#iommu_area_alloc\">iommu_area_alloc</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_map\">it_map</a>, <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>, <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_hint\">it_hint</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#npages\">npages</a>, 0, <a class=\"id\" href=\"#boundary_size\">boundary_size</a>, 0);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#offset\">offset</a> == ~0UL) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#chip_ops\">chip_ops</a>-><a class=\"id\" href=\"#tce_cache_blast\">tce_cache_blast</a>(<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#iommu_area_alloc\">iommu_area_alloc</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_map\">it_map</a>, <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>, 0,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#npages\">npages</a>, 0, <a class=\"id\" href=\"#boundary_size\">boundary_size</a>, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#offset\">offset</a> == ~0UL) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"Calgary: IOMMU full.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_lock\">it_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#panic_on_overflow\">panic_on_overflow</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#panic\">panic</a>(\"Calgary: fix the allocator.\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_hint\">it_hint</a> = <a class=\"id\" href=\"#offset\">offset</a> + <a class=\"id\" href=\"#npages\">npages</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_hint\">it_hint</a> &gt; <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_lock\">it_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#offset\">offset</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#iommu_alloc\">iommu_alloc</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>      void *<a class=\"id\" href=\"#vaddr\">vaddr</a>, unsigned int <a class=\"id\" href=\"#npages\">npages</a>, int <a class=\"id\" href=\"#direction\">direction</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#iommu_range_alloc\">iommu_range_alloc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>(<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"Calgary: failed to allocate %u pages in \"", 
"<span class=\"ts\"/><span class=\"ts\"/>       \"iommu %p\\n\", <a class=\"id\" href=\"#npages\">npages</a>, <a class=\"id\" href=\"#tbl\">tbl</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* set the return dma address */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = (<a class=\"id\" href=\"#entry\">entry</a> << <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>) | ((unsigned long)<a class=\"id\" href=\"#vaddr\">vaddr</a> &amp; ~<a class=\"id\" href=\"#PAGE_MASK\">PAGE_MASK</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* put the TCEs in the HW table */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tce_build\">tce_build</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#npages\">npages</a>, (unsigned long)<a class=\"id\" href=\"#vaddr\">vaddr</a> &amp; <a class=\"id\" href=\"#PAGE_MASK\">PAGE_MASK</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#direction\">direction</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#iommu_free\">iommu_free</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#dma_addr\">dma_addr</a>,", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#badend\">badend</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#flags\">flags</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* were we called with bad_dma_address? */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#badend\">badend</a> = <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a> + (<a class=\"id\" href=\"#EMERGENCY_PAGES\">EMERGENCY_PAGES</a> * <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#unlikely\">unlikely</a>((<a class=\"id\" href=\"#dma_addr\">dma_addr</a> >= <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>) && (<a class=\"id\" href=\"#dma_addr\">dma_addr</a> &lt; <a class=\"id\" href=\"#badend\">badend</a>))) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#WARN\">WARN</a>(1, <a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"Calgary: driver tried unmapping bad DMA \"", 
"<span class=\"ts\"/><span class=\"ts\"/>       \"address 0x%Lx\\n\", <a class=\"id\" href=\"#dma_addr\">dma_addr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#dma_addr\">dma_addr</a> >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#entry\">entry</a> + <a class=\"id\" href=\"#npages\">npages</a> &gt; <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tce_free\">tce_free</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_irqsave\">spin_lock_irqsave</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_lock\">it_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bitmap_clear\">bitmap_clear</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_map\">it_map</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_irqrestore\">spin_unlock_irqrestore</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_lock\">it_lock</a>, <a class=\"id\" href=\"#flags\">flags</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#pdev\">pdev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_bus\">pci_bus</a> *<a class=\"id\" href=\"#pbus\">pbus</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pdev\">pdev</a> = <a class=\"id\" href=\"#to_pci_dev\">to_pci_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* search up the device tree for an iommu */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pbus\">pbus</a> = <a class=\"id\" href=\"#pdev\">pdev</a>-><a class=\"id\" href=\"#bus\">bus</a>;", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#pbus\">pbus</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tbl\">tbl</a> && <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a> == <a class=\"id\" href=\"#pbus\">pbus</a>-><a class=\"id\" href=\"#number\">number</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pbus\">pbus</a> = <a class=\"id\" href=\"#pbus\">pbus</a>-><a class=\"id\" href=\"#parent\">parent</a>;", 
"<span class=\"ts\"/>} while (<a class=\"id\" href=\"#pbus\">pbus</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#tbl\">tbl</a> && (<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a> != <a class=\"id\" href=\"#pbus\">pbus</a>-><a class=\"id\" href=\"#number\">number</a>));", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tbl\">tbl</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calgary_unmap_sg\">calgary_unmap_sg</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#sglist\">sglist</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     int <a class=\"id\" href=\"#nelems\">nelems</a>,enum <a class=\"id\" href=\"#dma_data_direction\">dma_data_direction</a> <a class=\"id\" href=\"#dir\">dir</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     struct <a class=\"id\" href=\"#dma_attrs\">dma_attrs</a> *<a class=\"id\" href=\"#attrs\">attrs</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#s\">s</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#translation_enabled\">translation_enabled</a>(<a class=\"id\" href=\"#tbl\">tbl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#for_each_sg\">for_each_sg</a>(<a class=\"id\" href=\"#sglist\">sglist</a>, <a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#nelems\">nelems</a>, <a class=\"id\" href=\"#i\">i</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#dma\">dma</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#dma_address\">dma_address</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#dmalen\">dmalen</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#dma_length\">dma_length</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dmalen\">dmalen</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = <a class=\"id\" href=\"#iommu_num_pages\">iommu_num_pages</a>(<a class=\"id\" href=\"#dma\">dma</a>, <a class=\"id\" href=\"#dmalen\">dmalen</a>, <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iommu_free\">iommu_free</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#dma\">dma</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static int <a class=\"id\" href=\"#calgary_map_sg\">calgary_map_sg</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#sg\">sg</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  int <a class=\"id\" href=\"#nelems\">nelems</a>, enum <a class=\"id\" href=\"#dma_data_direction\">dma_data_direction</a> <a class=\"id\" href=\"#dir\">dir</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  struct <a class=\"id\" href=\"#dma_attrs\">dma_attrs</a> *<a class=\"id\" href=\"#attrs\">attrs</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#s\">s</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#vaddr\">vaddr</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#entry\">entry</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#for_each_sg\">for_each_sg</a>(<a class=\"id\" href=\"#sg\">sg</a>, <a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#nelems\">nelems</a>, <a class=\"id\" href=\"#i\">i</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(!<a class=\"id\" href=\"#sg_page\">sg_page</a>(<a class=\"id\" href=\"#s\">s</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#vaddr\">vaddr</a> = (unsigned long) <a class=\"id\" href=\"#sg_virt\">sg_virt</a>(<a class=\"id\" href=\"#s\">s</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = <a class=\"id\" href=\"#iommu_num_pages\">iommu_num_pages</a>(<a class=\"id\" href=\"#vaddr\">vaddr</a>, <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#length\">length</a>, <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#entry\">entry</a> = <a class=\"id\" href=\"#iommu_range_alloc\">iommu_range_alloc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#entry\">entry</a> == <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* makes sure unmap knows to stop */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#dma_length\">dma_length</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#dma_address\">dma_address</a> = (<a class=\"id\" href=\"#entry\">entry</a> << <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>) | <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#offset\">offset</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* insert into HW table */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tce_build\">tce_build</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#entry\">entry</a>, <a class=\"id\" href=\"#npages\">npages</a>, <a class=\"id\" href=\"#vaddr\">vaddr</a> &amp; <a class=\"id\" href=\"#PAGE_MASK\">PAGE_MASK</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#dma_length\">dma_length</a> = <a class=\"id\" href=\"#s\">s</a>-><a class=\"id\" href=\"#length\">length</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#nelems\">nelems</a>;", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#calgary_unmap_sg\">calgary_unmap_sg</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#sg\">sg</a>, <a class=\"id\" href=\"#nelems\">nelems</a>, <a class=\"id\" href=\"#dir\">dir</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#for_each_sg\">for_each_sg</a>(<a class=\"id\" href=\"#sg\">sg</a>, <a class=\"id\" href=\"#s\">s</a>, <a class=\"id\" href=\"#nelems\">nelems</a>, <a class=\"id\" href=\"#i\">i</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sg\">sg</a>-><a class=\"id\" href=\"#dma_address\">dma_address</a> = <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#sg\">sg</a>-><a class=\"id\" href=\"#dma_length\">dma_length</a> = 0;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static <a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#calgary_map_page\">calgary_map_page</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, struct <a class=\"id\" href=\"#page\">page</a> *<a class=\"id\" href=\"#page\">page</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   unsigned long <a class=\"id\" href=\"#offset\">offset</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   enum <a class=\"id\" href=\"#dma_data_direction\">dma_data_direction</a> <a class=\"id\" href=\"#dir\">dir</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>   struct <a class=\"id\" href=\"#dma_attrs\">dma_attrs</a> *<a class=\"id\" href=\"#attrs\">attrs</a>)", 
"{", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#vaddr\">vaddr</a> = <a class=\"id\" href=\"#page_address\">page_address</a>(<a class=\"id\" href=\"#page\">page</a>) + <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#uaddr\">uaddr</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#uaddr\">uaddr</a> = (unsigned long)<a class=\"id\" href=\"#vaddr\">vaddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = <a class=\"id\" href=\"#iommu_num_pages\">iommu_num_pages</a>(<a class=\"id\" href=\"#uaddr\">uaddr</a>, <a class=\"id\" href=\"#size\">size</a>, <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#iommu_alloc\">iommu_alloc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#vaddr\">vaddr</a>, <a class=\"id\" href=\"#npages\">npages</a>, <a class=\"id\" href=\"#dir\">dir</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calgary_unmap_page\">calgary_unmap_page</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#dma_addr\">dma_addr</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>, enum <a class=\"id\" href=\"#dma_data_direction\">dma_data_direction</a> <a class=\"id\" href=\"#dir\">dir</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       struct <a class=\"id\" href=\"#dma_attrs\">dma_attrs</a> *<a class=\"id\" href=\"#attrs\">attrs</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = <a class=\"id\" href=\"#iommu_num_pages\">iommu_num_pages</a>(<a class=\"id\" href=\"#dma_addr\">dma_addr</a>, <a class=\"id\" href=\"#size\">size</a>, <a class=\"id\" href=\"#PAGE_SIZE\">PAGE_SIZE</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iommu_free\">iommu_free</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#dma_addr\">dma_addr</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"}", 
"", 
"static void* <a class=\"id\" href=\"#calgary_alloc_coherent\">calgary_alloc_coherent</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>,", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> *<a class=\"id\" href=\"#dma_handle\">dma_handle</a>, <a class=\"id\" href=\"#gfp_t\">gfp_t</a> <a class=\"id\" href=\"#flag\">flag</a>)", 
"{", 
"<span class=\"ts\"/>void *<a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#mapping\">mapping</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>, <a class=\"id\" href=\"#order\">order</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size\">size</a> = <a class=\"id\" href=\"#PAGE_ALIGN\">PAGE_ALIGN</a>(<a class=\"id\" href=\"#size\">size</a>); <span class=\"comment\">/* size rounded up to full pages */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = <a class=\"id\" href=\"#size\">size</a> >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#order\">order</a> = <a class=\"id\" href=\"#get_order\">get_order</a>(<a class=\"id\" href=\"#size\">size</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#flag\">flag</a> &= ~(<a class=\"id\" href=\"#__GFP_DMA\">__GFP_DMA</a> | <a class=\"id\" href=\"#__GFP_HIGHMEM\">__GFP_HIGHMEM</a> | <a class=\"id\" href=\"#__GFP_DMA32\">__GFP_DMA32</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* alloc enough pages (and possibly more) */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = (void *)<a class=\"id\" href=\"#__get_free_pages\">__get_free_pages</a>(<a class=\"id\" href=\"#flag\">flag</a>, <a class=\"id\" href=\"#order\">order</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(<a class=\"id\" href=\"#ret\">ret</a>, 0, <a class=\"id\" href=\"#size\">size</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* set up tces to cover the allocated range */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mapping\">mapping</a> = <a class=\"id\" href=\"#iommu_alloc\">iommu_alloc</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#ret\">ret</a>, <a class=\"id\" href=\"#npages\">npages</a>, <a class=\"id\" href=\"#DMA_BIDIRECTIONAL\">DMA_BIDIRECTIONAL</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#mapping\">mapping</a> == <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#free\">free</a>;", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#dma_handle\">dma_handle</a> = <a class=\"id\" href=\"#mapping\">mapping</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"<a class=\"id\" href=\"#free\">free</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_pages\">free_pages</a>((unsigned long)<a class=\"id\" href=\"#ret\">ret</a>, <a class=\"id\" href=\"#get_order\">get_order</a>(<a class=\"id\" href=\"#size\">size</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calgary_free_coherent\">calgary_free_coherent</a>(struct <a class=\"id\" href=\"#device\">device</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#size\">size</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  void *<a class=\"id\" href=\"#vaddr\">vaddr</a>, <a class=\"id\" href=\"#dma_addr_t\">dma_addr_t</a> <a class=\"id\" href=\"#dma_handle\">dma_handle</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size\">size</a> = <a class=\"id\" href=\"#PAGE_ALIGN\">PAGE_ALIGN</a>(<a class=\"id\" href=\"#size\">size</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = <a class=\"id\" href=\"#size\">size</a> >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iommu_free\">iommu_free</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#dma_handle\">dma_handle</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_pages\">free_pages</a>((unsigned long)<a class=\"id\" href=\"#vaddr\">vaddr</a>, <a class=\"id\" href=\"#get_order\">get_order</a>(<a class=\"id\" href=\"#size\">size</a>));", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#dma_map_ops\">dma_map_ops</a> <a class=\"id\" href=\"#calgary_dma_ops\">calgary_dma_ops</a> = {", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#alloc_coherent\">alloc_coherent</a> = <a class=\"id\" href=\"#calgary_alloc_coherent\">calgary_alloc_coherent</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#free_coherent\">free_coherent</a> = <a class=\"id\" href=\"#calgary_free_coherent\">calgary_free_coherent</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#map_sg\">map_sg</a> = <a class=\"id\" href=\"#calgary_map_sg\">calgary_map_sg</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#unmap_sg\">unmap_sg</a> = <a class=\"id\" href=\"#calgary_unmap_sg\">calgary_unmap_sg</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#map_page\">map_page</a> = <a class=\"id\" href=\"#calgary_map_page\">calgary_map_page</a>,", 
"<span class=\"ts\"/>.<a class=\"id\" href=\"#unmap_page\">unmap_page</a> = <a class=\"id\" href=\"#calgary_unmap_page\">calgary_unmap_page</a>,", 
"};", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#__iomem\">__iomem</a> * <a class=\"id\" href=\"#busno_to_bbar\">busno_to_bbar</a>(unsigned char <a class=\"id\" href=\"#num\">num</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#num\">num</a>].<a class=\"id\" href=\"#bbar\">bbar</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#busno_to_phbid\">busno_to_phbid</a>(unsigned char <a class=\"id\" href=\"#num\">num</a>)", 
"{", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#num\">num</a>].<a class=\"id\" href=\"#phbid\">phbid</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned long <a class=\"id\" href=\"#split_queue_offset\">split_queue_offset</a>(unsigned char <a class=\"id\" href=\"#num\">num</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#busno_to_phbid\">busno_to_phbid</a>(<a class=\"id\" href=\"#num\">num</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#split_queue_offsets\">split_queue_offsets</a>[<a class=\"id\" href=\"#idx\">idx</a>];", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned long <a class=\"id\" href=\"#tar_offset\">tar_offset</a>(unsigned char <a class=\"id\" href=\"#num\">num</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#busno_to_phbid\">busno_to_phbid</a>(<a class=\"id\" href=\"#num\">num</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#tar_offsets\">tar_offsets</a>[<a class=\"id\" href=\"#idx\">idx</a>];", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> unsigned long <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(unsigned char <a class=\"id\" href=\"#num\">num</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#size_t\">size_t</a> <a class=\"id\" href=\"#idx\">idx</a> = <a class=\"id\" href=\"#busno_to_phbid\">busno_to_phbid</a>(<a class=\"id\" href=\"#num\">num</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#phb_offsets\">phb_offsets</a>[<a class=\"id\" href=\"#idx\">idx</a>];", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> void <a class=\"id\" href=\"#__iomem\">__iomem</a>* <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bar\">bar</a>, unsigned long <a class=\"id\" href=\"#offset\">offset</a>)", 
"{", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#target\">target</a> = ((unsigned long)<a class=\"id\" href=\"#bar\">bar</a>) | <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/>return (void <a class=\"id\" href=\"#__iomem\">__iomem</a>*)<a class=\"id\" href=\"#target\">target</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#is_calioc2\">is_calioc2</a>(unsigned short <a class=\"id\" href=\"#device\">device</a>)", 
"{", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#device\">device</a> == <a class=\"id\" href=\"#PCI_DEVICE_ID_IBM_CALIOC2\">PCI_DEVICE_ID_IBM_CALIOC2</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#is_calgary\">is_calgary</a>(unsigned short <a class=\"id\" href=\"#device\">device</a>)", 
"{", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#device\">device</a> == <a class=\"id\" href=\"#PCI_DEVICE_ID_IBM_CALGARY\">PCI_DEVICE_ID_IBM_CALGARY</a>);", 
"}", 
"", 
"static <a class=\"id\" href=\"#inline\">inline</a> int <a class=\"id\" href=\"#is_cal_pci_dev\">is_cal_pci_dev</a>(unsigned short <a class=\"id\" href=\"#device\">device</a>)", 
"{", 
"<span class=\"ts\"/>return (<a class=\"id\" href=\"#is_calgary\">is_calgary</a>(<a class=\"id\" href=\"#device\">device</a>) || <a class=\"id\" href=\"#is_calioc2\">is_calioc2</a>(<a class=\"id\" href=\"#device\">device</a>));", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calgary_tce_cache_blast\">calgary_tce_cache_blast</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val\">val</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#aer\">aer</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a> = 0;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* disable arbitration on the bus */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>) | <a class=\"id\" href=\"#PHB_AER_OFFSET\">PHB_AER_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#aer\">aer</a> = <a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(0, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* read plssr to ensure it got there */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>) | <a class=\"id\" href=\"#PHB_PLSSR_OFFSET\">PHB_PLSSR_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* poll split queues until all DMA activity is done */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#split_queue_offset\">split_queue_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>));", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>++;", 
"<span class=\"ts\"/>} while ((<a class=\"id\" href=\"#val\">val</a> &amp; 0xff) != 0xff && <a class=\"id\" href=\"#i\">i</a> &lt; 100);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> == 100)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"Calgary: PCI bus not quiesced, \"", 
"<span class=\"ts\"/><span class=\"ts\"/>       \"continuing anyway\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* invalidate TCE cache */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#tar_offset\">tar_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writeq\">writeq</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#tar_val\">tar_val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* enable arbitration */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>) | <a class=\"id\" href=\"#PHB_AER_OFFSET\">PHB_AER_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(<a class=\"id\" href=\"#aer\">aer</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/>(void)<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>); <span class=\"comment\">/* flush */</span>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calioc2_tce_cache_blast\">calioc2_tce_cache_blast</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>)", 
"{", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val64\">val64</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#val\">val</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a> = 0;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#count\">count</a> = 1;", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#bus\">bus</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>;", 
"", 
"<a class=\"id\" href=\"#begin\">begin</a>:", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"Calgary: CalIOC2 bus 0x%x entering tce cache blast \"", 
"<span class=\"ts\"/>       \"sequence - count %d\\n\", <a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#count\">count</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 1. using the Page Migration Control reg set SoftStop */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>) | <a class=\"id\" href=\"#PHB_PAGE_MIG_CTRL\">PHB_PAGE_MIG_CTRL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"1a. read 0x%x [LE] from %p\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> |= <a class=\"id\" href=\"#PMR_SOFTSTOP\">PMR_SOFTSTOP</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"1b. writing 0x%x [LE] to %p\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(<a class=\"id\" href=\"#cpu_to_be32\">cpu_to_be32</a>(<a class=\"id\" href=\"#val\">val</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 2. poll split queues until all DMA activity is done */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"2a. starting to poll split queues\\n\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#split_queue_offset\">split_queue_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>));", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> = <a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#i\">i</a>++;", 
"<span class=\"ts\"/>} while ((<a class=\"id\" href=\"#val64\">val64</a> &amp; 0xff) != 0xff && <a class=\"id\" href=\"#i\">i</a> &lt; 100);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#i\">i</a> == 100)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"CalIOC2: PCI bus not quiesced, \"", 
"<span class=\"ts\"/><span class=\"ts\"/>       \"continuing anyway\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 3. poll Page Migration DEBUG for SoftStopFault */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>) | <a class=\"id\" href=\"#PHB_PAGE_MIG_DEBUG\">PHB_PAGE_MIG_DEBUG</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"3. read 0x%x [LE] from %p\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 4. if SoftStopFault - goto (1) */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#val\">val</a> &amp; <a class=\"id\" href=\"#PMR_SOFTSTOPFAULT\">PMR_SOFTSTOPFAULT</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (++<a class=\"id\" href=\"#count\">count</a> &lt; 100)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#begin\">begin</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"CalIOC2: too many SoftStopFaults, \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       \"aborting TCE cache flush sequence!\\n\");", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return; <span class=\"comment\">/* pray for the best */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 5. Slam into HardStop by reading PHB_PAGE_MIG_CTRL */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>) | <a class=\"id\" href=\"#PHB_PAGE_MIG_CTRL\">PHB_PAGE_MIG_CTRL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"5a. slamming into HardStop by reading %p\\n\", <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"5b. read 0x%x [LE] from %p\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>) | <a class=\"id\" href=\"#PHB_PAGE_MIG_DEBUG\">PHB_PAGE_MIG_DEBUG</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"5c. read 0x%x [LE] from %p (debug)\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 6. invalidate TCE cache */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"6. invalidating TCE cache\\n\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#tar_offset\">tar_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writeq\">writeq</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#tar_val\">tar_val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 7. Re-read PMCR */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"7a. Re-reading PMCR\\n\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>) | <a class=\"id\" href=\"#PHB_PAGE_MIG_CTRL\">PHB_PAGE_MIG_CTRL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"7b. read 0x%x [LE] from %p\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* 8. Remove HardStop */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"8a. removing HardStop from PMCR\\n\");", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#bus\">bus</a>) | <a class=\"id\" href=\"#PHB_PAGE_MIG_CTRL\">PHB_PAGE_MIG_CTRL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"8b. writing 0x%x [LE] to %p\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(<a class=\"id\" href=\"#cpu_to_be32\">cpu_to_be32</a>(<a class=\"id\" href=\"#val\">val</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"8c. read 0x%x [LE] from %p\\n\", <a class=\"id\" href=\"#val\">val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_reserve_mem_region\">calgary_reserve_mem_region</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#start\">start</a>,", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#limit\">limit</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#numpages\">numpages</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#limit\">limit</a> = <a class=\"id\" href=\"#limit\">limit</a> | 0xfffff;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#limit\">limit</a>++;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#numpages\">numpages</a> = ((<a class=\"id\" href=\"#limit\">limit</a> - <a class=\"id\" href=\"#start\">start</a>) >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iommu_range_reserve\">iommu_range_reserve</a>(<a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>), <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#numpages\">numpages</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_reserve_peripheral_mem_1\">calgary_reserve_peripheral_mem_1</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#low\">low</a>, <a class=\"id\" href=\"#high\">high</a>, <a class=\"id\" href=\"#sizelow\">sizelow</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#limit\">limit</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#busnum\">busnum</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* peripheral MEM_1 region */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_MEM_1_LOW\">PHB_MEM_1_LOW</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#low\">low</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_MEM_1_HIGH\">PHB_MEM_1_HIGH</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#high\">high</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_MEM_1_SIZE\">PHB_MEM_1_SIZE</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sizelow\">sizelow</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = (<a class=\"id\" href=\"#high\">high</a> << 32) | <a class=\"id\" href=\"#low\">low</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#limit\">limit</a> = <a class=\"id\" href=\"#sizelow\">sizelow</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#calgary_reserve_mem_region\">calgary_reserve_mem_region</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#limit\">limit</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_reserve_peripheral_mem_2\">calgary_reserve_peripheral_mem_2</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#val32\">val32</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#low\">low</a>, <a class=\"id\" href=\"#high\">high</a>, <a class=\"id\" href=\"#sizelow\">sizelow</a>, <a class=\"id\" href=\"#sizehigh\">sizehigh</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#limit\">limit</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#busnum\">busnum</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* is it enabled? */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_CONFIG_RW_OFFSET\">PHB_CONFIG_RW_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/>if (!(<a class=\"id\" href=\"#val32\">val32</a> &amp; <a class=\"id\" href=\"#PHB_MEM2_ENABLE\">PHB_MEM2_ENABLE</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_MEM_2_LOW\">PHB_MEM_2_LOW</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#low\">low</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_MEM_2_HIGH\">PHB_MEM_2_HIGH</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#high\">high</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_MEM_2_SIZE_LOW\">PHB_MEM_2_SIZE_LOW</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sizelow\">sizelow</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_MEM_2_SIZE_HIGH\">PHB_MEM_2_SIZE_HIGH</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#sizehigh\">sizehigh</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = (<a class=\"id\" href=\"#high\">high</a> << 32) | <a class=\"id\" href=\"#low\">low</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#limit\">limit</a> = (<a class=\"id\" href=\"#sizehigh\">sizehigh</a> << 32) | <a class=\"id\" href=\"#sizelow\">sizelow</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#calgary_reserve_mem_region\">calgary_reserve_mem_region</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#limit\">limit</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * some regions of the IO address space do not get translated, so we</span>", 
"<span class=\"comment\"> * must not give devices IO addresses in those regions. The regions</span>", 
"<span class=\"comment\"> * are the 640KB-1MB region and the two PCI peripheral memory holes.</span>", 
"<span class=\"comment\"> * Reserve all of them in the IOMMU bitmap to avoid giving them out</span>", 
"<span class=\"comment\"> * later.</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_reserve_regions\">calgary_reserve_regions</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#npages\">npages</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#start\">start</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* reserve EMERGENCY_PAGES from bad_dma_address and up */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iommu_range_reserve\">iommu_range_reserve</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#DMA_ERROR_CODE\">DMA_ERROR_CODE</a>, <a class=\"id\" href=\"#EMERGENCY_PAGES\">EMERGENCY_PAGES</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* avoid the BIOS/VGA first 640KB-1MB region */</span>", 
"<span class=\"ts\"/><span class=\"comment\">/* for CalIOC2 - avoid the entire first MB */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_calgary\">is_calgary</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#device\">device</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = (640 * 1024);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = ((1024 - 640) * 1024) >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>;", 
"<span class=\"ts\"/>} else { <span class=\"comment\">/* calioc2 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#start\">start</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#npages\">npages</a> = (1 * 1024 * 1024) >> <a class=\"id\" href=\"#PAGE_SHIFT\">PAGE_SHIFT</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iommu_range_reserve\">iommu_range_reserve</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#start\">start</a>, <a class=\"id\" href=\"#npages\">npages</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* reserve the two PCI peripheral memory regions in IO space */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#calgary_reserve_peripheral_mem_1\">calgary_reserve_peripheral_mem_1</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#calgary_reserve_peripheral_mem_2\">calgary_reserve_peripheral_mem_2</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_setup_tar\">calgary_setup_tar</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>, void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val64\">val64</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#table_phys\">table_phys</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* build TCE tables for each PHB */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#build_tce_table\">build_tce_table</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bbar\">bbar</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_base\">it_base</a> = (unsigned long)<a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>].<a class=\"id\" href=\"#tce_space\">tce_space</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_kdump_kernel\">is_kdump_kernel</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#calgary_init_bitmap_from_tce_table\">calgary_init_bitmap_from_tce_table</a>(<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tce_free\">tce_free</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, 0, <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_calgary\">is_calgary</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#device\">device</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#chip_ops\">chip_ops</a> = &amp;<a class=\"id\" href=\"#calgary_chip_ops\">calgary_chip_ops</a>;", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#is_calioc2\">is_calioc2</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#device\">device</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#chip_ops\">chip_ops</a> = &amp;<a class=\"id\" href=\"#calioc2_chip_ops\">calioc2_chip_ops</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#calgary_reserve_regions\">calgary_reserve_regions</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* set TARs for each PHB */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#tar_offset\">tar_offset</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> = <a class=\"id\" href=\"#be64_to_cpu\">be64_to_cpu</a>(<a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* zero out all TAR bits under sw control */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> &= ~<a class=\"id\" href=\"#TAR_SW_BITS\">TAR_SW_BITS</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#table_phys\">table_phys</a> = (<a class=\"id\" href=\"#u64\">u64</a>)<a class=\"id\" href=\"#__pa\">__pa</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_base\">it_base</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> |= <a class=\"id\" href=\"#table_phys\">table_phys</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#specified_table_size\">specified_table_size</a> &gt; <a class=\"id\" href=\"#TCE_TABLE_SIZE_8M\">TCE_TABLE_SIZE_8M</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> |= (<a class=\"id\" href=\"#u64\">u64</a>) <a class=\"id\" href=\"#specified_table_size\">specified_table_size</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#tar_val\">tar_val</a> = <a class=\"id\" href=\"#cpu_to_be64\">cpu_to_be64</a>(<a class=\"id\" href=\"#val64\">val64</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writeq\">writeq</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#tar_val\">tar_val</a>, <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>); <span class=\"comment\">/* flush */</span>", 
"", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_free_bus\">calgary_free_bus</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val64\">val64</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#bitmapsz\">bitmapsz</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#tar_offset\">tar_offset</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> = <a class=\"id\" href=\"#be64_to_cpu\">be64_to_cpu</a>(<a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> &= ~<a class=\"id\" href=\"#TAR_SW_BITS\">TAR_SW_BITS</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writeq\">writeq</a>(<a class=\"id\" href=\"#cpu_to_be64\">cpu_to_be64</a>(<a class=\"id\" href=\"#val64\">val64</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>); <span class=\"comment\">/* flush */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bitmapsz\">bitmapsz</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_size\">it_size</a> / <a class=\"id\" href=\"#BITS_PER_BYTE\">BITS_PER_BYTE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#free_pages\">free_pages</a>((unsigned long)<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_map\">it_map</a>, <a class=\"id\" href=\"#get_order\">get_order</a>(<a class=\"id\" href=\"#bitmapsz\">bitmapsz</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_map\">it_map</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"<span class=\"ts\"/>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_pci_iommu\">set_pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Can't free bootmem allocated memory after system is up :-( */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>].<a class=\"id\" href=\"#tce_space\">tce_space</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calgary_dump_error_regs\">calgary_dump_error_regs</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>)", 
"{", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#csr\">csr</a>, <a class=\"id\" href=\"#plssr\">plssr</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>) | <a class=\"id\" href=\"#PHB_CSR_OFFSET\">PHB_CSR_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#csr\">csr</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>) | <a class=\"id\" href=\"#PHB_PLSSR_OFFSET\">PHB_PLSSR_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#plssr\">plssr</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* If no error, the agent ID in the CSR is not valid */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_EMERG\">KERN_EMERG</a> \"Calgary: DMA error on Calgary PHB 0x%x, \"", 
"<span class=\"ts\"/>       \"0x%08x@CSR 0x%08x@PLSSR\\n\", <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>, <a class=\"id\" href=\"#csr\">csr</a>, <a class=\"id\" href=\"#plssr\">plssr</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calioc2_dump_error_regs\">calioc2_dump_error_regs</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>)", 
"{", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#csr\">csr</a>, <a class=\"id\" href=\"#csmr\">csmr</a>, <a class=\"id\" href=\"#plssr\">plssr</a>, <a class=\"id\" href=\"#mck\">mck</a>, <a class=\"id\" href=\"#rcstat\">rcstat</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#phboff\">phboff</a> = <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>);", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#erroff\">erroff</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#errregs\">errregs</a>[7];", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#i\">i</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* dump CSR */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phboff\">phboff</a> | <a class=\"id\" href=\"#PHB_CSR_OFFSET\">PHB_CSR_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#csr\">csr</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><span class=\"comment\">/* dump PLSSR */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phboff\">phboff</a> | <a class=\"id\" href=\"#PHB_PLSSR_OFFSET\">PHB_PLSSR_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#plssr\">plssr</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><span class=\"comment\">/* dump CSMR */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phboff\">phboff</a> | 0x290);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#csmr\">csmr</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><span class=\"comment\">/* dump mck */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phboff\">phboff</a> | 0x800);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mck\">mck</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_EMERG\">KERN_EMERG</a> \"Calgary: DMA error on CalIOC2 PHB 0x%x\\n\",", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_EMERG\">KERN_EMERG</a> \"Calgary: 0x%08x@CSR 0x%08x@PLSSR 0x%08x@CSMR 0x%08x@MCK\\n\",", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#csr\">csr</a>, <a class=\"id\" href=\"#plssr\">plssr</a>, <a class=\"id\" href=\"#csmr\">csmr</a>, <a class=\"id\" href=\"#mck\">mck</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* dump rest of error regs */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_EMERG\">KERN_EMERG</a> \"Calgary: \");", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#i\">i</a> = 0; <a class=\"id\" href=\"#i\">i</a> &lt; <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#errregs\">errregs</a>); <a class=\"id\" href=\"#i\">i</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* err regs are at 0x810 - 0x870 */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#erroff\">erroff</a> = (0x810 + (<a class=\"id\" href=\"#i\">i</a> * 0x10));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phboff\">phboff</a> | <a class=\"id\" href=\"#erroff\">erroff</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#errregs\">errregs</a>[<a class=\"id\" href=\"#i\">i</a>] = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"0x%08x@0x%lx \", <a class=\"id\" href=\"#errregs\">errregs</a>[<a class=\"id\" href=\"#i\">i</a>], <a class=\"id\" href=\"#erroff\">erroff</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"\\n\");", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* root complex status */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phboff\">phboff</a> | <a class=\"id\" href=\"#PHB_ROOT_COMPLEX_STATUS\">PHB_ROOT_COMPLEX_STATUS</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rcstat\">rcstat</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_EMERG\">KERN_EMERG</a> \"Calgary: 0x%08x@0x%x\\n\", <a class=\"id\" href=\"#rcstat\">rcstat</a>,", 
"<span class=\"ts\"/>       <a class=\"id\" href=\"#PHB_ROOT_COMPLEX_STATUS\">PHB_ROOT_COMPLEX_STATUS</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#calgary_watchdog\">calgary_watchdog</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a> = (struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *)<a class=\"id\" href=\"#data\">data</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#val32\">val32</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>) | <a class=\"id\" href=\"#PHB_CSR_OFFSET\">PHB_CSR_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* If no error, the agent ID in the CSR is not valid */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#val32\">val32</a> &amp; <a class=\"id\" href=\"#CSR_AGENT_MASK\">CSR_AGENT_MASK</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#chip_ops\">chip_ops</a>-><a class=\"id\" href=\"#dump_error_regs\">dump_error_regs</a>(<a class=\"id\" href=\"#tbl\">tbl</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* reset error */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(0, <a class=\"id\" href=\"#target\">target</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Disable bus that caused the error */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#it_busno\">it_busno</a>) |", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#PHB_CONFIG_RW_OFFSET\">PHB_CONFIG_RW_OFFSET</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> |= <a class=\"id\" href=\"#PHB_SLOT_DISABLE\">PHB_SLOT_DISABLE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(<a class=\"id\" href=\"#cpu_to_be32\">cpu_to_be32</a>(<a class=\"id\" href=\"#val32\">val32</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>); <span class=\"comment\">/* flush */</span>", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* Reset the timer */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#watchdog_timer\">watchdog_timer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a> + 2 * <a class=\"id\" href=\"#HZ\">HZ</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_set_split_completion_timeout\">calgary_set_split_completion_timeout</a>(void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a>,", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#busnum\">busnum</a>, unsigned long <a class=\"id\" href=\"#timeout\">timeout</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#val64\">val64</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/>unsigned int <a class=\"id\" href=\"#phb_shift\">phb_shift</a> = ~0; <span class=\"comment\">/* silence gcc */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u64\">u64</a> <a class=\"id\" href=\"#mask\">mask</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#busno_to_phbid\">busno_to_phbid</a>(<a class=\"id\" href=\"#busnum\">busnum</a>)) {", 
"<span class=\"ts\"/>case 0: <a class=\"id\" href=\"#phb_shift\">phb_shift</a> = (63 - 19);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 1: <a class=\"id\" href=\"#phb_shift\">phb_shift</a> = (63 - 23);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 2: <a class=\"id\" href=\"#phb_shift\">phb_shift</a> = (63 - 27);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case 3: <a class=\"id\" href=\"#phb_shift\">phb_shift</a> = (63 - 35);", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(<a class=\"id\" href=\"#busno_to_phbid\">busno_to_phbid</a>(<a class=\"id\" href=\"#busnum\">busnum</a>));", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#CALGARY_CONFIG_REG\">CALGARY_CONFIG_REG</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> = <a class=\"id\" href=\"#be64_to_cpu\">be64_to_cpu</a>(<a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* zero out this PHB's timer bits */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mask\">mask</a> = ~(0xFUL << <a class=\"id\" href=\"#phb_shift\">phb_shift</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> &= <a class=\"id\" href=\"#mask\">mask</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val64\">val64</a> |= (<a class=\"id\" href=\"#timeout\">timeout</a> << <a class=\"id\" href=\"#phb_shift\">phb_shift</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writeq\">writeq</a>(<a class=\"id\" href=\"#cpu_to_be64\">cpu_to_be64</a>(<a class=\"id\" href=\"#val64\">val64</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#readq\">readq</a>(<a class=\"id\" href=\"#target\">target</a>); <span class=\"comment\">/* flush */</span>", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calioc2_handle_quirks\">calioc2_handle_quirks</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>, struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#busnum\">busnum</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * CalIOC2 designers recommend setting bit 8 in 0xnDB0 to 1</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_SAVIOR_L2\">PHB_SAVIOR_L2</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#cpu_to_be32\">cpu_to_be32</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> |= 0x00800000;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(<a class=\"id\" href=\"#cpu_to_be32\">cpu_to_be32</a>(<a class=\"id\" href=\"#val\">val</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_handle_quirks\">calgary_handle_quirks</a>(struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>, struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#busnum\">busnum</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * Give split completion a longer timeout on bus 1 for aic94xx</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * http://bugzilla.kernel.org/show_bug.cgi?id=7180</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_calgary\">is_calgary</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#device\">device</a>) && (<a class=\"id\" href=\"#busnum\">busnum</a> == 1))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#calgary_set_split_completion_timeout\">calgary_set_split_completion_timeout</a>(<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#busnum\">busnum</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#CCR_2SEC_TIMEOUT\">CCR_2SEC_TIMEOUT</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_enable_translation\">calgary_enable_translation</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#val32\">val32</a>;", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#busnum\">busnum</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#busnum\">busnum</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* enable TCE in PHB Config Register */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_CONFIG_RW_OFFSET\">PHB_CONFIG_RW_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> |= <a class=\"id\" href=\"#PHB_TCE_ENABLE\">PHB_TCE_ENABLE</a> | <a class=\"id\" href=\"#PHB_DAC_DISABLE\">PHB_DAC_DISABLE</a> | <a class=\"id\" href=\"#PHB_MCSR_ENABLE\">PHB_MCSR_ENABLE</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"Calgary: enabling translation on %s PHB %#x\\n\",", 
"<span class=\"ts\"/>       (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#device\">device</a> == <a class=\"id\" href=\"#PCI_DEVICE_ID_IBM_CALGARY\">PCI_DEVICE_ID_IBM_CALGARY</a>) ?", 
"<span class=\"ts\"/>       \"Calgary\" : \"CalIOC2\", <a class=\"id\" href=\"#busnum\">busnum</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"Calgary: errant DMAs will now be prevented on this \"", 
"<span class=\"ts\"/>       \"bus.\\n\");", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(<a class=\"id\" href=\"#cpu_to_be32\">cpu_to_be32</a>(<a class=\"id\" href=\"#val32\">val32</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>); <span class=\"comment\">/* flush */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#init_timer\">init_timer</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#watchdog_timer\">watchdog_timer</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#watchdog_timer\">watchdog_timer</a>.<a class=\"id\" href=\"#function\">function</a> = &amp;<a class=\"id\" href=\"#calgary_watchdog\">calgary_watchdog</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#watchdog_timer\">watchdog_timer</a>.<a class=\"id\" href=\"#data\">data</a> = (unsigned long)<a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#watchdog_timer\">watchdog_timer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_disable_translation\">calgary_disable_translation</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#val32\">val32</a>;", 
"<span class=\"ts\"/>unsigned char <a class=\"id\" href=\"#busnum\">busnum</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#busnum\">busnum</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#bbar\">bbar</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* disable TCE in PHB Config Register */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#phb_offset\">phb_offset</a>(<a class=\"id\" href=\"#busnum\">busnum</a>) | <a class=\"id\" href=\"#PHB_CONFIG_RW_OFFSET\">PHB_CONFIG_RW_OFFSET</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#val32\">val32</a> &= ~(<a class=\"id\" href=\"#PHB_TCE_ENABLE\">PHB_TCE_ENABLE</a> | <a class=\"id\" href=\"#PHB_DAC_DISABLE\">PHB_DAC_DISABLE</a> | <a class=\"id\" href=\"#PHB_MCSR_ENABLE\">PHB_MCSR_ENABLE</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_INFO\">KERN_INFO</a> \"Calgary: disabling translation on PHB %#x!\\n\", <a class=\"id\" href=\"#busnum\">busnum</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#writel\">writel</a>(<a class=\"id\" href=\"#cpu_to_be32\">cpu_to_be32</a>(<a class=\"id\" href=\"#val32\">val32</a>), <a class=\"id\" href=\"#target\">target</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>); <span class=\"comment\">/* flush */</span>", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#del_timer_sync\">del_timer_sync</a>(&amp;<a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#watchdog_timer\">watchdog_timer</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_init_one_nontraslated\">calgary_init_one_nontraslated</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pci_dev_get\">pci_dev_get</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#set_pci_iommu\">set_pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* is the device behind a bridge? */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#self\">self</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#self\">self</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_init_one\">calgary_init_one</a>(struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a>)", 
"{", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#busno_to_bbar\">busno_to_bbar</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#calgary_setup_tar\">calgary_setup_tar</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#bbar\">bbar</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#done\">done</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pci_dev_get\">pci_dev_get</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#self\">self</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_WARNING\">KERN_WARNING</a> \"Calgary: IEEEE, dev %p has \"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       \"bus->parent->self!\\n\", <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#parent\">parent</a>-><a class=\"id\" href=\"#self\">self</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#self\">self</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#pci_iommu\">pci_iommu</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a>-><a class=\"id\" href=\"#chip_ops\">chip_ops</a>-><a class=\"id\" href=\"#handle_quirks\">handle_quirks</a>(<a class=\"id\" href=\"#tbl\">tbl</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#calgary_enable_translation\">calgary_enable_translation</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#done\">done</a>:", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_locate_bbars\">calgary_locate_bbars</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rioidx\">rioidx</a>, <a class=\"id\" href=\"#phb\">phb</a>, <a class=\"id\" href=\"#bus\">bus</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/>void <a class=\"id\" href=\"#__iomem\">__iomem</a> *<a class=\"id\" href=\"#target\">target</a>;", 
"<span class=\"ts\"/>unsigned long <a class=\"id\" href=\"#offset\">offset</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#start_bus\">start_bus</a>, <a class=\"id\" href=\"#end_bus\">end_bus</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#val\">val</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = -<a class=\"id\" href=\"#ENODATA\">ENODATA</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#rioidx\">rioidx</a> = 0; <a class=\"id\" href=\"#rioidx\">rioidx</a> &lt; <a class=\"id\" href=\"#rio_table_hdr\">rio_table_hdr</a>-><a class=\"id\" href=\"#num_rio_dev\">num_rio_dev</a>; <a class=\"id\" href=\"#rioidx\">rioidx</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#rio_detail\">rio_detail</a> *<a class=\"id\" href=\"#rio\">rio</a> = <a class=\"id\" href=\"#rio_devs\">rio_devs</a>[<a class=\"id\" href=\"#rioidx\">rioidx</a>];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#rio\">rio</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#COMPAT_CALGARY\">COMPAT_CALGARY</a>) && (<a class=\"id\" href=\"#rio\">rio</a>-><a class=\"id\" href=\"#type\">type</a> != <a class=\"id\" href=\"#ALT_CALGARY\">ALT_CALGARY</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* map entire 1MB of Calgary config space */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#ioremap_nocache\">ioremap_nocache</a>(<a class=\"id\" href=\"#rio\">rio</a>-><a class=\"id\" href=\"#BBAR\">BBAR</a>, 1024 * 1024);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#bbar\">bbar</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#phb\">phb</a> = 0; <a class=\"id\" href=\"#phb\">phb</a> &lt; <a class=\"id\" href=\"#PHBS_PER_CALGARY\">PHBS_PER_CALGARY</a>; <a class=\"id\" href=\"#phb\">phb</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#offset\">offset</a> = <a class=\"id\" href=\"#phb_debug_offsets\">phb_debug_offsets</a>[<a class=\"id\" href=\"#phb\">phb</a>] | <a class=\"id\" href=\"#PHB_DEBUG_STUFF_OFFSET\">PHB_DEBUG_STUFF_OFFSET</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#target\">target</a> = <a class=\"id\" href=\"#calgary_reg\">calgary_reg</a>(<a class=\"id\" href=\"#bbar\">bbar</a>, <a class=\"id\" href=\"#offset\">offset</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#val\">val</a> = <a class=\"id\" href=\"#be32_to_cpu\">be32_to_cpu</a>(<a class=\"id\" href=\"#readl\">readl</a>(<a class=\"id\" href=\"#target\">target</a>));", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#start_bus\">start_bus</a> = (<a class=\"id\" href=\"#u8\">u8</a>)((<a class=\"id\" href=\"#val\">val</a> &amp; 0x00FF0000) >> 16);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#end_bus\">end_bus</a> = (<a class=\"id\" href=\"#u8\">u8</a>)((<a class=\"id\" href=\"#val\">val</a> &amp; 0x0000FF00) >> 8);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#end_bus\">end_bus</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#bus\">bus</a> = <a class=\"id\" href=\"#start_bus\">start_bus</a>; <a class=\"id\" href=\"#bus\">bus</a> <= <a class=\"id\" href=\"#end_bus\">end_bus</a>; <a class=\"id\" href=\"#bus\">bus</a>++) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#bus\">bus</a>].<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#bus\">bus</a>].<a class=\"id\" href=\"#phbid\">phbid</a> = <a class=\"id\" href=\"#phb\">phb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#start_bus\">start_bus</a>].<a class=\"id\" href=\"#bbar\">bbar</a> = <a class=\"id\" href=\"#bbar\">bbar</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#start_bus\">start_bus</a>].<a class=\"id\" href=\"#phbid\">phbid</a> = <a class=\"id\" href=\"#phb\">phb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return 0;", 
"", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/><span class=\"comment\">/* scan bus_info and iounmap any bbars we previously ioremap'd */</span>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#bus\">bus</a> = 0; <a class=\"id\" href=\"#bus\">bus</a> &lt; <a class=\"id\" href=\"#ARRAY_SIZE\">ARRAY_SIZE</a>(<a class=\"id\" href=\"#bus_info\">bus_info</a>); <a class=\"id\" href=\"#bus\">bus</a>++)", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#bus\">bus</a>].<a class=\"id\" href=\"#bbar\">bbar</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#iounmap\">iounmap</a>(<a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#bus\">bus</a>].<a class=\"id\" href=\"#bbar\">bbar</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#__init\">__init</a> <a class=\"id\" href=\"#calgary_init\">calgary_init</a>(void)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#ret\">ret</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#pci_dev\">pci_dev</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#calgary_bus_info\">calgary_bus_info</a> *<a class=\"id\" href=\"#info\">info</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#calgary_locate_bbars\">calgary_locate_bbars</a>();", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* Purely for kdump kernel case */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#is_kdump_kernel\">is_kdump_kernel</a>())", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#get_tce_space_from_tar\">get_tce_space_from_tar</a>();", 
"", 
"<span class=\"ts\"/>do {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#pci_get_device\">pci_get_device</a>(<a class=\"id\" href=\"#PCI_VENDOR_ID_IBM\">PCI_VENDOR_ID_IBM</a>, <a class=\"id\" href=\"#PCI_ANY_ID\">PCI_ANY_ID</a>, <a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#dev\">dev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#is_cal_pci_dev\">is_cal_pci_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#device\">device</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#info\">info</a> = &amp;<a class=\"id\" href=\"#bus_info\">bus_info</a>[<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#bus\">bus</a>-><a class=\"id\" href=\"#number\">number</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#translation_disabled\">translation_disabled</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#calgary_init_one_nontraslated\">calgary_init_one_nontraslated</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#info\">info</a>-><a class=\"id\" href=\"#tce_space\">tce_space</a> && !<a class=\"id\" href=\"#translate_empty_slots\">translate_empty_slots</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ret\">ret</a> = <a class=\"id\" href=\"#calgary_init_one\">calgary_init_one</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ret\">ret</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#error\">error</a>;", 
"<span class=\"ts\"/>} while (1);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#for_each_pci_dev\">for_each_pci_dev</a>(<a class=\"id\" href=\"#dev\">dev</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#iommu_table\">iommu_table</a> *<a class=\"id\" href=\"#tbl\">tbl</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tbl\">tbl</a> = <a class=\"id\" href=\"#find_iommu_table\">find_iommu_table</a>(&amp;<a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#translation_enabled\">translation_enabled</a>(<a class=\"id\" href=\"#tbl\">tbl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#dev\">dev</a>.<a class=\"id\" href=\"#archdata\">archdata</a>.<a class=\"id\" href=\"#dma_ops\">dma_ops</a> = &amp;<a class=\"id\" href=\"#calgary_dma_ops\">calgary_dma_ops</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ret\">ret</a>;", 
"", 
"<a class=\"id\" href=\"#error\">error</a>:", 
"<span class=\"ts\"/>do {", 
];
xr_frag_insert('l/f4/bbcab2964644d21be1697de9af791e5ab2d137.xr', __xr_tmp);
