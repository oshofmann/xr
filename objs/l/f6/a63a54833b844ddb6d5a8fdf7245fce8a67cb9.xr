var __xr_tmp = [
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#COMMON_AUDIT_DATA_INIT\">COMMON_AUDIT_DATA_INIT</a>(&amp;<a class=\"id\" href=\"#ad\">ad</a>, <a class=\"id\" href=\"#IPC\">IPC</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ad\">ad</a>.<a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#ipc_id\">ipc_id</a> = <a class=\"id\" href=\"#msq\">msq</a>-><a class=\"id\" href=\"#q_perm\">q_perm</a>.<a class=\"id\" href=\"#key\">key</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#avc_has_perm\">avc_has_perm</a>(<a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#isec\">isec</a>-><a class=\"id\" href=\"#sid\">sid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#SECCLASS_MSGQ\">SECCLASS_MSGQ</a>, <a class=\"id\" href=\"#MSGQ__READ\">MSGQ__READ</a>, &amp;<a class=\"id\" href=\"#ad\">ad</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#avc_has_perm\">avc_has_perm</a>(<a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#msec\">msec</a>-><a class=\"id\" href=\"#sid\">sid</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#SECCLASS_MSG\">SECCLASS_MSG</a>, <a class=\"id\" href=\"#MSG__RECEIVE\">MSG__RECEIVE</a>, &amp;<a class=\"id\" href=\"#ad\">ad</a>);", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"", 
"<span class=\"comment\">/* Shared Memory security operations */</span>", 
"static int <a class=\"id\" href=\"#selinux_shm_alloc_security\">selinux_shm_alloc_security</a>(struct <a class=\"id\" href=\"#shmid_kernel\">shmid_kernel</a> *<a class=\"id\" href=\"#shp\">shp</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipc_security_struct\">ipc_security_struct</a> *<a class=\"id\" href=\"#isec\">isec</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#common_audit_data\">common_audit_data</a> <a class=\"id\" href=\"#ad\">ad</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#current_sid\">current_sid</a>();", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#ipc_alloc_security\">ipc_alloc_security</a>(<a class=\"id\" href=\"#current\">current</a>, &amp;<a class=\"id\" href=\"#shp\">shp</a>-><a class=\"id\" href=\"#shm_perm\">shm_perm</a>, <a class=\"id\" href=\"#SECCLASS_SHM\">SECCLASS_SHM</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#isec\">isec</a> = <a class=\"id\" href=\"#shp\">shp</a>-><a class=\"id\" href=\"#shm_perm\">shm_perm</a>.<a class=\"id\" href=\"#security\">security</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#COMMON_AUDIT_DATA_INIT\">COMMON_AUDIT_DATA_INIT</a>(&amp;<a class=\"id\" href=\"#ad\">ad</a>, <a class=\"id\" href=\"#IPC\">IPC</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ad\">ad</a>.<a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#ipc_id\">ipc_id</a> = <a class=\"id\" href=\"#shp\">shp</a>-><a class=\"id\" href=\"#shm_perm\">shm_perm</a>.<a class=\"id\" href=\"#key\">key</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#avc_has_perm\">avc_has_perm</a>(<a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#isec\">isec</a>-><a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#SECCLASS_SHM\">SECCLASS_SHM</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#SHM__CREATE\">SHM__CREATE</a>, &amp;<a class=\"id\" href=\"#ad\">ad</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ipc_free_security\">ipc_free_security</a>(&amp;<a class=\"id\" href=\"#shp\">shp</a>-><a class=\"id\" href=\"#shm_perm\">shm_perm</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#selinux_shm_free_security\">selinux_shm_free_security</a>(struct <a class=\"id\" href=\"#shmid_kernel\">shmid_kernel</a> *<a class=\"id\" href=\"#shp\">shp</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ipc_free_security\">ipc_free_security</a>(&amp;<a class=\"id\" href=\"#shp\">shp</a>-><a class=\"id\" href=\"#shm_perm\">shm_perm</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#selinux_shm_associate\">selinux_shm_associate</a>(struct <a class=\"id\" href=\"#shmid_kernel\">shmid_kernel</a> *<a class=\"id\" href=\"#shp\">shp</a>, int <a class=\"id\" href=\"#shmflg\">shmflg</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ipc_security_struct\">ipc_security_struct</a> *<a class=\"id\" href=\"#isec\">isec</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#common_audit_data\">common_audit_data</a> <a class=\"id\" href=\"#ad\">ad</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u32\">u32</a> <a class=\"id\" href=\"#sid\">sid</a> = <a class=\"id\" href=\"#current_sid\">current_sid</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#isec\">isec</a> = <a class=\"id\" href=\"#shp\">shp</a>-><a class=\"id\" href=\"#shm_perm\">shm_perm</a>.<a class=\"id\" href=\"#security\">security</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#COMMON_AUDIT_DATA_INIT\">COMMON_AUDIT_DATA_INIT</a>(&amp;<a class=\"id\" href=\"#ad\">ad</a>, <a class=\"id\" href=\"#IPC\">IPC</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ad\">ad</a>.<a class=\"id\" href=\"#u\">u</a>.<a class=\"id\" href=\"#ipc_id\">ipc_id</a> = <a class=\"id\" href=\"#shp\">shp</a>-><a class=\"id\" href=\"#shm_perm\">shm_perm</a>.<a class=\"id\" href=\"#key\">key</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#avc_has_perm\">avc_has_perm</a>(<a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#isec\">isec</a>-><a class=\"id\" href=\"#sid\">sid</a>, <a class=\"id\" href=\"#SECCLASS_SHM\">SECCLASS_SHM</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#SHM__ASSOCIATE\">SHM__ASSOCIATE</a>, &amp;<a class=\"id\" href=\"#ad\">ad</a>);", 
"}", 
"", 
"<span class=\"comment\">/* Note, at this point, shp is locked down */</span>", 
"static int <a class=\"id\" href=\"#selinux_shm_shmctl\">selinux_shm_shmctl</a>(struct <a class=\"id\" href=\"#shmid_kernel\">shmid_kernel</a> *<a class=\"id\" href=\"#shp\">shp</a>, int <a class=\"id\" href=\"#cmd\">cmd</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#perms\">perms</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#err\">err</a>;", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IPC_INFO\">IPC_INFO</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SHM_INFO\">SHM_INFO</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* No specific object, just general system-wide information. */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#task_has_system\">task_has_system</a>(<a class=\"id\" href=\"#current\">current</a>, <a class=\"id\" href=\"#SYSTEM__IPC_INFO\">SYSTEM__IPC_INFO</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IPC_STAT\">IPC_STAT</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SHM_STAT\">SHM_STAT</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perms\">perms</a> = <a class=\"id\" href=\"#SHM__GETATTR\">SHM__GETATTR</a> | <a class=\"id\" href=\"#SHM__ASSOCIATE\">SHM__ASSOCIATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IPC_SET\">IPC_SET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perms\">perms</a> = <a class=\"id\" href=\"#SHM__SETATTR\">SHM__SETATTR</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SHM_LOCK\">SHM_LOCK</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#SHM_UNLOCK\">SHM_UNLOCK</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#perms\">perms</a> = <a class=\"id\" href=\"#SHM__LOCK\">SHM__LOCK</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>break;", 
];
xr_frag_insert('l/f6/a63a54833b844ddb6d5a8fdf7245fce8a67cb9.xr', __xr_tmp);
