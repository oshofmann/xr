var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Linux NET3:<span class=\"ts\"/>Internet Group Management Protocol  [IGMP]</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>This code implements the IGMP protocol as defined in RFC1112. There has</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>been a further revision of this protocol since which is now supported.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>If you have trouble with this module be careful what gcc you have used,</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>the older version didn't come out right using gcc 2.5.8, the newer one</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>seems to fall out with gcc 2.6.2.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Authors:</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox &lt;alan@lxorguk.ukuu.org.uk&gt;</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>This program is free software; you can redistribute it and/or</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>modify it under the terms of the GNU General Public License</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>as published by the Free Software Foundation; either version</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>2 of the License, or (at your option) any later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Fixes:</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox<span class=\"ts\"/>:<span class=\"ts\"/>Added lots of __inline__ to optimise</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>the memory usage of all the tiny little</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>functions.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox<span class=\"ts\"/>:<span class=\"ts\"/>Dumped the header building experiment.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox<span class=\"ts\"/>:<span class=\"ts\"/>Minor tweaks ready for multicast routing</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>and extended IGMP protocol.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox<span class=\"ts\"/>:<span class=\"ts\"/>Removed a load of inline directives. Gcc 2.5.8</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>writes utterly bogus code otherwise (sigh)</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>fixed IGMP loopback to behave in the manner</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>desired by mrouted, fixed the fact it has been</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>broken since 1.3.6 and cleaned up a few minor</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>points.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Chih-Jen Chang<span class=\"ts\"/>:<span class=\"ts\"/>Tried to revise IGMP to Version 2</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Tsu-Sheng Tsao<span class=\"ts\"/><span class=\"ts\"/>E-mail: chihjenc@scf.usc.edu and tsusheng@scf.usc.edu</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>The enhancements are mainly based on Steve Deering's</span>", 
"<span class=\"comment\"> * <span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>ipmulti-3.5 source code.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Chih-Jen Chang<span class=\"ts\"/>:<span class=\"ts\"/>Added the igmp_get_mrouter_info and</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Tsu-Sheng Tsao<span class=\"ts\"/><span class=\"ts\"/>igmp_set_mrouter_info to keep track of</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>the mrouted version on that device.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Chih-Jen Chang<span class=\"ts\"/>:<span class=\"ts\"/>Added the max_resp_time parameter to</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Tsu-Sheng Tsao<span class=\"ts\"/><span class=\"ts\"/>igmp_heard_query(). Using this parameter</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>to identify the multicast router version</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>and do what the IGMP version 2 specified.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Chih-Jen Chang<span class=\"ts\"/>:<span class=\"ts\"/>Added a timer to revert to IGMP V2 router</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Tsu-Sheng Tsao<span class=\"ts\"/><span class=\"ts\"/>if the specified time expired.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox<span class=\"ts\"/>:<span class=\"ts\"/>Stop IGMP from 0.0.0.0 being accepted.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox<span class=\"ts\"/>:<span class=\"ts\"/>Use GFP_ATOMIC in the right places.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Christian Daudt :<span class=\"ts\"/>igmp timer wasn't set for local group</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>memberships but was being deleted,</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>which caused a \"del_timer() called</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>from %p with timer not initialized\\n\"</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>message (960131).</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Christian Daudt :<span class=\"ts\"/>removed del_timer from</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>igmp_timer_expire function (960205).</span>", 
"<span class=\"comment\"> *             Christian Daudt :       igmp_heard_report now only calls</span>", 
"<span class=\"comment\"> *                                     igmp_timer_expire if tm-&gt;running is</span>", 
"<span class=\"comment\"> *                                     true (960216).</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Malcolm Beattie :<span class=\"ts\"/>ttl comparison wrong in igmp_rcv made</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>igmp_heard_query never trigger. Expiry</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>miscalculation fixed in igmp_heard_query</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>and random() made to return unsigned to</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>prevent negative expiry times.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alexey Kuznetsov:<span class=\"ts\"/>Wrong group leaving behaviour, backport</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>fix from pending 2.1.x patches.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alan Cox:<span class=\"ts\"/><span class=\"ts\"/>Forget to enable FDDI support earlier.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alexey Kuznetsov:<span class=\"ts\"/>Fixed leaving groups on device down.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>Alexey Kuznetsov:<span class=\"ts\"/>Accordance to igmp-v2-06 draft.</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/>David L Stevens:<span class=\"ts\"/>IGMPv3 support, with help from</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>Vinay Kulkarni</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#system\">system</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#jiffies\">jiffies</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#socket\">socket</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#sockios\">sockios</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#in\">in</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inet\">inet</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netdevice\">netdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#skbuff\">skbuff</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#inetdevice\">inetdevice</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#igmp\">igmp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#if_arp\">if_arp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#rtnetlink\">rtnetlink</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#times\">times</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#net_namespace\">net_namespace</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#arp\">arp</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#ip\">ip</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#protocol\">protocol</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#route\">route</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#sock\">sock</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#net\">net</a>/<a class=\"id\" href=\"#checksum\">checksum</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#netfilter_ipv4\">netfilter_ipv4</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MROUTE\">CONFIG_IP_MROUTE</a>", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mroute\">mroute</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_PROC_FS\">CONFIG_PROC_FS</a>", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#proc_fs\">proc_fs</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#seq_file\">seq_file</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IP_MAX_MEMBERSHIPS\">IP_MAX_MEMBERSHIPS</a><span class=\"ts\"/>20", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IP_MAX_MSF\">IP_MAX_MSF</a><span class=\"ts\"/><span class=\"ts\"/>10", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"<span class=\"comment\">/* Parameter names and values are taken from igmp-v2-06 draft */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_V1_Router_Present_Timeout\">IGMP_V1_Router_Present_Timeout</a><span class=\"ts\"/><span class=\"ts\"/>(400*<a class=\"id\" href=\"#HZ\">HZ</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_V2_Router_Present_Timeout\">IGMP_V2_Router_Present_Timeout</a><span class=\"ts\"/><span class=\"ts\"/>(400*<a class=\"id\" href=\"#HZ\">HZ</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_Unsolicited_Report_Interval\">IGMP_Unsolicited_Report_Interval</a><span class=\"ts\"/>(10*<a class=\"id\" href=\"#HZ\">HZ</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_Query_Response_Interval\">IGMP_Query_Response_Interval</a><span class=\"ts\"/><span class=\"ts\"/>(10*<a class=\"id\" href=\"#HZ\">HZ</a>)", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_Unsolicited_Report_Count\">IGMP_Unsolicited_Report_Count</a><span class=\"ts\"/><span class=\"ts\"/>2", 
"", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_Initial_Report_Delay\">IGMP_Initial_Report_Delay</a><span class=\"ts\"/><span class=\"ts\"/>(1)", 
"", 
"<span class=\"comment\">/* IGMP_Initial_Report_Delay is not from IGMP specs!</span>", 
"<span class=\"comment\"> * IGMP specs require to report membership immediately after</span>", 
"<span class=\"comment\"> * joining a group, but we delay the first report by a</span>", 
"<span class=\"comment\"> * small interval. It seems more natural and still does not</span>", 
"<span class=\"comment\"> * contradict to specs provided this delay is small enough.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_V1_SEEN\">IGMP_V1_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) \\", 
"<span class=\"ts\"/>(<a class=\"id\" href=\"#IPV4_DEVCONF_ALL\">IPV4_DEVCONF_ALL</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#FORCE_IGMP_VERSION\">FORCE_IGMP_VERSION</a>) == 1 || \\", 
"<span class=\"ts\"/> <a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>((<a class=\"id\" href=\"#in_dev\">in_dev</a>), <a class=\"id\" href=\"#FORCE_IGMP_VERSION\">FORCE_IGMP_VERSION</a>) == 1 || \\", 
"<span class=\"ts\"/> ((<a class=\"id\" href=\"#in_dev\">in_dev</a>)-><a class=\"id\" href=\"#mr_v1_seen\">mr_v1_seen</a> && \\", 
"<span class=\"ts\"/>  <a class=\"id\" href=\"#time_before\">time_before</a>(<a class=\"id\" href=\"#jiffies\">jiffies</a>, (<a class=\"id\" href=\"#in_dev\">in_dev</a>)-><a class=\"id\" href=\"#mr_v1_seen\">mr_v1_seen</a>)))", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_V2_SEEN\">IGMP_V2_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) \\", 
"<span class=\"ts\"/>(<a class=\"id\" href=\"#IPV4_DEVCONF_ALL\">IPV4_DEVCONF_ALL</a>(<a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#FORCE_IGMP_VERSION\">FORCE_IGMP_VERSION</a>) == 2 || \\", 
"<span class=\"ts\"/> <a class=\"id\" href=\"#IN_DEV_CONF_GET\">IN_DEV_CONF_GET</a>((<a class=\"id\" href=\"#in_dev\">in_dev</a>), <a class=\"id\" href=\"#FORCE_IGMP_VERSION\">FORCE_IGMP_VERSION</a>) == 2 || \\", 
"<span class=\"ts\"/> ((<a class=\"id\" href=\"#in_dev\">in_dev</a>)-><a class=\"id\" href=\"#mr_v2_seen\">mr_v2_seen</a> && \\", 
"<span class=\"ts\"/>  <a class=\"id\" href=\"#time_before\">time_before</a>(<a class=\"id\" href=\"#jiffies\">jiffies</a>, (<a class=\"id\" href=\"#in_dev\">in_dev</a>)-><a class=\"id\" href=\"#mr_v2_seen\">mr_v2_seen</a>)))", 
"", 
"static void <a class=\"id\" href=\"#igmpv3_add_delrec\">igmpv3_add_delrec</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#im\">im</a>);", 
"static void <a class=\"id\" href=\"#igmpv3_del_delrec\">igmpv3_del_delrec</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#__be32\">__be32</a> <a class=\"id\" href=\"#multiaddr\">multiaddr</a>);", 
"static void <a class=\"id\" href=\"#igmpv3_clear_delrec\">igmpv3_clear_delrec</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"static int <a class=\"id\" href=\"#sf_setstate\">sf_setstate</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>);", 
"static void <a class=\"id\" href=\"#sf_markstate\">sf_markstate</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"static void <a class=\"id\" href=\"#ip_mc_clear_src\">ip_mc_clear_src</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>);", 
"static int <a class=\"id\" href=\"#ip_mc_add_src\">ip_mc_add_src</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#pmca\">pmca</a>, int <a class=\"id\" href=\"#sfmode\">sfmode</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> int <a class=\"id\" href=\"#sfcount\">sfcount</a>, <a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#psfsrc\">psfsrc</a>, int <a class=\"id\" href=\"#delta\">delta</a>);", 
"", 
"static void <a class=\"id\" href=\"#ip_ma_put\">ip_ma_put</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#im\">im</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#atomic_dec_and_test\">atomic_dec_and_test</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_put\">in_dev_put</a>(<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#interface\">interface</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#im\">im</a>);", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#CONFIG_IP_MULTICAST\">CONFIG_IP_MULTICAST</a>", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Timer management</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#__inline__\">__inline__</a> void <a class=\"id\" href=\"#igmp_stop_timer\">igmp_stop_timer</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#im\">im</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#del_timer\">del_timer</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#timer\">timer</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_dec\">atomic_dec</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#tm_running\">tm_running</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#reporter\">reporter</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#unsolicit_count\">unsolicit_count</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"", 
"<span class=\"comment\">/* It must be called with locked im-&gt;lock */</span>", 
"static void <a class=\"id\" href=\"#igmp_start_timer\">igmp_start_timer</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#im\">im</a>, int <a class=\"id\" href=\"#max_delay\">max_delay</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#tv\">tv</a> = <a class=\"id\" href=\"#net_random\">net_random</a>() % <a class=\"id\" href=\"#max_delay\">max_delay</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#tm_running\">tm_running</a> = 1;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#timer\">timer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>+<a class=\"id\" href=\"#tv\">tv</a>+2))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_inc\">atomic_inc</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#igmp_gq_start_timer\">igmp_gq_start_timer</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#tv\">tv</a> = <a class=\"id\" href=\"#net_random\">net_random</a>() % <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_maxdelay\">mr_maxdelay</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_gq_running\">mr_gq_running</a> = 1;", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_gq_timer\">mr_gq_timer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>+<a class=\"id\" href=\"#tv\">tv</a>+2))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_hold\">in_dev_hold</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#igmp_ifc_start_timer\">igmp_ifc_start_timer</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, int <a class=\"id\" href=\"#delay\">delay</a>)", 
"{", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#tv\">tv</a> = <a class=\"id\" href=\"#net_random\">net_random</a>() % <a class=\"id\" href=\"#delay\">delay</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#mod_timer\">mod_timer</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_timer\">mr_ifc_timer</a>, <a class=\"id\" href=\"#jiffies\">jiffies</a>+<a class=\"id\" href=\"#tv\">tv</a>+2))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_hold\">in_dev_hold</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#igmp_mod_timer\">igmp_mod_timer</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#im\">im</a>, int <a class=\"id\" href=\"#max_delay\">max_delay</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#unsolicit_count\">unsolicit_count</a> = 0;", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#del_timer\">del_timer</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#timer\">timer</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((long)(<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#timer\">timer</a>.<a class=\"id\" href=\"#expires\">expires</a>-<a class=\"id\" href=\"#jiffies\">jiffies</a>) &lt; <a class=\"id\" href=\"#max_delay\">max_delay</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#add_timer\">add_timer</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#timer\">timer</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#tm_running\">tm_running</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#atomic_dec\">atomic_dec</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#refcnt\">refcnt</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmp_start_timer\">igmp_start_timer</a>(<a class=\"id\" href=\"#im\">im</a>, <a class=\"id\" href=\"#max_delay\">max_delay</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#im\">im</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"}", 
"", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Send an IGMP report.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#IGMP_SIZE\">IGMP_SIZE</a> (sizeof(struct <a class=\"id\" href=\"#igmphdr\">igmphdr</a>)+sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>)+4)", 
"", 
"", 
"static int <a class=\"id\" href=\"#is_in\">is_in</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>, struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>, int <a class=\"id\" href=\"#type\">type</a>,", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#gdeleted\">gdeleted</a>, int <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)", 
"{", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#type\">type</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IGMPV3_MODE_IS_INCLUDE\">IGMPV3_MODE_IS_INCLUDE</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IGMPV3_MODE_IS_EXCLUDE\">IGMPV3_MODE_IS_EXCLUDE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#gdeleted\">gdeleted</a> || <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#gsquery\">gsquery</a> && !<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_gsresp\">sf_gsresp</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* don't include if this source is excluded</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * in all filters</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_MODE_IS_INCLUDE\">IGMPV3_MODE_IS_INCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] ==", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>];", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IGMPV3_CHANGE_TO_INCLUDE\">IGMPV3_CHANGE_TO_INCLUDE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#gdeleted\">gdeleted</a> || <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>] != 0;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IGMPV3_CHANGE_TO_EXCLUDE\">IGMPV3_CHANGE_TO_EXCLUDE</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#gdeleted\">gdeleted</a> || <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] == 0 ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>] ==", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_count\">sf_count</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>];", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IGMPV3_ALLOW_NEW_SOURCES\">IGMPV3_ALLOW_NEW_SOURCES</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#gdeleted\">gdeleted</a> || !<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>return (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>) ^ <a class=\"id\" href=\"#sdeleted\">sdeleted</a>;", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#IGMPV3_BLOCK_OLD_SOURCES\">IGMPV3_BLOCK_OLD_SOURCES</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#gdeleted\">gdeleted</a> || (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> && <a class=\"id\" href=\"#sdeleted\">sdeleted</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> && !<a class=\"id\" href=\"#gdeleted\">gdeleted</a> && !<a class=\"id\" href=\"#sdeleted\">sdeleted</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return 0;", 
"}", 
"", 
"static int", 
"<a class=\"id\" href=\"#igmp_scount\">igmp_scount</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>, int <a class=\"id\" href=\"#type\">type</a>, int <a class=\"id\" href=\"#gdeleted\">gdeleted</a>, int <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#scount\">scount</a> = 0;", 
"", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#is_in\">is_in</a>(<a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#psf\">psf</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#gdeleted\">gdeleted</a>, <a class=\"id\" href=\"#sdeleted\">sdeleted</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scount\">scount</a>++;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#scount\">scount</a>;", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#igmpv3_newpack\">igmpv3_newpack</a>(struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a>, int <a class=\"id\" href=\"#size\">size</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#pip\">pip</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#igmpv3_report\">igmpv3_report</a> *<a class=\"id\" href=\"#pig\">pig</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#alloc_skb\">alloc_skb</a>(<a class=\"id\" href=\"#size\">size</a> + <a class=\"id\" href=\"#LL_ALLOCATED_SPACE\">LL_ALLOCATED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> = {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#IGMPV3_ALL_MCR\">IGMPV3_ALL_MCR</a> } },", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#IPPROTO_IGMP\">IPPROTO_IGMP</a> };", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ip_route_output_key\">ip_route_output_key</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree_skb\">kfree_skb</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_set\">skb_dst_set</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#dev\">dev</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reserve\">skb_reserve</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#LL_RESERVED_SPACE\">LL_RESERVED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reset_network_header\">skb_reset_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a> = <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>) + 4);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#version\">version</a>  = 4;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#ihl\">ihl</a>      = (sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>)+4)>>2;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#tos\">tos</a>      = 0xc0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#frag_off\">frag_off</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#IP_DF\">IP_DF</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#ttl\">ttl</a>      = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#daddr\">daddr</a>    = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_dst\">rt_dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#saddr\">saddr</a>    = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#IPPROTO_IGMP\">IPPROTO_IGMP</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pip\">pip</a>-><a class=\"id\" href=\"#tot_len\">tot_len</a>  = 0;<span class=\"ts\"/><span class=\"comment\">/* filled in later */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_select_ident\">ip_select_ident</a>(<a class=\"id\" href=\"#pip\">pip</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#pip\">pip</a>[1])[0] = <a class=\"id\" href=\"#IPOPT_RA\">IPOPT_RA</a>;", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#pip\">pip</a>[1])[1] = 4;", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#pip\">pip</a>[1])[2] = 0;", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#pip\">pip</a>[1])[3] = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#transport_header\">transport_header</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#network_header\">network_header</a> + sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>) + 4;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, sizeof(*<a class=\"id\" href=\"#pig\">pig</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pig\">pig</a> = <a class=\"id\" href=\"#igmpv3_report_hdr\">igmpv3_report_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pig\">pig</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_HOST_MEMBERSHIP_REPORT\">IGMPV3_HOST_MEMBERSHIP_REPORT</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pig\">pig</a>-><a class=\"id\" href=\"#resv1\">resv1</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pig\">pig</a>-><a class=\"id\" href=\"#csum\">csum</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pig\">pig</a>-><a class=\"id\" href=\"#resv2\">resv2</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pig\">pig</a>-><a class=\"id\" href=\"#ngrec\">ngrec</a> = 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#igmpv3_sendpack\">igmpv3_sendpack</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#igmphdr\">igmphdr</a> *<a class=\"id\" href=\"#pig\">pig</a> = <a class=\"id\" href=\"#igmp_hdr\">igmp_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/>const int <a class=\"id\" href=\"#igmplen\">igmplen</a> = <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#tail\">tail</a> - <a class=\"id\" href=\"#skb\">skb</a>-><a class=\"id\" href=\"#transport_header\">transport_header</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pig\">pig</a>-><a class=\"id\" href=\"#csum\">csum</a> = <a class=\"id\" href=\"#ip_compute_csum\">ip_compute_csum</a>(<a class=\"id\" href=\"#igmp_hdr\">igmp_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>), <a class=\"id\" href=\"#igmplen\">igmplen</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ip_local_out\">ip_local_out</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#grec_size\">grec_size</a>(struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>, int <a class=\"id\" href=\"#type\">type</a>, int <a class=\"id\" href=\"#gdel\">gdel</a>, int <a class=\"id\" href=\"#sdel\">sdel</a>)", 
"{", 
"<span class=\"ts\"/>return sizeof(struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a>) + 4*<a class=\"id\" href=\"#igmp_scount\">igmp_scount</a>(<a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#gdel\">gdel</a>, <a class=\"id\" href=\"#sdel\">sdel</a>);", 
"}", 
"", 
"static struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#add_grhead\">add_grhead</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>,", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#type\">type</a>, struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a> **<a class=\"id\" href=\"#ppgr\">ppgr</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#igmpv3_report\">igmpv3_report</a> *<a class=\"id\" href=\"#pih\">pih</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a> *<a class=\"id\" href=\"#pgr\">pgr</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#igmpv3_newpack\">igmpv3_newpack</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a>);", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pgr\">pgr</a> = (struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a> *)<a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, sizeof(struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pgr\">pgr</a>-><a class=\"id\" href=\"#grec_type\">grec_type</a> = <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pgr\">pgr</a>-><a class=\"id\" href=\"#grec_auxwords\">grec_auxwords</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pgr\">pgr</a>-><a class=\"id\" href=\"#grec_nsrcs\">grec_nsrcs</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pgr\">pgr</a>-><a class=\"id\" href=\"#grec_mca\">grec_mca</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pih\">pih</a> = <a class=\"id\" href=\"#igmpv3_report_hdr\">igmpv3_report_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pih\">pih</a>-><a class=\"id\" href=\"#ngrec\">ngrec</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#ntohs\">ntohs</a>(<a class=\"id\" href=\"#pih\">pih</a>-><a class=\"id\" href=\"#ngrec\">ngrec</a>)+1);", 
"<span class=\"ts\"/>*<a class=\"id\" href=\"#ppgr\">ppgr</a> = <a class=\"id\" href=\"#pgr\">pgr</a>;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>;", 
"}", 
"", 
"#<a class=\"id\" href=\"#define\">define</a> <a class=\"id\" href=\"#AVAILABLE\">AVAILABLE</a>(<a class=\"id\" href=\"#skb\">skb</a>) ((<a class=\"id\" href=\"#skb\">skb</a>) ? ((<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#dev\">dev</a> ? (<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a> - (<a class=\"id\" href=\"#skb\">skb</a>)-><a class=\"id\" href=\"#len\">len</a> : \\", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_tailroom\">skb_tailroom</a>(<a class=\"id\" href=\"#skb\">skb</a>)) : 0)", 
"", 
"static struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#add_grec\">add_grec</a>(struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>, struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>,", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#type\">type</a>, int <a class=\"id\" href=\"#gdeleted\">gdeleted</a>, int <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#igmpv3_report\">igmpv3_report</a> *<a class=\"id\" href=\"#pih\">pih</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a> *<a class=\"id\" href=\"#pgr\">pgr</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf\">psf</a>, *<a class=\"id\" href=\"#psf_next\">psf_next</a>, *<a class=\"id\" href=\"#psf_prev\">psf_prev</a>, **<a class=\"id\" href=\"#psf_list\">psf_list</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#scount\">scount</a>, <a class=\"id\" href=\"#stotal\">stotal</a>, <a class=\"id\" href=\"#first\">first</a>, <a class=\"id\" href=\"#isquery\">isquery</a>, <a class=\"id\" href=\"#truncate\">truncate</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a> == <a class=\"id\" href=\"#IGMP_ALL_HOSTS\">IGMP_ALL_HOSTS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#isquery\">isquery</a> = <a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_MODE_IS_INCLUDE\">IGMPV3_MODE_IS_INCLUDE</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_MODE_IS_EXCLUDE\">IGMPV3_MODE_IS_EXCLUDE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#truncate\">truncate</a> = <a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_MODE_IS_EXCLUDE\">IGMPV3_MODE_IS_EXCLUDE</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_CHANGE_TO_EXCLUDE\">IGMPV3_CHANGE_TO_EXCLUDE</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#stotal\">stotal</a> = <a class=\"id\" href=\"#scount\">scount</a> = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf_list\">psf_list</a> = <a class=\"id\" href=\"#sdeleted\">sdeleted</a> ? &amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a> : &amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>;", 
"", 
"<span class=\"ts\"/>if (!*<a class=\"id\" href=\"#psf_list\">psf_list</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#empty_source\">empty_source</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pih\">pih</a> = <a class=\"id\" href=\"#skb\">skb</a> ? <a class=\"id\" href=\"#igmpv3_report_hdr\">igmpv3_report_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>) : <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* EX and TO_EX get a fresh packet, if needed */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#truncate\">truncate</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pih\">pih</a> && <a class=\"id\" href=\"#pih\">pih</a>-><a class=\"id\" href=\"#ngrec\">ngrec</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#AVAILABLE\">AVAILABLE</a>(<a class=\"id\" href=\"#skb\">skb</a>) &lt; <a class=\"id\" href=\"#grec_size\">grec_size</a>(<a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#gdeleted\">gdeleted</a>, <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_sendpack\">igmpv3_sendpack</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#igmpv3_newpack\">igmpv3_newpack</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#first\">first</a> = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=*<a class=\"id\" href=\"#psf_list\">psf_list</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a>=<a class=\"id\" href=\"#psf_next\">psf_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a> *<a class=\"id\" href=\"#psrc\">psrc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_next\">psf_next</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#is_in\">is_in</a>(<a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#psf\">psf</a>, <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#gdeleted\">gdeleted</a>, <a class=\"id\" href=\"#sdeleted\">sdeleted</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* clear marks on query responses */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#isquery\">isquery</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_gsresp\">sf_gsresp</a> = 0;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#AVAILABLE\">AVAILABLE</a>(<a class=\"id\" href=\"#skb\">skb</a>) &lt; sizeof(<a class=\"id\" href=\"#__be32\">__be32</a>) +", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#first\">first</a>*sizeof(struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#truncate\">truncate</a> && !<a class=\"id\" href=\"#first\">first</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>break;<span class=\"ts\"/> <span class=\"comment\">/* truncate these */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pgr\">pgr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pgr\">pgr</a>-><a class=\"id\" href=\"#grec_nsrcs\">grec_nsrcs</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#scount\">scount</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_sendpack\">igmpv3_sendpack</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#igmpv3_newpack\">igmpv3_newpack</a>(<a class=\"id\" href=\"#dev\">dev</a>, <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#mtu\">mtu</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#first\">first</a> = 1;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scount\">scount</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#first\">first</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grhead\">add_grhead</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, &amp;<a class=\"id\" href=\"#pgr\">pgr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#first\">first</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psrc\">psrc</a> = (<a class=\"id\" href=\"#__be32\">__be32</a> *)<a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, sizeof(<a class=\"id\" href=\"#__be32\">__be32</a>));", 
"<span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#psrc\">psrc</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_inaddr\">sf_inaddr</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#scount\">scount</a>++; <a class=\"id\" href=\"#stotal\">stotal</a>++;", 
"<span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_ALLOW_NEW_SOURCES\">IGMPV3_ALLOW_NEW_SOURCES</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>     <a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_BLOCK_OLD_SOURCES\">IGMPV3_BLOCK_OLD_SOURCES</a>) && <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if ((<a class=\"id\" href=\"#sdeleted\">sdeleted</a> || <a class=\"id\" href=\"#gdeleted\">gdeleted</a>) && <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf_prev\">psf_prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#psf_list\">psf_list</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#psf\">psf</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<a class=\"id\" href=\"#empty_source\">empty_source</a>:", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#stotal\">stotal</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_ALLOW_NEW_SOURCES\">IGMPV3_ALLOW_NEW_SOURCES</a> ||", 
"<span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_BLOCK_OLD_SOURCES\">IGMPV3_BLOCK_OLD_SOURCES</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a> || <a class=\"id\" href=\"#isquery\">isquery</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* make sure we have room for group header */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> && <a class=\"id\" href=\"#AVAILABLE\">AVAILABLE</a>(<a class=\"id\" href=\"#skb\">skb</a>)&lt;sizeof(struct <a class=\"id\" href=\"#igmpv3_grec\">igmpv3_grec</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_sendpack\">igmpv3_sendpack</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>; <span class=\"comment\">/* add_grhead will get a new one */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grhead\">add_grhead</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, &amp;<a class=\"id\" href=\"#pgr\">pgr</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#pgr\">pgr</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pgr\">pgr</a>-><a class=\"id\" href=\"#grec_nsrcs\">grec_nsrcs</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#scount\">scount</a>);", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#isquery\">isquery</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#gsquery\">gsquery</a> = 0;<span class=\"ts\"/><span class=\"comment\">/* clear query state on report */</span>", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#skb\">skb</a>;", 
"}", 
"", 
"static int <a class=\"id\" href=\"#igmpv3_send_report\">igmpv3_send_report</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#type\">type</a>;", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#pmc\">pmc</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a> == <a class=\"id\" href=\"#IGMP_ALL_HOSTS\">IGMP_ALL_HOSTS</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>continue;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_MODE_IS_EXCLUDE\">IGMPV3_MODE_IS_EXCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_MODE_IS_INCLUDE\">IGMPV3_MODE_IS_INCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, 0, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>])", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_MODE_IS_EXCLUDE\">IGMPV3_MODE_IS_EXCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_MODE_IS_INCLUDE\">IGMPV3_MODE_IS_INCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, 0, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return 0;", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#igmpv3_sendpack\">igmpv3_sendpack</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"}", 
"", 
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> * remove zero-count source records from a source filter list</span>", 
"<span class=\"comment\"> */</span>", 
"static void <a class=\"id\" href=\"#igmpv3_clear_zeros\">igmpv3_clear_zeros</a>(struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> **<a class=\"id\" href=\"#ppsf\">ppsf</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_sf_list\">ip_sf_list</a> *<a class=\"id\" href=\"#psf_prev\">psf_prev</a>, *<a class=\"id\" href=\"#psf_next\">psf_next</a>, *<a class=\"id\" href=\"#psf\">psf</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#psf\">psf</a>=*<a class=\"id\" href=\"#ppsf\">ppsf</a>; <a class=\"id\" href=\"#psf\">psf</a>; <a class=\"id\" href=\"#psf\">psf</a> = <a class=\"id\" href=\"#psf_next\">psf_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_next\">psf_next</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_crcount\">sf_crcount</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#psf_prev\">psf_prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>*<a class=\"id\" href=\"#ppsf\">ppsf</a> = <a class=\"id\" href=\"#psf\">psf</a>-><a class=\"id\" href=\"#sf_next\">sf_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#psf\">psf</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#psf_prev\">psf_prev</a> = <a class=\"id\" href=\"#psf\">psf</a>;", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"static void <a class=\"id\" href=\"#igmpv3_send_cr\">igmpv3_send_cr</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>, *<a class=\"id\" href=\"#pmc_prev\">pmc_prev</a>, *<a class=\"id\" href=\"#pmc_next\">pmc_next</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#type\">type</a>, <a class=\"id\" href=\"#dtype\">dtype</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_lock\">read_lock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_tomb_lock\">mc_tomb_lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* deleted MCA's */</span>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#pmc_prev\">pmc_prev</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_tomb\">mc_tomb</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc_next\">pmc_next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc_next\">pmc_next</a> = <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_INCLUDE\">MCAST_INCLUDE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_BLOCK_OLD_SOURCES\">IGMPV3_BLOCK_OLD_SOURCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dtype\">dtype</a> = <a class=\"id\" href=\"#IGMPV3_BLOCK_OLD_SOURCES\">IGMPV3_BLOCK_OLD_SOURCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, 1, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#dtype\">dtype</a>, 1, 1);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_CHANGE_TO_INCLUDE\">IGMPV3_CHANGE_TO_INCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, 1, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_clear_zeros\">igmpv3_clear_zeros</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_clear_zeros\">igmpv3_clear_zeros</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a> == 0 && !<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#tomb\">tomb</a> && !<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sources\">sources</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc_prev\">pmc_prev</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc_prev\">pmc_prev</a>-><a class=\"id\" href=\"#next\">next</a> = <a class=\"id\" href=\"#pmc_next\">pmc_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_tomb\">mc_tomb</a> = <a class=\"id\" href=\"#pmc_next\">pmc_next</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev_put\">in_dev_put</a>(<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#interface\">interface</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#pmc\">pmc</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc_prev\">pmc_prev</a> = <a class=\"id\" href=\"#pmc\">pmc</a>;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_tomb_lock\">mc_tomb_lock</a>);", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* change recs */</span>", 
"<span class=\"ts\"/>for (<a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list\">mc_list</a>; <a class=\"id\" href=\"#pmc\">pmc</a>; <a class=\"id\" href=\"#pmc\">pmc</a>=<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#next\">next</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_lock_bh\">spin_lock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfcount\">sfcount</a>[<a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>]) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_BLOCK_OLD_SOURCES\">IGMPV3_BLOCK_OLD_SOURCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dtype\">dtype</a> = <a class=\"id\" href=\"#IGMPV3_ALLOW_NEW_SOURCES\">IGMPV3_ALLOW_NEW_SOURCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_ALLOW_NEW_SOURCES\">IGMPV3_ALLOW_NEW_SOURCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dtype\">dtype</a> = <a class=\"id\" href=\"#IGMPV3_BLOCK_OLD_SOURCES\">IGMPV3_BLOCK_OLD_SOURCES</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, 0, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#dtype\">dtype</a>, 0, 1);<span class=\"ts\"/><span class=\"comment\">/* deleted sources */</span>", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/* filter mode changes */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#sfmode\">sfmode</a> == <a class=\"id\" href=\"#MCAST_EXCLUDE\">MCAST_EXCLUDE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_CHANGE_TO_EXCLUDE\">IGMPV3_CHANGE_TO_EXCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#IGMPV3_CHANGE_TO_INCLUDE\">IGMPV3_CHANGE_TO_INCLUDE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#add_grec\">add_grec</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#pmc\">pmc</a>, <a class=\"id\" href=\"#type\">type</a>, 0, 0);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#crcount\">crcount</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#spin_unlock_bh\">spin_unlock_bh</a>(&amp;<a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#lock\">lock</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#read_unlock\">read_unlock</a>(&amp;<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mc_list_lock\">mc_list_lock</a>);", 
"", 
"<span class=\"ts\"/>if (!<a class=\"id\" href=\"#skb\">skb</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/>(void) <a class=\"id\" href=\"#igmpv3_sendpack\">igmpv3_sendpack</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"}", 
"", 
"static int <a class=\"id\" href=\"#igmp_send_report\">igmp_send_report</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>, struct <a class=\"id\" href=\"#ip_mc_list\">ip_mc_list</a> *<a class=\"id\" href=\"#pmc\">pmc</a>,", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#type\">type</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#sk_buff\">sk_buff</a> *<a class=\"id\" href=\"#skb\">skb</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#iphdr\">iphdr</a> *<a class=\"id\" href=\"#iph\">iph</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#igmphdr\">igmphdr</a> *<a class=\"id\" href=\"#ih\">ih</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#rtable\">rtable</a> *<a class=\"id\" href=\"#rt\">rt</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net_device\">net_device</a> *<a class=\"id\" href=\"#dev\">dev</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#dev\">dev</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#net\">net</a> *<a class=\"id\" href=\"#net\">net</a> = <a class=\"id\" href=\"#dev_net\">dev_net</a>(<a class=\"id\" href=\"#dev\">dev</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><a class=\"id\" href=\"#group\">group</a> = <a class=\"id\" href=\"#pmc\">pmc</a> ? <a class=\"id\" href=\"#pmc\">pmc</a>-><a class=\"id\" href=\"#multiaddr\">multiaddr</a> : 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__be32\">__be32</a><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMPV3_HOST_MEMBERSHIP_REPORT\">IGMPV3_HOST_MEMBERSHIP_REPORT</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#igmpv3_send_report\">igmpv3_send_report</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#pmc\">pmc</a>);", 
"<span class=\"ts\"/>else if (<a class=\"id\" href=\"#type\">type</a> == <a class=\"id\" href=\"#IGMP_HOST_LEAVE_MESSAGE\">IGMP_HOST_LEAVE_MESSAGE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#IGMP_ALL_ROUTER\">IGMP_ALL_ROUTER</a>;", 
"<span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#dst\">dst</a> = <a class=\"id\" href=\"#group\">group</a>;", 
"", 
"<span class=\"ts\"/>{", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#flowi\">flowi</a> <a class=\"id\" href=\"#fl\">fl</a> = { .<a class=\"id\" href=\"#oif\">oif</a> = <a class=\"id\" href=\"#dev\">dev</a>-><a class=\"id\" href=\"#ifindex\">ifindex</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#nl_u\">nl_u</a> = { .<a class=\"id\" href=\"#ip4_u\">ip4_u</a> = { .<a class=\"id\" href=\"#daddr\">daddr</a> = <a class=\"id\" href=\"#dst\">dst</a> } },", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    .<a class=\"id\" href=\"#proto\">proto</a> = <a class=\"id\" href=\"#IPPROTO_IGMP\">IPPROTO_IGMP</a> };", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#ip_route_output_key\">ip_route_output_key</a>(<a class=\"id\" href=\"#net\">net</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>, &amp;<a class=\"id\" href=\"#fl\">fl</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb\">skb</a> = <a class=\"id\" href=\"#alloc_skb\">alloc_skb</a>(<a class=\"id\" href=\"#IGMP_SIZE\">IGMP_SIZE</a>+<a class=\"id\" href=\"#LL_ALLOCATED_SPACE\">LL_ALLOCATED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>), <a class=\"id\" href=\"#GFP_ATOMIC\">GFP_ATOMIC</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#skb\">skb</a> == <a class=\"id\" href=\"#NULL\">NULL</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ip_rt_put\">ip_rt_put</a>(<a class=\"id\" href=\"#rt\">rt</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return -1;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_dst_set\">skb_dst_set</a>(<a class=\"id\" href=\"#skb\">skb</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reserve\">skb_reserve</a>(<a class=\"id\" href=\"#skb\">skb</a>, <a class=\"id\" href=\"#LL_RESERVED_SPACE\">LL_RESERVED_SPACE</a>(<a class=\"id\" href=\"#dev\">dev</a>));", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_reset_network_header\">skb_reset_network_header</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a> = <a class=\"id\" href=\"#ip_hdr\">ip_hdr</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>) + 4);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#version\">version</a>  = 4;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#ihl\">ihl</a>      = (sizeof(struct <a class=\"id\" href=\"#iphdr\">iphdr</a>)+4)>>2;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#tos\">tos</a>      = 0xc0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#frag_off\">frag_off</a> = <a class=\"id\" href=\"#htons\">htons</a>(<a class=\"id\" href=\"#IP_DF\">IP_DF</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#ttl\">ttl</a>      = 1;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#daddr\">daddr</a>    = <a class=\"id\" href=\"#dst\">dst</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#saddr\">saddr</a>    = <a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#rt_src\">rt_src</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#iph\">iph</a>-><a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#IPPROTO_IGMP\">IPPROTO_IGMP</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ip_select_ident\">ip_select_ident</a>(<a class=\"id\" href=\"#iph\">iph</a>, &amp;<a class=\"id\" href=\"#rt\">rt</a>-><a class=\"id\" href=\"#dst\">dst</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#iph\">iph</a>[1])[0] = <a class=\"id\" href=\"#IPOPT_RA\">IPOPT_RA</a>;", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#iph\">iph</a>[1])[1] = 4;", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#iph\">iph</a>[1])[2] = 0;", 
"<span class=\"ts\"/>((<a class=\"id\" href=\"#u8\">u8</a>*)&amp;<a class=\"id\" href=\"#iph\">iph</a>[1])[3] = 0;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ih\">ih</a> = (struct <a class=\"id\" href=\"#igmphdr\">igmphdr</a> *)<a class=\"id\" href=\"#skb_put\">skb_put</a>(<a class=\"id\" href=\"#skb\">skb</a>, sizeof(struct <a class=\"id\" href=\"#igmphdr\">igmphdr</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ih\">ih</a>-><a class=\"id\" href=\"#type\">type</a> = <a class=\"id\" href=\"#type\">type</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ih\">ih</a>-><a class=\"id\" href=\"#code\">code</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ih\">ih</a>-><a class=\"id\" href=\"#csum\">csum</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ih\">ih</a>-><a class=\"id\" href=\"#group\">group</a> = <a class=\"id\" href=\"#group\">group</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ih\">ih</a>-><a class=\"id\" href=\"#csum\">csum</a> = <a class=\"id\" href=\"#ip_compute_csum\">ip_compute_csum</a>((void *)<a class=\"id\" href=\"#ih\">ih</a>, sizeof(struct <a class=\"id\" href=\"#igmphdr\">igmphdr</a>));", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ip_local_out\">ip_local_out</a>(<a class=\"id\" href=\"#skb\">skb</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#igmp_gq_timer_expire\">igmp_gq_timer_expire</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = (struct <a class=\"id\" href=\"#in_device\">in_device</a> *)<a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_gq_running\">mr_gq_running</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_send_report\">igmpv3_send_report</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#NULL\">NULL</a>);", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__in_dev_put\">__in_dev_put</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#igmp_ifc_timer_expire\">igmp_ifc_timer_expire</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a> = (struct <a class=\"id\" href=\"#in_device\">in_device</a> *)<a class=\"id\" href=\"#data\">data</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmpv3_send_cr\">igmpv3_send_cr</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_count\">mr_ifc_count</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_count\">mr_ifc_count</a>--;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#igmp_ifc_start_timer\">igmp_ifc_start_timer</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, <a class=\"id\" href=\"#IGMP_Unsolicited_Report_Interval\">IGMP_Unsolicited_Report_Interval</a>);", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/><a class=\"id\" href=\"#__in_dev_put\">__in_dev_put</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>);", 
"}", 
"", 
"static void <a class=\"id\" href=\"#igmp_ifc_event\">igmp_ifc_event</a>(struct <a class=\"id\" href=\"#in_device\">in_device</a> *<a class=\"id\" href=\"#in_dev\">in_dev</a>)", 
"{", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#IGMP_V1_SEEN\">IGMP_V1_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>) || <a class=\"id\" href=\"#IGMP_V2_SEEN\">IGMP_V2_SEEN</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/>return;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_ifc_count\">mr_ifc_count</a> = <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> ? <a class=\"id\" href=\"#in_dev\">in_dev</a>-><a class=\"id\" href=\"#mr_qrv\">mr_qrv</a> :", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#IGMP_Unsolicited_Report_Count\">IGMP_Unsolicited_Report_Count</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#igmp_ifc_start_timer\">igmp_ifc_start_timer</a>(<a class=\"id\" href=\"#in_dev\">in_dev</a>, 1);", 
"}", 
"", 
"", 
"static void <a class=\"id\" href=\"#igmp_timer_expire\">igmp_timer_expire</a>(unsigned long <a class=\"id\" href=\"#data\">data</a>)", 
"{", 
];
xr_frag_insert('l/f7/6519c7d77a4cb4cc73ec397113a030fe57f12c.xr', __xr_tmp);
