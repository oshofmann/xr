var __xr_tmp = [
"<span class=\"comment\">/*</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>IDE I/O functions</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>Basic PIO and command management functionality.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This code was split off from ide.c. See ide.c for history and original</span>", 
"<span class=\"comment\"> * copyrights.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is free software; you can redistribute it and/or modify it</span>", 
"<span class=\"comment\"> * under the terms of the GNU General Public License as published by the</span>", 
"<span class=\"comment\"> * Free Software Foundation; either version 2, or (at your option) any</span>", 
"<span class=\"comment\"> * later version.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * This program is distributed in the hope that it will be useful, but</span>", 
"<span class=\"comment\"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>", 
"<span class=\"comment\"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>", 
"<span class=\"comment\"> * General Public License for more details.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> * For the avoidance of doubt the \"preferred form\" of this code is one which</span>", 
"<span class=\"comment\"> * is in an open non patent encumbered format. Where cryptographic key signing</span>", 
"<span class=\"comment\"> * forms part of the process of creating an executable the information</span>", 
"<span class=\"comment\"> * including keys needed to generate an equivalently functional executable</span>", 
"<span class=\"comment\"> * are deemed to be part of the source code.</span>", 
"<span class=\"comment\"> */</span>", 
" ", 
" ", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#module\">module</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#types\">types</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#string\">string</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kernel\">kernel</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#timer\">timer</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#mm\">mm</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#interrupt\">interrupt</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#major\">major</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#errno\">errno</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#genhd\">genhd</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#blkpg\">blkpg</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#slab\">slab</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#init\">init</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#pci\">pci</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#delay\">delay</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#ide\">ide</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#completion\">completion</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#reboot\">reboot</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#cdrom\">cdrom</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#seq_file\">seq_file</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#device\">device</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#kmod\">kmod</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#scatterlist\">scatterlist</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#linux\">linux</a>/<a class=\"id\" href=\"#bitops\">bitops</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#byteorder\">byteorder</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#irq\">irq</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#uaccess\">uaccess</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"#<a class=\"id\" href=\"#include\">include</a> &lt;<a class=\"id\" href=\"#asm\">asm</a>/<a class=\"id\" href=\"#io\">io</a>.<a class=\"id\" href=\"#h\">h</a>&gt;", 
"", 
"int <a class=\"id\" href=\"#ide_end_rq\">ide_end_rq</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>, int <a class=\"id\" href=\"#error\">error</a>,", 
"<span class=\"ts\"/>       unsigned int <a class=\"id\" href=\"#nr_bytes\">nr_bytes</a>)", 
"{", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * decide whether to reenable DMA -- 3 is a random magic for now,</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * if we DMA timeout more than 3 times, just stay in PIO</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dev_flags\">dev_flags</a> &amp; <a class=\"id\" href=\"#IDE_DFLAG_DMA_PIO_RETRY\">IDE_DFLAG_DMA_PIO_RETRY</a>) &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#retry_pio\">retry_pio</a> <= 3) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dev_flags\">dev_flags</a> &= ~<a class=\"id\" href=\"#IDE_DFLAG_DMA_PIO_RETRY\">IDE_DFLAG_DMA_PIO_RETRY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_dma_on\">ide_dma_on</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#blk_end_request\">blk_end_request</a>(<a class=\"id\" href=\"#rq\">rq</a>, <a class=\"id\" href=\"#error\">error</a>, <a class=\"id\" href=\"#nr_bytes\">nr_bytes</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#ide_end_rq\">ide_end_rq</a>);", 
"", 
"void <a class=\"id\" href=\"#ide_complete_cmd\">ide_complete_cmd</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#ide_cmd\">ide_cmd</a> *<a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#stat\">stat</a>, <a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#err\">err</a>)", 
"{", 
"<span class=\"ts\"/>const struct <a class=\"id\" href=\"#ide_tp_ops\">ide_tp_ops</a> *<a class=\"id\" href=\"#tp_ops\">tp_ops</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#tp_ops\">tp_ops</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ide_taskfile\">ide_taskfile</a> *<a class=\"id\" href=\"#tf\">tf</a> = &amp;<a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#tf\">tf</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a> = <a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#rq\">rq</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#tf_cmd\">tf_cmd</a> = <a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#command\">command</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#error\">error</a> = <a class=\"id\" href=\"#err\">err</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#status\">status</a> = <a class=\"id\" href=\"#stat\">stat</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#ftf_flags\">ftf_flags</a> &amp; <a class=\"id\" href=\"#IDE_FTFLAG_IN_DATA\">IDE_FTFLAG_IN_DATA</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#data\">data</a>[2];", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#tp_ops\">tp_ops</a>-><a class=\"id\" href=\"#input_data\">input_data</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#data\">data</a>, 2);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#tf\">tf</a>.<a class=\"id\" href=\"#data\">data</a>  = <a class=\"id\" href=\"#data\">data</a>[0];", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#hob\">hob</a>.<a class=\"id\" href=\"#data\">data</a> = <a class=\"id\" href=\"#data\">data</a>[1];", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_tf_readback\">ide_tf_readback</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#cmd\">cmd</a>);", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#tf_flags\">tf_flags</a> &amp; <a class=\"id\" href=\"#IDE_TFLAG_CUSTOM_HANDLER\">IDE_TFLAG_CUSTOM_HANDLER</a>) &&", 
"<span class=\"ts\"/>    <a class=\"id\" href=\"#tf_cmd\">tf_cmd</a> == <a class=\"id\" href=\"#ATA_CMD_IDLEIMMEDIATE\">ATA_CMD_IDLEIMMEDIATE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#lbal\">lbal</a> != 0xc4) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"%s: head unload failed!\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>       <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_tf_dump\">ide_tf_dump</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#cmd\">cmd</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#dev_flags\">dev_flags</a> |= <a class=\"id\" href=\"#IDE_DFLAG_PARKED\">IDE_DFLAG_PARKED</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rq\">rq</a> && <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_ATA_TASKFILE\">REQ_TYPE_ATA_TASKFILE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ide_cmd\">ide_cmd</a> *<a class=\"id\" href=\"#orig_cmd\">orig_cmd</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#tf_flags\">tf_flags</a> &amp; <a class=\"id\" href=\"#IDE_TFLAG_DYN\">IDE_TFLAG_DYN</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#kfree\">kfree</a>(<a class=\"id\" href=\"#orig_cmd\">orig_cmd</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#memcpy\">memcpy</a>(<a class=\"id\" href=\"#orig_cmd\">orig_cmd</a>, <a class=\"id\" href=\"#cmd\">cmd</a>, sizeof(*<a class=\"id\" href=\"#cmd\">cmd</a>));", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"int <a class=\"id\" href=\"#ide_complete_rq\">ide_complete_rq</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, int <a class=\"id\" href=\"#error\">error</a>, unsigned int <a class=\"id\" href=\"#nr_bytes\">nr_bytes</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_hwif_t\">ide_hwif_t</a> *<a class=\"id\" href=\"#hwif\">hwif</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a> = <a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#rq\">rq</a>;", 
"<span class=\"ts\"/>int <a class=\"id\" href=\"#rc\">rc</a>;", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * if failfast is set on a request, override number of sectors</span>", 
"<span class=\"comment\"><span class=\"ts\"/> * and complete the whole request right now</span>", 
"<span class=\"comment\"><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#blk_noretry_request\">blk_noretry_request</a>(<a class=\"id\" href=\"#rq\">rq</a>) && <a class=\"id\" href=\"#error\">error</a> <= 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#nr_bytes\">nr_bytes</a> = <a class=\"id\" href=\"#blk_rq_sectors\">blk_rq_sectors</a>(<a class=\"id\" href=\"#rq\">rq</a>) << 9;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rc\">rc</a> = <a class=\"id\" href=\"#ide_end_rq\">ide_end_rq</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>, <a class=\"id\" href=\"#error\">error</a>, <a class=\"id\" href=\"#nr_bytes\">nr_bytes</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#rc\">rc</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#rq\">rq</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#rc\">rc</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL\">EXPORT_SYMBOL</a>(<a class=\"id\" href=\"#ide_complete_rq\">ide_complete_rq</a>);", 
"", 
"void <a class=\"id\" href=\"#ide_kill_rq\">ide_kill_rq</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#drv_req\">drv_req</a> = (<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_SPECIAL\">REQ_TYPE_SPECIAL</a>) && <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#rq_disk\">rq_disk</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#media\">media</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#media\">media</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#failed_pc\">failed_pc</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"", 
"<span class=\"ts\"/>if ((<a class=\"id\" href=\"#media\">media</a> == <a class=\"id\" href=\"#ide_floppy\">ide_floppy</a> || <a class=\"id\" href=\"#media\">media</a> == <a class=\"id\" href=\"#ide_tape\">ide_tape</a>) && <a class=\"id\" href=\"#drv_req\">drv_req</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#errors\">errors</a> = 0;", 
"<span class=\"ts\"/>} else {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#media\">media</a> == <a class=\"id\" href=\"#ide_tape\">ide_tape</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#errors\">errors</a> = <a class=\"id\" href=\"#IDE_DRV_ERROR_GENERAL\">IDE_DRV_ERROR_GENERAL</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> != <a class=\"id\" href=\"#REQ_TYPE_FS\">REQ_TYPE_FS</a> && <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#errors\">errors</a> == 0)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#errors\">errors</a> = -<a class=\"id\" href=\"#EIO\">EIO</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_complete_rq\">ide_complete_rq</a>(<a class=\"id\" href=\"#drive\">drive</a>, -<a class=\"id\" href=\"#EIO\">EIO</a>, <a class=\"id\" href=\"#blk_rq_bytes\">blk_rq_bytes</a>(<a class=\"id\" href=\"#rq\">rq</a>));", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ide_tf_set_specify_cmd\">ide_tf_set_specify_cmd</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#ide_taskfile\">ide_taskfile</a> *<a class=\"id\" href=\"#tf\">tf</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#nsect\">nsect</a>   = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#sect\">sect</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#lbal\">lbal</a>    = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#sect\">sect</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#lbam\">lbam</a>    = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#cyl\">cyl</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#lbah\">lbah</a>    = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#cyl\">cyl</a> >> 8;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#device\">device</a>  = (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#head\">head</a> - 1) | <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#select\">select</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#command\">command</a> = <a class=\"id\" href=\"#ATA_CMD_INIT_DEV_PARAMS\">ATA_CMD_INIT_DEV_PARAMS</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ide_tf_set_restore_cmd\">ide_tf_set_restore_cmd</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#ide_taskfile\">ide_taskfile</a> *<a class=\"id\" href=\"#tf\">tf</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#nsect\">nsect</a>   = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#sect\">sect</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#command\">command</a> = <a class=\"id\" href=\"#ATA_CMD_RESTORE\">ATA_CMD_RESTORE</a>;", 
"}", 
"", 
"static void <a class=\"id\" href=\"#ide_tf_set_setmult_cmd\">ide_tf_set_setmult_cmd</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#ide_taskfile\">ide_taskfile</a> *<a class=\"id\" href=\"#tf\">tf</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#nsect\">nsect</a>   = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#mult_req\">mult_req</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#tf\">tf</a>-><a class=\"id\" href=\"#command\">command</a> = <a class=\"id\" href=\"#ATA_CMD_SET_MULTI\">ATA_CMD_SET_MULTI</a>;", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>do_special<span class=\"ts\"/><span class=\"ts\"/>-<span class=\"ts\"/>issue some special commands</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@drive: drive the command is for</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>do_special() is used to issue ATA_CMD_INIT_DEV_PARAMS,</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>ATA_CMD_RESTORE and ATA_CMD_SET_MULTI commands to a drive.</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#ide_startstop_t\">ide_startstop_t</a> <a class=\"id\" href=\"#do_special\">do_special</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ide_cmd\">ide_cmd</a> <a class=\"id\" href=\"#cmd\">cmd</a>;", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#DEBUG\">DEBUG</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_DEBUG\">KERN_DEBUG</a> \"%s: %s: 0x%02x\\n\", <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#__func__\">__func__</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#media\">media</a> != <a class=\"id\" href=\"#ide_disk\">ide_disk</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#mult_req\">mult_req</a> = 0;", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ide_stopped\">ide_stopped</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#memset\">memset</a>(&amp;<a class=\"id\" href=\"#cmd\">cmd</a>, 0, sizeof(<a class=\"id\" href=\"#cmd\">cmd</a>));", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#protocol\">protocol</a> = <a class=\"id\" href=\"#ATA_PROT_NODATA\">ATA_PROT_NODATA</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> &amp; <a class=\"id\" href=\"#IDE_SFLAG_SET_GEOMETRY\">IDE_SFLAG_SET_GEOMETRY</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> &= ~<a class=\"id\" href=\"#IDE_SFLAG_SET_GEOMETRY\">IDE_SFLAG_SET_GEOMETRY</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_tf_set_specify_cmd\">ide_tf_set_specify_cmd</a>(<a class=\"id\" href=\"#drive\">drive</a>, &amp;<a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf\">tf</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> &amp; <a class=\"id\" href=\"#IDE_SFLAG_RECALIBRATE\">IDE_SFLAG_RECALIBRATE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> &= ~<a class=\"id\" href=\"#IDE_SFLAG_RECALIBRATE\">IDE_SFLAG_RECALIBRATE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_tf_set_restore_cmd\">ide_tf_set_restore_cmd</a>(<a class=\"id\" href=\"#drive\">drive</a>, &amp;<a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf\">tf</a>);", 
"<span class=\"ts\"/>} else if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> &amp; <a class=\"id\" href=\"#IDE_SFLAG_SET_MULTMODE\">IDE_SFLAG_SET_MULTMODE</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> &= ~<a class=\"id\" href=\"#IDE_SFLAG_SET_MULTMODE\">IDE_SFLAG_SET_MULTMODE</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_tf_set_setmult_cmd\">ide_tf_set_setmult_cmd</a>(<a class=\"id\" href=\"#drive\">drive</a>, &amp;<a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf\">tf</a>);", 
"<span class=\"ts\"/>} else", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#valid\">valid</a>.<a class=\"id\" href=\"#out\">out</a>.<a class=\"id\" href=\"#tf\">tf</a> = <a class=\"id\" href=\"#IDE_VALID_OUT_TF\">IDE_VALID_OUT_TF</a> | <a class=\"id\" href=\"#IDE_VALID_DEVICE\">IDE_VALID_DEVICE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#valid\">valid</a>.<a class=\"id\" href=\"#in\">in</a>.<a class=\"id\" href=\"#tf\">tf</a>  = <a class=\"id\" href=\"#IDE_VALID_IN_TF\">IDE_VALID_IN_TF</a>  | <a class=\"id\" href=\"#IDE_VALID_DEVICE\">IDE_VALID_DEVICE</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>.<a class=\"id\" href=\"#tf_flags\">tf_flags</a> = <a class=\"id\" href=\"#IDE_TFLAG_CUSTOM_HANDLER\">IDE_TFLAG_CUSTOM_HANDLER</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#do_rw_taskfile\">do_rw_taskfile</a>(<a class=\"id\" href=\"#drive\">drive</a>, &amp;<a class=\"id\" href=\"#cmd\">cmd</a>);", 
"", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#ide_started\">ide_started</a>;", 
"}", 
"", 
"void <a class=\"id\" href=\"#ide_map_sg\">ide_map_sg</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#ide_cmd\">ide_cmd</a> *<a class=\"id\" href=\"#cmd\">cmd</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_hwif_t\">ide_hwif_t</a> *<a class=\"id\" href=\"#hwif\">hwif</a> = <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#scatterlist\">scatterlist</a> *<a class=\"id\" href=\"#sg\">sg</a> = <a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#sg_table\">sg_table</a>;", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a> = <a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#rq\">rq</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#sg_nents\">sg_nents</a> = <a class=\"id\" href=\"#blk_rq_map_sg\">blk_rq_map_sg</a>(<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#queue\">queue</a>, <a class=\"id\" href=\"#rq\">rq</a>, <a class=\"id\" href=\"#sg\">sg</a>);", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#ide_map_sg\">ide_map_sg</a>);", 
"", 
"void <a class=\"id\" href=\"#ide_init_sg_cmd\">ide_init_sg_cmd</a>(struct <a class=\"id\" href=\"#ide_cmd\">ide_cmd</a> *<a class=\"id\" href=\"#cmd\">cmd</a>, unsigned int <a class=\"id\" href=\"#nr_bytes\">nr_bytes</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#nbytes\">nbytes</a> = <a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#nleft\">nleft</a> = <a class=\"id\" href=\"#nr_bytes\">nr_bytes</a>;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#cursg_ofs\">cursg_ofs</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#cursg\">cursg</a> = <a class=\"id\" href=\"#NULL\">NULL</a>;", 
"}", 
"<a class=\"id\" href=\"#EXPORT_SYMBOL_GPL\">EXPORT_SYMBOL_GPL</a>(<a class=\"id\" href=\"#ide_init_sg_cmd\">ide_init_sg_cmd</a>);", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>execute_drive_command<span class=\"ts\"/>-<span class=\"ts\"/>issue special drive command</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@drive: the drive to issue the command on</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>@rq: the request structure holding the command</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>execute_drive_cmd() issues a special drive command,  usually </span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>initiated by ioctl() from the external hdparm program. The</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>command can be a drive command, drive task or taskfile </span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>operation. Weirdly you can call it with NULL to wait for</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>all commands to finish. Don't do this as that is due to change</span>", 
"<span class=\"comment\"> */</span>", 
"", 
"static <a class=\"id\" href=\"#ide_startstop_t\">ide_startstop_t</a> <a class=\"id\" href=\"#execute_drive_cmd\">execute_drive_cmd</a> (<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/>struct <a class=\"id\" href=\"#ide_cmd\">ide_cmd</a> *<a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a>;", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#cmd\">cmd</a>-><a class=\"id\" href=\"#protocol\">protocol</a> == <a class=\"id\" href=\"#ATA_PROT_PIO\">ATA_PROT_PIO</a>) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_init_sg_cmd\">ide_init_sg_cmd</a>(<a class=\"id\" href=\"#cmd\">cmd</a>, <a class=\"id\" href=\"#blk_rq_sectors\">blk_rq_sectors</a>(<a class=\"id\" href=\"#rq\">rq</a>) << 9);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_map_sg\">ide_map_sg</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#cmd\">cmd</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#do_rw_taskfile\">do_rw_taskfile</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#cmd\">cmd</a>);", 
"<span class=\"ts\"/>}", 
"", 
" <span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"> <span class=\"ts\"/> * NULL is actually a valid way of waiting for</span>", 
"<span class=\"comment\"> <span class=\"ts\"/> * all current requests to be flushed from the queue.</span>", 
"<span class=\"comment\"> <span class=\"ts\"/> */</span>", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#DEBUG\">DEBUG</a>", 
" <span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"%s: DRIVE_CMD (null)\\n\", <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#errors\">errors</a> = 0;", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_complete_rq\">ide_complete_rq</a>(<a class=\"id\" href=\"#drive\">drive</a>, 0, <a class=\"id\" href=\"#blk_rq_bytes\">blk_rq_bytes</a>(<a class=\"id\" href=\"#rq\">rq</a>));", 
"", 
" <span class=\"ts\"/>return <a class=\"id\" href=\"#ide_stopped\">ide_stopped</a>;", 
"}", 
"", 
"static <a class=\"id\" href=\"#ide_startstop_t\">ide_startstop_t</a> <a class=\"id\" href=\"#ide_special_rq\">ide_special_rq</a>(<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#u8\">u8</a> <a class=\"id\" href=\"#cmd\">cmd</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd\">cmd</a>[0];", 
"", 
"<span class=\"ts\"/>switch (<a class=\"id\" href=\"#cmd\">cmd</a>) {", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#REQ_PARK_HEADS\">REQ_PARK_HEADS</a>:", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#REQ_UNPARK_HEADS\">REQ_UNPARK_HEADS</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ide_do_park_unpark\">ide_do_park_unpark</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#REQ_DEVSET_EXEC\">REQ_DEVSET_EXEC</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ide_do_devset\">ide_do_devset</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/>case <a class=\"id\" href=\"#REQ_DRIVE_RESET\">REQ_DRIVE_RESET</a>:", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ide_do_reset\">ide_do_reset</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/>default:", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#BUG\">BUG</a>();", 
"<span class=\"ts\"/>}", 
"}", 
"", 
"<span class=\"comment\">/**</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>start_request<span class=\"ts\"/>-<span class=\"ts\"/>start of I/O and command issuing for IDE</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>start_request() initiates handling of a new I/O request. It</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>accepts commands and I/O (read/write) requests.</span>", 
"<span class=\"comment\"> *</span>", 
"<span class=\"comment\"> *<span class=\"ts\"/>FIXME: this function needs a rename</span>", 
"<span class=\"comment\"> */</span>", 
" ", 
"static <a class=\"id\" href=\"#ide_startstop_t\">ide_startstop_t</a> <a class=\"id\" href=\"#start_request\">start_request</a> (<a class=\"id\" href=\"#ide_drive_t\">ide_drive_t</a> *<a class=\"id\" href=\"#drive\">drive</a>, struct <a class=\"id\" href=\"#request\">request</a> *<a class=\"id\" href=\"#rq\">rq</a>)", 
"{", 
"<span class=\"ts\"/><a class=\"id\" href=\"#ide_startstop_t\">ide_startstop_t</a> <a class=\"id\" href=\"#startstop\">startstop</a>;", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#BUG_ON\">BUG_ON</a>(!(<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_flags\">cmd_flags</a> &amp; <a class=\"id\" href=\"#REQ_STARTED\">REQ_STARTED</a>));", 
"", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#DEBUG\">DEBUG</a>", 
"<span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"%s: start_request: current=0x%08lx\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#name\">name</a>, (unsigned long) <a class=\"id\" href=\"#rq\">rq</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"", 
"<span class=\"ts\"/><span class=\"comment\">/* bail early if we've exceeded max_failures */</span>", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#max_failures\">max_failures</a> && (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#failures\">failures</a> &gt; <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#max_failures\">max_failures</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_flags\">cmd_flags</a> |= <a class=\"id\" href=\"#REQ_FAILED\">REQ_FAILED</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>goto <a class=\"id\" href=\"#kill_rq\">kill_rq</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#blk_pm_request\">blk_pm_request</a>(<a class=\"id\" href=\"#rq\">rq</a>))", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_check_pm_state\">ide_check_pm_state</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"", 
"<span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#hwif\">hwif</a>-><a class=\"id\" href=\"#tp_ops\">tp_ops</a>-><a class=\"id\" href=\"#dev_select\">dev_select</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#ide_wait_stat\">ide_wait_stat</a>(&amp;<a class=\"id\" href=\"#startstop\">startstop</a>, <a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#ready_stat\">ready_stat</a>,", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>  <a class=\"id\" href=\"#ATA_BUSY\">ATA_BUSY</a> | <a class=\"id\" href=\"#ATA_DRQ\">ATA_DRQ</a>, <a class=\"id\" href=\"#WAIT_READY\">WAIT_READY</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(<a class=\"id\" href=\"#KERN_ERR\">KERN_ERR</a> \"%s: drive not ready for command\\n\", <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#startstop\">startstop</a>;", 
"<span class=\"ts\"/>}", 
"", 
"<span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#special_flags\">special_flags</a> == 0) {", 
"<span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#ide_driver\">ide_driver</a> *<a class=\"id\" href=\"#drv\">drv</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * We reset the drive so we need to issue a SETFEATURES.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> * Do it _after_ do_special() restored device parameters.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#current_speed\">current_speed</a> == 0xff)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_config_drive_speed\">ide_config_drive_speed</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#desired_speed\">desired_speed</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_ATA_TASKFILE\">REQ_TYPE_ATA_TASKFILE</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#execute_drive_cmd\">execute_drive_cmd</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/>else if (<a class=\"id\" href=\"#blk_pm_request\">blk_pm_request</a>(<a class=\"id\" href=\"#rq\">rq</a>)) {", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>struct <a class=\"id\" href=\"#request_pm_state\">request_pm_state</a> *<a class=\"id\" href=\"#pm\">pm</a> = <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#special\">special</a>;", 
"#<a class=\"id\" href=\"#ifdef\">ifdef</a> <a class=\"id\" href=\"#DEBUG_PM\">DEBUG_PM</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#printk\">printk</a>(\"%s: start_power_step(step: %d)\\n\",", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drive\">drive</a>-><a class=\"id\" href=\"#name\">name</a>, <a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a>);", 
"#<a class=\"id\" href=\"#endif\">endif</a>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#startstop\">startstop</a> = <a class=\"id\" href=\"#ide_start_power_step\">ide_start_power_step</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>if (<a class=\"id\" href=\"#startstop\">startstop</a> == <a class=\"id\" href=\"#ide_stopped\">ide_stopped</a> &&", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>    <a class=\"id\" href=\"#pm\">pm</a>-><a class=\"id\" href=\"#pm_step\">pm_step</a> == <a class=\"id\" href=\"#IDE_PM_COMPLETED\">IDE_PM_COMPLETED</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#ide_complete_pm_rq\">ide_complete_pm_rq</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#startstop\">startstop</a>;", 
"<span class=\"ts\"/><span class=\"ts\"/>} else if (!<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#rq_disk\">rq_disk</a> && <a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#cmd_type\">cmd_type</a> == <a class=\"id\" href=\"#REQ_TYPE_SPECIAL\">REQ_TYPE_SPECIAL</a>)", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/><span class=\"comment\">/*</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * TODO: Once all ULDs have been modified to</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * check for specific op codes rather than</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * blindly accepting any special request, the</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * check for -&gt;rq_disk above may be replaced</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * by a more suitable mechanism or even</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> * dropped entirely.</span>", 
"<span class=\"comment\"><span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/> */</span>", 
"<span class=\"ts\"/><span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#ide_special_rq\">ide_special_rq</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>);", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/><a class=\"id\" href=\"#drv\">drv</a> = *(struct <a class=\"id\" href=\"#ide_driver\">ide_driver</a> **)<a class=\"id\" href=\"#rq\">rq</a>-><a class=\"id\" href=\"#rq_disk\">rq_disk</a>-><a class=\"id\" href=\"#private_data\">private_data</a>;", 
"", 
"<span class=\"ts\"/><span class=\"ts\"/>return <a class=\"id\" href=\"#drv\">drv</a>-><a class=\"id\" href=\"#do_request\">do_request</a>(<a class=\"id\" href=\"#drive\">drive</a>, <a class=\"id\" href=\"#rq\">rq</a>, <a class=\"id\" href=\"#blk_rq_pos\">blk_rq_pos</a>(<a class=\"id\" href=\"#rq\">rq</a>));", 
"<span class=\"ts\"/>}", 
"<span class=\"ts\"/>return <a class=\"id\" href=\"#do_special\">do_special</a>(<a class=\"id\" href=\"#drive\">drive</a>);", 
"<a class=\"id\" href=\"#kill_rq\">kill_rq</a>:", 
];
xr_frag_insert('l/ff/b44c40f0c953809f583c971dbef24adcd6c47e.xr', __xr_tmp);
